{
  "hash": "790bf85760f8d31778757601fd5354c2",
  "result": {
    "engine": "jupyter",
    "markdown": "\\newcommand{\\d}{\\,\\mathrm{d}}\n\\newcommand{\\e}{\\mathrm{e}}\n\\newcommand{\\E}{\\mathbb{E}}\n\n\n\n# Ito's Formula {#sec-c_ito}\n\nWe use the changes of a Brownian motion to model randomness.  We build other stochastic processes using those changes.  The general idea is\n$$\\text{change} = \\text{mean} + \\text{std dev} \\times \\text{change in Brownian motion}\\,.$$\nThe mathematical foundations for our construction were created by K. Ito.  The key concepts are the Ito integral, Ito processes, and Ito's formula (also called Ito's lemma).  Using these foundations, we can build quite general processes from changes in Brownian motions, including processes with non-normal distributions.\n\n## Examples {#sec-s_discreteito}\n\nWe begin with some simple examples.  Consider a discrete partition of a time interval:\n$$0=t_0 < t_1< \\cdots < t_{n-1} < t_n=t$$\nwith equally spaced times.  Let $\\Delta t$ denote the difference between successive times.  \n\nFirst, let's drop the randomness entirely.  Consider the equation\n$$X_{t_i} -  X_{t_{i-1}} = \\mu X_{t_{i-1}}\\Delta t$$ {#eq-ito_discrete_1}\nfor a constant $\\mu$.  Thus, we have \"change $\\,=\\,$ mean,\" where the mean is proportional to the previous value with proportionality factor $\\mu \\Delta t$.  @fig-discrete-interest presents a plot of $X$, for particular values of $X_0$, $\\mu$, and $\\Delta t$.\n\nIf we increase $n$, making $\\Delta t$ smaller, then $X$ will converge to the solution of the ordinary differential equation\n$$\\d X_t = \\mu X_t\\,\\d t\\,.$$ {#eq-ito_discrete_2}\n@eq-ito_discrete_2 has a known solution, which is \n$$X_t = X_0 \\e^{\\mu t}\\,.$$ {#eq-ito_discrete_3}\nTo verify this, we only need to differentiate $X$ defined in @eq-ito_discrete_3:\n$$\\frac{\\d X_t}{\\d t} = \\mu X_0 \\e^{\\mu t} = \\mu X_t\\,.$$\nThe function presented in @eq-ito_discrete_3 is also shown in @fig-discrete-interest.\n\n::: Extra\n\nTo see how one might guess that @eq-ito_discrete_3 is the solution of @eq-ito_discrete_2, we can examine the logarithm of $X$.  A general rule gives us $\\d \\log X = \\d X / X$, so $\\d \\log X = \\mu \\d t$.  We can integrate both sides of this to obtain $\\log X_t - \\log X_0 = \\mu t$.  Now, rearranging and exponentiating gives $X_t = X_0\\e^{\\mu t}$.  We will eventually follow similar steps to see that @eq-ito_discrete_6 is the solution of @eq-ito_discrete_5.\n:::\n\n::: {#cell-fig-discrete-interest .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np \nimport plotly.graph_objects as go \nfig = go.Figure()\nfig.update_layout(\n    xaxis_title='Time',\n    yaxis_title='Binomial Process',\n    template='plotly_white',\n    height=300,\n)\nfig.show()\n```\n\n::: {#fig-discrete-interest .cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"405bca84-2df5-4736-82b1-7173183236c9\" class=\"plotly-graph-div\" style=\"height:300px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"405bca84-2df5-4736-82b1-7173183236c9\")) {                    Plotly.newPlot(                        \"405bca84-2df5-4736-82b1-7173183236c9\",                        [],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"title\":{\"text\":\"Time\"}},\"yaxis\":{\"title\":{\"text\":\"Binomial Process\"}},\"height\":300},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('405bca84-2df5-4736-82b1-7173183236c9');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n\nThe functions $X$ satisfying @eq-ito_discrete_1 and @eq-ito_discrete_3 for X0 = 1, mu = 1, and Delta t = 0.1.\n:::\n:::\n\n\nNow, let's include randomness.  Let's make the noise proportional to the value of $X$,  So, let $B$ be a standard Brownian motion and consider the equation\n$$X_{t_i} - X_{t_{i-1}} = \\mu X_{t_{i-1}}\\Delta t + \\sigma X_{t_{i-1}} \\Delta B_{t_i}$$ {#eq-ito_discrete_4}\nwhere $\\sigma$ is another constant, and $\\Delta B_{t_i} = B_{t_i} - B_{t_{i-1}}$.  A solution $X$ of this equation will have random paths, due to the random noise $\\Delta B_{t_i}$.  An example of a path is shown in @fig-discrete-random.\nIto showed how we can take the limit of this equation as we make $\\Delta t$ smaller and make sense of the equation\n$$\n\\d X_t = \\mu X_t\\,\\d t + \\sigma X_t \\,\\d B_t\\,.\n$$ {#eq-ito_discrete_5}\nThe solution $X$ of @eq-ito_discrete_5 is\n$$X_t = \\e^{(\\mu  - \\sigma^2/2)t + \\sigma B_t}\\,.$$ {#eq-ito_discrete_6}\nAn approximate path of this process $X$ is also shown in @fig-discrete-random.  It is generated by taking $\\Delta t$ very small, just as we generated approximate paths of Brownian motions in @sec-c_brownian.  We can show that $X$ defined in @eq-ito_discrete_6 satisfies @eq-ito_discrete_5 by differentiating, as we showed that $X$ defined in @eq-ito_discrete_3 satisfies @eq-ito_discrete_2.  However, we first need to explain Ito's formula, which is a formula for differentiating functions of Brownian motions and, more generally, functions of Ito processes.\n\n::: {#cell-fig-discrete-random .cell execution_count=2}\n``` {.python .cell-code}\nimport numpy as np \nimport plotly.graph_objects as go \nfig = go.Figure()\nfig.update_layout(\n    xaxis_title='Time',\n    yaxis_title='Binomial Process',\n    template='plotly_white',\n    height=300,\n)\nfig.show()\n```\n\n::: {#fig-discrete-random .cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"9119254c-a8ea-40f7-b785-b1da809f1c35\" class=\"plotly-graph-div\" style=\"height:300px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"9119254c-a8ea-40f7-b785-b1da809f1c35\")) {                    Plotly.newPlot(                        \"9119254c-a8ea-40f7-b785-b1da809f1c35\",                        [],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"title\":{\"text\":\"Time\"}},\"yaxis\":{\"title\":{\"text\":\"Binomial Process\"}},\"height\":300},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('9119254c-a8ea-40f7-b785-b1da809f1c35');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n\nPaths of the processes satisfying @eq-ito_discrete_4 and @eq-ito_discrete_6 for X0 = 1, mu = 1, Delta t = 0.1, and sigma = 1.\n:::\n:::\n\n\nThe functions and processes $X$ defined in this section have important interpretations.  @eq-ito_discrete_1 can be rewritten to say that the percent change in $X$ is $\\mu \\Delta t$.  This could represent the value of a savings account that earns interest of $\\mu \\Delta t$ in each period of length $\\Delta t$.  This is the common way of calculating, for example, monthly interest, where $\\mu$ is called the annual rate of interest and $\\Delta t$ would be $1/12$.  The limiting @eq-ito_discrete_3 is called continuous compounding of interest.\n\nSimilarly, @eq-ito_discrete_4 can be rewritten to say that the percent change in $X$ is $\\mu \\Delta t + \\sigma \\Delta B$.  This represents a random rate of return -- for example, the return of a stock.  The expected rate of return in this case is $\\mu \\Delta t$, and the variance of the rate of return is $\\sigma^2 \\Delta t$.  The limiting @eq-ito_discrete_3 is called continuous compounding of returns.\n\n\n\n## Ito Processes {#sec-s_itoprocesses}\n\nThe meaning of @eq-ito_discrete_2 is that, for all $t  > 0$,\n$$X_t = X_0 +  \\int_0^t \\mu X_s \\d s\\,.$$\nWe assume the reader is familiar with integrals, so we do not explain this further.  The function of time $X$ defined in @eq-ito_discrete_3 satisfies this equation.  Similarly, the meaning of @eq-ito_discrete_5 is that, for all $t > 0$,\n$$X_t = X_0 +  \\int_0^t \\mu X_s \\d s + \\int_0^t \\sigma X_s \\d B_s\\,.$$\nThe first integral in this formula is an ordinary integral.  The second is an Ito integral, which is to be explained.  The sum of an ordinary integral and an Ito integral is called an Ito process.  An Ito process always has continuous paths. \n\nLet's depart from the example of the previous section and consider a process $X$ satisfying, for all $t>0$,\n$$X_t = \\int_0^t \\alpha_s\\d s + \\int_0^t \\theta_s \\d B_s\\,.$${#eq-ito1}\nwhere $\\alpha$ and $\\theta$ can be stochastic processes.  The example of the previous section fits this form, because we could take $\\alpha_s = \\mu X_s$ and $\\theta_s = \\sigma X_s$.  The definition of the Ito integral\n$$\\int_0^t \\theta_s \\d B_s$$\nis relatively complicated.  It is enough for our purposes to know that it can be approximated by a  discrete sum\n$$\\sum_{i=1}^n \\theta_{t_{i-1}}(B_{t_i} - B_{t_{i-1}})\\,,$$\ngiven a partition\n$$ 0 = t_0 < \\cdots < t_n = t\\,,$$\nwhen $n$ is large and the time between successive dates is small.  The Ito integral exists provided $\\theta$ does not anticipate the future (so $\\theta_{t_{i-1}}$ is independent of the increment $B_{t_i}- B_{t_{i-1}}$) and provided $\\theta$ does not explode to $\\pm \\infty$ in finite time, so \n$$\\int_0^t \\theta_s^2 \\d s < \\infty$$\nfor all $t > 0$, with probability one.\n\nWe also write @eq-ito1 as\n$$\n\\d X_t = \\alpha_t\\d t + \\theta_t \\d B_t\\,. \n$${#eq-ito2}\nWe interpret this as \"change $=$ mean $+$ noise\" with $\\alpha_t \\d t$ being the mean and $\\theta_t\\d B_t$ being the mean-zero random noise.    The quantity $\\alpha_t$  is also called the drift of the process $X$ at time $t$.   \\index{drift} The coefficient $\\sigma_t$ is called the diffusion coefficient of $X$ at time $t$.  \\index{diffusion coefficient}\nIf $\\alpha$ and $\\theta$ are constant, it is standard to refer to an Ito process $X$ as a $(\\alpha,\\theta)$--Brownian motion.  When they are constant, we obtain\n$$X_t= X_0 + \\alpha t + \\theta B_t\\,.$$\n\nAn Ito process as in @eq-ito1 can be a martingale only if $\\alpha=0$.  This should seem sensible, because $\\alpha\\d  t$ is the expected change in $X$, and a process is a martingale only if its expected change is zero.   This observation plays a fundamental role in deriving asset pricing formulas.  Conversely, if $\\alpha=0$ and \n$$\n\\E \\left[\\int_0^t \\theta^2_s\\,\\d  s\\right] < \\infty\n$$ {#eq-regularity1}\nfor each $t$, then the Ito process is a continuous martingale, and the variance of its date--$t$ value, calculated with the information available at date $0$, is:\n$$\\mathrm{var}(X_t) = \\E \\left[\\int_0^t \\theta^2_t\\d  s\\right]\\; .$$  \n\n## Quadratic Variation of an Ito Process\n\nThe quadratic variation of the Ito process $X$ defined in @eq-ito2 through each date $t$ is \n$$\n\\int_0^t \\theta^2_s\\d  s\n$$ \nwith probability one.  In fact, when @eq-regularity1 holds, a somewhat more precise definition of the stochastic integral is the (unique) martingale with quadratic variation given by @eq-itoquadraticvariation.\n\nTo compute the quadratic variation of an Ito process, we use the following simple and important rules (for the sake of brevity, we drop the subscript $t$ from $B_t$ here and sometimes later).  These rules should be regarded as mnemonic devices.  The calculations we will do with them lead to the correct results, but the objects have no real mathematical meaning.\n\n::: Rule\n## \n\n\n$$\n(\\d  t)^2 = 0\\;, \n$$ {#eq-dtsquared}\n\n$$\n(\\d  t)(\\d  B) =0\\;, \n$$ {#eq-dB}\n\n$$\n(\\d  B)^2 =\\d  t\\;. \n$$ {#eq-dBsquared}\n\n\n\n:::\n\n\nWe apply these rules to compute the quadratic variation of $X$ as follows:\n\n::: Rule\n## \nIf $\\d  X = \\alpha\\,\\d  t + \\theta\\,\\d  B$ for a Brownian motion $B$, then\n\\begin{align*}\n(\\d  X)^2 &= (\\alpha\\,\\d  t+\\theta\\,\\d  B)^2\\\\\n&= \\alpha^2(\\d  t)^2 + 2\\alpha\\theta(\\d  t)(\\d  B) + \\theta^2(\\d  B)^2\\\\\n&= \\theta^2\\,\\d  t\\;.\n\\end{align*}\n:::\n\nWe integrate $(\\d X)^2$ over a time interval to compute the quadratic variation of $X$ over that period as:^[In a more formal mathematical presentation, one normally writes $\\d \\langle X,X\\rangle$ for what we are writing here as $(\\d  X)^2$.  This is the differential of the quadratic variation process, and the quadratic variation through date $T$ is\n$$\n\\langle X,X\\rangle _t = \\int_0^T \\d \\langle X,X\\rangle_t = \\int_0^T \\sigma^2_t\\,\\d  t\\;.\n$$]\n$$\n\\int_0^t (\\d  X_s)^2 = \\int_0^t \\theta^2_s\\,\\d  s\\;.\n$$ {#eq-itoquadraticvariation2}\n\n\n\n\n## Introduction to Ito's Formula {#sec-s_itosformula}\n\nFirst we recall some facts of the ordinary calculus.  If $y=f(x)$ and $x_t = g(t)$ with $f$ and $g$ being continuously differentiable functions, then \n$$\\frac{\\d  y}{\\d  t} = \\frac{\\d  y}{\\d  x}\\times \\frac{\\d  x}{\\d  t} = f'(x_t)g'(t)\\; .$$\nThis implies that, for each $t>0$,\n$$y_t = f(x_t) = y_0 + \\int_0^t \\frac{\\d  y}{\\d  s}\\,\\d  s = y_0 + \\int_0^t f'(x_s)g'(s)\\,\\d  s\\; .$$\nSubstituting $\\d x_s = g'(s)\\,\\d  s$, we can also write this as\n$$\ny_t = f(x_t) = y_0 + \\int_0^t f'(x_s)\\,\\d  x_s\\,,\n$$ {#eq-ordinarycalculus}\nor, in differential form,\n$$\ndy_t = f'(x_t)\\d x_t \\,.\n$$ {#eq-ordinarycalculus2}\nWhat people frequently remember about integrals from their calculus courses is that there are a lot of tricky substitutions that can be made to simplify the calculation of various integrals.  We won't need those in this book.  All we will use are equations of the form of @eq-ordinarycalculus, which is a special case of what is called the Fundamental Theorem of Calculus.  Intuitively, we can think of @eq-ordinarycalculus as saying that the change in $y$ over a discrete interval (from $0$ to $t$) is the continuous sum (integral) of its infinitesimal changes.  This is the principle that will be applied throughout the book.\n\nLet's contrast  @eq-ordinarycalculus  with a special case of Ito's formula for the calculus of Ito processes.  If $B$ is a Brownian motion and $Y = f(B)$ for a twice-continuously differentiable function $f$, then \n$$\\,\\d  Y_t = f'(B_t)\\,\\d  B_t + \\frac{1}{2}f''(B_t)\\,\\d  t + \\,. \n$$ {#eq-ito0}\nComparing @eq-ito0 to @eq-ordinarycalculus2, we see that Ito's formula has an extra term involving the second derivative $f''$.   \n\n@eq-ito0 implies that $Y=f(B)$ is an Ito process with drift $f''(B_t)/2$ and diffusion coefficient $f'(B_t)$.  The real meaning of @eq-ito0 is the integrated form:\n$$\nY_t = f(B_t) = Y_0 + \\int_0^t f'(B_s)\\,\\d  B_s + \\frac{1}{2}\\int_0^t f''(B_s)\\,\\d  s\\;.\n$$ {#eq-itonew1}\nThus, the change in $Y$ over a discrete interval is again the continuous sum of its infinitesimal changes, but now the infinitesimal changes are given by @eq-ito0.  Note that the first integral in @eq-itonew1 is an Ito integral.\n\nTo gain some intuition for the extra term in Ito's formula, we return to the ordinary calculus.  Given dates $s<t$, the derivative defines a linear approximation of the change in $y$ from $s$ to $t$; that is, setting $\\Delta x = x_t-x_s$ and $\\Delta y = y_t - y_s$, we have the approximation\n$$\\Delta y \\approx f'(x_s) \\,\\Delta x\\; .$$\nA better approximation is given by the second-order Taylor series expansion\n$$\\Delta y \\approx f'(x_s)\\,\\Delta x + \\frac{1}{2} f''(x_s)\\,(\\Delta x)^2\\; .$$\nAn interpretation of  @eq-ordinarycalculus is that the linear approximation works perfectly for infinitesimal time periods $\\d  s$, because we can compute the change in $y$ over the time interval $[0,t]$ by summing up the infinitesimal changes $f'(x_s)\\,\\d  x_s$.  In other words, the second-order term $\\frac{1}{2} f''(x_s)\\,(\\Delta x)^2$ vanishes when we consider very short time periods.\n\nThe second-order Taylor series expansion in the case of $Y=f(B)$ is \n$$\\Delta Y \\approx f'(B_s)\\,\\Delta B + \\frac{1}{2} f''(B_s)\\,(\\Delta B)^2\\; .$$\nFor example, given a partition $0=t_0 < t_1 < \\cdots < t_n=t$ of the time interval $[0,t]$, we have, with the same notation we have used earlier,\n\n$$\nY_t = Y_0 + \\sum_{i=1}^n \\Delta Y_{t_i}  \n\\approx Y_0 + \\sum_{i=1}^n f'(B_{t_{i-1}})\\,\\Delta B_{t_i} + \\frac{1}{2} \\sum_{i=1}^n f''(B_{t_{i-1}})\\,(\\Delta B_{t_i})^2\\;.\n$$ {#eq-itonew2}\n\n\nIf we make the time intervals $t_i-t_{i-1}$ shorter, letting $n \\rightarrow \\infty$, then we cannot expect that the extra term here will disappear, leading to the result  of the ordinary calculus shown in @eq-ordinarycalculus, because we know that\n$$\\lim_{n \\rightarrow \\infty} \\sum_{i=1}^n (\\Delta B_{t_i})^2 = t\\; ,$$\nwhereas for the continuously differentiable function $x_t = g(t)$, the same limit is zero.  In fact it seems sensible to interpret the limit of $(\\Delta B)^2$ as $(\\d  B)^2 =\\d  t$.\nThis is perfectly consistent with Ito's formula: if we take the limit in @eq-itonew2, replacing the limit of $(\\Delta B_{t_i})^2$ with $(\\d  B)^2 = \\d  t$, we obtain @eq-itonew1.\n\nTo see the accuracy of Ito's approximation over different time steps, as well as the impact of the second-derivative term $\\int_0^t (1/2)f''(B_s)\\d s$, we encourage readers to interact with the plot below.  It examines the function $f(x)=\\e^{x}$ (for which we have $f'(x)=\\e^x$ and $f''(x) = \\e^x$).  It simulates an approximate path of a Brownian motion as we have done before.  It then compares the true value of $\\e^{B_{t_i}}$ to the Ito expansion \n$$\\e^{B_t}=1 + \\int_0^t \\e^{B_s} \\d B_s + \\frac{1}{2}\\int_0^t \\e^{B_s} \\d s$$\nusing the discretization \n$$\\Delta \\e^{B_{t_i}}= \\e^{B_{t_{i-1}}} \\Delta B_{t_i} + \\frac{1}{2} \\e^{B_{t_{i-1}}} \\Delta t \\,.$$\nNotice that the discretization is just a second-order Taylor series expansion.  The discretization will approximate the true value better if we take $n$ larger and $\\Delta t$ smaller.  The important take-away from the figure is that the cumulative second-derivative terms in the discretization \ndo not vanish as we take $n$ larger but instead continue to contribute significantly to the approximation.\n\n\n::: {#fig-interactive_ito fig-cap=\"Accuracy of Ito Approximation\"}\n<iframe width=\"780\" height=\"1000\" src=\"https://derivatives-book-26ac36570fb8.herokuapp.com/math_finance_book_plots/ito_approx_plot\"></iframe>\n:::\n\n## Univariate Ito's Formula\n\nWe extend the example in the previous section slightly.\nConsider a process $Y$ defined as $Y_t = f(t, B_t)$ for some function $f$.  The following rule states that $Y$ is an Ito process with drift equal to\n$$\\frac{\\partial f}{\\partial t} + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial B^2}$$ \nand diffusion coefficient equal to\n$\\partial f/\\partial B$.\nThis is what we need to remember to make calculations.  The real meaning of $(\\d B)^2$ is $\\d t$, so we can (and will) substitute that in the following rule, but it may be easier to remember $(\\d B)^2$.  This becomes more important when we consider more complex examples in the next section.\n\n::: Rule\n\nIf $f(t, B)$ is continuously differentiable in $t$ and twice continuously differentiable in $B$ and $Y_t= f(t, B_t)$ for a standard Brownian motion $B$, then\n$$\\d Y_t = \\frac{\\partial f(t, B_t)}{\\partial t}\\d t + \\frac{\\partial f(t, B_t)}{\\partial B}\\d B_t + \\frac{1}{2} \\frac{\\partial^2 f(t, B_t)}{\\partial B^2}(\\d B_t)^2\\,.\n$$ {#eq-ito-firstformula}\n:::\n\nWe can apply this rule to finish the discussion in @sec-s_discreteito regarding the process defined in @eq-ito_discrete_6.  We want to show that it satisfies @eq-ito_discrete_5.  We do that by differentiating and applying the above rule.  For $f(t, B) = \\e^{(\\mu - \\sigma^2/2)t + \\sigma B}$, we have\n$$\\frac{\\partial f}{\\partial t} = \\left(\\mu-\\frac{1}{2}\\sigma^2\\right)f(t, B)\\,,\\quad \\frac{\\partial f}{\\partial B} = \\sigma f(t, B)\\,, \\quad \\frac{\\partial^2 f}{\\partial B^2} = \\sigma^2f(t, B)\\,.$$\nTherefore,\n$$\\d Y_t = \\left(\\mu-\\frac{1}{2}\\sigma^2\\right)Y_t\\d t + \\sigma Y_t \\d B_t + \\frac{1}{2}\\sigma^2 Y_t\\,(\\d B_t)^2 = \\mu Y_t\\d t + \\sigma Y_t \\d B_t$$\nThis verifies @eq-ito_discrete_5.\n\n## Extension to Functions of Ito Processes\n\nNow consider the more general case $Y_t = f(t, X_t)$ where $X$ is an Ito process.  As explained before, this means that\n$$\\d X_t = \\alpha_t\\d t + \\theta_t \\d B_t\n$$ {#eq-itoagain}\nfor some stochastic processes $\\alpha$ and $\\theta$, where $B$ is a standard Brownian motion.  Then, from our previous rules, $(\\d X)^2 = \\theta^2\\d t$.  Thankfully, Ito's formula in this more general case can be written in a form that is almost identical to what we saw in the previous section.\n\n::: {.Rule #ruleito2}\nIf $f(t, X)$ is continuously differentiable in $t$ and twice continuously differentiable in $X$ and $Y_t= f(t, X_t)$ where $X$ is an Ito process, then\n$$\\d Y_t = \\frac{\\partial f(t, X_t)}{\\partial t}\\d t + \\frac{\\partial f(t, X_t)}{\\partial X}\\d X_t + \\frac{1}{2} \\frac{\\partial^2 f(t, X_t)}{\\partial X^2}(\\d X_t)^2\\,.\n$$ {#eq-ito-secondformula}\n\n:::\n\nWe can write @eq-ito-secondformula in terms of $\\d t$ and $\\d B$ terms by substituting from @eq-itoagain and using $(\\d X)^2 = \\theta^2\\d t$.  This produces\n$$\\d Y_t = \\left(\\frac{\\partial f(t, X_t)}{\\partial t} + \\alpha_t\\frac{\\partial f(t, X_t)}{\\partial X} + \\frac{1}{2}\\theta_t^2 \\frac{\\partial^2 f(t, X_t)}{\\partial X^2}\\right)\\d t + \\theta_t\\frac{\\partial f(t, X_t)}{\\partial X}\\d B_t\\,.$$\n\n::: Extra\nWe already verified that $X$ defined in @eq-ito_discrete_6 satisfies @eq-ito_discrete_5, but it is also useful to see how we could start from @eq-ito_discrete_5 and deduce that @eq-ito_discrete_6 is the solution.  We can do that by taking logarithms, as we did in the non-random case in @sec-s_discrete.  Set $Y_t = \\log X_t$.  Then, using Calculation Rule \\ref{ruleito2}, we have\n$$\\d \\log X = \\frac{1}{X}\\d X - \\frac{1}{2X^2}(\\d X)^2\\,.$$\nSubstituting from @eq-ito_discrete_5 gives\n$$\\d \\log X = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)\\d t + \\sigma\\d B\\,.$$\nThere is no $X$ on the right-hand side of this, so we can simply integrate to compute $\\log X_t$ as\n$$\\log X_t = \\log x_0 + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma B_t\\,.$$\nExponentiating gives @eq-ito_discrete_6.\n\n:::\n\n## Extension to Functions of Multiple Ito Processes\n\nConsider two Ito processes\n\n\n$$\n\\d  X_t = \\mu_x_t\\,\\d  t + \\sigma_x_t\\,\\d  B_x_t\\;,\n$$ {#eq-itoprocess110}\n\n$$\n\\d  Y_t = \\mu_y_t\\,\\d  t + \\sigma_y_t\\,\\d  B_y_t\\;,\n$$ {#eq-itoprocess111}\n\n\n\nwhere $B_x$ and $B_y$ can be different Brownian motions.  The relation between the two Brownian motions is determined by their covariance or correlation.  Given dates $t<u$, we know that both changes $B_x(u)-B_x_t$ and $B_y(u)-B_y_t$ are normally distributed with mean 0 and variance equal to $u-t$.  There will exist a (possibly random) process $\\rho$ such that the covariance \\index{covariance} of these two normally distributed random variables, given the information at date $t$, is \n$$\\E_t \\left[\\int_t^u \\rho_s\\,\\d  s\\right]\\; .$$\nThe process $\\rho$ is called the correlation coefficient of the two Brownian motions, \\index{correlation coefficient} because when it is constant the correlation of the changes $B_x(u)-B_x_t$ and $B_y(u)-B_y_t$ is\n$$\\frac{\\text{covariance}}{\\text{product of standard deviations}}  = \\frac{\\int_t^u \\rho \\,\\d  s}{\\sqrt{u-t} \\sqrt{u-t}} = \\frac{(u-t)\\rho}{u-t} = \\rho\\; .$$\nMoreover, given increasingly fine partitions $0=t_0 < \\cdots < t_N=T$ of an interval $[0,T]$ as before, we will have\n$$\\sum_{i=1}^N \\Delta B_x_{t_i} \\times \\Delta B_y_{t_i} \\rightarrow \\int_0^T \\rho_t\\,\\d  t$$\nas $N \\rightarrow \\infty$, with probability one.  \n\nWe know that\n$$\\sum _{i=1}^N [\\Delta X_{t_i}]^2 \\rightarrow \\int_0^T \\sigma_x^2_t\\,\\d  t \\quad \\text{and}\\quad  \\sum _{i=1}^N [\\Delta Y_{t_i}]^2 \\rightarrow \\int_0^T\\sigma_y^2_t\\,\\d  t\\;.\n$$ {#eq-itoprocess112}\n\nFurthermore, it can be shown that the sum of products satisfies\n$$\n\\sum_{i=1}^N \\Delta X_{t_i} \\times \\Delta Y_{t_i} \\rightarrow \\int_0^T \\sigma_x_t\\sigma_y_t\\rho_t\\,\\d  t\\;.\n$$ {#eq-itoprocess113}\n\n\n::: Rule\n## \nBy adding the rule \n$$\n(\\d  B_x)(\\d  B_y) = \\rho\\,\\d  t \n$$ {#eq-\\,\\d  B\\,\\d  B}\n to the rules @eq-\\,\\d  tsquared--@eq-\\,\\d  Bsquared, we can compute the limit in @eq-itoprocess113 as\n\n$$\n\\lim_{N \\rightarrow\\infty} \\sum_{i=1}^N \\Delta X_{t_i} \\times \\Delta Y_{t_i}  = \\int_0^T (\\d  X)(\\d  Y)\n$$\n$$\n= \\int_0^T (\\mu_x\\,\\d  t +\\sigma_x\\,\\d  B_x)(\\mu_y\\,\\d  t+\\sigma_y\\,\\d  B_y)\n$$\n$$\n= \\int_0^T\\sigma_x_t\\sigma_y_t \\rho_t\\,\\d  t\\;.\n$$ {#eq-itojointvariation}\n\n\n:::\n\n\nThe most general case of Ito's formula that we will need is for a function $Z_t = g(t, X_t, Y_t)$ where $X$ and $Y$ are Ito processes as in @eq-itoprocess110 - @eq-itoprocess111.  In this case, Ito's formula is^[We need to assume $g(t,x,y)$ is continuously differentiable in $t$ and twice continuously differentiable in $(x,y)$ for @eq-itogeneralnew and @eq-itogeneralnew2 to be valid.  Note also that we are using a short-hand notation here.  The partial derivatives of $g$ will generally depend on $t$, $X_t$ and $Y_t$ just as $g$ does.]\n\n$$\nZ_t = Z_0 + \\int_0^T \\frac{\\partial g}{\\partial t}\\,\\d  t + \\int_0^T \\frac{\\partial g}{\\partial x}\\,\\d  X_t + \\int_0^T \\frac{\\partial g}{\\partial y}\\,\\d  Y_t \n$$\n$$\n+ \\frac{1}{2} \\int_0^T \\frac{\\partial^2 g}{\\partial x^2}\\,(\\d  X_t)^2 +  \\frac{1}{2} \\int_0^T \\frac{\\partial^2 g}{\\partial y^2}\\,(\\d  Y_t)^2 \n$$\n$$\n+  \\int_0^T \\frac{\\partial^2 g}{\\partial x\\partial y}\\,(\\d  X_t)( \\d  Y_t)\\;.\n$$ {#eq-itogeneralnew}\n\n\nIn this equation, we apply  @eq-dtsquared--@eq-dB to compute\n\\begin{align*}\n(\\d  X_t)^2&= \\sigma_x^2_t\\,\\d  t\\; ,\\\\\n(\\d  Y_t)^2 &= \\sigma_y^2_t\\,\\d  t\\; ,\\\\\n(\\d  X_t)( \\d  Y_t) &= \\sigma_x_t\\sigma_y_t\\rho_t\\,\\d  t\\;.\n\\end{align*}\nIto's formula (@eq-itogeneralnew) appears a bit simpler (and easier to remember) if we write it in differential form.  We have:\n\n\n::: Rule\n## \nIf $Z_t = g(t, X_t, Y_t)$ where $X$ and $Y$ are Ito processes as in @eq-itoprocess110 - @eq-itoprocess111, then\n\n$$\n\\d  Z =  \\frac{\\partial g}{\\partial t}\\,\\d  t + \\frac{\\partial g}{\\partial x}\\,\\d  X +  \\frac{\\partial g}{\\partial y}\\,\\d  Y + \\frac{1}{2} \\frac{\\partial^2 g}{\\partial x^2}\\,(\\d  X)^2 +  \\frac{1}{2}  \\frac{\\partial^2 g}{\\partial y^2}\\,(\\d  Y)^2 \n$$\n$$\n+ \\frac{\\partial^2 g}{\\partial x\\partial y}\\,(\\d  X)(\\d  Y)\\;.\n$$ {#eq-itogeneralnew2}\n\n\n\n:::\n\n\n## Examples of Ito's Formula {#sec-s_examples}\nThe following are the applications of Ito's formula that will be used most frequently in the book.  They follow from the boxed formula at the end of the previous section by taking $g(x,y)=xy$ or $g(x,y)=y/x$ or $g(x)=\\e^x$ or $g(x) = \\log x$.\n\n\n\n\n::: Rule\n\n**Products.**\nIf $Z=XY$, then $\\d  Z=X\\,\\d  Y+Y\\,\\d  X + (\\d  X)(\\d  Y)$.  We can write this as\n$$\n\\frac{\\d  Z}{Z}=\\frac{\\d  X}{X} + \\frac{\\d  Y}{Y} + \\left(\\frac{\\d  X}{X}\\right)\\left(\\frac{\\d  Y}{Y}\\right)\\;.\n$$ {#eq-rule2}\n\n\n:::\n\n\n\n\n::: Rule\n\n**Ratios.**\nIf $Z=Y/X$, then \n$$\\frac{\\d  Z}{Z} = \\frac{\\d  Y}{Y} -\\frac{\\d  X}{X} - \\left(\\frac{\\d  Y}{Y}\\right)\\left(\\frac{\\d  X}{X}\\right) + \\left(\\frac{\\d  X}{X}\\right)^2\\;.\n$$ {#eq-rule4}\n\n\n:::\n\n\n\n::: Rule\n\n**Exponentials.**\nIf $Z=\\mathrm{e}^X$, then \n$$\\frac{\\d  Z}{Z}=\\d  X + \\frac{(\\d  X)^2}{2}\\;.\n$$ {#eq-rule5}\n\n\n:::\n\n\n\n::: Rule\n\n**Logarithms.**\nIf $Z=\\log X$, then\n$$\n\\d  Z=\\frac{\\d  X}{X} - \\frac{1}{2}\\left(\\frac{\\d  X}{X}\\right)^2\\;.\n$$ {#eq-rule6}\n\n\n:::\n\n\n\n::: Rule\n\n**Compounding/Discounting.**\nLet  \n$$Y_t =\\exp\\left(\\int_0^t q_s\\,\\d  s\\right)$$\nfor some (possibly random) process $q$ and define $Z=XY$ for any Ito process $X$.\nThe usual calculus gives us \n$\\d  Y_t=q_tY_t\\,\\d  t$,\nand the product rule above implies\n$$\n\\frac{\\d  Z}{Z}=q\\,\\d  t + \\frac{\\d  X}{X}\\;.\n$$ {#eq-compdisc1}\n\nThis is the same as in the usual calculus.  \n\n:::\n\n\n\n## {.unnumbered}\n\n\n::: Exercise\n Consider a discrete partition $0=t_0 < t_1 < \\cdots t_N=T$ of the time interval $[0,T]$ with $t_i - t_{i-1} = \\Delta t = T/N$ for each $i$.  Consider the function \n$$X_t=\\mathrm{e}^t\\; .$$\nWrite a code, which computes and plots $\\sum_{i=1}^N [\\Delta X_{t_i}]^2$, where \n$$\\Delta X_{t_i} = X_{t_i}-X_{t_{i-1}} = \\mathrm{e}^{t_i} - \\mathrm{e}^{t_{i-1}}\\; .$$\n:::\n::: Exercise\n Repeat the previous problem for the function $X_t = t^3$.  In both this and the previous problem, what happens to $\\sum_{i=1}^N [\\Delta X_{t_i}]^2$ as $N \\rightarrow \\infty$?\n:::\n::: Exercise\n Either use the code provided or write a code to compute $\\sum_{i=1}^N [\\Delta B_{t_i}]^2$, where $B$ is a simulated Brownian motion.  For a given $T$, what happens to the sum as $N \\rightarrow \\infty$?  \n:::\n::: Exercise\n Repeat the previous problem to compute $\\sum_{i=1}^N [\\Delta B_{t_i}]^3$, where $B$ is a simulated Brownian motion.  For a given $T$, what happens to the sum as $N \\rightarrow \\infty$?  \n:::\n::: Exercise\n Repeat the previous problem, computing instead $\\sum_{i=1}^N |\\Delta B_{t_i}|$ where $| \\cdot |$ denotes the absolute value.  What happens to this sum as $N \\rightarrow \\infty$?\n:::\n::: Exercise\nUse Ito's Lemma to derive the stochastic differential equation for $S_t^2$.  Argue that $S_t^2$ is geometric Brownian motion and find $\\E[S_t^2]$.\n::: \n::: Exercise\nIto's Lemma can be used in different ways to get the same answer.  For example, let $X_t = a t + b B_t$ and use Ito's lemma on the function $\\e^{X_t}$.  Alternatively, let $f(t, B_t) = \\e^{a t + bB_t}$.  Use Ito's lemma on $f(,)$.\n::: \n::: Exercise \nUse the facts $\\e^{x+y}=\\e^x \\times \\e^y$ and $\\frac{\\e^x}{\\e^y} = \\e^{x-y}$ to deduce the drift and volatility of the product and ratio of two geometric Brownian motions.\n::: \n::: Exercise\n Consider a discrete partition $0=t_0 < t_1 < \\cdots t_N=T$ of the time interval $[0,T]$ with $t_i - t_{i-1} = \\Delta t = T/N$ for each $i$.  Consider a geometric Brownian motion\n$$\\frac{\\d  Z}{Z} = \\mu\\,\\d  t + \\sigma\\,\\d  B\\; .$$\nAn approximate path $\\tilde{Z}_t$ of the geometric Brownian motion can be simulated as\n$$\n\\Delta \\tilde{Z}_{t_i} = \\tilde{Z}_{t_{i-1}} \\big[ \\mu\\,\\Delta t + \\sigma\\,\\Delta B\\big]\\;.\n$$ {#eq-exponential111}\nModify the code to generate both a path $Z_t$ and an approximate path $\\tilde{Z}_t$ according to @eq-exponential111, using the same $\\Delta B$  for both paths and taking $\\tilde{Z}_0 = Z_0$.  Plot both paths in the same figure.  How well does the approximation work for large $N$?   Warning:  \nFor $N$ larger than about $100 T$, the approximation will look perfect---you won't be able to tell that there are two plots in the figure.  One reason this is true is an exact formula is \n$$\n Z_{t_i} = Z_{t_{i-1}} \\exp\\left[ \\left(\\mu -\\frac{\\sigma^2}{2}\\right)\\,\\Delta t + \\sigma\\,\\Delta B\\right]\\;.\n$$ {#eq-exponential112}\nand using Taylor's Theorem for small $\\Delta t$, $\\e^{\\left(\\mu-\\frac{\\sigma^2}{2}\\right) \\Delta t} \\approx 1+ \\left(\\mu-\\frac{\\sigma^2}{2}\\right) \\Delta t$ and $\\e^{\\sigma \\Delta B_t} \\approx 1+ \\sigma \\Delta B_t +\\frac{1}{2}\\sigma^2 (\\Delta B_t)^2$ and $(\\,\\d  B_t)^2=\\Delta t$.\n:::\n::: Exercise\nUse simulation to find  $\\E^*[\\e^{-r T}{\\mathbf{1}}_{\\{S_t \\ge K\\}}]$ in the risk-neutral probability where\n\\begin{equation*}\n\\,\\d  S_t= r S_t \\,\\d  t + \\sigma S_t \\,\\d  B_t^*\n\\end{equation*}\nVerify that $S_t/\\e^{r t}$ is a martingale in the $*$ measure where $B^*$ is a Brownian motion.\nThen use simulation to find $S_0\\E^S[\\frac{1}{S_t} {\\mathbf{1}}_{\\{S_t \\ge K\\}}]$ in the pricing measure which uses the share as numeraire where \n\\begin{equation*}\n\\,\\d  S_t = (r + \\sigma^2) S_t \\,\\d  t + \\sigma S_t \\,\\d  B_t^S\n\\end{equation*}\nso the log satisfies\n\\begin{equation*}\n\\log(S_t) = \\log(S_0) + (r + \\frac{\\sigma^2}{2})t + \\sigma B_t^S\n\\end{equation*}\nYou should verify $\\e^{rt}/S_t$ is a martingale in the $S$ measure where $B^S$ is a Brownian motion.\nBoth estimates should be the same up to simulation error and give the time zero value of the random payoff ${\\mathbf{1}}_{\\{S_t \\ge K\\}}$ which is a random variable equal to $1$ if $S_t\\ge K$ and $0$ otherwise.  You should choose the values for $r$, $\\sigma$, $T$, and $K$.\n::: \n\n",
    "supporting": [
      "Chapter_Ito_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}