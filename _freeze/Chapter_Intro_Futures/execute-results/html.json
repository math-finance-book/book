{
  "hash": "835fc7a81862b6aeaa02e4c991dff879",
  "result": {
    "engine": "jupyter",
    "markdown": "\\newcommand{\\d}{\\,\\mathrm{d}}\n\\newcommand{\\e}{\\mathrm{e}}\n\\newcommand{\\E}{\\mathbb{E}}\n\n::: {#4d5fae9d .cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"text/javascript\" async src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG\"></script>\n```\n:::\n:::\n\n\n# Futures Markets {#sec-c:futures}\n\nFutures contracts are among the oldest and most important derivative securities, with organized futures trading dating back centuries. These contracts are standardized agreements to buy or sell an asset at a predetermined price on a future date.  The predetermined price  is the price at which the trade takes place when the contract is bought by one party and sold by the other and is called the futures price.  The futures price is determined by the market, like stock and option prices.  Traders can submit either limit orders or market orders to buy or sell futures contracts.\n\nFutures trading is similar to options trading.  The exchange determines the contracts that are traded.  A clearinghouse stands as the counterparty to each trade, guaranteeing the fulfillment of the contract.  The clearinghouse imposes margin requirements to ensure that traders have the financial wherewithal to meet their obligations. There is no pre-existing supply of futures contracts.  Contracts are created by trade.  The number of outstanding long contracts is always equal to the number of short contracts and is called open interest.  \n\nA contrast between futures markets options markets is that both buyers and sellers of futures contracts have future obligations, and both parties must post margin.  In options markets, only the seller of an option has a future obligation and must post margin.  A related contrast is that the buyer of a futures contract does not pay the seller at the time of the trade.  Instead, buyers and sellers both post margin and make gains or losses based on changes in the futures price subsequent to the trade (as is explained below).\n\nThe buyer of a futures contract (who is said to be long the contract) has the obligation to accept delivery of the underlying asset at the  futures expiration date and to pay the futures price at which he bought the contract.  The seller of a contract (who is said to be short the contract) has an obligation to deliver the underlying asset at the futures price at the futures expiration date.  For example, the buyer of a corn contract will get corn and pay for it (if she does not offset the obligations by selling a contract prior to the contract's expiration) and the seller of a corn contract will deliver corn and receive payment (if he does not offset the obligations by buying a contract prior to the contract's expiration).\n\nLike options, most traders unwind positions by making offsetting trades rather than holding positions to expiration.  For example, a corn farmer might sell a corn futures contract at a price of $5.00 per bushel.  The farmer can deliver on the contract and receive $5.00.  However, the farmer could instead sell the contract at a later date at the market futures price.  Suppose for example that the spot price of corn is near $4.00 per bushel near the contract's expiration.  Then the futures price will be also be near $4.00, because a near-term futures contract is essentially a spot contract (this is called **spot-futures convergence**).  As an alternative to delivering on the futures contract at $5.00, the farmer could instead sell the futures contract in the market at $4.00, canceling the delivery obligation.  In this scenario, the farmer makes $1.00 per bushel from selling the contract at $5.00 and buying it at $4.00.  The farmer can then sell her corn in the spot market for $4.00.  Combined with the $1.00 profit on the futures contract, the net proceeds for the farmer are again $5.00 per bushel.  \n\nThe delivery terms on futures contracts are standardized and specified by the exchange.  The exchange designates a delivery location and a delivery date.  The exchange also specifies the quantity and quality of the underlying asset that must be delivered.  For some contracts, different qualities can be delivered, and there are specifications for price adjustments based on the quality.  The specification of the [corn futures contract on the CME](https://www.cmegroup.com/markets/agriculture/grains/corn.contractSpecs.html) gives a good sense for how this works.\n\nSome futures contracts are **cash settled**.  For such contracts, there are no provisions for physical delivery.  Instead, contracts that are held to expiration are settled based a formula tied to an underlying asset at the time of expiration.  For example, the [e-mini S&P 500 futures contract at the CME](https://www.cmegroup.com/markets/equities/sp/e-mini-sandp500.contractSpecs.html) is \ncash settled. The contract is settled based on the value of the S&P 500 index at the time of expiration.  This eliminates the need to deliver or receive delivery of the 500 stocks that make up the index.  The \"quantity\" specification for cash settled contracts is a **multiplier** that determines the dollar value of a contract.  The e-mini S&P 500 contract has a multiplier of 50 dollars per unit of the index.^[The term \"e-mini\" is an historical artifact.  When the S&P 500 futures contract was first introduced, it had a multiplier of $500.  When the index rose, so that a contract represented a higher dollar value of stocks, this was reduced to $250.  The e-mini was simultaneously traded with a multiplier of $50.  Currently, the e-mini contract has the largest multiplier of any S&P 500 contract at the CME (there is another contract with a multiplier of $5, called the \"micro e-mini\").]   If someone buys a contract at a futures price of 6000 and holds to expiration and the index is at 6500 on the expiration date, then that trader makes 50 $\\,\\times\\,$ (6500 - 6000) $\\,=\\,$ 250,000 dollars profit on the trade.\n\nFutures contracts in the modern sense began trading in the United States in 1851, but cash-settled contracts did not begin trading until 1981.^[Millo, Y., 2007, \"Making Things Deliverable: The Origins of Index-Based Derivatives\", *Sociological Review*, vol. 55.]  Part of the complication with introducing cash-settled contracts is that they blur the line between trading and gambling.  The buyer and seller of an S&P 500 futures contract are clearly betting on how the S&P 500 index will perform.  The buyer wins if the index finishes above the futures price, and the seller wins otherwise.  There are other cash settled contracts that do not even involve an underlying asset.  For example, there are weather contracts that are cash settled based on the number of heating degree days in a particular time frame.  The distinction that has been drawn between legal trading of cash-settled futures contracts and possibly illegal gambling is that futures contracts must satisfy legitimate risk-management needs for some market participants.  For example, an equity fund manager who wants to reduce her stock market exposure at a minimal trading cost can sell S&P 500 futures contracts to hedge the fund's stock portfolio.  \n\n\n## Margin and Marking to Market\n\nOne of the most distinctive features of futures trading is the **daily settlement** or **marking to market** process. This mechanism virtually eliminates counterparty risk and enables leverage while maintaining market integrity.\n\n#### The Daily Settlement Process\n\nEach trading day, the exchange establishes a **settlement price** (based on end-of-day transaction prices) for each futures contract. All open positions are marked to this price. The daily profit or loss on each position is calculated and immediately transferred between accounts.  \n\nAs an example, suppose you buy one e-mini S&P 500 futures contract at 6000 and the following happens:\n\n- Day 1: Settlement price = 6010 → Gain = (6010 - 6000) × $50 = $500 (credited to your account)\n- Day 2: Settlement price = 5990 → Loss = (5990 - 6010) × $50 = $1,000 (debited from your account)\n- Day 3: Settlement price = 6020 → Gain = (6020 - 5990) × $50 = $1,500 (credited to your account)\n\nAt the end of day 3, you have had a net sum of $1,000 credited to your account.  If you close your position by selling the contract at the end of day 3, you walk away with a $1,000 gain, which is simply the increase in the futures price over the time you held the contract (6020 - 6000) times the $50 multiplier.\n\n#### Margin Requirements\n\nThe exchange determines a minimum amount of margin required to open a futures position.  This is called the **initial margin**.  The initial margin is typically 3-12% of the contract value.  The exchange also determines a minimum (smaller) amount of margin required to keep a futures position open.  This is called the **maintenance margin**.  If the account balance falls below the maintenance margin, a margin call occurs.  The margin call is a demand for additional margin to be posted to bring the account balance back to the initial margin level.  If the trader fails to meet the margin call, the position will be liquidated.  \n\nTrading a futures contract with 10% margin means being levered 10 to 1.  If the futures price moves 1% against the trader, the trader will lose 10% of the margin deposit.  If the futures price moves 1% in favor of the trader, the trader will gain 10% of the margin deposit.  These high leverage ratios are feasible because of the marking to market process.\n\n## The Expectations Hypothesis\n\nThe expectations hypothesis states that futures prices represent the market's unbiased expectation of future spot prices. This is a simple theory of the determination of futures prices and provides a convenient way to infer investors' beliefs about the future from currently observable prices.\n\nThe motivation for the hypothesis is the idea that, if the futures price were lower than the expected spot price, then traders \"should\" buy the futures contract and plan to sell the spot asset when delivered on the futures at maturity.  This strategy has a positive expected profit when the futures price is lower than the expected spot price.  This buying activity should drive up the price of the futures contract, until it converges to the expected spot price.  Symmetrically, investors \"should\" sell the futures if its price is above the expected spot price, planning to buy the spot asset at the futures maturity to cover the delivery obligation on the futures, and this selling activity should cause the futures price to fall, until it converges to the expected spot price.  Thus, in equilibrium, futures prices \"should\" equal the expected spot price. \n\nAll of the quotation marks around \"should\" in the previous paragraph reflect the fact that the theory presumes risk neutrality on the part of a large enough group of investors to move the futures price to the expected spot price.  If investors are risk averse, then they may buy a limited quantity of the futures when its price is low relative to the expected spot price and sell a limited quantity of the futures when its price is high relative to the expected spot price, generating an expected profit as described in the previous paragraph.  However, risk averse investors will weigh the expected profit against the risk, considering their other investments as well, and only allocate a limited amount of capital to the bet.  This amount of capital may not be enough to move the futures price fully to the expected spot price.  Empirically, futures prices seem to frequently deviate from expected spot prices in significant ways.\n\nFrom the general theory of asset pricing, which is developed in this book, the difference between the futures price and the expected spot price depends on the covariance of the spot price with market risk factors.  For example, the Capital Asset Pricing Model asserts that it depends on the covariance of the spot price with the aggregate market return.\n\nDespite the presence of a risk premium, the expectations of traders regarding future spot prices are undoubtedly a prime determinant of futures prices.  They are also a prime determinant of today's spot prices.  The linkage between today's spot price and today's futures prices is known as **spot-futures parity**.  \n\n## Spot-Futures Parity\n\nIn contrast to the expectations hypothesis, which predicts a relationship between today's futures price and the expected future spot price, spot-futures parity is a relationship between today's futures price and today's spot price.  The foundation for spot-futures parity is arbitrage activity (making riskless profits) rather than making positive expected return but risky investments (as for the expectations hypothesis).  The arbitrage involves either (i) buying the spot asset and simultaneously selling a futures contract, or (ii) borrowing and selling the spot asset and simultaneously buying a futures contract.  The exact relationship between the spot and futures price depends on the differences between holding the underlying asset and being long a futures contract.  There are four potential differences, which are normally grouped into two categories.  \n\n- *Cost of carry*: The cost of carry is the cost of holding the underlying asset over a period of time.  There are no costs of owning a futures contract (ignoring the margin account).  \n  - One component of the cost of carry is that holding the underlying asset ties up funds, and we incur an opportunity cost of the foregone interest that could be earned by depositing the funds instead.  \n  - There can also be significant storage costs involved in holding commodities.  \n- *Convenience yield*: There can also be advantages to owning the underlying asset.  These are collectively called the convenience yield.\n  - If the underlying asset pays dividends or other cash flows, then these are part of the \"convenience\" of holding the spot asset.\n  - For commodities, there can be other advantages to holding the spot asset today rather than getting it in the future.  These may be difficult to quantify but can be very real.  For example, during a time of strained crude oil supply and elevated prices that is expected to be temporary, oil companies will not be indifferent about having crude now versus having it later. \n\nThe spot futures-parity formula is \n\n$$F = \\mathrm{e}^{(c-y)T}S$$\n\nwhere \n\n- $F=\\,$ futures price, \n- $S=\\,$ current spot price, \n- $c=\\,$ cost of carry expressed as a continuously compounded rate, \n- $y=\\,$ convenience yield expressed as a continuously compounded rate,\n- $T=\\,$ time to expiration.\n\n#### Arbitrage When Parity Is Violated\n\nTo see why the formula must be true, first consider the simplest case in which there are no storage costs, no dividends or other cash flows, and no other forms of convenience yield, so the opportunity cost of foregone interest is the only factor present.  In this case, $c=r$, the risk-free interest rate, and $y=0$.  \n\n*1. Buy spot and sell futures*:\n\nLet's suppose first that spot-futures parity is violated in the direction $F>\\mathrm{e}^{rT}S$ and see how that can be arbitraged.  The arbitrage is to buy the cheaper side of the inequality and sell the more expensive side (buy low and sell high, of course).  So, this means that we buy the underlying asset.  We do that by borrowing $S$ dollars.  We simultaneously sell the futures contract at price $F$.  At expiration, we deliver the spot asset that we bought to fulfill the futures contract and receive $F$.  We will at this time owe $\\mathrm{e}^{rT}S$ on the loan, and we can repay the loan and pocket the surplus $F-\\mathrm{e}^{rT}S$.\n\n*2. Sell spot and buy futures*:\n\nNow suppose that spot-futures parity is violated in the direction $F<\\mathrm{e}^{rT}S$.  Again, we buy low and sell high.  Here, that means that we buy the futures contract and sell the underlying asset.  We sell the underlying asset by borrowing it and then selling (called short selling).  Later, we have to return it to whomever we borrowed it from.   Because the lender will not be missing any dividend payments or other cash flows  and there is no other convenience of holding the underlying asset, we assume we can cover the loan of the asset by returning the same amount that we borrowed.  In practice, the lender will charge a small fee, but we ignore that here.  Because we bought the futures contract, we pay $F$ at maturity, accept delivery of the asset, and then deliver the asset to the lender.  We earn interest on the proceeds from selling the asset, so we net $\\mathrm{e}^{rT}S - F$.\n\nThis type of arbitraging activity will move market prices until spot-futures parity holds.  It is an activity in which institutions regularly engage.  It is thus safe to assume that spot-futures parity always holds to a reasonably high degree of approximation.  \n\nThis reasoning extends directly to including storage costs, which are clearly another expense of holding the underlying asset, when such costs are nonnegligible.  Likewise, dividends received or other advantages of holding the underlying asset act in the opposite direction of carrying costs and so should be subtracted from the cost of carry.  This reasoning leads to the general spot-futures parity formula.\n\n#### Forward Curves\n\nThe relationship between the contract maturity and the futures price is known as the **forward curve**. The spot-futures parity formula tells us that the futures price should depend on the contract maturity $T$ based on the factor $\\mathrm{e}^{(c-y)T}$.\n\nGold is an asset that has negligible storage costs, does not pay dividends, and has no other forms of convenience yield.  Thus, $c-y$ for gold is just the risk-free interest rate $r$.  Consequently, spot-futures parity for gold states that gold futures prices are higher than spot prices and increase with maturity.  @fig-forward1 presents the gold forward curve at a single point in time.  The upward slope reflects the fact that the future value factor $\\mathrm{e}^{rT}$ is larger for larger $T$.  \n\nFor financial assets, such as stock portfolios, the only cost of carry is the interest rate, and the only convenience yield is the dividend yield.  Consequently, in the spot-futures parity formula for financial assets, $c=r$ and $r-y$ is the difference between the interest rate and the dividend yield.  \nWhether $r-y$ is positive or negative determines whether futures prices are higher than spot prices (and increase with maturity) or whether the opposite is true.  \n\nFor currency futures, the dividend yield (by which we mean in general the cash flow earned from holding the underlying asset) is the interest rate that can be earned by investing the currency.  Thus, for currency futures, $c-y=r-r_f$, where $r_f$ is the foreign interest rate.  @fig-forward1 presents the forward curves for the Japanese yen and Mexican peso at a single date.  On that date, the dollar interest rate was higher than the yen interest rate - so $c-y>0$ and the forward curve was upward sloping - and lower than the peso interest rate - so $c-y<0$ and the forward curve was downward sloping.  @fig-forward1 also presents the forward curve for S&P 500 futures at a time when interest rates were lower than the dividend yields on stock, so $c-y<0$ and the forward curve was downward sloping.  When interest rates are higher, the S&P 500 forward curve is upward sloping. \n\n::: {#cell-fig-forward1 .cell fig-height='600' execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nfrom dateutil.relativedelta import relativedelta\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\ndf = pd.read_csv('https://www.dropbox.com/s/832hth1es40f4g7/newfutures.csv?dl=1', index_col=0)\ndf = df[df.date>='2010-01-01']\ndf.date = pd.to_datetime(df.date)\n\n# Function to add months and set day to 15th\ndef add_months_and_set_day(date, months_to_add):\n    new_date = date + relativedelta(months=int(months_to_add))\n    new_date = new_date.replace(day=15)\n    return new_date\n\n# Apply the function to create the new column\ndf['new_to_date'] = df.apply(\n    lambda row: add_months_and_set_day(row['date'], row['months past front month']), \n    axis=1\n)\ndf = df.reset_index(drop=True).set_index(['code', 'date', 'new_to_date']).settle\n\nyen = df.loc[('CME_JY', '2022-06-29')]\npeso = df.loc[('CME_MP', '2022-06-29')]\ngold = df.loc[('CME_GC', '2022-06-29')]\nsp500 = df.loc[('CME_ES', '2020-06-01')]\n\n# Create figure with 2x2 subplots with horizontal spacing\nfig = make_subplots(\n    rows=2, cols=2,\n    subplot_titles=('Gold (2022-06-29)', 'S&P 500 (2020-06-01)', \n                    'Japanese Yen (2022-06-29)', 'Mexican Peso (2022-06-29)'),\n    specs=[[{\"secondary_y\": False}, {\"secondary_y\": False}],\n           [{\"secondary_y\": False}, {\"secondary_y\": False}]],\n    horizontal_spacing=0.12  # Add horizontal spacing between columns\n)\n\n# Add Gold trace (top left)\nfig.add_trace(\n    go.Scatter(x=gold.index, y=gold.values, \n               name='Gold',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=1, col=1\n)\n\n# Add S&P 500 trace (top right)\nfig.add_trace(\n    go.Scatter(x=sp500.index, y=sp500.values, \n               name='S&P 500',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=1, col=2\n)\n\n# Add Yen trace (bottom left)\nfig.add_trace(\n    go.Scatter(x=yen.index, y=yen.values, \n               name='Japanese Yen',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=2, col=1\n)\n\n# Add Peso trace (bottom right)\nfig.add_trace(\n    go.Scatter(x=peso.index, y=peso.values, \n               name='Mexican Peso',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=2, col=2\n)\n\n# Update layout - set width=None for auto-sizing\nfig.update_layout(\n    height=600,\n    width=None,  # Auto-adjust width to container\n    showlegend=False,\n    autosize=True,  # Enable responsive sizing\n    template='plotly_white',  # Use plotly white template\n    margin=dict(t=60)  # Add top margin to prevent overlap with plotly icons\n)\n\n# Update axes labels with smaller font\nfig.update_xaxes(title_text=\"Maturity Date\", row=2, col=1)\nfig.update_xaxes(title_text=\"Maturity Date\", row=2, col=2)\nfig.update_yaxes(title_text=\"Futures Price\", row=1, col=1)\nfig.update_yaxes(title_text=\"\", row=1, col=2)\nfig.update_yaxes(title_text=\"Futures Price\", row=2, col=1)\nfig.update_yaxes(title_text=\"\", row=2, col=2)\n\nfig.show()\n```\n\n::: {#fig-forward1 .cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"b23bdfa2-16b8-4dbe-8d7d-0c068e71967e\" class=\"plotly-graph-div\" style=\"height:600px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"b23bdfa2-16b8-4dbe-8d7d-0c068e71967e\")) {                    Plotly.newPlot(                        \"b23bdfa2-16b8-4dbe-8d7d-0c068e71967e\",                        [{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Gold\",\"x\":[\"2022-06-15T00:00:00\",\"2022-07-15T00:00:00\",\"2022-08-15T00:00:00\",\"2022-09-15T00:00:00\",\"2022-11-15T00:00:00\",\"2023-01-15T00:00:00\",\"2023-03-15T00:00:00\",\"2023-05-15T00:00:00\",\"2023-07-15T00:00:00\",\"2023-09-15T00:00:00\",\"2023-11-15T00:00:00\",\"2024-01-15T00:00:00\",\"2024-03-15T00:00:00\",\"2024-05-15T00:00:00\"],\"y\":[1813.7,1817.5,1822.0,1826.5,1837.8,1850.1,1862.5,1874.5,1886.1,1897.8,1909.4,1913.2,1922.2,1931.1],\"type\":\"scatter\",\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"S&P 500\",\"x\":[\"2020-06-15T00:00:00\",\"2020-09-15T00:00:00\",\"2020-12-15T00:00:00\",\"2021-03-15T00:00:00\",\"2021-06-15T00:00:00\"],\"y\":[3054.0,3043.5,3036.0,3030.75,3022.25],\"type\":\"scatter\",\"xaxis\":\"x2\",\"yaxis\":\"y2\"},{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Japanese Yen\",\"x\":[\"2022-06-15T00:00:00\",\"2022-07-15T00:00:00\",\"2022-08-15T00:00:00\",\"2022-09-15T00:00:00\",\"2022-11-15T00:00:00\",\"2023-02-15T00:00:00\",\"2023-05-15T00:00:00\",\"2023-08-15T00:00:00\",\"2023-11-15T00:00:00\",\"2024-02-15T00:00:00\",\"2024-05-15T00:00:00\"],\"y\":[7332.0,7346.0,7365.0,7385.0,7431.0,7508.5,7595.0,7670.5,7742.0,7817.5,7895.0],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Mexican Peso\",\"x\":[\"2022-06-15T00:00:00\",\"2022-07-15T00:00:00\",\"2022-08-15T00:00:00\",\"2022-09-15T00:00:00\",\"2022-10-15T00:00:00\",\"2022-11-15T00:00:00\",\"2022-12-15T00:00:00\",\"2023-01-15T00:00:00\",\"2023-02-15T00:00:00\",\"2023-03-15T00:00:00\",\"2023-04-15T00:00:00\",\"2023-05-15T00:00:00\",\"2023-06-15T00:00:00\",\"2023-08-15T00:00:00\",\"2023-11-15T00:00:00\"],\"y\":[49550.0,49300.0,48970.0,48700.0,48430.0,48100.0,47860.0,47560.0,47290.0,46970.0,46720.0,46430.0,46160.0,45620.0,44860.0],\"type\":\"scatter\",\"xaxis\":\"x4\",\"yaxis\":\"y4\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,0.44]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.625,1.0],\"title\":{\"text\":\"Futures Price\"}},\"xaxis2\":{\"anchor\":\"y2\",\"domain\":[0.56,1.0]},\"yaxis2\":{\"anchor\":\"x2\",\"domain\":[0.625,1.0],\"title\":{\"text\":\"\"}},\"xaxis3\":{\"anchor\":\"y3\",\"domain\":[0.0,0.44],\"title\":{\"text\":\"Maturity Date\"}},\"yaxis3\":{\"anchor\":\"x3\",\"domain\":[0.0,0.375],\"title\":{\"text\":\"Futures Price\"}},\"xaxis4\":{\"anchor\":\"y4\",\"domain\":[0.56,1.0],\"title\":{\"text\":\"Maturity Date\"}},\"yaxis4\":{\"anchor\":\"x4\",\"domain\":[0.0,0.375],\"title\":{\"text\":\"\"}},\"annotations\":[{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Gold (2022-06-29)\",\"x\":0.22,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"S&P 500 (2020-06-01)\",\"x\":0.78,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Japanese Yen (2022-06-29)\",\"x\":0.22,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.375,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Mexican Peso (2022-06-29)\",\"x\":0.78,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.375,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"margin\":{\"t\":60},\"height\":600,\"showlegend\":false,\"autosize\":true},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('b23bdfa2-16b8-4dbe-8d7d-0c068e71967e');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n\nForward curves for CME futures contracts on the dates specified.\n:::\n:::\n\n\n#### Commodities\n\nSpot-futures parity for commodities is more complex than for financial assets, because of storage costs and convenience yields.  Because the convenience yield by definition is never negative, the spot-futures parity formula gives us $F \\leq  \\mathrm{e}^{rT}S$, where, for commodities, $c$ is the interest rate plus the storage cost rate.  The difference between the futures price $F$ and $\\mathrm{e}^{rT}S$ depends on the convenience yield $y$ and the contract maturity $T$.  We generally have no direct measure of the convenience yield except for this difference, so the spot-futures parity formula for commodities, while true and a useful concept, may have little predictive power.  An additional complication is that storage costs are very high for some commodities, such as electricity and natural gas, which can make the upper bound $F \\leq \\mathrm{e}^{rT}S$ nearly meaningless.\n\nAs a result of these factors, forward curves for commodities are in general more complex than forward curves for financial assets. @fig-forward2 presents forward curves for crude oil, natural gas, and corn at various dates.  April 20, 2020 is the day that crude famously \"went negative.\"  This was at the onset of the coronavirus crisis, when demand had plummeted, and storage facilities at Cushing, Oklahoma (the delivery point for the CME WTI contract) were full.  Some traders were willing to pay others to get out of their obligations to accept delivery in Cushing -- they sold their oil at a negative price!.  To connect to our discussion, note that the extremely large positive slope of the forward curve means that $c-y$ must be extremely large.  This was true because storage costs were extremely high and the convenience yield was zero.\n\nThe crude oil forward curve was steeply downward sloping in March 2022 following the Russian invasion of Ukraine, as seen in @fig-forward2.  This means that $c-y<0$ and large in absolute value.  We can attribute this to a high convenience yield of being in possession of oil at a time when future supplies were very uncertain.\n\nThe forward curve for natural gas is always cyclical as seen in @fig-forward2.  The initial upward sloping section in that figure reflects the high storage cost of natural gas (that is, a high $c$) The \"buy spot, sell futures\" arbitrage strategy described above is not an arbitrage here, because of the high storage cost of holding natural gas from summer to winter.  The downward sloping segment from winter to summer reflects the high convenience yield of owning natural gas in the winter when demand and spot market prices are high.  The overall slope of the natural gas forward curve in @fig-forward2 is downward, but that varies over time, depending on the convenience yield of owning natural gas at the time of the futures trading; that is, it depends on supply and demand conditions in the spot market. \n\nThe corn forward curve also has a cyclical pattern, as seen in @fig-forward2.  The cyclical pattern is a consequence of cyclicality in the convenience yield and storage costs of corn.   The convenience yield is highest in the summer before harvest, when corn is relatively scarce, and storage costs are highest after harvest, when silos are relatively full.  As is the case with natural gas, the overall slope of the forward curve for corn depends on demand and supply conditions in the spot market at the time of the futures trading.\n\n::: {#cell-fig-forward2 .cell fig-height='600' execution_count=3}\n``` {.python .cell-code}\ncrude1 = df.loc[('CME_CL', '2020-04-20')]\ncrude2 = df.loc[('CME_CL', '2022-03-08')]\ngas = df.loc[('CME_NG', '2018-06-08')]\ncorn = df.loc[('CME_C', '2018-06-08')]\n\n\n# Create figure with 2x2 subplots with horizontal spacing\nfig = make_subplots(\n    rows=2, cols=2,\n    subplot_titles=('Crude Oil (2020-04-20)', 'Crude Oil (2022-03-08)', \n                    'Natural Gas (2018-06-08)', 'Corn (2018-06-08)'),\n    specs=[[{\"secondary_y\": False}, {\"secondary_y\": False}],\n           [{\"secondary_y\": False}, {\"secondary_y\": False}]],\n    horizontal_spacing=0.12  # Add horizontal spacing between columns\n)\n\n# Add Gold trace (top left)\nfig.add_trace(\n    go.Scatter(x=crude1.index, y=crude1.values, \n               name='Crude (2020-04-20)',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=1, col=1\n)\n\n# Add S&P 500 trace (top right)\nfig.add_trace(\n    go.Scatter(x=crude2.index, y=crude2.values, \n               name='Crude (2022-03-08)',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=1, col=2\n)\n\n# Add Yen trace (bottom left)\nfig.add_trace(\n    go.Scatter(x=gas.index, y=gas.values, \n               name='Natural Gas (2018-06-08)',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=2, col=1\n)\n\n# Add Peso trace (bottom right)\nfig.add_trace(\n    go.Scatter(x=corn.index, y=corn.values, \n               name='Corn (2018-06-08)',\n               mode='lines+markers',\n               hovertemplate='%{x|%b %Y}<br>Price: %{y}<extra></extra>'),\n    row=2, col=2\n)\n\n# Update layout - set width=None for auto-sizing\nfig.update_layout(\n    height=600,\n    width=None,  # Auto-adjust width to container\n    showlegend=False,\n    autosize=True,  # Enable responsive sizing\n    template='plotly_white',  # Use plotly white template\n    margin=dict(t=60)  # Add top margin to prevent overlap with plotly icons\n)\n\n# Update axes labels with smaller font\nfig.update_xaxes(title_text=\"Contract Date\", row=2, col=1)\nfig.update_xaxes(title_text=\"Contract Date\", row=2, col=2)\nfig.update_yaxes(title_text=\"Futures Price\", row=1, col=1)\nfig.update_yaxes(title_text=\"\", row=1, col=2)\nfig.update_yaxes(title_text=\"Futures Price\", row=2, col=1)\nfig.update_yaxes(title_text=\"\", row=2, col=2)\n\nfig.show()\n```\n\n::: {#fig-forward2 .cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"7fc23269-b51e-455e-9252-af4207b5e89c\" class=\"plotly-graph-div\" style=\"height:600px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"7fc23269-b51e-455e-9252-af4207b5e89c\")) {                    Plotly.newPlot(                        \"7fc23269-b51e-455e-9252-af4207b5e89c\",                        [{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Crude (2020-04-20)\",\"x\":[\"2020-04-15T00:00:00\",\"2020-05-15T00:00:00\",\"2020-06-15T00:00:00\",\"2020-07-15T00:00:00\",\"2020-08-15T00:00:00\",\"2020-09-15T00:00:00\",\"2020-10-15T00:00:00\",\"2020-11-15T00:00:00\",\"2020-12-15T00:00:00\",\"2021-01-15T00:00:00\",\"2021-02-15T00:00:00\",\"2021-03-15T00:00:00\",\"2021-04-15T00:00:00\",\"2021-05-15T00:00:00\",\"2021-06-15T00:00:00\",\"2021-07-15T00:00:00\",\"2021-08-15T00:00:00\",\"2021-09-15T00:00:00\",\"2021-10-15T00:00:00\",\"2021-11-15T00:00:00\",\"2021-12-15T00:00:00\",\"2022-01-15T00:00:00\",\"2022-02-15T00:00:00\",\"2022-03-15T00:00:00\",\"2022-04-15T00:00:00\"],\"y\":[-37.63,20.43,26.28,28.51,29.84,30.81,31.66,32.41,33.02,33.53,33.98,34.35,34.68,34.99,35.25,35.5,35.74,35.99,36.25,36.48,36.67,36.87,37.09,37.32,37.55],\"type\":\"scatter\",\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Crude (2022-03-08)\",\"x\":[\"2022-03-15T00:00:00\",\"2022-04-15T00:00:00\",\"2022-05-15T00:00:00\",\"2022-06-15T00:00:00\",\"2022-07-15T00:00:00\",\"2022-08-15T00:00:00\",\"2022-09-15T00:00:00\",\"2022-10-15T00:00:00\",\"2022-11-15T00:00:00\",\"2022-12-15T00:00:00\",\"2023-01-15T00:00:00\",\"2023-02-15T00:00:00\",\"2023-03-15T00:00:00\",\"2023-04-15T00:00:00\",\"2023-05-15T00:00:00\",\"2023-06-15T00:00:00\",\"2023-07-15T00:00:00\",\"2023-08-15T00:00:00\",\"2023-09-15T00:00:00\",\"2023-10-15T00:00:00\",\"2023-11-15T00:00:00\",\"2023-12-15T00:00:00\",\"2024-01-15T00:00:00\",\"2024-02-15T00:00:00\",\"2024-03-15T00:00:00\"],\"y\":[123.7,119.65,115.21,110.83,106.8,103.41,100.77,98.61,96.77,95.09,93.55,92.17,90.94,89.81,88.68,87.61,86.61,85.68,84.82,84.02,83.28,82.45,81.63,80.85,80.1],\"type\":\"scatter\",\"xaxis\":\"x2\",\"yaxis\":\"y2\"},{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Natural Gas (2018-06-08)\",\"x\":[\"2018-06-15T00:00:00\",\"2018-07-15T00:00:00\",\"2018-08-15T00:00:00\",\"2018-09-15T00:00:00\",\"2018-10-15T00:00:00\",\"2018-11-15T00:00:00\",\"2018-12-15T00:00:00\",\"2019-01-15T00:00:00\",\"2019-02-15T00:00:00\",\"2019-03-15T00:00:00\",\"2019-04-15T00:00:00\",\"2019-05-15T00:00:00\",\"2019-06-15T00:00:00\",\"2019-07-15T00:00:00\",\"2019-08-15T00:00:00\",\"2019-09-15T00:00:00\",\"2019-10-15T00:00:00\",\"2019-11-15T00:00:00\",\"2019-12-15T00:00:00\",\"2020-01-15T00:00:00\",\"2020-02-15T00:00:00\",\"2020-03-15T00:00:00\",\"2020-04-15T00:00:00\",\"2020-05-15T00:00:00\",\"2020-06-15T00:00:00\"],\"y\":[2.89,2.894,2.876,2.89,2.937,3.047,3.133,3.102,3.004,2.637,2.595,2.622,2.653,2.662,2.649,2.669,2.721,2.85,2.947,2.911,2.816,2.546,2.52,2.55,2.583],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"hovertemplate\":\"%{x|%b %Y}\\u003cbr\\u003ePrice: %{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"mode\":\"lines+markers\",\"name\":\"Corn (2018-06-08)\",\"x\":[\"2018-06-15T00:00:00\",\"2018-08-15T00:00:00\",\"2018-11-15T00:00:00\",\"2019-02-15T00:00:00\",\"2019-04-15T00:00:00\",\"2019-06-15T00:00:00\",\"2019-08-15T00:00:00\",\"2019-11-15T00:00:00\",\"2020-02-15T00:00:00\",\"2020-04-15T00:00:00\",\"2020-06-15T00:00:00\"],\"y\":[377.75,386.5,398.0,407.0,413.0,418.5,406.75,412.0,420.5,425.5,429.5],\"type\":\"scatter\",\"xaxis\":\"x4\",\"yaxis\":\"y4\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,0.44]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.625,1.0],\"title\":{\"text\":\"Futures Price\"}},\"xaxis2\":{\"anchor\":\"y2\",\"domain\":[0.56,1.0]},\"yaxis2\":{\"anchor\":\"x2\",\"domain\":[0.625,1.0],\"title\":{\"text\":\"\"}},\"xaxis3\":{\"anchor\":\"y3\",\"domain\":[0.0,0.44],\"title\":{\"text\":\"Contract Date\"}},\"yaxis3\":{\"anchor\":\"x3\",\"domain\":[0.0,0.375],\"title\":{\"text\":\"Futures Price\"}},\"xaxis4\":{\"anchor\":\"y4\",\"domain\":[0.56,1.0],\"title\":{\"text\":\"Contract Date\"}},\"yaxis4\":{\"anchor\":\"x4\",\"domain\":[0.0,0.375],\"title\":{\"text\":\"\"}},\"annotations\":[{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Crude Oil (2020-04-20)\",\"x\":0.22,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Crude Oil (2022-03-08)\",\"x\":0.78,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Natural Gas (2018-06-08)\",\"x\":0.22,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.375,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Corn (2018-06-08)\",\"x\":0.78,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.375,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"margin\":{\"t\":60},\"height\":600,\"showlegend\":false,\"autosize\":true},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('7fc23269-b51e-455e-9252-af4207b5e89c');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n\nForward curves for CME futures contracts on the dates specified.\n:::\n:::\n\n\n## Options on Futures\n\nMany exchanges trade options on futures contracts, creating a derivative on a derivative. A call option on a futures contract is the right to buy the futures contract at the strike.  A put option is the right to sell the futures contract at the strike.  Compared to trading options on the underlying asset, options on futures benefit from the liquidity of the futures market and the leverage present in futures.  Moreover, they allow traders to avoid the issues of physical delivery and storage that are associated with options on the underlying asset.\n\nExercise of an option of a futures contract creates a long (for a call) or short (for a put) position in the futures contract for the party that exercises.  When an option is exercised, the clearinghouse randomly selects someone who has sold the option and assigns to them the opposite contract: a short (for the seller of a call) or long (for the seller of a put) position in the futures contract.\nBoth parties are immediately marked to market, and there are corresponding cash transfers based on the strike of the futures option and the current market futures price.  \n\nAn example should make this clearer.  Suppose a trader buys a call option on corn futures with a strike of $5.00 (per bushel).  The trader later exercises the option when the corn futures price is $5.50.  The trader will be assigned a long futures contract, marked to market at $5.50 and will receive in cash the $0.50 difference between the futures price and the strike price.  The option writer who is selected by the clearinghouse will have $0.50 deducted from her margin account and will be assigned a short futures contract at $5.50.  If they desire to do so, both the party who exercised and the option writer can trade out of their futures contracts at the market price and walk away with the $0.50 gain or loss and no further obligations.  \n\n",
    "supporting": [
      "Chapter_Intro_Futures_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}