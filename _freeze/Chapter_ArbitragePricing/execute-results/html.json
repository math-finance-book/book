{
  "hash": "5b11c284cf0845535b272f074c6ac69f",
  "result": {
    "engine": "jupyter",
    "markdown": "\\newcommand{\\d}{\\,\\mathrm{d}}\n\\newcommand{\\e}{\\mathrm{e}}\n\\newcommand{\\E}{\\mathbb{E}}\n\n\n# Arbitrage Pricing {#sec-c:arbitrage_pricing}\n\n::: {#d422a5c0 .cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"text/javascript\" async src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG\"></script>\n```\n:::\n:::\n\n\nThis chapter develops the fundamental principles of arbitrage pricing, starting from the concept of linear pricing and building up to continuous-time models with change of numeraire.\n\n## Linear Pricing\n\nThe fundamental concept underlying most finance theory, from Miller-Modigliani to the Black-Scholes model, is linear pricing. The concept of linear pricing is essentially the same as asking for the price of five apples and six oranges. Of course, this is the price of one apple times five plus the price of one orange times six. However, instead of pricing bundles of commodities today, we will find prices of dollars in different contingencies at times in the future.\n\nAn arbitrage opportunity is a trading strategy that produces nonnegative cash flows at all times in all contingencies with a strictly positive cash flow at some time in some contingency. If such an opportunity were to exist, traders would exploit it until prices adjust to eliminate the possibility. Although simple, this has powerful implications.\n\nConsider a world where there are $J$ possible states of the world at time $t$. No arbitrage then implies the following properties:\n\n1. If $X$ and $Y$ are time $t$ random cash flows, the time 0 price of the random cash flow $aX+bY$ is $a$ times the time 0 price of $X$ plus $b$ times the time 0 price of $Y$. If $P(\\cdot)$ is a pricing function that gives us the price of a random cash flow today, then $P(aX+bY)=aP(X) + bP(Y)$. In other words, the pricing operator is linear. This follows because if this fails to hold, there is an arbitrage assuming an agent can buy and sell any quantities at these prices. Because the pricing operator is linear, it must have the form $P(X) = \\sum_{j=1}^J \\pi_j X_j$ where $X_j$ is the random cash flow in state~$j$. We call $\\pi_j$ the price of a dollar at time $t$ in state $j$ or a state price.\n\n2. The price of any positive nonzero random cash flow at time $t$ is strictly positive. Again, this follows from no arbitrage (think how much of an asset paying a positive dividend you would want if it were free or even if you were paid to take the asset). This implies the state prices are strictly positive.\n\n3. The pricing operator obeys time value of money: $1=\\sum_{j=1}^J \\pi_j e^{rt}$, where $r$ is the continuously compounded yield to maturity of a bond maturing at $t$. This is the present value rule: the present value of the future value $e^{rt}$ is one or, equivalently, the present value of a dollar paid at $t$ is $e^{-rt}$.\n\n4. The pricing operator must be consistent with observable prices. The price $S_0$ of a traded asset with random cash flows at time $t$ is given by $S_0= \\sum_{j=1}^J \\pi_j S_j$ where $S_j$ is the random cash flow in state $j$.\n\n::: Principle\nIn the absence of arbitrage opportunities, there exist positive state prices such that the price of any security is the sum across the states of the world of its payoff multiplied by the state price.\n:::\n\nThis conclusion generalizes to other models, including models in which the stock price takes a continuum of possible values, interpreting the sum in that case as an integral.\n\n## State Prices in the Binomial Model\n\nIn the single-period binomial model with up and down states, we have two equations for the state prices $\\pi_u$ and $\\pi_d$:\n\n$$ 1 = \\pi_u e^{rt} + \\pi_d e^{rt} $$\n$$ S = \\pi_u S_u + \\pi_d S_d $$\n\nThe first equation prices the risk-free asset (invest \\$1 today, receive $e^{rt}$ in both states). The second prices the stock.\n\nSolving these equations gives:\n\n$$\\pi_u  = \\frac{S-e^{-rt}S_d}{S_u - S_d}, \\quad \\pi_d = \\frac{e^{-rt}S_u-S}{S_u - S_d}$$\n\nNotice that the requirement $\\pi_u, \\pi_d > 0$ is precisely the no-arbitrage condition:\n\n$$\\frac{S_u}{S} > e^{rt} > \\frac{S_d}{S}$$\n\nWe can think of any security as a portfolio of Arrow securities. An Arrow security pays \\$1 at time $t$ if a specific state occurs and pays nothing otherwise. In our binomial model, $\\pi_u$ is the price of an Arrow security paying \\$1 in the up state, and $\\pi_d$ is the price of an Arrow security paying \\$1 in the down state.\n\nFor any derivative with payoffs $C_u$ and $C_d$:\n\n$$C = \\pi_u C_u + \\pi_d C_d$$\n\n### Risk-Neutral Probabilities\n\nDefine $p_u = \\pi_u e^{rt}$ and $p_d = \\pi_d e^{rt}$. Since $p_u + p_d = 1$ and both are positive, we can interpret them as probabilities—the risk-neutral probabilities. Then:\n\n$$C = e^{-rt}[p_u C_u + p_d C_d]$$\n\nThe asset price equals its expected payoff discounted at the risk-free rate, where the expectation uses risk-neutral probabilities. Note that:\n\n$$p_u = \\frac{e^{rt} - S_d/S}{S_u/S - S_d/S}$$\n\n## Multiple States\n\nNow consider a market with $J > 2$ possible states at time $t$. We need to find $J$ state prices $\\pi_1, \\ldots, \\pi_J$. If we have $J$ traded assets (including the risk-free asset) with linearly independent payoffs, we can solve:\n\n$$\\begin{bmatrix} \ne^{rt} & e^{rt} & \\cdots & e^{rt} \\\\\nS_1^{(1)} & S_2^{(1)} & \\cdots & S_J^{(1)} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nS_1^{(J-1)} & S_2^{(J-1)} & \\cdots & S_J^{(J-1)}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\pi_1 \\\\ \\pi_2 \\\\ \\vdots \\\\ \\pi_J\n\\end{bmatrix} = \n\\begin{bmatrix}\n1 \\\\ S^{(1)} \\\\ \\vdots \\\\ S^{(J-1)}\n\\end{bmatrix}$$\n\nwhere $S^{(i)}$ is the current price of asset $i$ and $S_j^{(i)}$ is its payoff in state $j$.\n\nWith state prices determined, we can value any derivative:\n\n$$V = \\sum_{j=1}^J \\pi_j V_j$$\n\nThe risk-neutral probabilities are $p_j = \\pi_j e^{rt}$, giving:\n\n$$V = e^{-rt} \\sum_{j=1}^J p_j V_j = e^{-rt} \\mathbb{E}^p[V_t]$$\n\n## Martingale Pricing\n\nA martingale is a stochastic process for which the expected value of tomorrow's value is today's value. In our framework, discounted values of non-dividend paying trading strategies are martingales under the risk-neutral measure.\n\nIf $X(0)$ is today's value of a portfolio with random payoff $X$ at time $t$:\n\n$$\\frac{X(0)}{R(0)} = \\sum_{s=1}^S p_s \\frac{X_s}{e^{rt}} = \\mathbb{E}^R\\left[\\frac{X}{R_t}\\right]$$\n\nwhere $R(0) = 1$ and $R_t = e^{rt}$. The ratio of any asset price to the risk-free asset price is a martingale under the risk-neutral measure.\n\n## Continuous Time\n\nWe now extend to continuous-time models where the stock price can take a continuum of values. The principle becomes:\n\n::: Principle\nIf there are no arbitrage opportunities, then there exists for each date $t$ a strictly positive random variable $m_t$, called a stochastic discount factor, such that the date-0 value of any dividend-reinvested asset with price $P$ is:\n\n$$P_0 = \\mathbb{E}[m_t P_t]$$\n:::\n\nThe stochastic discount factor $m_t$ generalizes state prices to continuous distributions. For a finite number of states, $m_t = \\pi_j/\\text{prob}_j$ in state $j$, where $\\text{prob}_j$ is the actual probability.\n\n### Connection to Risk-Neutral Probabilities\n\nThe risk-free asset satisfies:\n\n$$1 = \\mathbb{E}[m_t e^{rt}]$$\n\nThis means $m_t e^{rt}$ has expectation 1. We can define a new probability measure by:\n\n$$\\mathbb{E}^R[Z] = \\mathbb{E}[m_t e^{rt} Z]$$\n\nfor any random variable $Z$. Under this risk-neutral measure:\n\n$$P_0 = e^{-rt} \\mathbb{E}^R[P_t]$$\n\n## Change of Numeraire\n\nOur choice of the risk-free asset as numeraire was arbitrary. Any strictly positive non-dividend paying trading strategy can serve as a numeraire.\n\nFor a dividend-reinvested asset $Y$ with strictly positive value:\n\n$$Y(0) = \\mathbb{E}[m_t Y_t]$$\n\nDefine new probabilities by:\n\n$$\\text{prob}^Y_s = \\frac{\\mathbb{E}[m_t Y_t \\mathbf{1}_{\\{s\\}}]}{Y(0)}$$\n\nwhere $\\mathbf{1}_{\\{s\\}}$ is the indicator function for state $s$. Then:\n\n$$S(0) = Y(0) \\mathbb{E}^Y\\left[\\frac{S_t}{Y_t}\\right]$$\n\nThe ratio $S_t/Y_t$ is a martingale under the probability measure induced by using $Y$ as numeraire.\n\n### Fundamental Pricing Formula\n\n::: Principle\nIn the absence of arbitrage opportunities, prices $P$ and $Y$ of dividend-reinvested assets satisfy, for all $s < t$:\n\n$$Y_s = P_s \\mathbb{E}^P_s \\left[\\frac{Y_t}{P_t}\\right]$$\n:::\n\nThis is the fundamental pricing formula. The value at time $s$ of asset $Y$ is the expectation, under the appropriate probability measure, of its value $Y_t$ at time $t$ discounted by the factor $P_s/P_t$.\n\nWhen $P$ is the risk-free asset:\n\n$$Y_s = e^{-r(t-s)} \\mathbb{E}^R_s[Y_t]$$\n\n### Changing Probability Measures\n\nFor continuous distributions, the probability of event $A$ using $S$ as numeraire is:\n\n$$\\text{prob}^S(A) = \\mathbb{E}\\left[\\mathbf{1}_A m_t \\frac{S_t}{S_0}\\right]$$\n\nThe expectation of any random variable $X$ using $S$ as numeraire is:\n\n$$\\mathbb{E}^S[X] = \\mathbb{E}\\left[X m_t \\frac{S_t}{S_0}\\right]$$\n\nDifferent numeraires lead to different probability measures but the same derivative prices.\n\n## Stock as Numeraire\n\nUsing the stock as numeraire is particularly useful for certain derivatives. In the binomial model, define:\n\n$$\\text{prob}^S_u = \\frac{\\pi_u S_u}{S}, \\quad \\text{prob}^S_d = \\frac{\\pi_d S_d}{S}$$\n\nThese sum to 1 and are positive. For a call option:\n\n$$\\frac{C}{S} = \\text{prob}^S_u \\frac{C_u}{S_u} + \\text{prob}^S_d \\frac{C_d}{S_d}$$\n\nThe ratio $C/S$ (number of shares the call is worth) is a martingale under the stock numeraire measure.\n\nIn continuous time, for any derivative $V$ on stock $S$:\n\n$$V_0 = S_0 \\mathbb{E}^S\\left[\\frac{V_T}{S_T}\\right]$$\n\nThis formulation is often convenient for options that depend on the stock price relative to some level.\n\n## Changes of Probability and Girsanov's Theorem\n\nWhen we change probability measures, we cannot expect a process $B$ that was a Brownian motion to remain a Brownian motion. The expected change in a Brownian motion must always be zero, but when we change probabilities, the expected change of $B$ is likely to become nonzero. However, the Brownian motion $B$ will still be an Ito process under the new probability measure.\n\nChanging probabilities only changes the drift of an Ito process—the diffusion coefficient remains unchanged. This is because the diffusion coefficient determines how much each path \"jiggles,\" which is unaffected by changing the probability measure.\n\n### Example: Risk-Neutral Probability\n\nSuppose the stock price follows:\n\n$$\\frac{\\mathrm{d}S}{S} = \\mu \\mathrm{d}t + \\sigma \\mathrm{d}B$$\n\nwhere $B$ is a Brownian motion under the actual probability measure. Under the risk-neutral measure, the drift must be the risk-free rate $r$:\n\n$$\\frac{\\mathrm{d}S}{S} = r \\mathrm{d}t + \\sigma \\mathrm{d}B^*$$\n\nwhere $B^*$ is a Brownian motion under the risk-neutral probability.\n\n## Girsanov's Theorem in the Black-Scholes Model\n\nIn the Black-Scholes model, the dividend-reinvested stock price follows:\n\n$$\\mathrm{d}S_t = \\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}B_t$$\n\nWe can rewrite this as:\n\n$$\\mathrm{d}S_t = r S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}\\left(B_t + \\frac{\\mu - r}{\\sigma}t\\right)$$\n\nDefine $\\kappa = \\frac{\\mu - r}{\\sigma}$, called the market price of risk or Sharpe ratio.\n\n::: Principle\nDefine the exponential martingale:\n\n$$Z_t = \\exp\\left(-\\frac{1}{2}\\kappa^2 t - \\kappa B_t\\right)$$\n\nSince $Z_T$ is lognormal, $\\mathbb{E}[Z_T] = 1$. Under the probability measure defined by:\n\n$$\\mathbb{E}^\\kappa[Y] = \\mathbb{E}[Z_T Y]$$\n\nfor any function $Y$ of $B_t$ ($0 \\leq t \\leq T$), the process $B_t^\\kappa = B_t + \\kappa t$ is a Brownian motion. Moreover, if $M_t$ is a martingale under the new measure, then $Z_t M_t$ is a martingale under the original measure.\n:::\n\nThis is Girsanov's Theorem. It tells us how to construct the risk-neutral measure from the original measure. Using Ito's lemma, we can verify that $Z_t \\frac{S_t}{R_t}$ is indeed a martingale:\n\n$$Z_t \\frac{S_t}{R_t} = S_0 \\exp\\left(-\\frac{1}{2}(\\sigma - \\kappa)^2 t + (\\sigma - \\kappa)B_t\\right)$$\n\nTherefore:\n\n$$\\mathbb{E}\\left[Z_t \\frac{S_t}{R_t}\\right] = S_0$$\n\n### Stock as Numeraire Revisited\n\nWhen using the stock as numeraire, we need the process $\\frac{R_t}{S_t}$ to be a martingale. Following similar analysis with Girsanov's Theorem, we find that under the stock numeraire measure:\n\n$$\\mathrm{d}S_t = (r + \\sigma^2) S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}B_t^S$$\n\nwhere $B_t^S = B_t^R - \\sigma t$ is a Brownian motion under the stock numeraire measure.\n\n### Digital Options in Black-Scholes\n\nUsing these results, we can value digital options in the Black-Scholes model. The digital option paying $\\mathbf{1}_{\\{S(T) \\geq K\\}}$ has value:\n\n$$e^{-rT} \\mathbb{E}^R\\left[\\mathbf{1}_{\\{S(T) \\geq K\\}}\\right] = e^{-rT} N(d_2)$$\n\nwhere:\n\n$$d_2 = \\frac{\\log(S_0/K) + (r - \\frac{\\sigma^2}{2})T}{\\sigma\\sqrt{T}}$$\n\nand $N(\\cdot)$ is the standard normal cumulative distribution function.\n\nFor the digital option paying $S(T)\\mathbf{1}_{\\{S(T) \\geq K\\}}$, it's easier to use the stock as numeraire:\n\n$$S_0 \\mathbb{E}^S\\left[\\mathbf{1}_{\\{S(T) \\geq K\\}}\\right] = S_0 N(d_1)$$\n\nwhere:\n\n$$d_1 = \\frac{\\log(S_0/K) + (r + \\frac{\\sigma^2}{2})T}{\\sigma\\sqrt{T}}$$\n\n## Summary\n\nWe have developed a unified framework for derivative pricing based on the absence of arbitrage:\n\n1. **Linear pricing** implies the existence of state prices\n2. **State prices** can be converted to risk-neutral probabilities  \n3. **Asset price ratios** are martingales under appropriate probability measures\n4. **Any positive asset** can serve as numeraire, inducing its own probability measure\n5. The **fundamental pricing formula** expresses values as expectations of discounted payoffs\n6. **Girsanov's Theorem** provides the mathematical machinery to change between probability measures in continuous time\n\nThis framework extends from simple binomial models to general continuous-time models, providing the foundation for modern derivative pricing theory.\n\n",
    "supporting": [
      "Chapter_ArbitragePricing_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}