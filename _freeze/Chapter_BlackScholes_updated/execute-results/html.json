{
  "hash": "1c81675ff189cd8f271d339414978f9e",
  "result": {
    "engine": "jupyter",
    "markdown": "\\newcommand{\\d}{\\,\\mathrm{d}}\n\\newcommand{\\e}{\\mathrm{e}}\n\\newcommand{\\E}{\\mathbb{E}}\n\n\n# The Black-Scholes Model {#sec-c:blackscholes_updated}\n\n::: {#a70967f5 .cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"text/javascript\" async src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG\"></script>\n```\n:::\n:::\n\n\nIn the previous chapter, we developed a general framework for derivative pricing based on the absence of arbitrage. We saw how linear pricing leads to state prices, risk-neutral probabilities, and the fundamental pricing formula. We also introduced Girsanov's Theorem, which provides the mathematical machinery to change between probability measures in continuous time. In this chapter, we apply these principles to derive and analyze the celebrated Black-Scholes formula for European option pricing.\n\nThe Black-Scholes model assumes that the underlying asset pays a constant dividend yield $q$ and has price $S$ satisfying\n\n$$\\frac{\\mathrm{d}S}{S} = (\\mu - q) \\mathrm{d}t + \\sigma \\mathrm{d}B$$\n\nfor a Brownian motion $B$, where $\\sigma$ is assumed constant and $\\mu$ can be a quite general random process. We also assume a constant continuously-compounded risk-free rate $r$.\n\n## Derivation via Change of Numeraire\n\nWe can derive the Black-Scholes formula directly using the change of numeraire approach developed in the previous chapter. A European call option pays $(S_T - K)^+$ at maturity $T$. We can decompose this payoff as:\n\n$$(S_T - K)^+ = \\mathbf{1}_{\\{S_T > K\\}} S_T - K \\mathbf{1}_{\\{S_T > K\\}}$$\n\nThis represents one share digital minus $K$ cash digitals, both paying when $S_T > K$.\n\n### Digital Options\n\nIn continuous time, digital options serve as the primitive securities. A digital option paying \\$1 when $S_T > K$ has value:\n\n$$e^{-r(T-t)} \\mathbb{E}_t^R[\\mathbf{1}_{\\{S_T > K\\}}] = e^{-r(T-t)} \\text{prob}^R(S_T > K)$$\n\nUnder the risk-neutral measure from our previous analysis:\n\n$$\\frac{\\mathrm{d}S}{S} = (r - q) \\mathrm{d}t + \\sigma \\mathrm{d}B^R$$\n\nTherefore:\n\n$$S_T = S_t \\exp\\left((r - q - \\frac{\\sigma^2}{2})(T-t) + \\sigma B_{T-t}^R\\right)$$\n\nThe condition $S_T > K$ is equivalent to:\n\n$$\\frac{\\log(S_t/K) + (r - q - \\frac{\\sigma^2}{2})(T-t)}{\\sigma\\sqrt{T-t}} > -\\frac{B_{T-t}^R}{\\sqrt{T-t}}$$\n\nSince $-B_{T-t}^R/\\sqrt{T-t}$ is standard normal under the risk-neutral measure:\n\n$$\\text{prob}^R(S_T > K) = N(d_2)$$\n\nwhere:\n\n$$d_2 = \\frac{\\log(S_t/K) + (r - q - \\frac{\\sigma^2}{2})(T-t)}{\\sigma\\sqrt{T-t}}$$\n\n### Share Digital Options\n\nFor the share digital paying $S_T \\mathbf{1}_{\\{S_T > K\\}}$, we use the stock as numeraire. From our Girsanov's Theorem analysis:\n\n$$\\mathrm{d}S_t = (r - q + \\sigma^2) S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}B_t^S$$\n\nunder the stock numeraire measure. Following similar calculations:\n\n$$\\text{prob}^S(S_T > K) = N(d_1)$$\n\nwhere:\n\n$$d_1 = \\frac{\\log(S_t/K) + (r - q + \\frac{\\sigma^2}{2})(T-t)}{\\sigma\\sqrt{T-t}} = d_2 + \\sigma\\sqrt{T-t}$$\n\n### The Black-Scholes Formula\n\nCombining our results:\n\n::: Rule\nThe value of a European call option is:\n\n$$C(t, S_t) = e^{-q(T-t)} S_t N(d_1) - e^{-r(T-t)} K N(d_2)$$\n\nwhere $d_1$ and $d_2$ are defined above and $N(\\cdot)$ is the standard normal cumulative distribution function.\n:::\n\nFor a European put option:\n\n::: Rule\n$$P(t, S_t) = e^{-r(T-t)} K N(-d_2) - e^{-q(T-t)} S_t N(-d_1)$$\n:::\n\nThe call and put values satisfy put-call parity:\n\n$$e^{-r(T-t)} K + C(t, S_t) = e^{-q(T-t)} S_t + P(t, S_t)$$\n\n## Replication and Delta Hedging\n\nThe arbitrage pricing principle requires that we can replicate option payoffs through dynamic trading. Following Merton's argument, we construct a portfolio holding $\\delta_t$ shares of stock and $\\alpha_t$ units of the risk-free asset, with value:\n\n$$W_t = \\alpha_t e^{rt} + \\delta_t S_t$$\n\nFor continuous trading with no cash inflows or outflows:\n\n$$\\mathrm{d}W_t = \\delta_t \\mathrm{d}S_t + \\delta_t q S_t \\mathrm{d}t + \\alpha_t r e^{rt} \\mathrm{d}t$$\n\nIf the option value is $C(t, S_t)$, then by Ito's lemma:\n\n$$\\mathrm{d}C = \\frac{\\partial C}{\\partial t} \\mathrm{d}t + \\frac{\\partial C}{\\partial S} \\mathrm{d}S + \\frac{1}{2} \\frac{\\partial^2 C}{\\partial S^2} \\sigma^2 S^2 \\mathrm{d}t$$\n\nMatching the stochastic terms requires:\n\n$$\\delta_t = \\frac{\\partial C}{\\partial S}$$\n\nThis is the option's delta—the number of shares needed to hedge the option. By no-arbitrage, $W_t = C(t, S_t)$, leading to the fundamental partial differential equation.\n\n## The Fundamental PDE\n\nAny European derivative with payoff $V(S_T)$ at maturity $T$ must satisfy:\n\n$$r V = \\frac{\\partial V}{\\partial t} + \\frac{\\partial V}{\\partial S}(r - q)S + \\frac{1}{2} \\frac{\\partial^2 V}{\\partial S^2} \\sigma^2 S^2$$\n\nwith boundary condition $V(S_T, T) = V(S_T)$.\n\nThis PDE has several important interpretations:\n\n1. **Risk-neutral expectation**: The solution is $V(t, S_t) = \\mathbb{E}_t^R[e^{-r(T-t)} V(S_T)]$\n2. **Replication**: The portfolio holds $\\frac{\\partial V}{\\partial S}$ shares and $V - \\frac{\\partial V}{\\partial S}S$ in cash\n3. **Hedging condition**: The drift term equals the risk-free return when perfectly hedged\n\nThe Black-Scholes formula satisfies this PDE with the appropriate boundary conditions for calls and puts.\n\n## Greeks\n\nThe sensitivities of option values to various inputs are called Greeks. From the Black-Scholes formula:\n\n### Delta ($\\delta$)\nThe sensitivity to stock price changes:\n\n$$\\delta_{call} = e^{-q(T-t)} N(d_1)$$\n$$\\delta_{put} = -e^{-q(T-t)} N(-d_1)$$\n\n### Gamma ($\\Gamma$)\nThe rate of change of delta:\n\n$$\\Gamma = \\frac{e^{-q(T-t)} n(d_1)}{S \\sigma \\sqrt{T-t}}$$\n\nwhere $n(\\cdot)$ is the standard normal density. Gamma is the same for calls and puts.\n\n### Theta ($\\Theta$)\nThe time decay (using $\\partial/\\partial(-T)$ so positive theta means value increases as time passes):\n\n$$\\Theta_{call} = -\\frac{e^{-q(T-t)} S n(d_1) \\sigma}{2\\sqrt{T-t}} + q e^{-q(T-t)} S N(d_1) - r e^{-r(T-t)} K N(d_2)$$\n\n### Vega ($\\mathcal{V}$)\nThe sensitivity to volatility:\n\n$$\\mathcal{V} = e^{-q(T-t)} S n(d_1) \\sqrt{T-t}$$\n\n### Rho ($\\rho$)\nThe sensitivity to interest rates:\n\n$$\\rho_{call} = (T-t) e^{-r(T-t)} K N(d_2)$$\n\n## Theta and Gamma in Delta Hedges\n\nThe relationship between theta and gamma provides deep insight into option hedging. Consider a delta-hedged portfolio (short call, long $\\delta$ shares). From the fundamental PDE and our Greeks:\n\n$$\\Theta + \\frac{1}{2} \\Gamma \\sigma^2 S^2 = r C - (r - q) S \\delta$$\n\nIn continuous time, the portfolio change is:\n\n$$-\\Theta \\mathrm{d}t - \\frac{1}{2} \\Gamma \\sigma^2 S^2 \\mathrm{d}t + q \\delta S \\mathrm{d}t + (C - \\delta S) r \\mathrm{d}t$$\n\nThese terms exactly cancel—the time decay and dividends received offset losses from being short gamma and interest payments. This perfect cancellation only holds with continuous rebalancing.\n\nWith discrete rebalancing, the hedge is imperfect. The portfolio is short gamma, meaning it loses money when the stock moves significantly between rebalances. This loss is approximately:\n\n$$\\frac{1}{2} \\Gamma (\\Delta S)^2$$\n\nwhere $\\Delta S$ is the stock price change. The hedging error increases with:\n- Larger gamma (near the strike at expiration)\n- Higher volatility\n- Longer time between rebalances\n\n## Implied Volatilities\n\nWhile all other Black-Scholes inputs are observable, volatility must be estimated. Given an option's market price, we can invert the Black-Scholes formula to find the implied volatility—the $\\sigma$ that produces the observed price.\n\nImplied volatilities serve several purposes:\n\n1. **Price quotes**: Options are often quoted in terms of implied volatility\n2. **Relative value**: Comparing implied volatilities helps identify expensive or cheap options\n3. **Market views**: Implied volatilities reflect market expectations of future volatility\n\n### The Volatility Smile\n\nIf the Black-Scholes model were perfect, all options with the same maturity would have the same implied volatility. In practice, plotting implied volatility against strike typically shows:\n\n- Higher implied volatilities for low strikes (out-of-the-money puts)\n- Lower implied volatilities near the at-the-money strike\n- Slightly increasing implied volatilities for high strikes\n\nThis \"volatility smile\" or \"smirk\" indicates that market prices reflect:\n- Fat tails: Higher probability of extreme moves than lognormal\n- Negative skewness: Larger probability of extreme downward moves\n\nThe smile has been particularly pronounced for equity index options since the 1987 crash, suggesting market participants price in crash risk.\n\n## Summary\n\nThe Black-Scholes model combines the theoretical foundations of arbitrage pricing with practical implementation:\n\n1. **Change of numeraire**: Digital options under different measures give the formula\n2. **Replication**: Delta hedging shows how to replicate option payoffs\n3. **Fundamental PDE**: All derivatives satisfy the same partial differential equation\n4. **Greeks**: Sensitivities guide risk management and hedging\n5. **Market practice**: Implied volatilities reveal market expectations and model limitations\n\nThe model's elegance lies in showing that, under its assumptions, options can be perfectly hedged through dynamic trading. While real markets violate these assumptions, the Black-Scholes framework remains the foundation for understanding option pricing and hedging.\n\n",
    "supporting": [
      "Chapter_BlackScholes_updated_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\nif (typeof require !== 'undefined') {\nrequire.undef(\"plotly\");\nrequirejs.config({\n    paths: {\n        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']\n    }\n});\nrequire(['plotly'], function(Plotly) {\n    window._Plotly = Plotly;\n});\n}\n</script>\n\n"
      ]
    }
  }
}