{
  "hash": "a003d1d577c5f76a9ef3abc5955dec20",
  "result": {
    "engine": "jupyter",
    "markdown": "\\newcommand{\\d}{\\,\\mathrm{d}}\n\\newcommand{\\e}{\\mathrm{e}}\n\\newcommand{\\E}{\\mathbb{E}}\n\n\n\n# Portfolios and Delta Hedges {#sec-c:deltas} \n\n::: {.cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<IPython.core.display.HTML object>\n```\n:::\n:::\n\n\nConsider trading in a single risky asset, which we will call a stock.  Let $S$ denote the dividend-reinvested price, and let $\\mu$ denote its expected return and $\\sigma$ its volatility, meaning that\n$$\\frac{\\d S}{S} = \\mu\\d t + \\sigma \\d B$$\nwhere $B$ is a Brownian motion.  We allow for the possibility that $\\mu$ and $\\sigma$ change randomly over time (that is, they are stochastic processes).  Trading the asset means buying it with cash or selling it for cash.  We keep the cash in a money market account earning an instantaneous risk-free rate $r$, which can also vary randomly over time.  Let $V_t$ denote the total value of the portfolio of cash and stock at a point in time, and let $\\pi_t$ denote the fraction of the value that we have invested in the stock at a point in time, so that $1-\\pi_t$ is the fraction in the money market account.  We earn interest $r$ on the fraction $1-\\pi$, and we earn the return $\\d S/S$ on the fraction $\\pi$, so the return on our portfolio is\n$$(1-\\pi)r\\d t + \\pi \\frac{\\d S}{S}\\,.$$\nAssume that we do not withdraw any funds from the portfolio to spend, nor do we add additional funds to it.  Then, changes in the value of the portfolio are due only to the portfolio return.  This means that\n$$\\frac{\\d V}{V} = (1-\\pi)r\\d t + \\pi \\frac{\\d S}{S}\\,.$$\n\nIn the remainder of this chapter, we consider how to replicate a derivative security written on the stock by trading the stock.  This is the continuous-time version of the replication studied in @sec-c:arbitrage.  Replicating means that we want to match the portfolio value $V$ to the value of the derivative security.  To do so, the portfolio return just described must match the return on the derivative security.\n\nWe use the terms \"replication\" and \"delta hedge\" pretty much interchangeably.  If we can replicate a security, then the replication can serve as a hedge for a short position in the security, because the long $\\,+\\,$ short positions have opposite returns, producing a risk-free portfolio.  Symmetrically, if we can replicate a short position in the security, then the replication can serve as a hedge for a long position in the security.  The meaning of \"delta\" in \"delta hedge\" will become clear.\n\n## Path-Independent Derivatives\n\n## Ito's Formula and Deltas \n\n## The Fundamental PDE \n\n\n## Example: Replicating Portfolios and Simulating Portfolio Insurance\n\nAnother derivation of the Black Scholes formula is provided by Merton.  He asked  whether the payoff to a European call option can be replicated by trading the stock and the risk free asset.  Let $\\theta_t$ be the number of shares of the stock held at time $t$ and $\\alpha_t$ the number of shares of an initial investment of one dollar in the risk free asset.   Then the portfolio is worth $\\alpha_t R_t + \\theta_t S_t$ where $R_t= e^{rt}$ is the time $t$ value of an initial time $0$ investment of one dollar in the risk free asset. The portfolio should start with an initial value, should not have any cash inflows or outflows and have a terminal value equal to a call payoff so the changes in value are completely dictated by the changes in the value of the assets.  That is, assuming continuous trading,\n$$  d W_t = \\theta_t d S_t + \\alpha_t  d R_t = \\theta_t \\left(\\mu S_t dt + q S_t dt + \\sigma S_t d B_t\\right)  + \\alpha_t r R_t dt$$\nwith terminal condition \n$$ W_T = \\alpha_T R_T + \\theta_T S_T = (S_T - K)^{+} $$\nThe problem is to find $\\theta_t$ and $\\alpha_t$ for all times and states.  If we can accomplish this, then by `no-arbitrage' the call price must be the value of the initial investment.  Assume the call price is a function of the stock price and time: $C(t,S_t)$.  Then by Ito's Lemma\n$$ d C(t,S_t) = \\left(\\frac{\\partial C}{\\partial t} + \\frac{\\partial C}{\\partial S} (\\mu-q) S_t + \\frac{1}{2} \\frac{\\partial^2 C}{\\partial S^2} \\sigma^2 S_t^2 \\right) dt + \\frac{\\partial C}{\\partial S} \\sigma S_t dB_t $$\nIt should be apparent that we want to hold $\\theta = \\frac{\\partial C}{\\partial S}$, which is the delta of the call option.  By doing so, we match the diffusion term in thw change in wealth and the change in the call option.  Then matching the drift terms in both expressions\n$$ \\frac{\\partial C}{\\partial S} \\mu S_t + \\alpha_t r R_t = \\frac{\\partial C}{\\partial t} + \\frac{\\partial C}{\\partial S} (\\mu-q) S_t + \\frac{1}{2} \\frac{\\partial^2 C}{\\partial S^2} \\sigma^2 S_t^2$$\nwhich can be solved to give\n$$ \\alpha_t r R_t=r \\left(W_t -\\frac{\\partial C}{\\partial S} S_t\\right)  = \\frac{\\partial C}{\\partial t}-\\frac{\\partial C}{\\partial S} q S_t  + \\frac{1}{2} \\frac{\\partial^2 C}{\\partial S^2} \\sigma^2 S_t^2$$\nwhich gives the equation\n$$r W_t = \\frac{\\partial C}{\\partial t} + \\frac{\\partial C}{\\partial S}(r-q) S_t+\\frac{1}{2} \\frac{\\partial^2 C}{\\partial S^2} \\sigma^2 S_t^2$$\nwith a boundary condition $W_T = (S_T-K)^{+}$.  However, no-arbitrage suggests $W_t = C(t,S_t)$ which gives us the partial differential equation\n$$r C = \\frac{\\partial C}{\\partial t} + \\frac{\\partial C}{\\partial S} (r-q) S+\\frac{1}{2} \\frac{\\partial^2 C}{\\partial S^2} \\sigma^2 S^2$$\nwith a boundary condition $C(T,S_T)= (S_T - K)^{+}$.  This is a partial differential equation and a fairly tedious set of calcuations show the Black Scholes formula is a solution (in fact it is the only positive solution).  Close observation of the right hand side we see this is the drift term of Ito expansion for $C$ if we work in the risk-neutral probability.  The right hand side then says in the risk-neutral probability, the call option earns the risk free return.\n\nHowever, there is nothing special about a call option.  The same argument will apply for any European style option.  The only difference is the boundary condition.  \n\n![](under_construction.jpg)\n\n\nThe ability to create a fully hedged (risk-free) portfolio of the stock and an option is the essence of the arbitrage argument underlying the Black-Scholes formula, as we saw in @sec-c:arbitrage for the binomial model.  For a call option, such a portfolio consists of delta shares of the underlying asset and a short call option, or a short position of delta shares of the underlying and a long call option.  \\index{delta hedge} These portfolios have no instantaneous exposure to the price of the underlying.  To create a perfect hedge, the portfolio must be adjusted continuously, because the delta changes when the price of the underlying changes and when time passes.  In practice, any hedge will therefore be imperfect, even if the assumptions of the model are satisfied. \n\nWe first consider the continuous-time hedging argument.  Consider a European call option with maturity $T$, and let $C(S,t)$ denote the value of the option at date $t<T$ when the stock price is $S$ at date $t$.  Consider a portfolio that is short one call option and long $\\delta$ shares of the underlying asset and that has a (short) cash position equal to $C-\\delta S$.  This portfolio has zero value at date $t$.  \n\nThe change in the value of the portfolio in an instant $\\d  t$ is\n$$\n-\\d  C + \\delta \\d   S + q \\delta S\\d   t+(C-\\delta S)r\\d   t\\;.\n$$ {#eq-changeportfoliovalue}\n\nThe first term reflects the change in the value of the option, the second term is the capital gain or loss on $\\delta$ shares of stock, the third term is the dividends received on $\\delta$ shares of stock, and the fourth term is the interest expense on the short cash position.\n\nOn the other hand, we know from Ito's formula that\n\n$$\n\\d  C = \\frac{\\partial C}{\\partial S}\\d   S + \\frac{\\partial C}{\\partial t}\\d   t + \\frac{1}{2}\\frac{\\partial^2C}{\\partial S^2} (\\d  S)^2  \n$$\n$$\n= \\delta \\d   S + \\Theta \\d   t + \\frac{1}{2}\\Gamma \\sigma^2S^2\\d   t\\;.\n$$ {#eq-changeportfoliovalue2}\n\n\n## Portfolio Insurance \n\nThis procedure allows us to replicate the payoff of any European option even for those which might not be traded.  This observation had a profound effect on practice.  A particularly popular example is portfolio insurance.\n\nRecall, that a protective put position buys a put and buys a share and the payoff at the expiration of the put is given by $\\max(K,S_T)$.  The reason for the name protective put is apparent since the position can pay off no less than $K$.  The cost of this insurance is the price of the put.  However, if the put is not traded, we can synthetically replicate this payoff using the prodedure above assuming we can trade continuously.  The basic recipe is to start with inital wealth equal to that for a protective put position: $W_0 = P(0,S_0)+S_0$.  The delta of the protective put position can be calcuated to be the delta of the put plus 1 which is $N(d_1)$, where $d_1$ is calculated at each point in time.  However, in practice we cannot trade continuously.  \n\n",
    "supporting": [
      "Chapter_Deltas_files\\figure-pdf"
    ],
    "filters": []
  }
}