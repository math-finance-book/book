{
  "hash": "8877dbf8a58698c6e7fbfbae50b532ae",
  "result": {
    "engine": "jupyter",
    "markdown": "\\newcommand{\\d}{\\,\\mathrm{d}}\n\\newcommand{\\e}{\\mathrm{e}}\n\\newcommand{\\E}{\\mathbb{E}}\n\n\n\n\n## Geometric Brownian Motion {#sec-s:geometricbrownianmotion} \n\n::: {.cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<IPython.core.display.HTML object>\n```\n:::\n:::\n\n\nAn important Ito process is $S$ defined as \n$$\nS_t=S_0\\e^{(\\mu- \\sigma^2 /2)t + \\sigma B_t}\n$$ {#eq-exponential1}\n\nfor constants $\\mu$ and $\\sigma$, where $B$ is a Brownian motion.  Using the product rule and the rule for exponentials, we obtain\n$$\n\\frac{\\d  S}{S} = \\mu\\d   t+\\sigma\\d   B\\;.\n$$ {#eq-Y}\n\nWhen we see an equation of the form @eq-Y, we should recognize @eq-exponential1 as the solution. \n\nThe process $S$ is called a geometric Brownian motion.  \\index{geometric Brownian motion} In keeping with the discussion of @sec-s:itoprocesses, we interpret @eq-Y as stating that $\\mu\\d   t$ is the expected rate of change of $S$ and $\\sigma^2\\d   t$ is the variance of the rate of change in an instant $\\d  t$.  We call $\\mu$ the drift and $\\sigma$ the volatility.  \\index{volatility} \n\nTaking the natural logarithm of @eq-exponential1 gives an equivalent form of the solution:\n$$\n\\log S_t= \\log S_0+\\left(\\mu -\\frac{1}{2}\\sigma^2\\right)t + \\sigma B_t\\;.\n$$ {#eq-exponential2}\n  This shows that $\\log S_t - \\log S_0$ is a $(\\mu-\\sigma^2/2,\\sigma)$--Brownian motion.  Given information at time $t$, the logarithm of $S(u)$ for $u>t$ is normally \\index{lognormal distribution}distributed with mean $(u-t)(\\mu-\\sigma^2/2)$ and variance $(u-t)\\sigma^2$.  Because $S$ is the exponential of its logarithm, $S$ can never be negative.  For this reason, a geometric Brownian motion is a better model for stock prices than is a Brownian motion.\n\nThe differential of @eq-exponential2 is\n$$\n\\d  \\log S_t = \\left(\\mu -\\frac{1}{2}\\sigma^2\\right)\\d   t+ \\sigma\\d   B_t\\;.\n$$ {#eq-exponential3}\n\nWe conclude:\n\n::: Rule\n\nThe  equation \n$$\\frac{\\d  S}{S} = \\mu\\d   t+\\sigma\\d   B$$\nis equivalent to the equation\n$$\\d  \\log S = \\left(\\mu -\\frac{1}{2}\\sigma^2\\right)\\d   t+ \\sigma\\d   B\\; .$$\nThe solution of both equations is @eq-exponential1 or the equivalent @eq-exponential2.\n\n:::\n\n## Lognormal Variables and Average Growth Rates\n\nA random variable is said to be lognormally distributed if it can be written as $\\tilde{y}=  \\e^{\\tilde{x}}$ where $\\tilde{x}$ has a normal distribution with mean $m$ and standard deviation $s$.  The mean of a lognormal random variable is given by the following.\n\n::: Rule\n\n##\nIf $\\tilde{x}$ is normally distributed with mean $m$ and standard deviation $s$, then $\\e^{\\tilde{x}}$ is lognormally distributed and\n$$\\E[\\e^{\\tilde{x}}]=e^{m + \\frac{1}{2} s^2}\\,.\n$$ {#eq-lognormal}\n\n\n:::\n\n@eq-exponential1 shows that if $S$ is a geometric Brownian motion, then, for each $t<u$, \n$$\\frac{S_u}{S_t} = \\e^{(\\mu-\\sigma^2/2)(u-t) + \\sigma(B_u-B_t)}\\,,$$\nwhich is a lognormally distributed random variable, conditional on information at $t$.  We can apply the previous calculation rule by taking $m=(\\mu-\\sigma^2/2)(u-t)$ and $s=\\sigma\\sqrt{u-t}$.  This produces\n$$\\E_t[S_u] = S_t\\e^{(u-t)\\mu}\\,.$$\nThus, a geometric Brownian motion grows at the average rate of $\\mu$.\n\nA special case is $\\mu=0$.  When $\\mu=0$, we have $\\E_t[S_u]=S_t$, so $S$ is a martingale.  This is an important example of a strictly positive martingale.  \n\n## Distribution of Continuously Compounded Returns\n\nOver a discrete time interval $\\Delta t$, @eq-exponential3 implies that the change in the logarithm of $S$ is \n$$\n\\Delta \\log S = \\left(\\mu -\\frac{1}{2}\\sigma^2\\right)\\Delta t+ \\sigma\\,\\Delta B\\;.\n$$ {#eq-exponential11}\n\nIf $S$ is the price of a dividend-reinvested asset, then over the time period $t_{i-1}$ to $t_i$, with $t_i-t_{i-1}=\\Delta t$, we have\n$$\n\\Delta \\log S = r_i\\,\\Delta t\\;,\n$$ {#eq-exponential10}\n\nwhere $r_i$ is the  continuously compounded annualized rate of return \\index{continuously compounded return} during the period $\\Delta t$.  This follows from the definition of the continuously compounded rate of return as the constant rate over the time period $\\Delta t$ that would cause $S$ to grow (or fall) from $S_{t_{i-1}}$ to $S_{t_i}$.  To be precise, $r_i$ is defined by\n$$\\frac{S_{t_i}}{S_{t_{i-1}}} = \\mathrm{e}^{r_i\\Delta t}\\; ,$$\nwhich is equivalent to @eq-exponential10.\nThus, when a dividend-reinvested asset price is a geometric Brownian motions satisfying @eq-Y, then the continuously compounded annualized rate of return over a period of length $\\Delta t$ is $$r_i = \\mu -\\frac{1}{2}\\sigma^2+ \\frac{\\sigma\\Delta B}{\\Delta t}\\; .$$\nThis implies that $r_i$ is normally distributed with mean $\\mu-\\sigma^2/2$ and variance $\\sigma^2/\\Delta t$.  Given historical data on the rates of return, the parameters $\\mu$ and $\\sigma$ can be estimated by standard methods (see @sec-c:stochasticvolatility).\n\n\n## Tail Probabilities of Geometric Brownian Motions {#sec-tailprobs}\n\nAn important calculation for pricing options is to compute the probability of an option finishing in the money under different probability measures.  Consider computing the probability at date $0<t$ of the event that $S_t > K$ for some positive constant $K$, where $S$ is a geometric Brownian motion satisfying @eq-Y.   We use the logarithmic version of the solution given in @eq-exponential2.  We have\n$$\\begin{align*}\nS_t > K  & \\quad\\Longleftrightarrow\\quad \\log S_t > \\log K\\\\\n&\n \\quad\\Longleftrightarrow\\quad \\sigma B_t > \\log K - \\log S_0-\\mu t\n \\\\\n&\n \\quad\\Longleftrightarrow\\quad \\frac{B_t}{\\sqrt{t}} > \\frac{\\log K - \\log S_0-\\mu t}{\\sigma\\sqrt{t}}\n\\\\\n&\n \\quad\\Longleftrightarrow\\quad -\\frac{B_t}{\\sqrt{t}} < \\frac{\\log S_0-\\log K + \\mu t}{\\sigma\\sqrt{t}}\n \\end{align*}\n$$ {#eq-tailprob2}\nWe denote the probability that a standard normal random variable is less than some number $d$ as $\\mathrm{N}(d)$.  Because $-B_t / \\sqrt{t}$ is a standard normal random variable, the above calculations imply the following.\n\n::: Rule\n## \nAssume $S$ is a geometric Brownian motion satisfying @eq-Y$.  Then, for any positive number $K$\n$$\n\\text{prob}(S_t>K) = \\mathrm{N}(d)\\;,\n$$ {#eq-tailprob01}\n\nwhere\n$$\nd = \\frac{\\log S_0 - \\log K+ \\mu t}{\\sigma\\sqrt{t}}\\;.\n$$ {#eq-tailprob3}\nFurthermore,\n$$\n\\text{prob}(S_t<K) = 1 - \\mathrm{N}(d) = \\mathrm{N}(-d)\\;.\n$$ {#eq-tailprob011}\n:::\n\n\n\n\n\n\n\n## {.unnumbered}\n\n\n::: Exercise\n Consider a discrete partition $0=t_0 < t_1 < \\cdots t_N=T$ of the time interval $[0,T]$ with $t_i - t_{i-1} = \\Delta t = T/N$ for each $i$.  Consider the function \n$$X_t=\\mathrm{e}^t\\; .$$\nWrite a code, which computes and plots $\\sum_{i=1}^N [\\Delta X_{t_i}]^2$, where \n$$\\Delta X_{t_i} = X_{t_i}-X_{t_{i-1}} = \\mathrm{e}^{t_i} - \\mathrm{e}^{t_{i-1}}\\; .$$\n:::\n::: Exercise\n Repeat the previous problem for the function $X_t = t^3$.  In both this and the previous problem, what happens to $\\sum_{i=1}^N [\\Delta X_{t_i}]^2$ as $N \\rightarrow \\infty$?\n:::\n::: Exercise\n Either use the code provided or write a code to compute $\\sum_{i=1}^N [\\Delta B_{t_i}]^2$, where $B$ is a simulated Brownian motion.  For a given $T$, what happens to the sum as $N \\rightarrow \\infty$?  \n:::\n::: Exercise\n Repeat the previous problem to compute $\\sum_{i=1}^N [\\Delta B_{t_i}]^3$, where $B$ is a simulated Brownian motion.  For a given $T$, what happens to the sum as $N \\rightarrow \\infty$?  \n:::\n::: Exercise\n Repeat the previous problem, computing instead $\\sum_{i=1}^N |\\Delta B_{t_i}|$ where $| \\cdot |$ denotes the absolute value.  What happens to this sum as $N \\rightarrow \\infty$?\n:::\n::: Exercise\nUse Ito's Lemma to derive the stochastic differential equation for $S_t^2$.  Argue that $S_t^2$ is geometric Brownian motion and find $\\E[S_t^2]$.\n::: \n::: Exercise\nIto's Lemma can be used in different ways to get the same answer.  For example, let $X_t = a t + b B_t$ and use Ito's lemma on the function $e^{X_t}$.  Alternatively, let $f(t, B_t) = e^{a t + bB_t}$.  Use Ito's lemma on $f(,)$.\n::: \n::: Exercise \nUse the facts $e^{x+y}=e^x \\times e^y$ and $\\frac{e^x}{e^y} = e^{x-y}$ to deduce the drift and volatility of the product and ratio of two geometric Brownian motions.\n::: \n::: Exercise\n Consider a discrete partition $0=t_0 < t_1 < \\cdots t_N=T$ of the time interval $[0,T]$ with $t_i - t_{i-1} = \\Delta t = T/N$ for each $i$.  Consider a geometric Brownian motion\n$$\\frac{\\d  Z}{Z} = \\mu\\d   t + \\sigma\\d   B\\; .$$\nAn approximate path $\\tilde{Z}_t$ of the geometric Brownian motion can be simulated as\n$$\n\\Delta \\tilde{Z}_{t_i} = \\tilde{Z}_{t_{i-1}} \\big[ \\mu\\,\\Delta t + \\sigma\\,\\Delta B\\big]\\;.\n$$ {#eq-exponential111}\nModify the code to generate both a path $Z_t$ and an approximate path $\\tilde{Z}_t$ according to @eq-exponential111, using the same $\\Delta B$  for both paths and taking $\\tilde{Z}_0 = Z_0$.  Plot both paths in the same figure.  How well does the approximation work for large $N$?   Warning:  \nFor $N$ larger than about $100 T$, the approximation will look perfect---you won't be able to tell that there are two plots in the figure.  One reason this is true is an exact formula is \n$$\n Z_{t_i} = Z_{t_{i-1}} \\exp\\left[ \\left(\\mu -\\frac{\\sigma^2}{2}\\right)\\,\\Delta t + \\sigma\\,\\Delta B\\right]\\;.\n$$ {#eq-exponential112}\nand using Taylor's Theorem for small $\\Delta t$, $e^{\\left(\\mu-\\frac{\\sigma^2}{2}\\right) \\Delta t} \\approx 1+ \\left(\\mu-\\frac{\\sigma^2}{2}\\right) \\Delta t$ and $e^{\\sigma \\Delta B_t} \\approx 1+ \\sigma \\Delta B_t +\\frac{1}{2}\\sigma^2 (\\Delta B_t)^2$ and $(\\d   B_t)^2=\\Delta t$.\n:::\n::: Exercise\nUse simulation to find  $\\E^*[e^{-r T}{\\mathbf{1}}_{\\{S_t \\ge K\\}}]$ in the risk-neutral probability where\n\\begin{equation*}\n\\d   S_t= r S_t \\d   t + \\sigma S_t \\d   B_t^*\n\\end{equation*}\nVerify that $S_t/e^{r t}$ is a martingale in the $*$ measure where $B^*$ is a Brownian motion.\nThen use simulation to find $S_0\\E^S[\\frac{1}{S_t} {\\mathbf{1}}_{\\{S_t \\ge K\\}}]$ in the pricing measure which uses the share as numeraire where \n\\begin{equation*}\n\\d   S_t = (r + \\sigma^2) S_t \\d   t + \\sigma S_t \\d   B_t^S\n\\end{equation*}\nso the log satisfies\n\\begin{equation*}\n\\log(S_t) = \\log(S_0) + (r + \\frac{\\sigma^2}{2})t + \\sigma B_t^S\n\\end{equation*}\nYou should verify $e^{rt}/S_t$ is a martingale in the $S$ measure where $B^S$ is a Brownian motion.\nBoth estimates should be the same up to simulation error and give the time zero value of the random payoff ${\\mathbf{1}}_{\\{S_t \\ge K\\}}$ which is a random variable equal to $1$ if $S_t\\ge K$ and $0$ otherwise.  You should choose the values for $r$, $\\sigma$, $T$, and $K$.\n::: \n\n## {.unnumbered}\n\n::: Exercise\nUse Ito's formula to derive the stochastic differential equation for $S_t^2$.  Argue that $S_t^2$ is geometric Brownian motion and find $\\E[S_t^2]$.\n::: \n\n::: Exercise \nUse the facts $\\e^{x+y}=\\e^x \\times \\e^y$ and $\\frac{\\e^x}{\\e^y} = \\e^{x-y}$ to deduce the drift and volatility of the product and ratio of two geometric Brownian motions.\n::: \n::: Exercise\n Consider a discrete partition $0=t_0 < t_1 < \\cdots t_N=T$ of the time interval $[0,T]$ with $t_i - t_{i-1} = \\Delta t = T/N$ for each $i$.  Consider a geometric Brownian motion\n$$\\frac{\\d  Z}{Z} = \\mu\\d   t + \\sigma\\d   B\\; .$$\nAn approximate path $\\tilde{Z}_t$ of the geometric Brownian motion can be simulated as\n$$\n\\Delta \\tilde{Z}_{t_i} = \\tilde{Z}_{t_{i-1}} \\big[ \\mu\\,\\Delta t + \\sigma\\,\\Delta B\\big]\\;.\n$$ {#eq-exponential111}\nModify the code to generate both a path $Z_t$ and an approximate path $\\tilde{Z}_t$ according to @eq-exponential111, using the same $\\Delta B$  for both paths and taking $\\tilde{Z}_0 = Z_0$.  Plot both paths in the same figure.  How well does the approximation work for large $N$?   Warning:  \nFor $N$ larger than about $100 T$, the approximation will look perfect---you won't be able to tell that there are two plots in the figure.  One reason this is true is an exact formula is \n$$\n Z_{t_i} = Z_{t_{i-1}} \\exp\\left[ \\left(\\mu -\\frac{\\sigma^2}{2}\\right)\\,\\Delta t + \\sigma\\,\\Delta B\\right]\\;.\n$$ {#eq-exponential112}\nand using Taylor's Theorem for small $\\Delta t$, $\\e^{\\left(\\mu-\\frac{\\sigma^2}{2}\\right) \\Delta t} \\approx 1+ \\left(\\mu-\\frac{\\sigma^2}{2}\\right) \\Delta t$ and $\\e^{\\sigma \\Delta B_t} \\approx 1+ \\sigma \\Delta B_t +\\frac{1}{2}\\sigma^2 (\\Delta B_t)^2$ and $(\\d   B_t)^2=\\Delta t$.\n:::\n::: Exercise\nUse simulation to find  $\\E^*[\\e^{-r T}{\\mathbf{1}}_{\\{S_t \\ge K\\}}]$ in the risk-neutral probability where\n\\begin{equation*}\n\\d   S_t= r S_t \\d   t + \\sigma S_t \\d   B_t^*\n\\end{equation*}\nVerify that $S_t/\\e^{r t}$ is a martingale in the $*$ measure where $B^*$ is a Brownian motion.\nThen use simulation to find $S_0\\E^S[\\frac{1}{S_t} {\\mathbf{1}}_{\\{S_t \\ge K\\}}]$ in the pricing measure which uses the share as numeraire where \n\\begin{equation*}\n\\d   S_t = (r + \\sigma^2) S_t \\d   t + \\sigma S_t \\d   B_t^S\n\\end{equation*}\nso the log satisfies\n\\begin{equation*}\n\\log(S_t) = \\log(S_0) + (r + \\frac{\\sigma^2}{2})t + \\sigma B_t^S\n\\end{equation*}\nYou should verify $\\e^{rt}/S_t$ is a martingale in the $S$ measure where $B^S$ is a Brownian motion.\nBoth estimates should be the same up to simulation error and give the time zero value of the random payoff ${\\mathbf{1}}_{\\{S_t \\ge K\\}}$ which is a random variable equal to $1$ if $S_t\\ge K$ and $0$ otherwise.  You should choose the values for $r$, $\\sigma$, $T$, and $K$.\n::: \n\n",
    "supporting": [
      "Chapter_GBM_files\\figure-pdf"
    ],
    "filters": []
  }
}