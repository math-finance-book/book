<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Finance Book - 8&nbsp; Exotic Options</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter9.html" rel="next">
<link href="./Chapter7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Finance Book</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Asset Pricing Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Continuous-Time Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Black-Scholes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimating and Modelling Volatility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo and Binomial Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Monte Carlo and Binomial Valuation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter14.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#forward-start-options" id="toc-forward-start-options" class="nav-link active" data-scroll-target="#forward-start-options"><span class="toc-section-number">9</span>  Forward-Start Options</a>
  <ul class="collapse">
  <li><a href="#forward-start-call-payoff" id="toc-forward-start-call-payoff" class="nav-link" data-scroll-target="#forward-start-call-payoff">Forward-Start Call Payoff</a></li>
  <li><a href="#numeraires" id="toc-numeraires" class="nav-link" data-scroll-target="#numeraires">Numeraires</a></li>
  <li><a href="#calculating-probabilities" id="toc-calculating-probabilities" class="nav-link" data-scroll-target="#calculating-probabilities">Calculating Probabilities</a></li>
  <li><a href="#forward-start-call-pricing-formula" id="toc-forward-start-call-pricing-formula" class="nav-link" data-scroll-target="#forward-start-call-pricing-formula">Forward-Start Call Pricing Formula</a></li>
  <li><a href="#put-call-parity" id="toc-put-call-parity" class="nav-link" data-scroll-target="#put-call-parity">Put-Call Parity</a></li>
  </ul></li>
  <li><a href="#compound-options" id="toc-compound-options" class="nav-link" data-scroll-target="#compound-options"><span class="toc-section-number">10</span>  Compound Options</a>
  <ul class="collapse">
  <li><a href="#call-on-a-call-payoff" id="toc-call-on-a-call-payoff" class="nav-link" data-scroll-target="#call-on-a-call-payoff">Call-on-a-Call Payoff</a></li>
  <li><a href="#numeraires" id="toc-numeraires" class="nav-link" data-scroll-target="#numeraires">Numeraires</a></li>
  <li><a href="#calculating-probabilities" id="toc-calculating-probabilities" class="nav-link" data-scroll-target="#calculating-probabilities">Calculating Probabilities</a></li>
  <li><a href="#american-call-pricing-formula" id="toc-american-call-pricing-formula" class="nav-link" data-scroll-target="#american-call-pricing-formula">American Call Pricing Formula</a></li>
  </ul></li>
  <li><a href="#s_choosers" id="toc-s_choosers" class="nav-link" data-scroll-target="#s_choosers"><span class="toc-section-number">11</span>  Choosers</a>
  <ul class="collapse">
  <li><a href="#chooser-payoff" id="toc-chooser-payoff" class="nav-link" data-scroll-target="#chooser-payoff">Chooser Payoff</a></li>
  <li><a href="#numeraires" id="toc-numeraires" class="nav-link" data-scroll-target="#numeraires">Numeraires</a></li>
  <li><a href="#chooser-pricing-formula" id="toc-chooser-pricing-formula" class="nav-link" data-scroll-target="#chooser-pricing-formula">Chooser Pricing Formula</a></li>
  </ul></li>
  <li><a href="#options-on-the-max-or-min" id="toc-options-on-the-max-or-min" class="nav-link" data-scroll-target="#options-on-the-max-or-min"><span class="toc-section-number">12</span>  Options on the Max or Min</a>
  <ul class="collapse">
  <li><a href="#call-on-the-max-payoff" id="toc-call-on-the-max-payoff" class="nav-link" data-scroll-target="#call-on-the-max-payoff">Call-on-the-Max Payoff</a></li>
  <li><a href="#numeraires" id="toc-numeraires" class="nav-link" data-scroll-target="#numeraires">Numeraires</a></li>
  <li><a href="#calculating-probabilities" id="toc-calculating-probabilities" class="nav-link" data-scroll-target="#calculating-probabilities">Calculating Probabilities</a></li>
  <li><a href="#down-and-out-call-pricing-formula" id="toc-down-and-out-call-pricing-formula" class="nav-link" data-scroll-target="#down-and-out-call-pricing-formula">Down-and-Out Call Pricing Formula</a></li>
  </ul></li>
  <li><a href="#s_lookbacks" id="toc-s_lookbacks" class="nav-link" data-scroll-target="#s_lookbacks"><span class="toc-section-number">13</span>  Lookbacks</a>
  <ul class="collapse">
  <li><a href="#floating-strike-lookback-call-payoff" id="toc-floating-strike-lookback-call-payoff" class="nav-link" data-scroll-target="#floating-strike-lookback-call-payoff">Floating-Strike Lookback Call Payoff</a></li>
  <li><a href="#calculations" id="toc-calculations" class="nav-link" data-scroll-target="#calculations">Calculations</a></li>
  <li><a href="#floating-strike-lookback-call-pricing-formula" id="toc-floating-strike-lookback-call-pricing-formula" class="nav-link" data-scroll-target="#floating-strike-lookback-call-pricing-formula">Floating-Strike Lookback Call Pricing Formula</a></li>
  </ul></li>
  <li><a href="#s_baskets" id="toc-s_baskets" class="nav-link" data-scroll-target="#s_baskets"><span class="toc-section-number">14</span>  Basket and Spread Options</a></li>
  <li><a href="#s_asians" id="toc-s_asians" class="nav-link" data-scroll-target="#s_asians"><span class="toc-section-number">15</span>  Asian Options</a></li>
  <li><a href="#s_exotics_matlab" id="toc-s_exotics_matlab" class="nav-link" data-scroll-target="#s_exotics_matlab"><span class="toc-section-number">16</span>  Calculations in VBA</a>
  <ul class="collapse">
  <li><a href="#bivariate-normal-distribution-function" id="toc-bivariate-normal-distribution-function" class="nav-link" data-scroll-target="#bivariate-normal-distribution-function">Bivariate Normal Distribution Function</a></li>
  <li><a href="#forward-start-call" id="toc-forward-start-call" class="nav-link" data-scroll-target="#forward-start-call">Forward-Start Call</a></li>
  <li><a href="#call-on-a-call" id="toc-call-on-a-call" class="nav-link" data-scroll-target="#call-on-a-call">Call on a Call</a></li>
  <li><a href="#call-on-a-put" id="toc-call-on-a-put" class="nav-link" data-scroll-target="#call-on-a-put">Call on a Put</a></li>
  <li><a href="#american-calls-with-discrete-dividends" id="toc-american-calls-with-discrete-dividends" class="nav-link" data-scroll-target="#american-calls-with-discrete-dividends">American Calls with Discrete Dividends</a></li>
  <li><a href="#choosers" id="toc-choosers" class="nav-link" data-scroll-target="#choosers">Choosers</a></li>
  <li><a href="#floating-strike-lookbacks" id="toc-floating-strike-lookbacks" class="nav-link" data-scroll-target="#floating-strike-lookbacks">Floating-Strike Lookbacks</a></li>
  <li><a href="#discretely-sampled-geometric-average-price-calls" id="toc-discretely-sampled-geometric-average-price-calls" class="nav-link" data-scroll-target="#discretely-sampled-geometric-average-price-calls">Discretely-Sampled Geometric-Average-Price Calls</a></li>
  </ul></li>
  <li><a href="#problems" id="toc-problems" class="nav-link" data-scroll-target="#problems">Problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="c_exotics" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>We will only discuss a few exotic options. The reason for studying the derivation of an option pricing formula is that it may better equip one to analyze new products. Hopefully, this chapter will be of some assistance in that regard. Of course, one cannot expect to derive a closed-form solution for the value of every product, and often numerical methods will be necessary. For a much more comprehensive presentation of exotic option pricing formulas, the book by Haug <span class="citation" data-cites="Haug">[@Haug]</span> and the Excel software that accompanies it are highly recommended. Zhang <span class="citation" data-cites="Zhang">[@Zhang]</span> is also a comprehensive reference for exotics.</p>
<p>The valuation of an American call option on an asset paying a discrete cash dividend (rather than a continuous dividend) is considered in Sect. <a href="#s_discrete" data-reference-type="ref" data-reference="s_discrete">[s_discrete]</a>. Under a particular assumption on the volatility, valuing this option is very similar to valuing a compound option. Except for the assumption of a discrete dividend in Sect. <a href="#s_discrete" data-reference-type="ref" data-reference="s_discrete">[s_discrete]</a>, we will make the Black-Scholes assumptions throughout this chapter: there is a constant risk-free rate <span class="math inline">\(r\)</span> and the underlying asset has a constant volatility <span class="math inline">\(\sigma\)</span> and a constant dividend yield <span class="math inline">\(q\)</span>.</p>
<p>The order in which exotics are presented in this chapter is based on the simplicity of the analysis—the chapter begins with the easiest to analyze and works towards the more difficult. This order is roughly the inverse of importance, the most important exotics in practice being barriers, baskets, spreads and Asians. In the cases of Asian and basket options, we will explain why there are no simple closed-form formulas (sums of lognormally distributed random variables are not lognormal). We will use these cases and discretely-sampled barriers and lookbacks as examples in the next chapter.</p>
<section id="forward-start-options" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Forward-Start Options</h1>
<p>A forward-start option is an option for which the strike price is set equal to the stock price at some later date. In essence, it is issued at the later date, with the strike price set at the money. For example, an executive may know that he is to be given an option grant at some later date with the strike price set equal to the stock price at that date.</p>
<section id="forward-start-call-payoff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="forward-start-call-payoff">Forward-Start Call Payoff</h2>
<p>A forward-start call is defined by its maturity date <span class="math inline">\(T'\)</span> and the date <span class="math inline">\(T&lt;T'\)</span> at which the strike price is set. The value of a forward-start call at maturity is <span class="math display">\[\max(0,S(T')-S(T))\; .\]</span> Let <span class="math display">\[x= \begin{cases} 1 &amp;\text{if $S(T')&gt;S(T)$\;,}\\
                               0 &amp; \text{otherwise\;.}
        \end{cases}
\]</span> Then, the value of the call at maturity can be written as <span class="math display">\[xS(T')-xS(T)\; .\]</span></p>
</section>
<section id="numeraires" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="numeraires">Numeraires</h2>
<ol type="1">
<li><p>Use <span class="math inline">\(V(t)=\E^{qt}S(t)\)</span> as numeraire to price the payoff <span class="math inline">\(xS(T')\)</span>. From the fundamental pricing formula <a href="#formula" data-reference-type="eqref" data-reference="formula">[formula]</a>, the value at date 0 is <span class="math display">\[\E^{-qT'}S(0)E^V[x] = \E^{-qT'}S(0)\times \text{prob}^V\!(S(T')&gt;S(T))\; .\]</span></p></li>
<li><p>To price the payoff <span class="math inline">\(xS(T)\)</span>, use the following portfolio as numeraire:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> purchase <span class="math inline">\(\E^{-qT}\)</span> shares of the stock at date 0 and reinvest dividends until date <span class="math inline">\(T\)</span>. This will result in the ownership of one share at date <span class="math inline">\(T\)</span>, worth <span class="math inline">\(S(T)\)</span> dollars. At date <span class="math inline">\(T\)</span>, sell the share and invest the proceeds in the risk-free asset and hold this position until date <span class="math inline">\(T'\)</span>. At date <span class="math inline">\(T'\)</span>, the portfolio will be worth <span class="math inline">\(\E^{r(T'-T)}S(T)\)</span>. Let <span class="math inline">\(Z(t)\)</span> denote the value of this portfolio for each <span class="math inline">\(0\leq t\leq T'\)</span>. The fundamental pricing formula <a href="#formula" data-reference-type="eqref" data-reference="formula">[formula]</a> implies that the value of receiving <span class="math inline">\(xS(T)\)</span> at date <span class="math inline">\(T'\)</span> is <span class="math display">\[\begin{aligned}
Z(0)E^Z\left[ \frac{xS(T)}{Z(T')}\right] &amp;=
\E^{-qT}S(0)E^Z\left[ \frac{xS(T)}{\E^{r(T'-T)}S(T)}\right]\\&amp;= \E^{-qT-r(T'-T)}S(0)E^Z[x] \\&amp;= \E^{-qT-r(T'-T)}S(0) \times\text{prob}^Z(S(T')&gt;S(T))\;.
\end{aligned}\]</span></p></li>
</ol>
</section>
<section id="calculating-probabilities" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="calculating-probabilities">Calculating Probabilities</h2>
<ol type="1">
<li><p>As in the case of a share digital, we know that <span class="math display">\[\log S(t) = \log S(0) + \left(r-q +\frac{1}{2}\sigma^2\right)t + \sigma B^*(t)\]</span> for all <span class="math inline">\(t&gt;0\)</span>, where <span class="math inline">\(B^*\)</span> is a Brownian motion when <span class="math inline">\(V\)</span> is used as the numeraire. Taking <span class="math inline">\(t=T'\)</span> and <span class="math inline">\(t=T\)</span> and subtracting yields <span class="math display">\[\log S(T')-\log S(T) = \left(r-q +\frac{1}{2}\sigma^2\right)(T'-T) + \sigma \left[B^*(T')-B^*(T)\right]\; .\]</span> Hence, <span class="math inline">\(S(T')&gt;S(T)\)</span> if and only if <span class="math display">\[-\frac{B^*(T')-B^*(T)}{\sqrt{T'-T}} &lt; \frac{\left(r-q +\frac{1}{2}\sigma^2\right)(T'-T)}{\sigma\sqrt{T'-T}}\; .\]</span> The random variable on the left hand side is a standard normal, so <span class="math display">\[ \text{prob}^V\!(S(T')&gt;S(T)) = \N(d_1)\; ,\]</span> where \begin{subequations} <span class="math display">\[\begin{equation}\label{forwardstart_d1}
d_1 = \frac{\left(r-q +\frac{1}{2}\sigma^2\right)(T'-T)}{\sigma\sqrt{T'-T}} =\frac{\left(r-q +\frac{1}{2}\sigma^2\right)\sqrt{T'-T}}{\sigma}\;.
\end{equation}\]</span></p></li>
<li><p>To calculate the probability <span class="math inline">\(\text{prob}^Z(S(T')&gt;S(T))\)</span>, note that between <span class="math inline">\(T\)</span> and <span class="math inline">\(T'\)</span>, the portfolio with price <span class="math inline">\(Z\)</span> earns the risk-free rate <span class="math inline">\(r\)</span>. The same argument presented in Sect.~<span class="math inline">\(\ref{s_girsanov}\)</span> shows that between <span class="math inline">\(T\)</span> and <span class="math inline">\(T'\)</span> we have <span class="math display">\[\frac{\D S}{S} = (r-q)\,\D t + \sigma\,\D B^*\; ,\]</span> where now <span class="math inline">\(B^*\)</span> denotes a Brownian motion when <span class="math inline">\(Z\)</span> is used as the numeraire. This implies as usual that <span class="math display">\[ \D\log S = \left(r-q-\frac{1}{2}\sigma^2\right)\,\D t + \sigma\,\D B^*\; ,\]</span> which means that <span class="math display">\[\log S(T') - \log S(T) = \left(r-q-\frac{1}{2}\sigma^2\right)(T'-T) + \sigma(B^*(T')-B^*(T))\; .\]</span> Hence, <span class="math inline">\(S(T')&gt;S(T)\)</span> if and only if <span class="math display">\[-\frac{B^*(T')-B^*(T)}{\sqrt{T'-T}} &lt; \frac{\left(r-q -\frac{1}{2}\sigma^2\right)(T'-T)}{\sigma\sqrt{T'-T}}\; .\]</span> As before, the random variable on the left hand side is a standard normal, so <span class="math display">\[\text{prob}^Z(S(T')&gt;S(T)) = \N(d_2)\; ,\]</span> where <span class="math display">\[\begin{equation}\label{forwardstart_d2}
d_2 = \frac{\left(r-q -\frac{1}{2}\sigma^2\right)\sqrt{T'-T}}{\sigma}=d_1-\sigma\sqrt{T'-T}\;.
\end{equation}\]</span>\end{subequations}</p></li>
</ol>
</section>
<section id="forward-start-call-pricing-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="forward-start-call-pricing-formula">Forward-Start Call Pricing Formula</h2>
<p>Combining these results, we have: </p>
</section>
<section id="put-call-parity" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="put-call-parity">Put-Call Parity</h2>
<p>Forward-strike calls and puts satisfy a somewhat unusual form of put-call parity. The usual put-call parity is of the form: <span class="math display">\[\text{Call} \;+\; \text{Cash} \quad = \quad \text{Put} \;+ \;\text{Underlying}\; .\]</span> The amount of cash is the amount that will accumulate to the exercise price at maturity; i.e., it is <span class="math inline">\(\E^{-rT'}K\)</span>. For forward-start calls and puts, the effective exercise price is <span class="math inline">\(S(T)\)</span>, which is not known at date 0. However, the portfolio used as numeraire to value the second part of the payoff will be worth <span class="math inline">\(\E^{r(T'-T)}S(T)\)</span> at date <span class="math inline">\(T'\)</span>, and by following the same strategy but starting with <span class="math inline">\(\E^{-r(T'-T)-qT}\)</span> instead of <span class="math inline">\(\E^{-qT}\)</span> shares, we will have <span class="math inline">\(S(T)\)</span> dollars at date <span class="math inline">\(T'\)</span>. The date–0 value of this portfolio should replace “Cash” in the above. Thus: </p>
</section>
</section>
<section id="compound-options" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Compound Options</h1>
<p>A compound option is an option on an option, for example a call option on a call option or a call on a put. These options are useful for hedging when there is some uncertainty about the need for hedging which may be resolved by the exercise date of the compound option. As speculative trades, they have the benefit of higher leverage than ordinary options. These options were first discussed by Geske <span class="citation" data-cites="Geske">[@Geske]</span>.</p>
<section id="call-on-a-call-payoff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="call-on-a-call-payoff">Call-on-a-Call Payoff</h2>
<p>Let the underlying call option have exercise price <span class="math inline">\(K'\)</span> and maturity <span class="math inline">\(T'\)</span>. Consider an option maturing at <span class="math inline">\(T&lt;T'\)</span> to purchase the underlying call at price <span class="math inline">\(K\)</span>.</p>
<p>Let <span class="math inline">\(C(t,S)\)</span> denote the value at date <span class="math inline">\(t\)</span> of the underlying call when the stock price is <span class="math inline">\(S\)</span> (i.e., <span class="math inline">\(C\)</span> is the Black-Scholes formula). It is of course rational to exercise the compound call at date <span class="math inline">\(T\)</span> if the value of the underlying call exceeds <span class="math inline">\(K\)</span>; i.e., if <span class="math inline">\(C(T,S(T))&gt;K\)</span>. Let <span class="math inline">\(S^*\)</span> denote the critical price such that <span class="math inline">\(C(T,S^*)=K\)</span>. To calculate <span class="math inline">\(S^*\)</span>, we need to solve <code>Black_Scholes_Call(Sstar,Kprime,r,sigma,q,Tprime-T) = K</code>.</p>
<p>for <span class="math inline">\(S^*\)</span>. We can do this by bisection or one of the other methods mentioned in Sect. <a href="Chapter3.html#s_impliedvolatility" data-reference-type="ref" data-reference="s_impliedvolatility">[s_impliedvolatility]</a>.</p>
<p>It is rational to exercise the compound option when <span class="math inline">\(S(T) &gt; S^*\)</span>.</p>
<p>When <span class="math inline">\(S(T) &gt; S^*\)</span>, exercise of the compound option generates a cash flow of <span class="math inline">\(-K\)</span> at date <span class="math inline">\(T\)</span>. There is a cash flow (of <span class="math inline">\(S(T')-K'\)</span>) at date <span class="math inline">\(T'\)</span> only if the compound call is exercised and the underlying call finishes in the money. This is equivalent to: <span class="math display">\[\begin{equation}\label{compound1}
S(T) &gt; S^* \quad\text{and}\quad S(T')&gt;K'\;.
\end{equation}\]</span> Let <span class="math display">\[\begin{align*}
x&amp;= \begin{cases} 1 &amp;\text{if $S(T)&gt;S^*$\;,}\\
                               0 &amp; \text{otherwise\;,}
        \end{cases}\\
\intertext{and let}
y&amp;= \begin{cases} 1 &amp;\text{if $S(T)&gt;S^*$ and $S(T')&gt;K'$\;,}\\
                               0 &amp; \text{otherwise\;.}
        \end{cases}
\end{align*}\]</span> The cash flows of the compound option are <span class="math inline">\(-xK\)</span> at date <span class="math inline">\(T\)</span> and <span class="math inline">\(yS(T')-yK'\)</span> at date <span class="math inline">\(T'\)</span>. We can value the compound option at date 0 by valuing these separate cash flows.</p>
<p>The cash flow <span class="math inline">\(-xK\)</span> is the cash flow from being short <span class="math inline">\(K\)</span> digital options on the underlying asset with strike price <span class="math inline">\(S^*\)</span> and maturity <span class="math inline">\(T\)</span>. Therefore the value at date 0 of this cash flow is <span class="math inline">\(-\E^{-rT}K\N(d_2)\)</span>, where <span class="math display">\[\begin{equation}\label{calloncalld1d2}
d_1 = \frac{\log\left(\frac{S(0)}{S^*}\right)+\left(r-q+\frac{1}{2}\sigma^2\right)T}{\sigma\sqrt{T}},  \qquad d_2 = d_1-\sigma\sqrt{T}\;.
\end{equation}\]</span></p>
</section>
<section id="numeraires" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="numeraires">Numeraires</h2>
<p>The payoffs <span class="math inline">\(yS(T)\)</span> and <span class="math inline">\(yK'\)</span> are similar to share digitals and digitals, respectively, except that the event <span class="math inline">\(y=1\)</span> is more complex than we have previously encountered. However, we know from the analysis of share digitals and digitals that the values at date 0 of these payoffs are <span class="math display">\[\E^{-q T'}S(0)\times\text{prob}^V\!(y=1) \quad \text{and}\quad \E^{-rT'}K'\times\text{prob}^R(y=1)\; ,\]</span> where <span class="math inline">\(V(t)=\E^{qt}S(t)\)</span> and <span class="math inline">\(R(t)=\E^{rt}\)</span>.</p>
</section>
<section id="calculating-probabilities" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="calculating-probabilities">Calculating Probabilities</h2>
We will calculate the two probabilities in terms of the bivariate normal distribution function.<br>

</section>
<section id="american-call-pricing-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="american-call-pricing-formula">American Call Pricing Formula</h2>

</section>
</section>
<section id="s_choosers" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Choosers</h1>
<p>A “chooser option” allows the holder to choose whether the option will be a put or call at some fixed date before the option maturity. Let <span class="math inline">\(T\)</span> denote the date at which the choice is made, <span class="math inline">\(T_c\)</span> the date at which the call expires, <span class="math inline">\(T_p\)</span> the date at which the put expires, <span class="math inline">\(K_c\)</span> the exercise price of the call, and <span class="math inline">\(K_p\)</span> the exercise price of the put, where <span class="math inline">\(0&lt;T&lt;T_c\)</span> and <span class="math inline">\(0&lt;T&lt;T_p\)</span>. A “simple chooser” has <span class="math inline">\(T_c=T_p\)</span> and <span class="math inline">\(K_c=K_p\)</span>. A chooser is similar in spirit to a straddle: it is a bet on volatility without making a bet on direction. A simple chooser must be cheaper than a straddle with the same exercise price and maturity <span class="math inline">\(T'=T_c=T_p\)</span>, because a straddle is always in the money at maturity, whereas a simple chooser has the same value as the straddle if it is in the money but is only in the money at <span class="math inline">\(T'\)</span> when the choice made at <span class="math inline">\(T\)</span> turns out to have been the best one.</p>
<section id="chooser-payoff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="chooser-payoff">Chooser Payoff</h2>
The value of the chooser at date <span class="math inline">\(T\)</span> will be the larger of the call and put prices. Let <span class="math inline">\(S^*\)</span> denote the stock price at which the call and put have the same value. We can find <span class="math inline">\(S^*\)</span> by solving
<p>For a simple chooser with <span class="math inline">\(K_c=K_p=K\)</span> and <span class="math inline">\(T_c=T_p=T'\)</span>, we can find <span class="math inline">\(S^*\)</span> from the put-call parity relation at <span class="math inline">\(T\)</span>, leading to <span class="math inline">\(S^*=\E^{(q-r)(T'-T)}K.\)</span></p>
<p>The call will be chosen when <span class="math inline">\(S(T)&gt;S^*\)</span> and it finishes in the money if <span class="math inline">\(S(T_c)&gt;K_c\)</span> at date <span class="math inline">\(T_c\)</span>, so the payoff of the chooser is <span class="math inline">\(S(T_c)-K_c\)</span> when <span class="math display">\[S(T)&gt;S^* \quad \text{and}\quad S(T_c)&gt;K_c\;.
\]</span> The payoff is <span class="math inline">\(K_p-S(T_p)\)</span> at date <span class="math inline">\(T_p\)</span> when <span class="math display">\[
S(T)&lt;S^* \quad \text{and}\quad S(T_p)&lt;K_p\;.
\]</span> Let <span class="math display">\[\begin{align*}
x&amp;= \begin{cases} 1 &amp;\text{if $S(T)&gt;S^* $ and $S(T_c)&gt;K_c$\;,}\\
                               0 &amp; \text{otherwise\;.}
        \end{cases}\\
\intertext{Likewise, let}
y&amp;= \begin{cases} 1 &amp;\text{if $S(T)&lt;S^*$ and $S(T_p)&lt;K_p$\;,}\\
                               0 &amp; \text{otherwise\;.}
        \end{cases}
\end{align*}\]</span> Then the payoff of the chooser is <span class="math inline">\(xS(T_c)-xK_c\)</span> at date <span class="math inline">\(T_c\)</span> and <span class="math inline">\(yK_p-yS(T_p)\)</span> at date <span class="math inline">\(T_p\)</span>.</p>
</section>
<section id="numeraires" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="numeraires">Numeraires</h2>
<p>As in the analysis of compound options, the value of the chooser at date 0 must be <span class="math display">\[\begin{multline}
\E^{-q T_c}S(0)\times\text{prob}^V\!(x=1) \;- \;\E^{-rT_c}K_c\times\text{prob}^R(x=1)
\\+\; \E^{-rT_p}K_p\times\text{prob}^R(y=1) \;- \;\E^{-q T_p}S(0)\times\text{prob}^V\!(y=1)\;,\label{chooser1}
\end{multline}\]</span> where we use <span class="math inline">\(V(t)=\E^{qt}S(t)\)</span> and <span class="math inline">\(R(t)=\E^{rt}\)</span> as numeraires.</p>
</section>
<section id="chooser-pricing-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="chooser-pricing-formula">Chooser Pricing Formula</h2>
<p>Equation <a href="#chooser1" data-reference-type="eqref" data-reference="chooser1">[chooser1]</a> and calculations similar to those of the previous two sections lead us to:</p>
</section>
</section>
<section id="options-on-the-max-or-min" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Options on the Max or Min</h1>
<p>We will consider here an option written on the maximum or minimum of two asset prices; for example, a call on the maximum pays <span class="math display">\[\max(0,\max(S_1(T), S_2(T))-K) = \max(0,S_1(T)-K,S_2(T)-K)\]</span> at maturity <span class="math inline">\(T\)</span>. There are also call options on <span class="math inline">\(\min(S_1(T), S_2(T))\)</span> and put options on the maximum and minimum of two (or more) asset prices. Pricing formulas for these options are due to Stulz , who also discusses applications. We will assume the two assets have constant dividend yields <span class="math inline">\(q_i\)</span>, constant volatilities <span class="math inline">\(\sigma_i\)</span>, and a constant correlation <span class="math inline">\(\rho\)</span>.</p>
<section id="call-on-the-max-payoff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="call-on-the-max-payoff">Call-on-the-Max Payoff</h2>
<p>To value the above option, define the random variables: <span class="math display">\[\begin{align*}
x&amp;= \begin{cases} 1 &amp; \text{if $S_1(T)&gt;S_2(T)$ and $S_1(T)&gt;K$}\; ,\\
0 &amp; \text{otherwise}\;, \end{cases}\\
y&amp;= \begin{cases} 1 &amp; \text{if $S_2(T)&gt; S_1(T)$ and $S_2(T)&gt;K$}\; ,\\
0 &amp; \text{otherwise}\;, \end{cases}\\
z&amp;= \begin{cases} 1 &amp; \text{if $S_1(T) &gt; K$ or $S_2(T)&gt; K$}\; ,\\
0 &amp; \text{otherwise}\;. \end{cases}
\end{align*}\]</span> Then the value of the option at maturity is <span class="math display">\[xS_1(T) + yS_2(T) - zK\; .\]</span></p>
</section>
<section id="numeraires" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="numeraires">Numeraires</h2>
<p>Consider numeraires <span class="math inline">\(V_1(t) = \E^{q_1t}S_1(t)\)</span>, <span class="math inline">\(V_2(t)=\E^{q_2t}S_2(t)\)</span>, and <span class="math inline">\(R(t)=\E^{rt}\)</span>. By familiar arguments, the value of the option at date 0 is <span class="math display">\[\begin{multline*}
\E^{-q_1T}S_1(0)\times\text{prob}^{V_1}(x=1) + \E^{-q_2T}S_2(0)\times\text{prob}^{V_2}(y=1) \\- \E^{-rT}K\times\text{prob}^R(z=1)\; .
\end{multline*}\]</span></p>
</section>
<section id="calculating-probabilities" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="calculating-probabilities">Calculating Probabilities</h2>

</section>
<section id="down-and-out-call-pricing-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="down-and-out-call-pricing-formula">Down-and-Out Call Pricing Formula</h2>

</section>
</section>
<section id="s_lookbacks" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Lookbacks</h1>
<p> A “floating-strike lookback call” pays the difference between the asset price at maturity and the minimum price realized during the life of the contract. A “floating-strike lookback put” pays the difference between the maximum price over the life of the contract and the price at maturity. Thus, the floating-strike lookback call allows one to buy the asset at its minimum price, and the floating-strike lookback put allows one to sell the asset at its maximum price. Of course, one pays upfront for this opportunity to time the market. These options were first discussed by Goldman, Sosin and Gatto <span class="citation" data-cites="GSG">[@GSG]</span>.</p>
<p>A “fixed-strike lookback put” pays the difference between a fixed strike price and the minimum price during the lifetime of the contract. Thus, a fixed-strike lookback put and a floating-strike lookback call are similar in one respect: both enable one to buy the asset at its minimum price. However, the put allows one to sell the asset at a fixed price whereas the call allows one to sell it at the terminal asset price. A “fixed-strike lookback call” pays the difference between the maximum price and a fixed strike price and is similar to a floating-strike lookback put in the sense that both enable one to sell the asset at its maximum price. Fixed-strike lookback options were first discussed by Conze and Viswanathan <span class="citation" data-cites="CV">[@CV]</span>. We will discuss the valuation of floating-strike lookback calls. As in the discussion of barrier options, we will assume that the price is continuously sampled for the purpose of computing the minimum.</p>
<section id="floating-strike-lookback-call-payoff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="floating-strike-lookback-call-payoff">Floating-Strike Lookback Call Payoff</h2>
<p>As in the previous section, let <span class="math inline">\(z\)</span> denote the minimum stock price realized over the <em>remaining lifetime of the contract</em>. This is not necessarily the minimum stock price realized during the entire lifetime of the contract. Let <span class="math inline">\(S_{\min}\)</span> denote the minimum stock price realized during the lifetime of the contract up to and including date 0, which is the date at which we are valuing the contract. The minimum stock price during the <em>entire lifetime of the contract</em> will be the smaller of <span class="math inline">\(z\)</span> and <span class="math inline">\(S_{\text{min}}\)</span>. The payoff of the floating strike lookback call is <span class="math inline">\(S(T) - \min\left(z, S_{\text{min}}\right)\)</span>.</p>
</section>
<section id="calculations" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="calculations">Calculations</h2>
<p>The value at date 0 of the piece <span class="math inline">\(S(T)\)</span> is simply <span class="math inline">\(\E^{-qT}S(0)\)</span>. Using the result in Appendix <a href="#a_minimum" data-reference-type="ref" data-reference="a_minimum">[a_minimum]</a> on the distribution of <span class="math inline">\(z\)</span>, it can be shown (see, e.g., Musiela and Rutkowski <span class="citation" data-cites="MR">[@MR]</span> for the details) that the value at date 0 of receiving <span class="math display">\[\min(z, S_{\text{min}})\]</span> at date <span class="math inline">\(T\)</span> is <span class="math display">\[\begin{multline*}
\E^{-rT}S_{\text{min}}\N(d_2) -\frac{\sigma^2}{2(r-q)}\left(\frac{S_{\text{min}}}{S(0)}\right)^{2(r-q)/\sigma^2}\E^{-rT}S(0)\N(d_2') \\
+\left(1+ \frac{\sigma^2}{2(r-q)}\right)\E^{-qT}S(0)\N(-d_1)\;.
\end{multline*}\]</span> where Using the fact that <span class="math inline">\([1-\N(-d_1)]\E^{-qT}S(0)=\E^{-qT}S(0)\N(d_1)\)</span>, this implies:</p>
</section>
<section id="floating-strike-lookback-call-pricing-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="floating-strike-lookback-call-pricing-formula">Floating-Strike Lookback Call Pricing Formula</h2>

</section>
</section>
<section id="s_baskets" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Basket and Spread Options</h1>
<p>A “spread option” is a call or a put written on the difference of two asset prices. For example, a spread call will pay at maturity <span class="math inline">\(T\)</span> the larger of zero and <span class="math inline">\(S_1(T)-S_2(T)-K\)</span>, where the <span class="math inline">\(S_i\)</span> are the asset prices and <span class="math inline">\(K\)</span> is the strike price of the call. Spread options can be used by producers to hedge the difference between an input price and an output price. They are also useful for hedging basis risk. For example, someone may want to hedge an asset by selling a futures contract on a closely related but not identical asset. This exposes the hedger to basis risk: the difference in value between the asset and the underlying asset on the futures contract. A spread call can hedge the basis risk: take <span class="math inline">\(S_1\)</span> to be the value of the asset underlying the futures contract and <span class="math inline">\(S_2\)</span> the value of the asset being hedged.</p>
<p>A spread option is actually an exchange option. Assuming constant dividend yields <span class="math inline">\(q_1\)</span> and <span class="math inline">\(q_2\)</span>, we can take the assets underlying the exchange option to be as follows</p>
<ol type="1">
<li>At date 0, purchase <span class="math inline">\(\E^{-q_1T}\)</span> units of the asset with price <span class="math inline">\(S_1\)</span> and reinvest dividends, leading to a value of <span class="math inline">\(S_1(T)\)</span> at date <span class="math inline">\(T\)</span>,</li>
<li>At date 0, purchase <span class="math inline">\(\E^{-q_2T}\)</span> units of the asset with price <span class="math inline">\(S_2\)</span> and invest <span class="math inline">\(\E^{-rT}K\)</span> in the risk-free asset. Reinvesting dividends and accumulating interest means that we will have <span class="math inline">\(S_2(T)+K\)</span> dollars at date <span class="math inline">\(T\)</span>.</li>
</ol>
<p>However, we cannot apply Margrabe’s formula to price spread options, because the second portfolio described above will have a stochastic volatility. To see this, note that if the price <span class="math inline">\(S_2(t)\)</span> falls to a low level, then the portfolio will consist primarily of the risk-free asset, so the portfolio volatility will be near the volatility of the risk-free asset, which is zero. On the other hand, if <span class="math inline">\(S_2(t)\)</span> becomes very high, then the portfolio will be weighted very heavily on the stock investment, and its volatility will approach the volatility of <span class="math inline">\(S_2\)</span>.</p>
<p>A “basket option” is an option written on a portfolio of assets. For example, someone may want to hedge the change in the value of the dollar relative to a basket of currencies. A basket option is an alternative to purchasing separate options on each currency. Generally, the basket option would have a lower premium than the separate options, because an option on a portfolio is cheaper (and pays less at maturity) than a portfolio of options.</p>
<p>Letting <span class="math inline">\(S_1\)</span>, , <span class="math inline">\(S_n\)</span> denote the asset prices and <span class="math inline">\(w_1\)</span>, , <span class="math inline">\(w_n\)</span> the weights specified by the contract, a basket call would pay <span class="math display">\[\max\left(0,\;\sum_{i=1}^n w_iS_i(T) - K\right)\]</span> at maturity <span class="math inline">\(T\)</span>. A spread option is actually a special case of a basket option, with <span class="math inline">\(n=2\)</span>, <span class="math inline">\(w_1=1\)</span>, and <span class="math inline">\(w_2=-1\)</span>. The difficulty in valuing basket options is the same as that encountered in valuing spread options. The volatility of the basket price <span class="math inline">\(\sum_{i=1}^nw_iS_i(t)\)</span> will vary over time, depending on the relative volatilities of the assets and the price changes in the assets. For example, consider the case <span class="math inline">\(n=2\)</span> and write <span class="math inline">\(S(t)\)</span> for the basket price <span class="math inline">\(w_1S_1(t)+w_2S_2(t)\)</span>. Then <span class="math display">\[\begin{align*}
\frac{\D S}{S} &amp;= \frac{w_1\,\D S_1}{S} + \frac{w_2\,\D S_2}{S}\\
&amp;=\frac{w_1S_1}{S}\times \frac{\D S_1}{S_1} + \frac{w_2S_2}{S}\times \frac{\D S_2}{S_2}\;.
\end{align*}\]</span> Let <span class="math inline">\(x_i(t)=w_iS_i(t)/S(t)\)</span>. This is the fraction of the portfolio value that the <span class="math inline">\(i\)</span>–th asset contributes. It will vary randomly over time as the prices change. Letting <span class="math inline">\(\sigma_i\)</span> denote the volatilities of the individual assets and <span class="math inline">\(\rho\)</span> their correlation, the formula just given for <span class="math inline">\(\D S/S\)</span> shows that the instantaneous volatility of the basket price at any date <span class="math inline">\(t\)</span> is <span class="math display">\[\sqrt{x_1^2(t)\sigma_1^2 + 2x_1(t)x_2(t)\rho\sigma_1\sigma_2 + x_2^2(t)\sigma_2^2}\; .\]</span> Hence, the volatility will vary randomly over time as the <span class="math inline">\(x_i\)</span> change. As in the case of spread options, there is no simple closed-form solution for the value of a basket option.</p>
</section>
<section id="s_asians" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Asian Options</h1>
<p>An “Asian option” is an option the value of which depends on the average underlying asset price during the lifetime of the option. “Average-price” calls and puts are defined like standard calls and puts but with the final asset price replaced by the average price. “Average-strike” calls and puts are defined like standard calls and puts but with the exercise price replaced by the average asset price. A firm that must purchase an input at frequent intervals or will sell a product in a foreign currency at frequent intervals can use an average price option as an alternative to buying multiple options with different maturity dates. The average-price option will generally be both less expensive and a better hedge than purchasing multiple options.</p>
<p>In practice, the average price is computed by averaging over the prices sampled at a finite number of discrete dates. First, we consider the case of continuous sampling. With continuous sampling, the average price at date <span class="math inline">\(T\)</span> for an option written at date 0 will be denoted by <span class="math inline">\(A(T)\)</span> and is defined as <span class="math display">\[A(T) = \frac{1}{T}\int_0^T S(t)\,\D t\; .\]</span> To obtain a closed-form solution for the value of an option on the average price, we face essentially the same problem as for basket and spread options: a sum of lognormally distributed variables is not itself lognormally distributed. In this case, the integral, which is essentially a continuous sum of the prices at different dates, is not lognormally distributed.</p>
<p>An alternative contract would replace the average price with the “geometric average.” This is defined as the exponential of the average logarithm. We will denote this by <span class="math inline">\(A_\text{g}(T)\)</span>. The average logarithm is <span class="math display">\[\frac{1}{T}\int_0^T \log S(t)\,\D t\; ,\]</span> and the geometric average is <span class="math display">\[A_\text{g}(T) = \exp\left(\frac{1}{T}\int_0^T \log S(t)\,\D t\right)\; .\]</span> The concavity of the logarithm function guarantees that <span class="math display">\[\log \frac{1}{T}\int_0^T S(t) &gt; \frac{1}{T}\int_0^T \log S(t)\,\D t \; .\]</span> Therefore, <span class="math display">\[\begin{align*}
A(T) &amp;= \exp\left(\log \frac{1}{T}\int_0^T S(t)\right)\\
&amp;&gt; \exp\left(\frac{1}{T}\int_0^T \log S(t)\,\D t\right) \\
&amp;= A_\text{g}(T)\; .
\end{align*}\]</span> Consequently, approximating the value of an average-price or average-strike option by substituting <span class="math inline">\(A_\text{g}(T)\)</span> for <span class="math inline">\(A(T)\)</span> will produce a biased estimate of the value. Nevertheless, the geometric average<span class="math inline">\(A_\text{g}(T)\)</span> and the arithmetic average <span class="math inline">\(A(T)\)</span> will be highly correlated, so <span class="math inline">\(A_\text{g}(T)\)</span> forms a very useful for Monte-Carlo valuation of average-price and average-strike options, as will be discussed in Chap.~<span class="math inline">\(\ref{c_montecarlo}\)</span>. To implement the idea, we need a valuation formula for options written on <span class="math inline">\(A_\text{g}(T)\)</span>. We will derive this for an average-price call, in which <span class="math inline">\(A_\text{g}(T)\)</span> substitutes for <span class="math inline">\(A(T)\)</span>.</p>
<p>Specifically, consider a contract that pays <span class="math display">\[\max(0,A_\text{g}(T)-K)\]</span> at its maturity <span class="math inline">\(T\)</span>. This is a “geometric-average-price call,”, and we will analyze it in the same way that we analyzed quanto options in Chap. <a href="Chapter6.html" data-reference-type="ref" data-reference="c_foreignexchange">[c_foreignexchange]</a>. Let <span class="math inline">\(V(t)\)</span> denote the value at date <span class="math inline">\(t\)</span> of receiving <span class="math inline">\(A_\text{g}(T)\)</span> at date <span class="math inline">\(T\)</span>. This can be calculated, and the result will be given below. <span class="math inline">\(V(t)\)</span> is the value of a non-dividend-paying portfolio, and, by definition, <span class="math inline">\(V(T)=A_\text{g}(T)\)</span>, so the geometric-average-price call is equivalent to a standard call with <span class="math inline">\(V\)</span> being the price of the underlying. We will show that <span class="math inline">\(V\)</span> has a time-varying but non-random volatility. Therefore, we can apply the Black-Scholes formula, inputting the average volatility as described in Sect. <a href="Chapter3.html#s_timevaryingvolatility" data-reference-type="ref" data-reference="s_timevaryingvolatility">[s_timevaryingvolatility]</a>, to value the geometric-average-price call. We could attempt the same route to price average-price options, but we would find that the volatility of the corresponding value <span class="math inline">\(V\)</span> would vary randomly, just as we found the basket portfolio to have a random volatility in the previous section.</p>
<p>The value <span class="math inline">\(V(t)\)</span> can be calculated as <span class="math display">\[V(t)= \E^{-r(T-t)}E^R_t\big[A_\text{g}(T)\big]\; .\]</span> Define <span class="math display">\[A_g(t) = \exp\left(\frac{1}{t}\int_0^t \log S(u)\,du\right)\; .\]</span> We will verify at the end of this section that <span class="math display">\[\begin{equation}\label{geometricaveragev1}
V(t) = \E^{-r(T-t)}A_g(t)^{\frac{t}{T}}S(t)^{\frac{T-t}{T}}\exp\left(\frac{(r-q-\sigma^2/2)(T-t)^2}{2T} + \frac{\sigma^2(T-t)^3}{6T^2}\right)\;.
\end{equation}\]</span> Two points are noteworthy. First, the value at date 0 is <span class="math display">\[\begin{align}
V(0) &amp;= \E^{-rT}S(0)\exp\left(\frac{(r-q-\sigma^2/2)T}{2} + \frac{\sigma^2T}{6}\right)\notag\\
&amp;=\exp\left(-\frac{6r+6q + \sigma^2}{12}T\right)S(0)\;.\label{asianV0}
\end{align}\]</span> Second, the volatility comes from the factor <span class="math display">\[S(t)^{\frac{T-t}{T}}\; ,\]</span> and, by Itô’s formula, <span class="math display">\[\frac{ \D S^{\frac{T-t}{T}}}{S^{\frac{T-t}{T}}} = \text{something}\,\,\D t + \left(\frac{T-t}{T}\right)\sigma\,\D B\; .\]</span> This implies that the average volatility, in the sense of Sect.~<span class="math inline">\(\ref{s_timevaryingvolatility}\)</span>, is <span class="math display">\[\sigma_{\text{avg}} = \sqrt{\frac{1}{T}\int_0^T \left(\frac{T-t}{T}\right)^2\sigma^2\,\D t}
=\frac{\sigma}{\sqrt{3}}\; .\]</span> Applying the Black-Scholes formula yields: </p>
<p>We can also value a discretely-sampled geometric-average-price call by the same arguments. Consider dates <span class="math inline">\(0&lt;t_0&lt; t_1 &lt; \cdots t_N=T\)</span>, where <span class="math inline">\(t_i-t_{i-1}=\varDelta t\)</span> for each <span class="math inline">\(i\)</span> and suppose the price is to be sampled at the dates <span class="math inline">\(t_1,\ldots,t_N\)</span>. Now let <span class="math inline">\(V(t)\)</span> denote the value at date <span class="math inline">\(t\)</span> of the contract that pays <span class="math display">\[\begin{equation}\label{geometricaveragev0}
\exp\left(\frac{1}{N} \sum_{i=1}^N \log S(t_i)\right) = \left(\prod_{i=1}^N S(t_i)\right)^{1/N}
\end{equation}\]</span> at date <span class="math inline">\(T\)</span>. The call option will pay <span class="math inline">\(\max(0,V(T)-K)\)</span> at date <span class="math inline">\(T\)</span>. Let <span class="math inline">\(k\)</span> denote the integer such that <span class="math inline">\(t_{N-k-1} \leq t &lt; t_{N-k}\)</span>. This means that we have already observed the prices <span class="math inline">\(S(t_1), \ldots, S(t_{N-k-1})\)</span> and we have yet to observe the <span class="math inline">\(k+1\)</span> prices <span class="math inline">\(S(t_{N-k}), \ldots ,S(t_N)\)</span>. Define <span class="math inline">\(\varepsilon = (t_{N\!-k}-t)/\varDelta t\)</span>, which is fraction of the interval <span class="math inline">\(\varDelta t\)</span> that must pass before we reach the next sampling date <span class="math inline">\(t_{N\!-k}\)</span>. We will show at the end of this section that <span class="math display">\[\begin{multline}\label{geometricaveragev2}
V(t) = \E^{-r(T-t)}S(t)^{\frac{k+1}{N}}\prod_{i=1}^{N-k-1}S(t_i)^{\frac{1}{N}}\\
\times\,\exp\left(\left[ \frac{(k+1)\varepsilon\nu}{N}\!+\! \frac{k(k+1)\nu}{2N}\! +\! \frac{(k+1)^2\sigma^2\varepsilon}{2N^2}\!+\!\frac{k(k+1)(2k+1)\sigma^2}{12N^2} \right]\varDelta t\right)\;,
\end{multline}\]</span> where <span class="math inline">\(\nu = r-q-\sigma^2/2\)</span></p>
<p>Again, two points are noteworthy. Assume the call was written at date 0 and the first observation date <span class="math inline">\(t_1\)</span> is <span class="math inline">\(\varDelta t\)</span> years away. Then, we have <span class="math inline">\(k+1=N\)</span> and <span class="math inline">\(\varepsilon=1\)</span> so <span class="math display">\[\begin{equation}\label{asianV02}
V(0) = \E^{-rT}S(0)\exp\left( \frac{(N+1)\nu\varDelta t}{2} + \frac{(N+1)(2N+1)\sigma^2\varDelta t}{12N} \right)\;.
\end{equation}\]</span> Second, the volatility of <span class="math inline">\(V(t)\)</span> comes from the factor <span class="math inline">\(S(t)^{(k+1)/N}\)</span>, and <span class="math display">\[\frac{ \D S^{\frac{k+1}{N}}}{S^{\frac{k+1}{N}}} = \text{something}\,\,\D t + \left(\frac{k+1}{N}\right)\sigma\,\D B\; .\]</span> This implies that the average volatility, in the sense of Sect.~<span class="math inline">\(\ref{s_timevaryingvolatility}\)</span>, is <span class="math display">\[\begin{align}
\sigma_{\text{avg}} &amp;= \sqrt{\frac{1}{N}\sum_{k=0}^{N-1} \left(\frac{k+1}{N}\right)^2\sigma^2\,\D t}\notag\\
&amp;=\frac{\sigma}{N^{3/2}}\sqrt{\frac{N(N+1)(2N+1)}{6}}\;,\label{asiansigmaavg}
\end{align}\]</span> where we have used the fact that <span class="math inline">\(\sum_{i=1}^N i^2 = N(N+1)(2N+1)/6\)</span> to obtain the second equality. Thus, the Black-Scholes formula implies: This formula will be used in Sect.~<span class="math inline">\(\ref{s_controlvariates}\)</span> as a control variate for pricing discretely-sampled average-price calls (even average-price calls that were written before the date of valuation).</p>
</section>
<section id="s_exotics_matlab" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Calculations in VBA</h1>
<p>The new features in the option pricing formulas in this chapter are the use of the bivariate normal distribution function and sometimes the need to compute a critical (at-the-money) value of the underlying asset price. We will compute the critical values by bisection, in the same way that we computed implied volatilities for the Black-Scholes formula in Chap. <a href="Chapter3.html" data-reference-type="ref" data-reference="c_blackscholes">[c_blackscholes]</a>.</p>
<section id="bivariate-normal-distribution-function" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bivariate-normal-distribution-function">Bivariate Normal Distribution Function</h2>
<p>The following is a fast approximation of the bivariate cumulative normal distribution function, accurate to six decimal places, due to Drezner <span class="citation" data-cites="Drezner">[@Drezner]</span>). For given numbers <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, this function gives the probability that <span class="math inline">\(\xi_1&lt;a\)</span> and <span class="math inline">\(\xi_2&lt;b\)</span> where <span class="math inline">\(\xi_1\)</span> and <span class="math inline">\(\xi_2\)</span> are standard normal random variables with a given correlation <span class="math inline">\(\rho\)</span>, which we must input.</p>

<p>Notice that this function calls itself. This is an example of ``recursion.’’</p>
</section>
<section id="forward-start-call" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="forward-start-call">Forward-Start Call</h2>
<p>The forward-start call pricing formula is of the same form as the Black-Scholes, Margrabe, Black, and Merton formulas, as discussed in Sect. <a href="Chapter7.html#s_matlabimplementations" data-reference-type="ref" data-reference="s_matlabimplementations">[s_matlabimplementations]</a>. We can compute it with our <code>Generic_Option</code> pricing function.</p>

</section>
<section id="call-on-a-call" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="call-on-a-call">Call on a Call</h2>
<p>We will use bisection to find the critical price <span class="math inline">\(S^*\)</span>. We can use <span class="math inline">\(e^{q(T'-T)}(K+K')\)</span> as an upper bound for <span class="math inline">\(S^*\)</span> and 0 as a lower bound.<br>
The following uses <span class="math inline">\(10^{-6}\)</span> as the error tolerance in the bisection.</p>

</section>
<section id="call-on-a-put" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="call-on-a-put">Call on a Put</h2>
<p>The implementation of the call-on-a-put formula is of course very similar to that of a call-on-a-call. One difference is that there is no obvious upper bound for <span class="math inline">\(S^*\)</span>, so we start with <span class="math inline">\(2K'\)</span> (= <code>2*K2</code>) and double this until the value of the put is below <span class="math inline">\(K\)</span>. We can take 0 again to be the lower bound. Recall that we assume <span class="math inline">\(K&lt;\E^{-r(T'-T)}K'\)</span> and the right-hand side of this is the value of the put at date <span class="math inline">\(T\)</span> when <span class="math inline">\(S(T)=0\)</span>.</p>

</section>
<section id="american-calls-with-discrete-dividends" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="american-calls-with-discrete-dividends">American Calls with Discrete Dividends</h2>
To value an American call when there is one dividend payment before the option matures, we input the initial asset price <span class="math inline">\(S(0)\)</span> and then compute <span class="math inline">\(Z(0)=X(0)-\E^{-rT}D\)</span>. If <span class="math inline">\(D-K \leq -\E^{-r(T'-T)}K\)</span>, we return the Black-Scholes value of a European call written on <span class="math inline">\(Z\)</span>. Otherwise, we need to compute <span class="math inline">\(Z^*\)</span> and our bisection algorithm requires an upper bound for <span class="math inline">\(Z^*\)</span>, which would be any value of <span class="math inline">\(Z(T)\)</span> such that exercise at <span class="math inline">\(T\)</span> is optimal. It is not obvious what this should be, so we start with <span class="math inline">\(K\)</span> and keep doubling this until we obtain a value of <span class="math inline">\(Z(T)\)</span> at which exercise would be optimal. Then, we use the bisection algorithm to compute <span class="math inline">\(Z^*\)</span> and finally compute the option value <a href="#americancall" data-reference-type="eqref" data-reference="americancall">[americancall]</a>.

</section>
<section id="choosers" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="choosers">Choosers</h2>
To implement the bisection to compute <span class="math inline">\(S^*\)</span>, we can take zero as a lower bound and <span class="math inline">\(K_c+K_p\)</span> as an upper bound.



</section>
<section id="floating-strike-lookbacks" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="floating-strike-lookbacks">Floating-Strike Lookbacks</h2>

</section>
<section id="discretely-sampled-geometric-average-price-calls" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="discretely-sampled-geometric-average-price-calls">Discretely-Sampled Geometric-Average-Price Calls</h2>

</section>
</section>
<section id="problems" class="level1 unnumbered">
<h1 class="unnumbered">Problems</h1>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We are going to use equation <a href="#probSnumeraire" data-reference-type="eqref" data-reference="probSnumeraire">[probSnumeraire]</a> at date <span class="math inline">\(T'\)</span> to define the probabilities, because it will not be known until date <span class="math inline">\(T'\)</span> whether the event <span class="math inline">\(S(T')&gt;S(T)\)</span> is true. Thus, we need the price of a numeraire asset at date <span class="math inline">\(T'\)</span>. We would like this price to be a constant times <span class="math inline">\(S(T)\)</span>, which is what we will obtain. An equivalent numeraire is to make a smaller investment in the same portfolio: start with <span class="math inline">\(\E^{-r(T'-T)-qT}\)</span> shares. This results in a final value of <span class="math inline">\(S(T)\)</span> at date <span class="math inline">\(T'\)</span>. As will be seen, this is useful for deriving the put-call parity relation for forward-start options.<span id="forwardstartnote" label="forwardstartnote"></span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter9.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Monte Carlo and Binomial Valuation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>