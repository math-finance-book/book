<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Brownian Motion and Ito Calculus – Pricing and Hedging Derivative Securities: Theory and Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter_BlackScholes.html" rel="next">
<link href="./Chapter_Arbitrage.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bb6b93f51bf5a7975605005bd985cc1c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_Intro.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./Chapter_Ito.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Brownian Motion and Ito Calculus</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pricing and Hedging Derivative Securities: Theory and Methods</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Options</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Arbitrage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Arbitrage Pricing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Ito.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Brownian Motion and Ito Calculus</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Black-Scholes and Extensions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_BlackScholes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FX.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Merton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Merton, Black, and Margrabe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Exotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exotic Options</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Stochastic Volatility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Vol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Stochastic Volatility</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Numerical Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_MC_Binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Monte Carlo and Binomial Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FiniteDifferences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fourier Transforms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Fixed Income</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FixedIncome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FixedIncomeDerivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Vasicek.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Miscellaneous Facts about Continuous-Time Models</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_Intro.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./Chapter_Ito.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Brownian Motion and Ito Calculus</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-c_continuoustime" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Brownian Motion and Ito Calculus</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec_f_discrete" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sec_f_discrete"><span class="header-section-number">3.1</span> From Discrete to Continuous Time</h2>
<p>Our main point of departure is knowing how a given quantity evolves through time. For example, <span class="math inline">\(X(t)\)</span> might denote how much wealth you have at time <span class="math inline">\(t\)</span>. Partition the interval <span class="math inline">\([0,T]\)</span> into <span class="math inline">\(N\)</span> intervals of length <span class="math inline">\(\Delta t = \frac{T}{N}\)</span>, in other words <span class="math display">\[[0, \Delta t = \frac{T}{N}, 2 \Delta t, ..., (N-1) \Delta t, N \Delta t =T].\]</span></p>
<p>If you invest your wealth <span class="math inline">\(X((i-1)\Delta t)\)</span> at a fixed rate of interest <span class="math inline">\(r \Delta t\)</span> over a period of length <span class="math inline">\(\Delta t=\frac{T}{N}\)</span>, you will have <span class="math inline">\(X((i-1)\Delta t) (1+ r \Delta t)\)</span> at the end of the period; the change of your wealth from <span class="math inline">\((i-1)\Delta t\)</span> to <span class="math inline">\(t = i\Delta t\)</span> is <span class="math display">\[
\Delta X(t) = X(i \Delta t)-X((i-1) \Delta t)=(1+r \Delta t) X((i-1) \Delta t) - X(t)= r X(t) \Delta t.
\]</span><br>
The limiting form of this equation is <span class="math display">\[
X(t) = r X(t) dt ~~~\text{or} ~~~\frac{d X(t)}{dt} = r X(t)
\]</span></p>
<p>which is a differential equation. Notice this can also be written as a sum</p>
<p><span class="math display">\[X(N \Delta t) =X(0)+ \sum_{i=0}^N (X(i \Delta t)-X((i-1)\Delta t)) = X(0) + \sum_{i=0}^{N} r X((i-1)\Delta t) \Delta t ;
\]</span></p>
<p>in the limit we get an integral equation</p>
<p><span class="math display">\[X(t) = X(0) + \int_0^T r X(t) dt.\]</span></p>
<p>The solution is <span class="math inline">\(X(t) = X(0) e^{r T}\)</span> which is easily verified by taking the derivative <span class="math inline">\(\frac{d}{dt}e^{r t} X(t) = r X(t)\)</span> or by inserting the solution into the integral equation. This is also the limiting value of the discretely compunded interest as the number of compounding periods <span class="math inline">\(n\)</span> goes to infinity:</p>
<p><span class="math display">\[X(t)=\lim_{t \rightarrow \infty} \left(1+r \frac{T}{N}\right)^{N}.\]</span></p>
<p>This can be verified by taking the log of <span class="math inline">\(\left(1+r \frac{T}{N}\right)^{N}\)</span> and using l’Hospital’s rule. Given the initial wealth, <span class="math inline">\(X(0)\)</span> and the rate of change <span class="math inline">\(r X(t)\)</span> (which, if the unit of account is dollars, is in units dollars / time), we can we solve for the value of our wealth at all times.</p>
<p>However, most investments involve risk. We might think that part of the return is more or less known while a portion of the investment is random or risky. Therefore we would like a model which can be written as <span class="math display">\[ d X(t) = \mu X(t) dt + \text{`noise'} \times X(t). \]</span></p>
<p>It makes sense that the units of the noise should be in the unit of account (dollars) and it should have zero mean but it is not obvious how to make sense of a noisy change over an instant. In the next section we examine the most popular choice for this model, namely Brownian motion. Loosely speaking, we can take expectations to get</p>
<p><span class="math display">\[ d E[X(t)]= \mu E[X(t)] dt\]</span></p>
<p>which gives a solution</p>
<p><span class="math display">\[E[X(t)]=X(0) e^{\mu T}. \]</span></p>
<p>So we can think of this model as a known expected continuously compunded investment at a rate <span class="math inline">\(\mu\)</span> plus a noisy return.</p>
<p>Historically, these deterministic mathematics trace back to Issac Newton who developed the classical laws of motion. The model of noise was developed by Ito to account for random disturbances, such as unpredictable wind gusts, to a deterministic model, for example, in a model predicting the position of a falling object.</p>
<p>This chapter has three objectives. The first is to introduce the concept of a Brownian motion. A Brownian motion is a random process (a variable that changes randomly over time) that evolves continuously in time and has the property that its change over any time period is normally distributed with mean zero and variance equal to the length of the time period. The mean zero feature means that a Brownian motion is a martingale. We will also give a different characterization (Levy’s theorem) emphasizing the quadratic variation process, which is a property of the paths (how the variable evolves over time, in a given state of the world) of the process.</p>
<p>The second objective is to explain Ito’s formula, which is the chain rule for stochastic calculus. In the Black-Scholes model, the stock price is assumed to satisfy <span class="math display">\[\frac{\mathrm{d} S}{S}=\mu\,\mathrm{d} t+\sigma\,\mathrm{d} B\; ,\]</span> where <span class="math inline">\(B\)</span> is a Brownian motion. In the case that the stock pays no dividend, the rate of return is its price change <span class="math inline">\(\mathrm{d} S\)</span> divided by the initial price <span class="math inline">\(S\)</span>, so the model states that the expected rate of return in each instant <span class="math inline">\(\mathrm{d} t\)</span> is <span class="math inline">\(\mu\,\mathrm{d} t\)</span> (of course, <span class="math inline">\(t\)</span> denotes time, so <span class="math inline">\(\mathrm{d} t\)</span> is the change in time). The variance of the rate of return depends on <span class="math inline">\(\sigma\)</span>. This model can be equivalently written in terms of the natural logarithm of <span class="math inline">\(S\)</span>, which we will write as <span class="math inline">\(\log S\)</span>. The above equation for the rate of return is equivalent to <span class="math display">\[\mathrm{d}\,\log S = \left(\mu - \frac{1}{2}\sigma^2\right)\,\mathrm{d} t + \sigma\,\mathrm{d} B\; .\]</span> We will explain this equivalence and other similar calculations that are useful for pricing derivatives.</p>
<p>The third objective is to explain how, when we change numeraires, as described in the previous chapter, we can calculate the expectation in the fundamental pricing <a href="Chapter_Arbitrage.html#eq-formula" class="quarto-xref">Equation&nbsp;<span>2.29</span></a>. The question is what effect does changing the numeraire (and hence the probability measure) have on the distribution of an asset price.</p>
<p>Everything in the remainder of the book is based on the mathematics presented in this chapter. For easy reference, the essential formulas have been highlighted in boxes.</p>
</section>
<section id="sec-s_simulatingbrownian" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-s_simulatingbrownian"><span class="header-section-number">3.2</span> Simulating a Brownian Motion</h2>
<p>We begin with the fact that changes in the value of a Brownian motion are normally distributed with mean zero and variance equal to the length of the time period. Let <span class="math inline">\(B(t)\)</span> denote the value of a Brownian motion at time <span class="math inline">\(t\)</span>. Then for any date <span class="math inline">\(u&gt;t\)</span>, given the information at time <span class="math inline">\(t\)</span>, the random variable <span class="math inline">\(B(u) - B(t)\)</span> is normally distributed with mean zero and variance equal to <span class="math inline">\(u-t\)</span>. Unless stated otherwise, our convention will be that a Brownian motion starts at <span class="math inline">\(B(0)=0\)</span>.</p>
<p>We can generate an approximate Brownian motion in Python. To do so, we take a small time period <span class="math inline">\(\Delta t\)</span> and define the value at the end of the period to be the value of the Brownian motion at the beginning plus a normally distributed variable with mean 0 and variance <span class="math inline">\(\Delta t\)</span>. In the following procedure, we input the length <span class="math inline">\(T=0.5\)</span> of the entire time period over which the Brownian motion is to be simulated. One input the is number <span class="math inline">\(n=10000\)</span> of time periods of length <span class="math inline">\(\Delta t\)</span> within the full interval <span class="math inline">\([0,T]\)</span>. The length <span class="math inline">\(\Delta t\)</span> of each individual time period is then calculated as <span class="math inline">\(T/n\)</span>. The quality of the approximation of this simulation to a true Brownian motion will be always be improved by increasing the number <span class="math inline">\(n\)</span>. Plotting the output of the procedure creates a picture of what we call a path of the Brownian motion, which means that it shows the value taken at each time in one state of the world. The procedure generates <span class="math inline">\(m=2\)</span> paths which can be interpreted as the values of the Brownian motion in another state of the world. In other words, the path of the Brownian motion is itself random, depending in this approximation on the numbers produced by Python’s random number generating function. The random number generator np.random.normal(loc = 0, scale = vol,size = (n,m)) is an algorithm which produces numbers which mimic <span class="math inline">\(n \times m\)</span> normally distributed random variables with mean 0 (loc=0) and standard deviation <span class="math inline">\(\sqrt{\Delta t}\)</span> (scale=vol). By setting the seed=1234 the generator is initialized and we will always get the same output whenever we run the code. The Brownian path is just the cumulative sum of <span class="math inline">\(n\)</span> of the normal increments.</p>
<div id="simulated-brownian-motion" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of subdivisions</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># number of paths</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># last date</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># delta t</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T<span class="op">/</span>n</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># volatility is standard deviation</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>vol <span class="op">=</span> np.sqrt(dt)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># seed for random generator</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>seed<span class="op">=</span> <span class="dv">1234</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># define a random generator</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>np.random.seed(seed)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># generate "dB" for each date on each path distributed N(0,vol)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>inc <span class="op">=</span> np.random.normal(loc <span class="op">=</span> <span class="dv">0</span>, scale <span class="op">=</span> vol,size <span class="op">=</span> (n,m))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Bt <span class="op">=</span> np.zeros(shape <span class="op">=</span> (n <span class="op">+</span> <span class="dv">1</span>, m))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Brownian path starts at 0 and is cumulative sum of the dB</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>Bt[<span class="dv">1</span>:] <span class="op">=</span> inc.cumsum(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Could do previous step in a loop</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    Bt[i] <span class="op">=</span> Bt[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> inc[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot one path</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.array(<span class="bu">range</span>(<span class="dv">0</span>, n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">*</span> dt</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>plt.plot(t,Bt[:,<span class="dv">0</span>])</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Brownian Motion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="simulated-brownian-motion-1" class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Text(0, 0.5, 'Brownian Motion')</code></pre>
<p>Simulated Brownian Motion</p>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_Ito_files/figure-html/simulated-brownian-motion-output-2.png" id="simulated-brownian-motion-2" width="738" height="503" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<!-- ^[The generation of normally distributed random numbers in Excel is discussed in Appendix~A.  The function RandN() here is user-created (to simplify typing) to equal the function Application.NormSInv(Rnd()) supplied in VBA.  The construction $\text{sqrtdt]*z$ scales the standard normal $z$ so that its standard deviation is $\sqrt{\Delta t}$ and hence its variance is $\Delta t$, as desired.  The subroutine creates two columns of data below the active cell in the Excel worksheet with headings Time and Brownian Motion.  To plot the path of the Brownian motion, select the two columns and insert an XY (Scatter) chart, with data points connected by lines.} -->
<!-- <!-- \addcontentsline{lof}{figure}{Simulating Brownian Motion}
\begin{verbatim}
Sub Simulating_Brownian_Motion()
Dim T, dt, Sqrdt, BrownianMotion, i, N
T = InputBox("Enter the length of the time period (t)")
N = InputBox("Enter the number of periods (N)")
dt = T / N
Sqrdt = Sqr(dt)
ActiveCell.Value = "Time"
ActiveCell.Offset(0, 1) = "Brownian Motion"
ActiveCell.Offset(1, 0) = 0   ' beginning time
ActiveCell.Offset(1, 1) = 0   ' beginning value of Brownian motion
BrownianMotion = 0
For i = 1 To N
  ActiveCell.Offset(i + 1, 0) = i * dt          ' next time
  BrownianMotion = BrownianMotion + Sqrdt * RandN()
  ActiveCell.Offset(i + 1, 1) = BrownianMotion  ' next value
Next i
End Sub -->
<!-- \end{verbatim} -->
<p>–&gt;</p>
</section>
<section id="sec-s_quadraticvariation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-s_quadraticvariation"><span class="header-section-number">3.3</span> Quadratic Variation</h2>
<p>If we take a large number <span class="math inline">\(n\)</span> of time steps in the simulation of the preceding section, we will see the distinctive characteristic of a Brownian motion: it jiggles rapidly, moving up and down in a very erratic way. The name Brownian motion derives from the botanist Robert Brown’s observations of the erratic behavior of particles suspended in a fluid. This has long been thought to be a reasonable model for the behavior of a stock price.<br>
The plot of other functions with which we may be familiar will be much smoother. This is captured in the concept of quadratic variation.</p>
<p>Consider a discrete partition <span class="math display">\[0=t_0 &lt; t_1 &lt; t_2 &lt; \cdots &lt; t_N=T\]</span> of the time interval <span class="math inline">\([0,T]\)</span>. Let <span class="math inline">\(B\)</span> be a Brownian motion and calculate the sum of squared changes <span class="math display">\[\sum_{i=1}^N [\Delta B_{t_i}]^2\; ,\]</span> where <span class="math inline">\(\Delta B_{t_i}\)</span> denotes the change <span class="math inline">\(B_{t_i}-B(t_{i-1}).\)</span> If we consider finer partitions with the length of each time interval <span class="math inline">\(t_i-t_{i-1}\)</span> going to zero, the limit of the sum is called the quadratic variation of the process. For a Brownian motion, the quadratic variation over an interval <span class="math inline">\([0,T]\)</span> is equal to <span class="math inline">\(T\)</span> with probability one. Here is a plot of the quadratic variation. For large values of <span class="math inline">\(n\)</span>, it is equal to <span class="math inline">\(t\)</span>.</p>
<div id="quadratic-variation" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic variation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> np.zeros(shape <span class="op">=</span> (n, m))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate dB^2</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> (Bt[<span class="dv">1</span>:n <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> Bt[<span class="dv">0</span>:n])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratic variation is the cumulative sum of dB^2</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>QV <span class="op">=</span> np.zeros(shape <span class="op">=</span> (n <span class="op">+</span> <span class="dv">1</span>, m))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>QV[<span class="dv">1</span>:] <span class="op">=</span> Q.cumsum(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.plot(t,QV[:,<span class="dv">0</span>])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Quadratic Variation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="quadratic-variation-1" class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Text(0, 0.5, 'Quadratic Variation')</code></pre>
<p>Quadratic Variation</p>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_Ito_files/figure-html/quadratic-variation-output-2.png" id="quadratic-variation-2" width="738" height="503" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The functions with which we are normally familiar are continuously differentiable. If <span class="math inline">\(X\)</span> is a continuously differentiable function of time (in each state of the world), then the quadratic variation of <span class="math inline">\(X\)</span> will be zero. A simple example is a linear function: <span class="math inline">\(X(t) = at\)</span> for some constant <span class="math inline">\(a\)</span>. Then, taking <span class="math inline">\(t_i-t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>, the sum of squared changes is <span class="math display">\[\sum_{i=1}^N [\Delta X_{t_i}]^2 = \sum_{i=1}^N  [a\,\Delta t]^2 = Na^2 (\Delta t)^2 = Na^2 \left(\frac{T}{N}\right)^2 = \frac{a^2T^2}{N} \rightarrow 0\]</span> as <span class="math inline">\(N \rightarrow \infty\)</span>. Essentially the same argument shows that the quadratic variation of any continuously differentiable function is zero, because such a function is approximately linear at each point. Below is a plot of the quadratic variation for the function <span class="math inline">\(X(t)=t\)</span>. Look carefully at the scale of the y-axis</p>
<div id="cell-squaredvariation" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot dt^2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.plot(t,t <span class="op">*</span> dt <span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="squaredvariation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption>Approximate Squared Variation of <span class="math inline">\(f(t)=t\)</span></figcaption>
<p><img src="Chapter_Ito_files/figure-html/squaredvariation-output-1.png" width="719" height="499" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Thus, the jiggling of a Brownian motion, which leads to the nonzero quadratic variation, is quite unusual. To explain exactly how unusual it is, it is helpful to introduce the concept of total variation, which is defined in the same way as quadratic variation but with the squared changes <span class="math inline">\([\Delta B_{t_i}]^2\)</span> replaced by the absolute value of the changes <span class="math inline">\(|\Delta B_{t_i}|.\)</span> If the quadratic variation of a continuous function is nonzero, then its total variation is necessarily infinite, so each path of a Brownian motion has infinite total variation (with probability one). It was mentioned above that, with a large number of time steps in the simulation of the preceding section, one could see the distinctive jiggling property of a Brownian motion. This is not quite right. Any plot drawn by a pencil (or a laser printer, for that matter) must have finite total variation, because the total variation is the total distance traveled by the pencil. Hence, no matter how many time steps one uses, one will never create a continuous plot with the nonzero quadratic variation (and infinite total variation) that a Brownian path has. Another way to understand this is to consider focusing on a small segment of a plot and viewing it with a magnifying glass. If the segment is small enough, and excluding the finite number of kinks that a pencil can draw in the plot of a function, it will look approximately like a straight line under the magnifying glass (with slope equal to the derivative of the function). However, if one could view a segment of a path of a true Brownian motion under a magnifying glass, it would look much the same as the entire picture does to the naked eye—no matter how small the segment, one would still see the characteristic jiggling.</p>
<p>To better visualize the convergence of the quadratic for a handfull of simulated paths of a standard Brownian motion, we encourage readers to interact with the plot below.</p>
<div id="fig-interactive_quad_var" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-interactive_quad_var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Convergence of quadratic variation for a standard Brownian motion
</figcaption>
<div aria-describedby="fig-interactive_quad_var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<iframe width="780" height="1000" src="https://derivatives-book-26ac36570fb8.herokuapp.com/math_finance_book_plots/quad_var_plot">
</iframe>
</div>
</figure>
</div>
<p>One may well question why we should be interested in this curious mathematical object. The reason is that asset pricing inherently involves martingales (variables that evolve randomly over time in such a way that their expected changes are always zero), as our fundamental pricing <a href="Chapter_Arbitrage.html#eq-formula" class="quarto-xref">Equation&nbsp;<span>2.29</span></a> establishes. Furthermore, continuous processes (variables whose paths are continuous functions of time) are much more tractable mathematically than are processes that can jump at some instants. More importantly, it is possible in a mathematical model with continuous processes to define perfect hedges much more readily than it is in a model involving jump processes. So, we are led to a study of continuous martingales. An important fact is that any non-constant continuous martingale must have infinite total variation! So, the normal functions with which we are familiar are left behind once we enter the study of continuous martingales.</p>
<p>There remains perhaps the question of why we focus on Brownian motion within the world of continuous martingales. The answer here is that any continuous martingale is really just a transformation of a Brownian motion. This is a consequence of the following important fact, which is known as Levy’s theorem: </p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A continuous martingale is a Brownian motion if and only if its quadratic variation over each interval <span class="math inline">\([0,T]\)</span> equals <span class="math inline">\(T\)</span>.</p>
</div>
</div>
<p>Thus, among continuous martingales, a Brownian motion is defined by the condition that the quadratic variation over each interval <span class="math inline">\([0,T]\)</span> is equal to <span class="math inline">\(T\)</span>. This is really just a normalization. A different continuous martingale may have a different quadratic variation, but it can be converted to a Brownian motion just by deforming the time scale. Furthermore, many continuous martingales can be constructed as stochastic integrals with respect to a Brownian motion. We take up this topic in the next section.</p>
</section>
<section id="sec-s_itoprocesses" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sec-s_itoprocesses"><span class="header-section-number">3.4</span> Ito Processes</h2>
<p>An Ito process is a variable <span class="math inline">\(X\)</span> that changes over time as <span id="eq-itoprocess"><span class="math display">\[
\mathrm{d} X(t) = \mu(t)\,\mathrm{d} t+\sigma(t)\,\mathrm{d} B(t)\;,
\qquad(3.1)\]</span></span></p>
<p>where <span class="math inline">\(B\)</span> is a Brownian motion, and <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> can also be random processes. Some regularity conditions are needed on <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> which we will omit, except for noting that <span class="math inline">\(\mu(t)\)</span> and <span class="math inline">\(\sigma(t)\)</span> should be known at time <span class="math inline">\(t\)</span>. In particular, constant <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are certainly acceptable. When we add the changes over time, we get <span class="math display">\[X(t)=X(0) + \int_0^T\mu(t)\,\mathrm{d} t + \int_0^T\sigma(t)\,\mathrm{d} B(t)\]</span> for any <span class="math inline">\(T&gt;0\)</span>. There are other types of random processes, in particular, processes that can jump, but we will not consider them in this book.</p>
<p>We will not formally define the integral <span class="math inline">\(\int_0^T \sigma(t)\,\mathrm{d} B(t)\)</span>, but it should be understood as being approximately equal to a discrete sum of the form <span class="math display">\[\sum_{i=1}^N \sigma(t_{i-1})\,\Delta B_{t_i}\; ,\]</span> where <span class="math inline">\(0=t_0 &lt; \cdots t_N=T\)</span> and the time periods <span class="math inline">\(t_i-t_{i-1}\)</span> are small. Given that we can simulate the changes <span class="math inline">\(\Delta B_{t_i}\)</span> as random normals, we can approximately simulate the random variable <span class="math inline">\(\int_0^T \sigma(t)\,\mathrm{d} B(t)\)</span> and hence we can approximately simulate <span class="math inline">\(X(t)\)</span>.</p>
<p>An Ito process evolves continuously over time. We interpret <span class="math inline">\(\mu(t)\,\mathrm{d} t\)</span> as the expected change in <span class="math inline">\(X\)</span> in an instant <span class="math inline">\(\mathrm{d} t\)</span>. The quantity <span class="math inline">\(\mu(t)\)</span> is also called the drift of the process <span class="math inline">\(X\)</span> at time <span class="math inline">\(t\)</span>. The coefficient <span class="math inline">\(\sigma(t)\)</span> is called the diffusion coefficient of <span class="math inline">\(X\)</span> at time <span class="math inline">\(t\)</span>. </p>
<p>If <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are constant, it is standard to refer to an Ito process <span class="math inline">\(X\)</span> as a <span class="math inline">\((\mu,\sigma)\)</span>–Brownian motion. In this case we have <span class="math display">\[X(t)= \mu t + \sigma B(t)\]</span></p>
<p>Of course, it is not a martingale when <span class="math inline">\(\mu\neq 0\)</span>. For example, when <span class="math inline">\(\mu&gt;0\)</span>, <span class="math inline">\(X\)</span> tends to increase over time. However, it has the jiggling property of a Brownian motion, scaled by the diffusion coefficient <span class="math inline">\(\sigma\)</span>.</p>
<p>A very important fact is that an Ito process such as <a href="#eq-itoprocess" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> can be a martingale only if <span class="math inline">\(\mu=0\)</span>. This should seem sensible, because <span class="math inline">\(\mu\,\mathrm{d} t\)</span> is the expected change in <span class="math inline">\(X\)</span>, and a process is a martingale only if its expected change is zero.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This observation plays a fundamental role in deriving asset pricing formulas, as we will begin to see in <a href="#sec-s_girsanov" class="quarto-xref"><span>Section 3.10</span></a>. Conversely, if <span class="math inline">\(\mu=0\)</span> and <span id="eq-regularity1"><span class="math display">\[
E \left[\int_0^T \sigma^2(t)\,\mathrm{d} t\right] &lt; \infty
\qquad(3.2)\]</span></span></p>
<p>for each <span class="math inline">\(T\)</span>,<br>
then the Ito process is a continuous martingale and the variance of its date–<span class="math inline">\(T\)</span> value, calculated with the information available at date 0, is: <span class="math display">\[\mathrm{var}[X(t)] = E \left[\int_0^T \sigma^2(t)\,\mathrm{d} t\right]\; .\]</span></p>
<p>Whether <span class="math inline">\(\mu\)</span> is zero or not, and independently of the assumption <a href="#eq-regularity1" class="quarto-xref">Equation&nbsp;<span>3.2</span></a>, the quadratic variation of the Ito process <span class="math inline">\(X\)</span> is <span id="eq-itoquadraticvariation"><span class="math display">\[
\lim_{N \rightarrow \infty} \sum_{i=1}^N[\Delta X_{t_i}]^2 = \int_0^T \sigma^2(t)\,\mathrm{d} t
\qquad(3.3)\]</span></span></p>
<p>with probability one. Thus we obtain (when <span class="math inline">\(\mu=0\)</span> and <a href="#eq-regularity1" class="quarto-xref">Equation&nbsp;<span>3.2</span></a> holds) a continuous martingale with a different quadratic variation than a Brownian motion via the diffusion function <span class="math inline">\(\sigma\)</span>. In fact, when <a href="#eq-regularity1" class="quarto-xref">Equation&nbsp;<span>3.2</span></a> holds, a somewhat more precise definition of the stochastic integral is the (unique) martingale with quadratic variation given by <a href="#eq-itoquadraticvariation" class="quarto-xref">Equation&nbsp;<span>3.3</span></a>.</p>
<p>To compute the quadratic variation of an Ito process, we use the following simple and important rules (for the sake of brevity, we drop the <span class="math inline">\((t)\)</span> notation from <span class="math inline">\(B(t)\)</span> here and sometimes later):</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-dtsquared"><span class="math display">\[
(\mathrm{d} t)^2 = 0\;,
\qquad(3.4)\]</span></span></p>
<p><span id="eq-dtdB"><span class="math display">\[
(\mathrm{d} t)(\mathrm{d} B) =0\;,
\qquad(3.5)\]</span></span></p>
<p><span id="eq-dBsquared"><span class="math display">\[
(\mathrm{d} B)^2 =\mathrm{d} t\;.
\qquad(3.6)\]</span></span></p>
</div>
</div>
<p>We apply these rules to compute the quadratic variation of <span class="math inline">\(X\)</span> as follows:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(\mathrm{d} X = \mu\,\mathrm{d} t + \sigma\,\mathrm{d} B\)</span> for a Brownian motion <span class="math inline">\(B\)</span>, then <span class="math display">\[\begin{align*}
(\mathrm{d} X)^2 &amp;= (\mu\,\mathrm{d} t+\sigma\,\mathrm{d} B)^2\\
&amp;= \mu^2(\mathrm{d} t)^2 + 2\mu\sigma(\mathrm{d} t)(\mathrm{d} B) + \sigma^2(\mathrm{d} B)^2\\
&amp;= 0 + 0 + \sigma^2\,\mathrm{d} t\;.
\end{align*}\]</span></p>
</div>
</div>
<p>We integrate this from 0 to <span class="math inline">\(T\)</span> to obtain the quadratic variation <a href="#eq-itoquadraticvariation" class="quarto-xref">Equation&nbsp;<span>3.3</span></a> over that time period:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <span id="eq-itoquadraticvariation2"><span class="math display">\[
\int_0^T (\mathrm{d} X(t))^2 = \int_0^T \sigma^2(t)\,\mathrm{d} t\;.
\qquad(3.7)\]</span></span></p>
</section>
<section id="sec-s_itosformula" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="sec-s_itosformula"><span class="header-section-number">3.5</span> Ito’s Formula</h2>
<p>First we recall some facts of the ordinary calculus. If <span class="math inline">\(y=g(x)\)</span> and <span class="math inline">\(x = f(t)\)</span> with <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> being continuously differentiable functions, then <span class="math display">\[\frac{\mathrm{d} y}{\mathrm{d} t} = \frac{\mathrm{d} y}{\mathrm{d} x}\times \frac{\mathrm{d} x}{\mathrm{d} t} = g'(x(t))f'(t)\; .\]</span> Over a time period <span class="math inline">\([0,T]\)</span>, this implies that <span class="math display">\[y(t) = y(0) + \int_0^T \frac{\mathrm{d} y}{\mathrm{d} t}\,\mathrm{d} t = y(0) + \int_0^T g'(x(t))f'(t)\,\mathrm{d} t\; .\]</span> Substituting <span class="math inline">\(\mathrm{d} x(t) = f'(t)\,\mathrm{d} t\)</span>, we can also write this as <span id="eq-ordinarycalculus"><span class="math display">\[
y(t) = y(0) + \int_0^T g'(x(t))\,\mathrm{d} x(t)\;.
\qquad(3.8)\]</span></span></p>
<p>We can contrast <a href="#eq-ordinarycalculus" class="quarto-xref">Equation&nbsp;<span>3.8</span></a> with a special case of Ito’s formula for the calculus of Ito processes (the more general formula will be discussed in the next section). If <span class="math inline">\(B\)</span> is a Brownian motion and <span class="math inline">\(Y = g(B)\)</span> for a twice-continuously differentiable function <span class="math inline">\(g\)</span>, then <span id="eq-itonew1"><span class="math display">\[
Y(t) = Y(0) + \int_0^T g'(B(t))\,\mathrm{d} B(t) + \frac{1}{2}\int_0^T g''(B(t))\,\mathrm{d} t\;.
\qquad(3.9)\]</span></span></p>
<p>Thus, relative to the ordinary calculus, Ito’s formula has an extra term involving the second derivative <span class="math inline">\(g''\)</span>. We can write <a href="#eq-itonew1" class="quarto-xref">Equation&nbsp;<span>3.9</span></a> in differential form as <span class="math display">\[dY(t) = \frac{1}{2}g''(B(t))\,\mathrm{d} t + g'(B(t))\,\mathrm{d} B(t).\]</span> Thus, <span class="math inline">\(Y=g(B)\)</span> is an Ito process with drift <span class="math inline">\(g''(B(t))/2\)</span> and diffusion coefficient <span class="math inline">\(g'(B(t))\)</span>.</p>
<p>To gain some intuition for the extra term in Ito’s formula, we return to the ordinary calculus. Given dates <span class="math inline">\(t&lt;u\)</span>, the derivative defines a linear approximation of the change in <span class="math inline">\(y\)</span> over this time period; i.e., setting <span class="math inline">\(\Delta x = x(u)-x(t)\)</span> and <span class="math inline">\(\Delta y = y(u) - y(t)\)</span>, we have the approximation <span class="math display">\[\Delta y \approx g'(x(t)) \,\Delta x\; .\]</span> A better approximation is given by the second-order Taylor series expansion <span class="math display">\[\Delta y \approx g'(x(t))\,\Delta x + \frac{1}{2} g''(x(t))\,[\Delta x]^2\; .\]</span> An interpretation of <a href="#eq-ordinarycalculus" class="quarto-xref">Equation&nbsp;<span>3.8</span></a> is that the linear approximation works perfectly for infinitesimal time periods <span class="math inline">\(\mathrm{d} t\)</span>, because we can compute the change in <span class="math inline">\(y\)</span> over the time period <span class="math inline">\([0,T]\)</span> by summing up the infinitesimal changes <span class="math inline">\(g'(x(t))\,\mathrm{d} x(t)\)</span>. In other words, the second-order term <span class="math inline">\(\frac{1}{2} g''(x(t))\,[\Delta x]^2\)</span> vanishes when we consider very small time periods.</p>
<p>The second-order Taylor series expansion in the case of <span class="math inline">\(Y=g(B)\)</span> is <span class="math display">\[\Delta Y \approx g'(B(t))\,\Delta B + \frac{1}{2} g''(B(t))\,[\Delta B]^2\; .\]</span> For example, given a partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots &lt; t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span>, we have, with the same notation we have used earlier,</p>
<p><span class="math display">\[
Y(t) = Y(0) + \sum_{i=1}^N \Delta Y_{t_i}  
\]</span> <span id="eq-itonew2"><span class="math display">\[
\approx Y(0) + \sum_{i=1}^N g'(B(t_{i-1}))\,\Delta B_{t_i} + \frac{1}{2} \sum_{i=1}^N g''(B(t_{i-1}))\,[\Delta B_{t_i}]^2\;.
\qquad(3.10)\]</span></span></p>
<p>If we make the time intervals <span class="math inline">\(t_i-t_{i-1}\)</span> shorter, letting <span class="math inline">\(N \rightarrow \infty\)</span>, we cannot expect that the extra term here will disappear, leading to the result <a href="#eq-ordinarycalculus" class="quarto-xref">Equation&nbsp;<span>3.8</span></a> of the ordinary calculus, because we know that <span class="math display">\[\lim_{N \rightarrow \infty} \sum_{i=1}^N [\Delta B_{t_i}]^2 = T\; ,\]</span> whereas for the continuously differentiable function <span class="math inline">\(x(t) = f(t)\)</span>, the same limit is zero. In fact it seems sensible to interpret the limit of <span class="math inline">\([\Delta B]^2\)</span> as <span class="math inline">\((\mathrm{d} B)^2 =\mathrm{d} t\)</span>. This is perfectly consistent with Ito’s formula: if we take the limit in <a href="#eq-itonew2" class="quarto-xref">Equation&nbsp;<span>3.10</span></a>, replacing the limit of <span class="math inline">\([\Delta B_{t_i}]^2\)</span> with <span class="math inline">\((\mathrm{d} B)^2 = \mathrm{d} t\)</span>, we obtain <a href="#eq-itonew1" class="quarto-xref">Equation&nbsp;<span>3.9</span></a>.</p>
<p>The code below defines a function <span class="math inline">\(g(x)=e^{x}\)</span> (<span class="math inline">\(g'(x)=e^x\)</span> and <span class="math inline">\(g''(x) = e^x\)</span>) and simulates the value <span class="math inline">\(e^{B(t)}\)</span> in two ways. The first way is to simulate the Ito expansion <span class="math display">\[e^{B(t)}=1 + \int_0^t e^{B_s} d B_s + \frac{1}{2}\int_0^t e^{B_s} ds\]</span> using the discretization <span class="math display">\[\Delta e^{B(t)}= e^{B(t)} \Delta B(t) + \frac{1}{2} e^{B(t)} \Delta t \]</span></p>
<p>::: {#cell-Simulated Ito Formula .cell execution_count=4}</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function and its first and second derivative</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(x)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>DG <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(x)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>DDG <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(x)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Build G'(x)dB</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>GdB <span class="op">=</span> np.zeros(shape <span class="op">=</span> (n, m))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>GdB[<span class="dv">0</span>] <span class="op">=</span> np.repeat(DG(<span class="dv">0</span>), m) <span class="op">*</span> inc[<span class="dv">0</span>]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>GdB[<span class="dv">1</span>:] <span class="op">=</span> DG(Bt[<span class="dv">0</span>:n <span class="op">-</span> <span class="dv">1</span>]) <span class="op">*</span> inc[<span class="dv">1</span>:]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>SI <span class="op">=</span> np.zeros(shape <span class="op">=</span> (n, m))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Stochastic Integral is cumulative sum of G'(B)dB plus initial</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>SI <span class="op">=</span> GdB.cumsum(axis <span class="op">=</span> <span class="dv">0</span>) <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> (DDG(Bt[<span class="dv">0</span>:n])<span class="op">*</span>Q).cumsum(axis <span class="op">=</span><span class="dv">0</span>) <span class="op">+</span> G(<span class="dv">0</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Ito's Lemma </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.plot(t[<span class="dv">0</span>:n], SI[:,<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="simulated-ito-formula" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption>Simulated Ito Formula</figcaption>
<p><img src="Chapter_Ito_files/figure-html/simulated-ito-formula-output-1.png" width="719" height="485" class="figure-img"></p>
</figure>
</div>
</div>
<p>:::</p>
<p>Below is the exact simulated solution <span class="math inline">\(e^{B(t)}\)</span>. It is almost impossible to see a difference.</p>
<p>::: {#cell-Simulated Exact Solution .cell execution_count=5}</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exact solution</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.plot(t[<span class="dv">0</span>:n], G(Bt[<span class="dv">1</span>:n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="simulated-exact-solution" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption>Simulated Exact Solution</figcaption>
<p><img src="Chapter_Ito_files/figure-html/simulated-exact-solution-output-1.png" width="719" height="485" class="figure-img"></p>
</figure>
</div>
</div>
<p>:::</p>
<p>Below we plot the <span class="math inline">\(\int_0^t \frac{1}{2} g''(B_s) ds\)</span> term. Without this term the two plots above will not match.</p>
<div id="cell-correction" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correction term in Ito formula</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>QVV <span class="op">=</span> np.zeros(shape <span class="op">=</span> (n, m))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>QVV <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>(DDG(Bt[<span class="dv">0</span>:n]) <span class="op">*</span> Q).cumsum(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.plot(t[<span class="dv">0</span>:n], QVV[:,<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="correction" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption>Second Derivative Term in Ito’s Formula</figcaption>
<p><img src="Chapter_Ito_files/figure-html/correction-output-1.png" width="728" height="488" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To see the accuracy of Ito’s approximation over different amounts of subdivisions, as well as the impact of the second derivative term <span class="math inline">\(\int_0^t \fra{1}{2}g''(B_s)ds\)</span>, we encourage readers to interact with the plot below.</p>
<div id="fig-interactive_ito" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-interactive_ito-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Accuracy of Ito’s approximation
</figcaption>
<div aria-describedby="fig-interactive_ito-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<iframe width="780" height="1000" src="https://derivatives-book-26ac36570fb8.herokuapp.com/math_finance_book_plots/ito_approx_plot">
</iframe>
</div>
</figure>
</div>
</section>
<section id="multiple-ito-processes" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="multiple-ito-processes"><span class="header-section-number">3.6</span> Multiple Ito Processes</h2>
<p>Now consider two Ito processes</p>
<p><span id="eq-itoprocess110"><span class="math display">\[
\mathrm{d} X(t) = \mu_x(t)\,\mathrm{d} t + \sigma_x(t)\,\mathrm{d} B_x(t)\;,
\qquad(3.11)\]</span></span></p>
<p><span id="eq-itoprocess111"><span class="math display">\[
\mathrm{d} Y(t) = \mu_y(t)\,\mathrm{d} t + \sigma_y(t)\,\mathrm{d} B_y(t)\;,
\qquad(3.12)\]</span></span></p>
<p>where <span class="math inline">\(B_x\)</span> and <span class="math inline">\(B_y\)</span> can be different Brownian motions. The relation between the two Brownian motions is determined by their covariance or correlation. Given dates <span class="math inline">\(t&lt;u\)</span>, we know that both changes <span class="math inline">\(B_x(u)-B_x(t)\)</span> and <span class="math inline">\(B_y(u)-B_y(t)\)</span> are normally distributed with mean 0 and variance equal to <span class="math inline">\(u-t\)</span>. There will exist a (possibly random) process <span class="math inline">\(\rho\)</span> such that the covariance of these two normally distributed random variables, given the information at date <span class="math inline">\(t\)</span>, is <span class="math display">\[E(t) \left[\int(t)^u \rho(s)\,\mathrm{d} s\right]\; .\]</span> The process <span class="math inline">\(\rho\)</span> is called the correlation coefficient of the two Brownian motions, because when it is constant the correlation of the changes <span class="math inline">\(B_x(u)-B_x(t)\)</span> and <span class="math inline">\(B_y(u)-B_y(t)\)</span> is <span class="math display">\[\frac{\text{covariance}}{\text{product of standard deviations}}  = \frac{\int(t)^u \rho \,\mathrm{d} s}{\sqrt{u-t} \sqrt{u-t}} = \frac{(u-t)\rho}{u-t} = \rho\; .\]</span> Moreover, given increasingly fine partitions <span class="math inline">\(0=t_0 &lt; \cdots &lt; t_N=T\)</span> of an interval <span class="math inline">\([0,T]\)</span> as before, we will have <span class="math display">\[\sum_{i=1}^N \Delta B_x_{t_i} \times \Delta B_y_{t_i} \rightarrow \int_0^T \rho(t)\,\mathrm{d} t\]</span> as <span class="math inline">\(N \rightarrow \infty\)</span>, with probability one.</p>
<p>We know that <span id="eq-itoprocess112"><span class="math display">\[\sum _{i=1}^N [\Delta X_{t_i}]^2 \rightarrow \int_0^T \sigma_x^2(t)\,\mathrm{d} t \quad \text{and}\quad  \sum _{i=1}^N [\Delta Y_{t_i}]^2 \rightarrow \int_0^T\sigma_y^2(t)\,\mathrm{d} t\;.
\qquad(3.13)\]</span></span></p>
<p>Furthermore, it can be shown that the sum of products satisfies <span id="eq-itoprocess113"><span class="math display">\[
\sum_{i=1}^N \Delta X_{t_i} \times \Delta Y_{t_i} \rightarrow \int_0^T \sigma_x(t)\sigma_y(t)\rho(t)\,\mathrm{d} t\;.
\qquad(3.14)\]</span></span></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>By adding the rule <span id="eq-dBdB"><span class="math display">\[
(\mathrm{d} B_x)(\mathrm{d} B_y) = \rho\,\mathrm{d} t
\qquad(3.15)\]</span></span> to the rules <a href="#eq-dtsquared" class="quarto-xref">Equation&nbsp;<span>3.4</span></a>–<a href="#eq-dBsquared" class="quarto-xref">Equation&nbsp;<span>3.6</span></a>, we can compute the limit in <a href="#eq-itoprocess113" class="quarto-xref">Equation&nbsp;<span>3.14</span></a> as</p>
<p><span class="math display">\[
\lim_{N \rightarrow\infty} \sum_{i=1}^N \Delta X_{t_i} \times \Delta Y_{t_i}  = \int_0^T (\mathrm{d} X)(\mathrm{d} Y)
\]</span> <span class="math display">\[
= \int_0^T (\mu_x\,\mathrm{d} t +\sigma_x\,\mathrm{d} B_x)(\mu_y\,\mathrm{d} t+\sigma_y\,\mathrm{d} B_y)
\]</span> <span id="eq-itojointvariation"><span class="math display">\[
= \int_0^T\sigma_x(t)\sigma_y(t) \rho(t)\,\mathrm{d} t\;.
\qquad(3.16)\]</span></span></p>
</div>
</div>
<p>The most general case of Ito’s formula that we will need is for a function <span class="math inline">\(Z(t) = g(t, X(t), Y(t))\)</span> where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are Ito processes as in <a href="#eq-itoprocess110" class="quarto-xref">Equation&nbsp;<span>3.11</span></a> - <a href="#eq-itoprocess111" class="quarto-xref">Equation&nbsp;<span>3.12</span></a>. In this case, Ito’s formula is<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p><span class="math display">\[
Z(t) = Z(0) + \int_0^T \frac{\partial g}{\partial t}\,\mathrm{d} t + \int_0^T \frac{\partial g}{\partial x}\,\mathrm{d} X(t) + \int_0^T \frac{\partial g}{\partial y}\,\mathrm{d} Y(t)
\]</span> <span class="math display">\[
+ \frac{1}{2} \int_0^T \frac{\partial^2 g}{\partial x^2}\,(\mathrm{d} X(t))^2 +  \frac{1}{2} \int_0^T \frac{\partial^2 g}{\partial y^2}\,(\mathrm{d} Y(t))^2
\]</span> <span id="eq-itogeneralnew"><span class="math display">\[
+  \int_0^T \frac{\partial^2 g}{\partial x\partial y}\,(\mathrm{d} X(t))( \mathrm{d} Y(t))\;.
\qquad(3.17)\]</span></span></p>
<p>In this equation, we apply the rules <a href="#eq-dtsquared" class="quarto-xref">Equation&nbsp;<span>3.4</span></a>–<a href="#eq-dBdB" class="quarto-xref">Equation&nbsp;<span>3.15</span></a> to compute <span class="math display">\[\begin{align*}
(\mathrm{d} X(t))^2&amp;= \sigma_x^2(t)\,\mathrm{d} t\; ,\\
(\mathrm{d} Y(t))^2 &amp;= \sigma_y^2(t)\,\mathrm{d} t\; ,\\
(\mathrm{d} X(t))( \mathrm{d} Y(t)) &amp;= \sigma_x(t)\sigma_y(t)\rho(t)\,\mathrm{d} t\;.
\end{align*}\]</span> Ito’s <a href="#eq-itogeneralnew" class="quarto-xref">Equation&nbsp;<span>3.17</span></a> appears a bit simpler (and easier to remember) if we write it in differential form.” We have:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(Z(t) = g(t, X(t), Y(t))\)</span> where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are Ito processes as in <a href="#eq-itoprocess110" class="quarto-xref">Equation&nbsp;<span>3.11</span></a> - <a href="#eq-itoprocess111" class="quarto-xref">Equation&nbsp;<span>3.12</span></a>, then</p>
<p><span class="math display">\[
\mathrm{d} Z =  \frac{\partial g}{\partial t}\,\mathrm{d} t + \frac{\partial g}{\partial x}\,\mathrm{d} X +  \frac{\partial g}{\partial y}\,\mathrm{d} Y + \frac{1}{2} \frac{\partial^2 g}{\partial x^2}\,(\mathrm{d} X)^2 +  \frac{1}{2}  \frac{\partial^2 g}{\partial y^2}\,(\mathrm{d} Y)^2
\]</span> <span id="eq-itogeneralnew2"><span class="math display">\[
+ \frac{\partial^2 g}{\partial x\partial y}\,(\mathrm{d} X)(\mathrm{d} Y)\;.
\qquad(3.18)\]</span></span></p>
</div>
</div>
</section>
<section id="sec-s_examples" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="sec-s_examples"><span class="header-section-number">3.7</span> Examples of Ito’s Formula</h2>
<p>The following are the applications of Ito’s formula that will be used most frequently in the book. They follow from the boxed formula at the end of the previous section by taking <span class="math inline">\(g(x,y)=xy\)</span> or <span class="math inline">\(g(x,y)=y/x\)</span> or <span class="math inline">\(g(x)=e^x\)</span> or <span class="math inline">\(g(x) = \log x\)</span>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Products.</strong>; If <span class="math inline">\(Z=XY\)</span>, then <span class="math inline">\(\mathrm{d} Z=X\,\mathrm{d} Y+Y\,\mathrm{d} X + (\mathrm{d} X)(\mathrm{d} Y)\)</span>. We can write this as <span id="eq-rule2"><span class="math display">\[
\frac{\mathrm{d} Z}{Z}=\frac{\mathrm{d} X}{X} + \frac{\mathrm{d} Y}{Y} + \left(\frac{\mathrm{d} X}{X}\right)\left(\frac{\mathrm{d} Y}{Y}\right)\;.
\qquad(3.19)\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Ratios.</strong>; If <span class="math inline">\(Z=Y/X\)</span>, then <span id="eq-rule4"><span class="math display">\[\frac{\mathrm{d} Z}{Z} = \frac{\mathrm{d} Y}{Y} -\frac{\mathrm{d} X}{X} - \left(\frac{\mathrm{d} Y}{Y}\right)\left(\frac{\mathrm{d} X}{X}\right) + \left(\frac{\mathrm{d} X}{X}\right)^2\;.
\qquad(3.20)\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Exponentials.</strong>; If <span class="math inline">\(Z=\mathrm{e}^X\)</span>, then <span id="eq-rule5"><span class="math display">\[\frac{\mathrm{d} Z}{Z}=\mathrm{d} X + \frac{(\mathrm{d} X)^2}{2}\;.
\qquad(3.21)\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Logarithms.</strong>; If <span class="math inline">\(Z=\log X\)</span>, then <span id="eq-rule6"><span class="math display">\[
\mathrm{d} Z=\frac{\mathrm{d} X}{X} - \frac{1}{2}\left(\frac{\mathrm{d} X}{X}\right)^2\;.
\qquad(3.22)\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Compounding/Discounting.</strong> Let<br>
<span class="math display">\[Y(t) =\exp\left(\int_0^t q(s)\,\mathrm{d} s\right)\]</span> for some (possibly random) process <span class="math inline">\(q\)</span> and define <span class="math inline">\(Z=XY\)</span> for any Ito process <span class="math inline">\(X\)</span>. The usual calculus gives us <span class="math inline">\(\mathrm{d} Y(t)=q(t)Y(t)\,\mathrm{d} t\)</span>, and the product rule above implies <span id="eq-compdisc1"><span class="math display">\[
\frac{\mathrm{d} Z}{Z}=q\,\mathrm{d} t + \frac{\mathrm{d} X}{X}\;.
\qquad(3.23)\]</span></span></p>
<p>This is the same as in the usual calculus.</p>
</div>
</div>
</section>
<section id="sec-s_reinvestingdividends" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="sec-s_reinvestingdividends"><span class="header-section-number">3.8</span> Reinvesting Dividends</h2>
<p>Frequently, we will assume that the asset underlying a derivative security pays a constant dividend yield, which we will denote by <span class="math inline">\(q\)</span>. This means, for an asset with price <span class="math inline">\(S(t)\)</span>, that the dividend in an instant <span class="math inline">\(\mathrm{d} t\)</span> is <span class="math inline">\(q S(t)\,\mathrm{d} t\)</span>. If the dividends are reinvested in new shares, the number of shares will grow exponentially at rate <span class="math inline">\(q\)</span>. To see this, consider the portfolio starting with a single share of the asset and reinvesting dividends until some date <span class="math inline">\(T\)</span>. Let <span class="math inline">\(X(t)\)</span> denote the number of shares resulting from this strategy at any time <span class="math inline">\(t\leq T\)</span>. Then the dividend received at date <span class="math inline">\(t\)</span> is <span class="math inline">\(q S(t)X(t)\,\mathrm{d} t\)</span>, which can be used to purchase <span class="math inline">\(q X(t)\,\mathrm{d} t\)</span> new shares. This implies that <span class="math inline">\(\mathrm{d} X(t)=q X(t)\,\mathrm{d} t\)</span>, or <span class="math inline">\(\mathrm{d} X(t)/\mathrm{d} t = q X(t)\)</span>, and it is easy to check (and very well known) that this equation is solved by <span class="math inline">\(X(t)=\mathrm{e}^{q t}X(0)\)</span>. In our case, with <span class="math inline">\(X(0)=1\)</span>, we have <span class="math inline">\(X(t)=\mathrm{e}^{q t}\)</span>.</p>
<p>The dollar value of the trading strategy just described will be <span class="math inline">\(X(t)S(t) = \mathrm{e}^{q t}S(t)\)</span>. Denote this by <span class="math inline">\(V(t)\)</span>. This is the value of a non-dividend-paying portfolio, because all dividends are reinvested. From the Compounding/Discounting example in <a href="#sec-s_examples" class="quarto-xref"><span>Section 3.7</span></a>, we know that <span id="eq-reinvestingdividends"><span class="math display">\[
\frac{\mathrm{d} V}{V} = q\,\mathrm{d} t + \frac{\mathrm{d} S}{S}\;.
\qquad(3.24)\]</span></span></p>
<p>This means that the rate of return on the portfolio is the dividend yield <span class="math inline">\(q\,\mathrm{d} t\)</span> plus the return <span class="math inline">\(\mathrm{d} S/S\)</span> due to capital gains.</p>
</section>
<section id="sec-s_geometricbrownianmotion" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="sec-s_geometricbrownianmotion"><span class="header-section-number">3.9</span> Geometric Brownian Motion</h2>
<p>A random variable is lognormally distributed if it can be written as <span class="math inline">\(\tilde{y}=  e^{\tilde{x}}\)</span> where <span class="math inline">\(\tilde{x}\)</span> is distributed according to a normal distribution with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(s\)</span>. The expected value of <span class="math inline">\(\tilde{y}\)</span> is given by <span class="math inline">\(E[\tilde{y}] = e^{m+\frac{s^2}{2}}\)</span>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Lognormal Random Variable.</strong>; If <span class="math inline">\(\tilde{x}\)</span> is normally distributed with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(s\)</span>, then <span class="math inline">\(e^{\tilde{x}}\)</span> is lognormally distributed and <span id="eq-lognormal"><span class="math display">\[E[e^{\tilde{x}}]=e^{m + \frac{1}{2} s^2};.
\qquad(3.25)\]</span></span></p>
</div>
</div>
<p>An important stochastic process is the Geometric Brownian Motion given by <span id="eq-exponential1"><span class="math display">\[
S(t)=S(0)\exp\left(\mu t- \sigma^2 t/2 + \sigma B(t)\right)
\qquad(3.26)\]</span></span></p>
<p>for constants <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion. Note that for each time <span class="math inline">\(t\)</span>, geometric Brownian motion is a lognormal random variable. Using the product rule and the rule for exponentials, we obtain <span id="eq-Y"><span class="math display">\[
\frac{\mathrm{d} S}{S} = \mu\,\mathrm{d} t+\sigma\,\mathrm{d} B\;.
\qquad(3.27)\]</span></span></p>
<p>When we see an equation of the form <a href="#eq-Y" class="quarto-xref">Equation&nbsp;<span>3.27</span></a>, we should recognize <a href="#eq-exponential1" class="quarto-xref">Equation&nbsp;<span>3.26</span></a> as the solution.</p>
<p>The process <span class="math inline">\(S\)</span> is called a geometric Brownian motion. In keeping with the discussion of <a href="#sec-s_itoprocesses" class="quarto-xref"><span>Section 3.4</span></a>, we interpret <a href="#eq-Y" class="quarto-xref">Equation&nbsp;<span>3.27</span></a> as stating that <span class="math inline">\(\mu\,\mathrm{d} t\)</span> is the expected rate of change of <span class="math inline">\(S\)</span> and <span class="math inline">\(\sigma^2\,\mathrm{d} t\)</span> is the variance of the rate of change in an instant <span class="math inline">\(\mathrm{d} t\)</span>. We call <span class="math inline">\(\mu\)</span> the drift and <span class="math inline">\(\sigma\)</span> the volatility. The geometric Brownian motion will grow at the average rate of <span class="math inline">\(\mu\)</span>, in the sense that <span class="math inline">\(E[S(t)] = \mathrm{e}^{\mu t}S(0)\)</span>; one way to verify this uses the formula for the mean of a lognormal random variable.</p>
<p>Taking the natural logarithm of <a href="#eq-exponential1" class="quarto-xref">Equation&nbsp;<span>3.26</span></a> gives an equivalent form of the solution: <span id="eq-exponential2"><span class="math display">\[
\log S(t)= \log S(0)+\left(\mu -\frac{1}{2}\sigma^2\right)t + \sigma B(t)\;.
\qquad(3.28)\]</span></span> This shows that <span class="math inline">\(\log S(t) - \log S(0)\)</span> is a <span class="math inline">\((\mu-\sigma^2/2,\sigma)\)</span>–Brownian motion. Given information at time <span class="math inline">\(t\)</span>, the logarithm of <span class="math inline">\(S(u)\)</span> for <span class="math inline">\(u&gt;t\)</span> is normally distributed with mean <span class="math inline">\((u-t)(\mu-\sigma^2/2)\)</span> and variance <span class="math inline">\((u-t)\sigma^2\)</span>. Because <span class="math inline">\(S\)</span> is the exponential of its logarithm, <span class="math inline">\(S\)</span> can never be negative. For this reason, a geometric Brownian motion is a better model for stock prices than is a Brownian motion.</p>
<p>The differential of <a href="#eq-exponential2" class="quarto-xref">Equation&nbsp;<span>3.28</span></a> is <span id="eq-exponential3"><span class="math display">\[
\mathrm{d} \log S(t) = \left(\mu -\frac{1}{2}\sigma^2\right)\,\mathrm{d} t+ \sigma\,\mathrm{d} B(t)\;.
\qquad(3.29)\]</span></span></p>
<p>We conclude:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The equation <span class="math display">\[\frac{\mathrm{d} S}{S} = \mu\,\mathrm{d} t+\sigma\,\mathrm{d} B\]</span> is equivalent to the equation <span class="math display">\[\mathrm{d} \log S(t) = \left(\mu -\frac{1}{2}\sigma^2\right)\,\mathrm{d} t+ \sigma\,\mathrm{d} B(t)\; .\]</span> The solution of both equations is <a href="#eq-exponential1" class="quarto-xref">Equation&nbsp;<span>3.26</span></a> or the equivalent <a href="#eq-exponential2" class="quarto-xref">Equation&nbsp;<span>3.28</span></a>.</p>
</div>
</div>
<p>Over a discrete time interval <span class="math inline">\(\Delta t\)</span>, <a href="#eq-exponential3" class="quarto-xref">Equation&nbsp;<span>3.29</span></a> implies that the change in the logarithm of <span class="math inline">\(S\)</span> is <span id="eq-exponential11"><span class="math display">\[
\Delta \log S = \left(\mu -\frac{1}{2}\sigma^2\right)\Delta t+ \sigma\,\Delta B\;.
\qquad(3.30)\]</span></span></p>
<p>If <span class="math inline">\(S\)</span> is the price of a non-dividend-paying asset, then over the time period <span class="math inline">\(t_{i-1}\)</span> to <span class="math inline">\(t_i\)</span>, with <span class="math inline">\(t_i-t_{i-1}=\Delta t\)</span>, we have <span id="eq-exponential10"><span class="math display">\[
\Delta \log S = r_i\,\Delta t\;,
\qquad(3.31)\]</span></span></p>
<p>where <span class="math inline">\(r_i\)</span> is the continuously compounded annualized rate of return during the period <span class="math inline">\(\Delta t\)</span>. This follows from the definition of the continuously compounded rate of return as the constant rate over the time period <span class="math inline">\(\Delta t\)</span> that would cause <span class="math inline">\(S\)</span> to grow (or fall) from <span class="math inline">\(S(t_{i-1})\)</span> to <span class="math inline">\(S_{t_i}\)</span>. To be precise, <span class="math inline">\(r_i\)</span> is defined by <span class="math display">\[\frac{S_{t_i}}{S(t_{i-1})} = \mathrm{e}^{r_i\Delta t}\; ,\]</span> which is equivalent to <a href="#eq-exponential10" class="quarto-xref">Equation&nbsp;<span>3.31</span></a>. Thus, the geometric Brownian motion model <a href="#eq-Y" class="quarto-xref">Equation&nbsp;<span>3.27</span></a> implies that the continuously compounded annualized rate of return over a period of length <span class="math inline">\(\Delta t\)</span> is given by <span class="math display">\[r_i = \mu -\frac{1}{2}\sigma^2+ \frac{\sigma\Delta B}{\Delta t}\; .\]</span> This means that <span class="math inline">\(r_i\)</span> is normally distributed with mean <span class="math inline">\(\mu-\sigma^2/2\)</span> and variance <span class="math inline">\(\sigma^2/\Delta t\)</span>. Given historical data on the rates of return, the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> can be estimated by standard methods (see <a href="Chapter_Vol.html" class="quarto-xref"><span>Chapter 8</span></a>).</p>
<p>We can simulate a path of <span class="math inline">\(S\)</span> by simulating the changes <span class="math inline">\(\Delta \log S\)</span>. The random variable <span class="math inline">\(\sigma \Delta B\)</span> in <a href="#eq-exponential11" class="quarto-xref">Equation&nbsp;<span>3.30</span></a> has a normal distribution with zero mean and variance equal to <span class="math inline">\(\sigma^2\Delta t\)</span>. We simulate it as <span class="math inline">\(\sigma\sqrt{\Delta t}\)</span> multiplied by a standard normal. The code below simulates <span class="math inline">\(n=10000\)</span> paths with <span class="math inline">\(m=1000\)</span> time steps. There are some features of the simulation which will prove useful later. The drift <span class="math inline">\(\mu\)</span> is labelled the interest rate <span class="math inline">\(r=0.1\)</span>. Other parameters are <span class="math inline">\(\sigma = 0.2\)</span>, and <span class="math inline">\(T=0.5\)</span>. The drift of the log stock price is labelled <span class="math inline">\(drift=r-\frac{\sigma^2}{2}\)</span>. The plot output is one of the simulated sample paths. In practice, if we are only interested in the terminal value of the stock price we would use many fewer subdivisions, <span class="math inline">\(n=1\)</span>. Given a simulated mean zero normal random variable, <span class="math inline">\(z\)</span>, changing the sign to <span class="math inline">\(-z\)</span> is also a simulated normal random variable with zero mean and the same standard deviation. As a result, we have two simulations for the stock price labelled <span class="math inline">\(St\)</span> and <span class="math inline">\(St1\)</span>, but we only plot one sample path for <span class="math inline">\(St\)</span>.</p>
<div id="66689889" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Geometric Brownian Motion</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of paths</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#number of divisions</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Interest rate (We set the drift equal to the interest rate)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Volatility</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sig <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial Stock Price</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>S0 <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Maturity</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Delta t</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T<span class="op">/</span>m</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Drift</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>drift <span class="op">=</span> (r<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>sig<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Volatility</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>vol <span class="op">=</span> sig <span class="op">*</span> np.sqrt(dt)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.array(<span class="bu">range</span>(<span class="dv">0</span>,m <span class="op">+</span> <span class="dv">1</span>,<span class="dv">1</span>)) <span class="op">*</span> dt</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># seed for random generator</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>seed<span class="op">=</span> <span class="dv">2020</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># define a random generator</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>np.random.seed(seed)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>inc <span class="op">=</span> np.zeros(shape <span class="op">=</span> (m <span class="op">+</span> <span class="dv">1</span>, n))</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>inc[<span class="dv">1</span>:] <span class="op">=</span> np.transpose(np.random.normal(loc <span class="op">=</span> <span class="dv">0</span>, scale <span class="op">=</span> vol,size <span class="op">=</span> (n,m)))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>St <span class="op">=</span> np.zeros(shape <span class="op">=</span> (m <span class="op">+</span> <span class="dv">1</span>, n))</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>St <span class="op">=</span> S0 <span class="op">*</span> np.exp(np.cumsum(inc,axis<span class="op">=</span><span class="dv">0</span>) <span class="op">+</span> (drift <span class="op">*</span> t[<span class="dv">0</span>:m <span class="op">+</span> <span class="dv">1</span>])[:,<span class="va">None</span>])</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>St1 <span class="op">=</span> S0 <span class="op">*</span> np.exp(<span class="op">-</span>np.cumsum(inc,axis<span class="op">=</span><span class="dv">0</span>) <span class="op">+</span> (drift <span class="op">*</span> t[<span class="dv">0</span>:m <span class="op">+</span> <span class="dv">1</span>])[:,<span class="va">None</span>])</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>plt.plot(t,St[:,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_Ito_files/figure-html/cell-8-output-1.png" width="715" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The plot below is the distribution of the simulated stock price at <span class="math inline">\(T\)</span>.</p>
<div id="b7d48213" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>plt.hist(St[m,:], bins<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_Ito_files/figure-html/cell-9-output-1.png" width="724" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While Geometric Brownian Motion is an important stochastic process to model stock prices, the process with drift equal to zero given by <span class="math display">\[X(t) = \exp\left(-\frac{\kappa^2}{2} + \kappa B(t)\right)\]</span></p>
<p>satisfies <span class="math inline">\(E[X(t)]=1\)</span> and <span class="math inline">\(E[X(t)|X(s)]=X(s)\)</span> and is an important example of a strictly positive martingale. Again, these facts can be verified using the formula for the expected value of a lognormal random variable. Notice we can write <span class="math display">\[dX(t)= \kappa X(t) dB(t)\]</span> which agrees with the martingale characterization of <span class="math inline">\(\int_0^t \sigma(X(t),t) dB(t)\)</span>.</p>
</section>
<section id="sec-s_girsanov" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="sec-s_girsanov"><span class="header-section-number">3.10</span> Numeraires and Probabilities</h2>
<p>When we change probability measures, we cannot expect a process <span class="math inline">\(B\)</span> that was a Brownian motion to remain a Brownian motion. The expected change in a Brownian motion must always be zero, but when we change probabilities, the expected change of <span class="math inline">\(B\)</span> is likely to become nonzero. (Likewise, a martingale is unlikely to remain a martingale when we change probabilities.) However, the Brownian motion <span class="math inline">\(B\)</span> will still be an Ito process under the new probability measure. In fact, every Ito process under one probability measure will still be an Ito process under the new probability measure, and the diffusion coefficient of the Ito process will be unaffected by the change in probabilities.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> Changing probabilities only changes the drift of an Ito process.</p>
<p>In a sense, this should not be surprising. It was noted in <a href="#sec-s_quadraticvariation" class="quarto-xref"><span>Section 3.3</span></a> that a Brownian motion <span class="math inline">\(B\)</span> can be defined as a continuous martingale with paths that jiggle in such a way that the quadratic variation over any interval <span class="math inline">\([0,T]\)</span> is equal to <span class="math inline">\(T\)</span>. Changing the probabilities will change the probabilities of the various paths (so it may affect the expected change in <span class="math inline">\(B\)</span>) but it will not affect how each path jiggles. So, under the new probability measure, <span class="math inline">\(B\)</span> should still be like a Brownian motion but it may have a nonzero drift. If we consider a general Ito process, the reasoning is the same. The diffusion coefficient <span class="math inline">\(\sigma\)</span> determines how much each path jiggles, and this is unaffected by changing the probability measure. Furthermore, instantaneous covariances—the <span class="math inline">\((\mathrm{d} X)(\mathrm{d} Y)\)</span> terms—between Ito processes are unaffected by changing the probability measure. Only the drifts are affected.</p>
<p>As explained in <a href="Chapter_Arbitrage.html#sec-s_introoptions" class="quarto-xref"><span>Section 2.4</span></a>, we need to know the distribution of the underlying under probability measures corresponding to different numeraires. Let <span class="math inline">\(S\)</span> be the price of an asset that has a constant dividend yield <span class="math inline">\(q\)</span>, and, as in <a href="#sec-s_reinvestingdividends" class="quarto-xref"><span>Section 3.8</span></a>, let <span class="math inline">\(V(t)=\mathrm{e}^{qt}S(t)\)</span>. This is the price of the portfolio in which all dividends are reinvested, and we have <span class="math display">\[\frac{\mathrm{d} V}{V} = q\,\mathrm{d} t + \frac{\mathrm{d} S}{S}\; .\]</span> Let <span class="math inline">\(Y\)</span> be the price of another another asset that does not pay dividends. Let <span class="math inline">\(r(t)\)</span> denote the instantaneous risk-free rate at date <span class="math inline">\(t\)</span> and let <span class="math inline">\(R(t) = \exp\left(\int_0^t r(s)\,\mathrm{d} s\right)\)</span>. Assume <span class="math display">\[\begin{align*}
\frac{\mathrm{d} S}{S} &amp;= \mu_s\,\mathrm{d} t+\sigma_s\,\mathrm{d} B_s\; ,\\
\frac{\mathrm{d} Y}{Y} &amp;= \mu_y\,\mathrm{d} t+\sigma_y\,\mathrm{d} B_y\;,
\end{align*}\]</span> where <span class="math inline">\(B_s\)</span> and <span class="math inline">\(B_y\)</span> are Brownian motions under the actual probability measure with correlation <span class="math inline">\(\rho\)</span>, and where <span class="math inline">\(\mu_s, \mu_y, \sigma_s, \sigma_y\)</span> and <span class="math inline">\(\rho\)</span> can be quite general random pro-cesses.<br>
We consider the dynamics of the asset price <span class="math inline">\(S\)</span> under three different probability measures. In each case, we follow the same steps: (i) we note that the ratio of an asset price to the numeraire asset price must be a martingale, (ii) we use Ito’s formula to calculate the drift of this ratio, and (iii) we use the fact that the drift of a martingale must be zero to compute the drift of <span class="math inline">\(\mathrm{d} S/S\)</span>.</p>
<section id="risk-neutral-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="risk-neutral-probabilities">Risk-Neutral Probabilities</h3>
<p>Under the risk-neutral measure, <span class="math inline">\(Z(t)\)</span> defined as <span class="math display">\[Z(t) = \frac{V(t)}{R(t)} = \exp\left(-\int_0^t r(s)\,\mathrm{d} s\right)V(t)\]</span> is a martingale. Using the compounding/discounting rule, we have <span class="math display">\[\frac{\mathrm{d} Z}{Z} =-r\,\mathrm{d} t + \frac{\mathrm{d} V}{V} = (q-r)\,\mathrm{d} t + \frac{\mathrm{d} S}{S}\; .\]</span> For <span class="math inline">\(Z\)</span> to be a martingale, the drift (<span class="math inline">\(\mathrm{d} t\)</span> part) of <span class="math inline">\(\mathrm{d} Z/Z\)</span> must be zero. Therefore, the drift of <span class="math inline">\(\mathrm{d} S/S\)</span> must be <span class="math inline">\((r-q)\,\mathrm{d} t\)</span> under the risk-neutral measure. Because the change of measure does not affect the volatility, this implies:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-riskneutral11"><span class="math display">\[
\frac{\mathrm{d} S}{S} =( r-q)\,\mathrm{d} t+\sigma_s\,\mathrm{d} B^*_s\;,
\qquad(3.32)\]</span></span></p>
<p>where <span class="math inline">\(B^*_s\)</span> is a Brownian motion under the risk-neutral measure.</p>
</div>
</div>
</section>
<section id="underlying-as-the-numeraire" class="level3">
<h3 class="anchored" data-anchor-id="underlying-as-the-numeraire">Underlying as the Numeraire</h3>
<p>When <span class="math inline">\(V\)</span> is the numeraire, the process <span class="math inline">\(Z(t)\)</span> defined as <span class="math display">\[Z(t) = \frac{R(t)}{V(t)} = \frac{\exp\left(\int_0^t r(s)\,\mathrm{d} s\right)}{V(t)}\]</span> is a martingale. Using the rule for ratios, we have <span class="math display">\[\frac{\mathrm{d} Z}{Z} =r\,\mathrm{d} t - \frac{\mathrm{d} V}{V} + \left(\frac{\mathrm{d} V}{V}\right)^2 = (r -q+ \sigma^2_s)\,\mathrm{d} t - \frac{\mathrm{d} S}{S}\; .\]</span> Because the drift of <span class="math inline">\(\mathrm{d} Z/Z\)</span> must be zero, this implies that the drift of <span class="math inline">\(\mathrm{d} S/
S\)</span> is <span class="math inline">\((r -q + \sigma^2_s)\,\mathrm{d} t\)</span>. We conclude that:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-own11"><span class="math display">\[
\frac{\mathrm{d} S}{S} = (r-q+ \sigma^2_s)\,\mathrm{d} t+\sigma_s\,\mathrm{d} B^*_s\;,
\qquad(3.33)\]</span></span></p>
<p>where now <span class="math inline">\(B^*_s\)</span> denotes a Brownian motion when <span class="math inline">\(V(t)=\mathrm{e}^{qt}S(t)\)</span> is the numeraire.</p>
</div>
</div>
</section>
<section id="another-risky-asset-as-the-numeraire" class="level3">
<h3 class="anchored" data-anchor-id="another-risky-asset-as-the-numeraire">Another Risky Asset as the Numeraire</h3>
<p>When <span class="math inline">\(Y\)</span> is the numeraire, <span class="math inline">\(Z(t)\)</span> defined as <span class="math display">\[Z(t) = \frac{V(t)}{Y(t)}\]</span> must be a martingale. Using again the rule for ratios, we have <span class="math display">\[\begin{align*}
\frac{\mathrm{d} Z}{Z} &amp;= \frac{\mathrm{d} V}{V} -\frac{\mathrm{d} Y}{Y}- \left(\frac{\mathrm{d} V}{V}\right)\left(\frac{\mathrm{d} Y}{Y}\right) + \left(\frac{\mathrm{d} Y}{Y}\right)^2\\
&amp; = \frac{\mathrm{d} V}{V} -\frac{\mathrm{d} Y}{Y} -\rho\sigma_s\sigma_y\,\mathrm{d} t+\sigma_y^2\,\mathrm{d} t\\
&amp;= \frac{\mathrm{d} S}{S} -\frac{\mathrm{d} Y}{Y} + (q-\rho\sigma_s\sigma_y\,\mathrm{d} t+\sigma_y^2)\,\mathrm{d} t\; .
\end{align*}\]</span> We can apply our previous example to compute the dynamics of <span class="math inline">\(Y\)</span> when <span class="math inline">\(Y\)</span> is the numeraire. This shows that the drift of <span class="math inline">\(\mathrm{d} Y/Y\)</span> is <span class="math inline">\((r+ \sigma^2_y)\,\mathrm{d} t\)</span>. Because the drift of <span class="math inline">\(\mathrm{d} Z/Z\)</span> must be zero, it follows that the drift of <span class="math inline">\(\mathrm{d} S/S\)</span> is <span class="math inline">\((r-q+ \rho\sigma_s\sigma_y)\,\mathrm{d} t\)</span>. We conclude that:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-other11"><span class="math display">\[
\frac{\mathrm{d} S}{S} = (r-q+ \rho\sigma_s\sigma_y)\,\mathrm{d} t+\sigma_s\,\mathrm{d} B^*_s\;,
\qquad(3.34)\]</span></span></p>
<p>where <span class="math inline">\(B^*_s\)</span> denotes a Brownian motion under the probability measure corresponding to the non-dividend-paying risky asset <span class="math inline">\(Y\)</span> being the numeraire, and where <span class="math inline">\(\rho\)</span> is the correlation of <span class="math inline">\(S\)</span> and <span class="math inline">\(Y\)</span>.</p>
</div>
</div>
<p>Notice that <a href="#eq-other11" class="quarto-xref">Equation&nbsp;<span>3.34</span></a>, while more complicated, is also more general than the others. In fact, it includes the formulas <a href="#eq-riskneutral11" class="quarto-xref">Equation&nbsp;<span>3.32</span></a> and <a href="#eq-own11" class="quarto-xref">Equation&nbsp;<span>3.33</span></a> as special cases: (i) if <span class="math inline">\(Y\)</span> is the price of the instantaneously risk-free asset, then <span class="math inline">\(\sigma_y=0\)</span> and <a href="#eq-other11" class="quarto-xref">Equation&nbsp;<span>3.34</span></a> simplifies to <a href="#eq-riskneutral11" class="quarto-xref">Equation&nbsp;<span>3.32</span></a>, and (ii) if <span class="math inline">\(Y=
V\)</span>, then <span class="math inline">\(\sigma_y=\sigma_s\)</span> and <span class="math inline">\(\rho=1\)</span>, so <a href="#eq-other11" class="quarto-xref">Equation&nbsp;<span>3.34</span></a> simplifies to <a href="#eq-own11" class="quarto-xref">Equation&nbsp;<span>3.33</span></a>.</p>
</section>
<section id="further-discussion" class="level3">
<h3 class="anchored" data-anchor-id="further-discussion">Further Discussion</h3>
<p>It would be natural for one to ask at this point: what is the Brownian motion <span class="math inline">\(B^*_s\)</span> and where did it come from? We have argued that once we know the drift, and the fact that the volatility does not change, we can immediately write down, for example, <span class="math display">\[\frac{\mathrm{d} S}{S} = (r-q)\,\mathrm{d} t + \sigma_s\,\mathrm{d} B^*_s\]</span> for a Brownian motion <span class="math inline">\(B^*_s\)</span> under the risk-neutral measure. To answer this question, we will give here the definition of <span class="math inline">\(B^*_s\)</span> under the risk-neutral measure. The definition shows that we are justified in writing down <a href="#eq-riskneutral11" class="quarto-xref">Equation&nbsp;<span>3.32</span></a>–<a href="#eq-other11" class="quarto-xref">Equation&nbsp;<span>3.34</span></a>, but we will not repeat the definition each time we make a statement of this sort.</p>
<p>We showed that <span class="math inline">\(Z\)</span> is a martingale under the risk-neutral measure, where <span class="math inline">\(Z\)</span> satisfies <span id="eq-numeraire101"><span class="math display">\[
\frac{\mathrm{d} Z}{Z} = (q-r)\,\mathrm{d} t + \frac{\mathrm{d} S}{S} = (q-r+\mu_s)\,\mathrm{d} t + \sigma_s\,\mathrm{d} B_s\;.
\qquad(3.35)\]</span></span></p>
<p>Define <span class="math inline">\(B^*_s(0) = 0\)</span> and <span id="eq-numeraire102"><span class="math display">\[
\mathrm{d} B^*_s = \left(\frac{q-r+\mu_s}{\sigma_s}\right)\,\mathrm{d} t + \mathrm{d} B_s\;.
\qquad(3.36)\]</span></span></p>
<p>Then <span class="math display">\[\mathrm{d} B^*_s = \frac{1}{\sigma_s}\left(\frac{\mathrm{d} Z}{Z}\right)\]</span> and hence is a continuous martingale under the risk-neutral measure. We can compute its quadratic variation as <span class="math display">\[(\mathrm{d} B^*_s)^2 = \left(\frac{q-r+\mu_s}{\sigma_s}\right)^2(\mathrm{d} t)^2 + 2\left(\frac{q-r+\mu_s}{\sigma_s}\right)(\mathrm{d} t)(\mathrm{d} B_s) + (\mathrm{d} B_s)^2 = \mathrm{d} t\; .\]</span> Therefore, by Levy’s theorem (<a href="#sec-s_quadraticvariation" class="quarto-xref"><span>Section 3.3</span></a>), <span class="math inline">\(B^*_s\)</span> is a Brownian motion under the risk-neutral measure. From <a href="#eq-numeraire101" class="quarto-xref">Equation&nbsp;<span>3.35</span></a> and <a href="#eq-numeraire102" class="quarto-xref">Equation&nbsp;<span>3.36</span></a> we have <span class="math display">\[(q-r)\,\mathrm{d} t + \frac{\mathrm{d} S}{S} = \sigma_s\,\mathrm{d} B^*_s \quad \Longleftrightarrow \quad \frac{\mathrm{d} S}{S} = (r-q)\,\mathrm{d} t + \sigma_s\,\mathrm{d} B^*_s\;,\]</span> as in <a href="#eq-riskneutral11" class="quarto-xref">Equation&nbsp;<span>3.32</span></a>.</p>
</section>
</section>
<section id="tail-probabilities-of-geometric-brownian-motions-sec-stailprobs" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="tail-probabilities-of-geometric-brownian-motions-sec-stailprobs"><span class="header-section-number">3.11</span> Tail Probabilities of Geometric Brownian Motions {#sec-s(t)ailprobs}</h2>
<p>For each of the numeraires discussed in the previous section, we have <span id="eq-tailprob1"><span class="math display">\[
\mathrm{d} \log S = \alpha\,\mathrm{d} t + \sigma\,\mathrm{d} B\;,
\qquad(3.37)\]</span></span></p>
<p>for some <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion under the probability measure associated with the numeraire. Specifically, <span class="math inline">\(\sigma=\sigma_s\)</span>, <span class="math inline">\(B=B^*_s\)</span>, and</p>
<ol type="1">
<li>for the risk-neutral measure, <span class="math inline">\(\alpha = r-q-\sigma_s^2/2\)</span>,</li>
<li>when <span class="math inline">\(\mathrm{e}^{qt}S(t)\)</span> is the numeraire, <span class="math inline">\(\alpha = r-q +\sigma_s^2/2\)</span>,</li>
<li>when another risky asset price <span class="math inline">\(Y\)</span> is the numeraire, <span class="math inline">\(\alpha = r-q+\rho\sigma_s\sigma_y-\sigma_s^2/2\)</span>.</li>
</ol>
<p>We will assume in this section that <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> are constants. The essential calculation in pricing options, as we will see in the next chapter and in <a href="Chapter_Exotics.html" class="quarto-xref"><span>Chapter 7</span></a>, is to compute <span class="math inline">\(\text{prob}(S(t)&gt;K)\)</span> and <span class="math inline">\(\text{prob}(S(t)&lt;K)\)</span> for a constant <span class="math inline">\(K\)</span> (the strike price of an option), where <span class="math inline">\(\text{prob}\)</span> denotes the probabilities at date 0 (the date we are pricing an option) associated with a particular numeraire.</p>
<p><a href="#eq-tailprob1" class="quarto-xref">Equation&nbsp;<span>3.37</span></a> gives us <span class="math display">\[\log S(t) = \log S(0) + \alpha T + \sigma B(t)\; .\]</span> Given this, we deduce</p>
<p><span class="math display">\[
S(t) &gt; K  \quad\Longleftrightarrow\quad \log S(t) &gt; \log K
\]</span> <span class="math display">\[
\quad\Longleftrightarrow\quad \sigma B(t) &gt; \log K - \log S(0)-\alpha T
\]</span> <span class="math display">\[
\quad\Longleftrightarrow\quad \frac{B(t)}{\sqrt{T}} &gt; \frac{\log K - \log S(0)-\alpha T}{\sigma\sqrt{T}}
\]</span> <span class="math display">\[
\quad\Longleftrightarrow\quad -\frac{B(t)}{\sqrt{T}} &lt; \frac{\log S(0)-\log K + \alpha T}{\sigma\sqrt{T}}
\]</span> <span id="eq-tailprob2"><span class="math display">\[
\quad\Longleftrightarrow\quad -\frac{B(t)}{\sqrt{T}} &lt; \frac{\log \left(\frac{S(0)}{K}\right) + \alpha T}{\sigma\sqrt{T}}\;.
\qquad(3.38)\]</span></span></p>
<p>The random variable on the left-hand side of <a href="#eq-tailprob2" class="quarto-xref">Equation&nbsp;<span>3.38</span></a> has the standard normal distribution—it is normally distributed with mean equal to zero and variance equal to one. As is customary, we will denote the probability that a standard normal is less than some number <span class="math inline">\(d\)</span> as <span class="math inline">\(\mathrm{N}(d)\)</span>. We conclude:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Assume <span class="math inline">\(\mathrm{d} \log S = \alpha\,\mathrm{d} t + \sigma\,\mathrm{d} B\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion. Then, for any number <span class="math inline">\(K\)</span>, <span id="eq-tailprob01"><span class="math display">\[
\text{prob}(S(t)&gt;K) = \mathrm{N}(d)\;,
\qquad(3.39)\]</span></span></p>
<p>where <span id="eq-tailprob3"><span class="math display">\[
d = \frac{\log \left(\frac{S(0)}{K}\right) + \alpha T}{\sigma\sqrt{T}}\;.
\qquad(3.40)\]</span></span></p>
</div>
</div>
<p>The probability <span class="math inline">\(\text{prob}(S(t)&lt;K)\)</span> can be calculated similarly, but the simplest way to derive it is to note that the events <span class="math inline">\(S(t)&gt;K\)</span> and <span class="math inline">\(S(t)&lt;K\)</span> are complementary—their probabilities sum to one (the event <span class="math inline">\(S(t)=K\)</span> having zero probability). Therefore <span class="math inline">\(\text{prob}(S(t)&lt;K) = 1-\mathrm{N}(d)\)</span>. This is the probability that a standard normal is greater than <span class="math inline">\(d\)</span>, and by virtue of the symmetry of the standard normal distribution, it equals the probability that a standard normal is less than <span class="math inline">\(-d\)</span>. Therefore, we have:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Assume <span class="math inline">\(\mathrm{d} \log S = \alpha\,\mathrm{d} t + \sigma\,\mathrm{d} B\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion. Then, for any number <span class="math inline">\(K\)</span>, <span id="eq-tailprob02"><span class="math display">\[
\text{prob}(S(t)&lt;K) = \mathrm{N}(-d)\;,
\qquad(3.41)\]</span></span></p>
<p>where <span class="math inline">\(d\)</span> is defined in <a href="#eq-tailprob3" class="quarto-xref">Equation&nbsp;<span>3.40</span></a>.</p>
</div>
</div>
</section>
<section id="sec-s_volatilities" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="sec-s_volatilities"><span class="header-section-number">3.12</span> Volatilities</h2>
<p>As mentioned in <a href="#sec-s_geometricbrownianmotion" class="quarto-xref"><span>Section 3.9</span></a>, when we encounter an equation of the form <span class="math display">\[\frac{\mathrm{d} S}{S} = \mu\,\mathrm{d} t + \sigma\,\mathrm{d} B\]</span> where <span class="math inline">\(B\)</span> is a Brownian motion, we will say ``<span class="math inline">\(\sigma\)</span> is the volatility of <span class="math inline">\(S\)</span>. For example, in the Black-Scholes model, the most important assumption is that the volatility of the underlying asset price is constant. We will occasionally need to compute the volatilities of products or ratios of random processes. These computations follow directly from Ito’s formula.</p>
<p>Suppose <span class="math display">\[\frac{\mathrm{d} X}{X} = \mu_x\,\mathrm{d} t + \sigma_x\,\mathrm{d} B_x \qquad \text{and} \qquad
\frac{\mathrm{d} Y}{Y} = \mu_y\,\mathrm{d} t + \sigma_y\,\mathrm{d} B_y\; ,\]</span> where <span class="math inline">\(B_x\)</span> and <span class="math inline">\(B_y\)</span> are Brownian motions with correlation <span class="math inline">\(\rho\)</span>, and <span class="math inline">\(\mu_x\)</span>, <span class="math inline">\(\mu_y\)</span>, <span class="math inline">\(\sigma_x\)</span>, <span class="math inline">\(\sigma_y\)</span>, and <span class="math inline">\(\rho\)</span> may be quite general random processes.</p>
<section id="products" class="level3">
<h3 class="anchored" data-anchor-id="products">Products</h3>
<p>If <span class="math inline">\(Z=XY\)</span>, then <a href="#eq-rule2" class="quarto-xref">Equation&nbsp;<span>3.19</span></a> gives us <span id="eq-volproduct1"><span class="math display">\[
\frac{\mathrm{d} Z}{Z} = (\mu_x+\mu_y+\rho\sigma_x\sigma_y)\,\mathrm{d} t + \sigma_x\,\mathrm{d} B_x + \sigma_y\,\mathrm{d} B_y\;.
\qquad(3.42)\]</span></span></p>
<p>The instantaneous variance of <span class="math inline">\(\mathrm{d} Z/Z\)</span> is calculated, using the rules for products of differentials, as <span class="math display">\[\begin{align*}
\left(\frac{\mathrm{d} Z}{Z}\right)^2 &amp;= (\sigma_x\,\mathrm{d} B_x + \sigma_y\,\mathrm{d} B_y)^2\\
&amp;= (\sigma_x^2 + \sigma_y^2 + 2\rho\sigma_x\sigma_y)\,\mathrm{d} t\;.
\end{align*}\]</span> As will be explained below, the volatility is the square root of the instantaneous variance (dropping the <span class="math inline">\(\mathrm{d} t\)</span>). This implies:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The volatility of <span class="math inline">\(XY\)</span> is <span id="eq-volatilityproduct"><span class="math display">\[
\sqrt{\sigma_x^2 + \sigma_y^2 + 2\rho\sigma_x\sigma_y}\;.
\qquad(3.43)\]</span></span></p>
</div>
</div>
</section>
<section id="ratios" class="level3">
<h3 class="anchored" data-anchor-id="ratios">Ratios</h3>
<p>If <span class="math inline">\(Z=Y/X\)</span>, then <a href="#eq-rule4" class="quarto-xref">Equation&nbsp;<span>3.20</span></a> gives us <span id="eq-ratioproduct1"><span class="math display">\[
\frac{\mathrm{d} Z}{Z} = (\mu_y-\mu_x-\rho\sigma_x\sigma_y+\sigma_x^2)\,\mathrm{d} t + \sigma_y\,\mathrm{d} B_y - \sigma_x\,\mathrm{d} B_x\;.
\qquad(3.44)\]</span></span></p>
<p>The instantaneous variance of <span class="math inline">\(\mathrm{d} Z/Z\)</span> is therefore <span class="math display">\[\begin{align*}
\left(\frac{\mathrm{d} Z}{Z}\right)^2 &amp;= (\sigma_y\,\mathrm{d} B_y - \sigma_x\,\mathrm{d} B_x)^2\\
&amp;= (\sigma_x^2 + \sigma_y^2 - 2\rho\sigma_x\sigma_y)\,\mathrm{d} t\;.
\end{align*}\]</span> This implies:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The volatility of <span class="math inline">\(Y/X\)</span> is<br>
<span id="eq-volatilityratio"><span class="math display">\[
\sqrt{\sigma_x^2 + \sigma_y^2 - 2\rho\sigma_x\sigma_y}\;.
\qquad(3.45)\]</span></span></p>
</div>
</div>
</section>
<section id="further-discussion-1" class="level3">
<h3 class="anchored" data-anchor-id="further-discussion-1">Further Discussion</h3>
<p>To understand why taking the square root of <span class="math inline">\((\mathrm{d} Z/Z)^2\)</span> (dropping the <span class="math inline">\(\mathrm{d} t\)</span>) gives the volatility, consider for example the product case <span class="math inline">\(Z=XY\)</span>. Define a random process <span class="math inline">\(B\)</span> by <span class="math inline">\(B(0)=0\)</span> and <span id="eq-foreigndB"><span class="math display">\[
\mathrm{d} B = \frac{\sigma_x}{\sigma}\,\mathrm{d} B_x + \frac{\sigma_y}{\sigma}\,\mathrm{d} B_y\;,
\qquad(3.46)\]</span></span></p>
<p>where <span class="math inline">\(\sigma\)</span> is the volatility defined in <a href="#eq-volatilityproduct" class="quarto-xref">Equation&nbsp;<span>3.43</span></a>. Then we can write <a href="#eq-volproduct1" class="quarto-xref">Equation&nbsp;<span>3.42</span></a> as <span id="eq-volproduct2"><span class="math display">\[
\frac{\mathrm{d} Z}{Z} = \left(\mu_x +\mu_y+ \rho\sigma_x\sigma_y\right)\,\mathrm{d} t + \sigma\,\mathrm{d} B\;. \qquad(3.47)\]</span></span></p>
<p>From the discussion in <a href="#sec-s_itoprocesses" class="quarto-xref"><span>Section 3.4</span></a>, we know that <span class="math inline">\(B\)</span> is a continuous martingale. We can compute its quadratic variation from <span class="math display">\[\begin{align*}
(\mathrm{d} B)^2 &amp;= \left(\frac{\sigma_x\,\mathrm{d} B_x + \sigma_s\,\mathrm{d} B_s}{\sigma}\right)^2\\
&amp;= \frac{(\sigma_x^2 + \sigma_s^2 + 2\rho\sigma_x\sigma_s)\,\mathrm{d} t}{\sigma^2}\; ,\\
&amp;= \mathrm{d} t\;.
\end{align*}\]</span> By Levy’s theorem (see <a href="#sec-s_quadraticvariation" class="quarto-xref"><span>Section 3.3</span></a>), any continuous martingale with this quadratic variation is necessarily a Brownian motion. Therefore, <a href="#eq-volproduct2" class="quarto-xref">Equation&nbsp;<span>3.47</span></a> shows that <span class="math inline">\(\sigma\)</span> is the volatility of <span class="math inline">\(Z\)</span> as defined at the beginning of the section.</p>
</section>
</section>
<section id="exercises" class="level2" data-number="3.13">
<h2 data-number="3.13" class="anchored" data-anchor-id="exercises"><span class="header-section-number">3.13</span> Exercises</h2>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.1</strong></span> Consider a discrete partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_i - t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>. Consider the function <span class="math display">\[X(t)=\mathrm{e}^t\; .\]</span> Write a code, which computes and plots <span class="math inline">\(\sum_{i=1}^N [\Delta X_{t_i}]^2\)</span>, where <span class="math display">\[\Delta X_{t_i} = X_{t_i}-X(t_{i-1}) = \mathrm{e}^{t_i} - \mathrm{e}^{t_{i-1}}\; .\]</span> <!-- Hint: The sum can be computed as follows.
\begin{verbatim}
sum = 0
For i = 1 To N
    DeltaX = Exp(i/N)-Exp((i-1)/N)
    sum = sum + DeltaX * DeltaX
Next i
\end{verbatim} --></p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.2</strong></span> Repeat the previous problem for the function <span class="math inline">\(X(t) = t^3\)</span>. In both this and the previous problem, what happens to <span class="math inline">\(\sum_{i=1}^N [\Delta X_{t_i}]^2\)</span> as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.3</strong></span> Either use the code provided or write a code to compute <span class="math inline">\(\sum_{i=1}^N [\Delta B_{t_i}]^2\)</span>, where <span class="math inline">\(B\)</span> is a simulated Brownian motion. For a given <span class="math inline">\(T\)</span>, what happens to the sum as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.4</strong></span> Repeat the previous problem to compute <span class="math inline">\(\sum_{i=1}^N [\Delta B_{t_i}]^3\)</span>, where <span class="math inline">\(B\)</span> is a simulated Brownian motion. For a given <span class="math inline">\(T\)</span>, what happens to the sum as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.5</strong></span> Repeat the previous problem, computing instead <span class="math inline">\(\sum_{i=1}^N |\Delta B_{t_i}|\)</span> where <span class="math inline">\(| \cdot |\)</span> denotes the absolute value. What happens to this sum as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.6</strong></span> Use Ito’s Lemma to derive the stochastic differential equation for <span class="math inline">\(S(t)^2\)</span>. Argue that <span class="math inline">\(S(t)^2\)</span> is Geometric Brownian Motion and find <span class="math inline">\(E[S(t)^2]\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.7</strong></span> Ito’s Lemma can be used in different ways to get the same answer. For example, let <span class="math inline">\(X(t) = a t + b B(t)\)</span> and use Ito’s lemma on the function <span class="math inline">\(e^{X(t)}\)</span>. Alternatively, let <span class="math inline">\(f(t, B(t)) = e^{a t + bB(t)}\)</span>. Use Ito’s lemma on <span class="math inline">\(f(,)\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.8</strong></span> Use the facts <span class="math inline">\(e^{x+y}=e^x \times e^y\)</span> and <span class="math inline">\(\frac{e^x}{e^y} = e^{x-y}\)</span> to deduce the drift and volatility of the product and ratio of two Geometric Brownian motions.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.9</strong></span> Consider a discrete partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_i - t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>. Consider a geometric Brownian motion <span class="math display">\[\frac{\mathrm{d} Z}{Z} = \mu\,\mathrm{d} t + \sigma\,\mathrm{d} B\; .\]</span> An approximate path <span class="math inline">\(\tilde{Z}(t)\)</span> of the geometric Brownian motion can be simulated as <span id="eq-exponential111"><span class="math display">\[
\Delta \tilde{Z}_{t_i} = \tilde{Z}(t_{i-1}) \big[ \mu\,\Delta t + \sigma\,\Delta B\big]\;.
\qquad(3.48)\]</span></span> Modify the code to generate both a path <span class="math inline">\(Z(t)\)</span> and an approximate path <span class="math inline">\(\tilde{Z}(t)\)</span> according to <a href="#eq-exponential111" class="quarto-xref">Equation&nbsp;<span>3.48</span></a>, using the same <span class="math inline">\(\Delta B\)</span> for both paths and taking <span class="math inline">\(\tilde{Z}(0) = Z(0)\)</span>. Plot both paths in the same figure. How well does the approximation work for large <span class="math inline">\(N\)</span>? Warning:<br>
For <span class="math inline">\(N\)</span> larger than about <span class="math inline">\(100 T\)</span>, the approximation will look perfect—you won’t be able to tell that there are two plots in the figure. One reason this is true is an exact formula is <span id="eq-exponential112"><span class="math display">\[
Z_{t_i} = Z(t_{i-1}) \exp\left[ \left(\mu -\frac{\sigma^2}{2}\right)\,\Delta t + \sigma\,\Delta B\right]\;.
\qquad(3.49)\]</span></span> and using Taylor’s Theorem for small <span class="math inline">\(\Delta t\)</span>, <span class="math inline">\(e^{\left(\mu-\frac{\sigma^2}{2}\right) \Delta t} \approx 1+ \left(\mu-\frac{\sigma^2}{2}\right) \Delta t\)</span> and <span class="math inline">\(e^{\sigma \Delta B(t)} \approx 1+ \sigma \Delta B(t) +\frac{1}{2}\sigma^2 (\Delta B(t))^2\)</span> and <span class="math inline">\((dB(t))^2=\Delta t\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.10</strong></span> Use simulation to find <span class="math inline">\(E^*[e^{-r T}{\mathbf{1}}_{\{S(t) \ge K\}}]\)</span> in the risk neutral measure where <span class="math display">\[\begin{equation*}
dS(t)= r S(t) dt + \sigma S(t) dB(t)^*
\end{equation*}\]</span> Verify that <span class="math inline">\(S(t)/e^{r t}\)</span> is a martingale in the <span class="math inline">\(*\)</span> measure where <span class="math inline">\(B^*\)</span> is a Brownian motion. Then use simulation to find <span class="math inline">\(S(0)E^S[\frac{1}{S(t)} {\mathbf{1}}_{\{S(t) \ge K\}}]\)</span> in the pricing measure which uses the share as numeraire where <span class="math display">\[\begin{equation*}
dS(t) = (r + \sigma^2) S(t) dt + \sigma S(t) dB(t)^S
\end{equation*}\]</span> so the log satisfies <span class="math display">\[\begin{equation*}
\log(S(t)) = \log(S(0)) + (r + \frac{\sigma^2}{2})t + \sigma B(t)^S
\end{equation*}\]</span> You should verify <span class="math inline">\(e^{rt}/S(t)\)</span> is a martingale in the <span class="math inline">\(S\)</span> measure where <span class="math inline">\(B^S\)</span> is a Brownian motion. Both estimates should be the same up to simulation error and give the time zero value of the random payoff <span class="math inline">\({\mathbf{1}}_{\{S(t) \ge K\}}\)</span> which is a random variable equal to <span class="math inline">\(1\)</span> if <span class="math inline">\(S(t)\ge K\)</span> and <span class="math inline">\(0\)</span> otherwise. You should choose the values for <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(K\)</span>.</p>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>If the sources of uncertainty in the market can be modeled as Brownian motions, then in fact every martingale is an Ito process with <span class="math inline">\(\mu=0\)</span>. This is some justification for the assumption we will make in this book, when studying continuous-time models, that all martingales are Ito processes.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In a more formal mathematical presentation, one normally writes <span class="math inline">\(\mathrm{d}\langle X,X\rangle\)</span> for what we are writing here as <span class="math inline">\((\mathrm{d} X)^2\)</span>. This is the differential of the quadratic variation process, and the quadratic variation through date <span class="math inline">\(T\)</span> is <span class="math display">\[
\langle X,X\rangle (t) = \int_0^T \mathrm{d}\langle X,X\rangle(t) = \int_0^T \sigma^2(t)\,\mathrm{d} t\;.
\]</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We need to assume <span class="math inline">\(g(t,x,y)\)</span> is continuously differentiable in <span class="math inline">\(t\)</span> and twice continuously differentiable in <span class="math inline">\((x,y)\)</span> for <a href="#eq-itogeneralnew" class="quarto-xref">Equation&nbsp;<span>3.17</span></a> and <a href="#eq-itogeneralnew2" class="quarto-xref">Equation&nbsp;<span>3.18</span></a> to be valid. Note also that we are using a short-hand notation here. The partial derivatives of <span class="math inline">\(g\)</span> will generally depend on <span class="math inline">\(t\)</span>, <span class="math inline">\(X(t)\)</span> and <span class="math inline">\(Y(t)\)</span> just as <span class="math inline">\(g\)</span> does.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>To be a little more precise, this is true provided sets of states of the world having zero probability continue to have zero probability when the probabilities are changed. Because of the way we change probability measures when we change numeraires (cf. <a href="Chapter_Arbitrage.html#eq-probSnumeraire" class="quarto-xref">Equation&nbsp;<span>2.23</span></a>) this will always be true for us.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter_Arbitrage.html" class="pagination-link" aria-label="Arbitrage Pricing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Arbitrage Pricing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter_BlackScholes.html" class="pagination-link" aria-label="Black-Scholes">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>