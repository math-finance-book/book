<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Foreign Exchange – Pricing and Hedging Derivative Securities: Theory and Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter8.html" rel="next">
<link href="./Chapter6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4975dddfb21a72edc69865bd112efcff.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter7.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Table of Contents</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Binomial Model and Changes of Measure</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Continuous-Time Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimating and Modeling Volatility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Monte Carlo and Binomial Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exotic Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ChapterFT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Using Fourier Transforms to Price Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Miscellaneous Facts about Continuous-Time Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Chapter contents</h2>
   
  <ul class="collapse">
  <li><a href="#currency-options" id="toc-currency-options" class="nav-link active" data-scroll-target="#currency-options"><span class="header-section-number">7.1</span> Currency Options</a></li>
  <li><a href="#sec-s_foreignstrike" id="toc-sec-s_foreignstrike" class="nav-link" data-scroll-target="#sec-s_foreignstrike"><span class="header-section-number">7.2</span> Options on Foreign Assets Struck in Foreign Currency</a></li>
  <li><a href="#sec-s_domesticstrike" id="toc-sec-s_domesticstrike" class="nav-link" data-scroll-target="#sec-s_domesticstrike"><span class="header-section-number">7.3</span> Options on Foreign Assets Struck in Domestic Currency</a></li>
  <li><a href="#sec-s_currencyforwards" id="toc-sec-s_currencyforwards" class="nav-link" data-scroll-target="#sec-s_currencyforwards"><span class="header-section-number">7.4</span> Currency Forwards and Futures</a></li>
  <li><a href="#sec-s_quantos" id="toc-sec-s_quantos" class="nav-link" data-scroll-target="#sec-s_quantos"><span class="header-section-number">7.5</span> Quantos</a></li>
  <li><a href="#sec-s_replicatingquantos" id="toc-sec-s_replicatingquantos" class="nav-link" data-scroll-target="#sec-s_replicatingquantos"><span class="header-section-number">7.6</span> Replicating Quantos</a></li>
  <li><a href="#sec-s_quantoforwards" id="toc-sec-s_quantoforwards" class="nav-link" data-scroll-target="#sec-s_quantoforwards"><span class="header-section-number">7.7</span> Quanto Forwards</a></li>
  <li><a href="#sec-s_quantooptions" id="toc-sec-s_quantooptions" class="nav-link" data-scroll-target="#sec-s_quantooptions"><span class="header-section-number">7.8</span> Quanto Options</a></li>
  <li><a href="#sec-s_returnswaps" id="toc-sec-s_returnswaps" class="nav-link" data-scroll-target="#sec-s_returnswaps"><span class="header-section-number">7.9</span> Return Swaps</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">7.10</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-c_foreignexchange" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We will see in this chapter how to apply the Black-Scholes formulas to value currency options and options on foreign assets. We will also discuss currency forwards and futures, quanto forwards, and return swaps.</p>
<p>For concreteness, we will call one currency the domestic currency and the other the foreign currency. Let <span class="math inline">\(X(t)\)</span> denote the exchange rate at time <span class="math inline">\(t\)</span> measured in units of the domestic currency per unit of the foreign currency. Exchange rates can be confusing, because we can look at them from the perspective of either currency, so it may help to keep in mind that <span class="math inline">\(X(t)\)</span> here means the price of a unit of the foreign currency, just as we might consider the price of a stock. When we speak of the cost or value of something without specifying the currency, it should be understood to be the domestic currency that we mean. If <span class="math inline">\(S\)</span> is the price of a foreign asset, denominated in units of the foreign currency, we can convert it into a domestic asset price simply by multiplying by the exchange rate: <span class="math inline">\(X(t)S(t)\)</span> is the price of the asset, denominated in the domestic currency. For example, if the domestic currency is dollars and the foreign currency is yen, then <span class="math inline">\(S\)</span> is in units of yen and <span class="math inline">\(X\)</span> is units of dollars per unit of yen, so <span class="math inline">\(XS\)</span> is in units of dollars.</p>
<p>Throughout the chapter, we will maintain assumptions similar to the Black-Scholes assumptions. There is a foreign asset with price <span class="math inline">\(S\)</span> in the foreign currency. It has a constant dividend yield <span class="math inline">\(q\)</span> and a constant volatility <span class="math inline">\(\sigma_s\)</span>. The exchange rate has a constant volatility <span class="math inline">\(\sigma_x\)</span> and a constant correlation <span class="math inline">\(\rho\)</span> with the foreign asset. There is a domestic risk-free asset with constant interest rate <span class="math inline">\(r\)</span> and a foreign risk-free asset with constant interest rate <span class="math inline">\(r_f\)</span>. The term risk free means of course that they are risk-free in their respective currencies. For example, an investment in the foreign risk-free asset is not risk free to a domestic investor, because of exchange rate risk.</p>
<section id="currency-options" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="currency-options"><span class="header-section-number">7.1</span> Currency Options</h2>
<p>A European call option on the exchange rate <span class="math inline">\(X\)</span> pays <span class="math inline">\(\max(0,X(T)-K)\)</span> at its maturity <span class="math inline">\(T\)</span>, where <span class="math inline">\(K\)</span> is the strike price (in domestic currency). The underlying asset should be regarded as the foreign risk-free asset, the domestic price of which fluctuates with the exchange rate. An investment in the foreign risk-free asset grows via reinvestment of interest at rate <span class="math inline">\(r_f\)</span>, just as the number of shares held of a stock grows via reinvestment of dividends at rate <span class="math inline">\(q\)</span>, if <span class="math inline">\(q\)</span> is its constant dividend yield. In particular, the cost at date~0 of obtaining one unit of foreign currency at date <span class="math inline">\(T\)</span> is the cost at date 0 of <span class="math inline">\(\mathrm{e}^{-r_fT}\)</span> units of foreign currency, which is <span class="math inline">\(\mathrm{e}^{-r_fT}X(0)\)</span>. Thus, the exchange rate is analogous to a stock price, with the foreign risk-free rate being its dividend yield. This means we can apply the Black-Scholes formulas to value currency calls and puts:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calls and puts on foreign currency can be valued by the Black-Scholes formulas with inputs <span class="math inline">\(X(0) =\)</span> initial asset price, <span class="math inline">\(r =\)</span> risk-free rate, <span class="math inline">\(\sigma_x =\)</span> volatility, and <span class="math inline">\(r_f =\)</span> dividend yield.</p>
</div>
</div>
</section>
<section id="sec-s_foreignstrike" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sec-s_foreignstrike"><span class="header-section-number">7.2</span> Options on Foreign Assets Struck in Foreign Currency</h2>
<p>An option on a foreign asset, with the strike price defined in the foreign currency, can be priced with the Black-Scholes formula, assuming the volatility and dividend yields of the asset are constant and that the (foreign) interest rate is constant. This must be true, because we did not need to specify the currency (dollars, yen, etc.) when deriving the Black-Scholes formula. The value given by the Black-Scholes formula is in the same currency as the asset. To obtain a value in domestic currency for an option on a foreign asset, we simply multiply the Black-Scholes formula by the current exchange rate.</p>
</section>
<section id="sec-s_domesticstrike" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="sec-s_domesticstrike"><span class="header-section-number">7.3</span> Options on Foreign Assets Struck in Domestic Currency</h2>
<p>A call option on a foreign asset with domestic strike price <span class="math inline">\(K\)</span> on the foreign asset with price <span class="math inline">\(S\)</span> pays <span class="math display">\[
\max(X(T)S(T)-K,0)
\]</span> at its maturity <span class="math inline">\(T\)</span>. The underlying price <span class="math inline">\(X(T)S(T)\)</span> is the value in domestic currency of the portfolio that with starts with <span class="math inline">\(\mathrm{e}^{-qT}\)</span> units of the asset and reinvests dividends until date <span class="math inline">\(T\)</span>. Thus, we can use the Black-Scholes formula to value it, taking the initial asset price to be <span class="math inline">\(\mathrm{e}^{-qT}X(0)S(0)\)</span> and the dividend rate to be zero (or taking the initial asset price to be <span class="math inline">\(X(0)S(0)\)</span> and the dividend rate to be <span class="math inline">\(q\)</span>). The volatility that should be input into the Black-Scholes formula is the volatility of the domestic currency price <span class="math inline">\(\mathrm{e}^{-q(T-t)}X(t)S(t)\)</span>, which is the same as the volatility of <span class="math inline">\(X(t)S(t)\)</span>.<br>
According to <a href="Chapter3.html#eq-volatilityproduct" class="quarto-xref">Equation&nbsp;<span>3.43</span></a>, the volatility of the domestic currency price <span class="math inline">\(XS\)</span> is <span id="eq-foreignoptiondomcurrencyvol"><span class="math display">\[
\sigma = \sqrt{\sigma_x^2+\sigma_s^2+2\rho\sigma_x\sigma_s}\;.
\tag{7.1}\]</span></span></p>
<p>We conclude:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calls and puts on foreign assets struck in domestic currency can be valued by the Black-Scholes formulas with inputs <span class="math inline">\(X(0)S(0) =\)</span> initial price, <span class="math inline">\(r =\)</span> risk-free rate, <a href="#eq-foreignoptiondomcurrencyvol" class="quarto-xref">Equation&nbsp;<span>7.1</span></a> = volatility, <span class="math inline">\(q =\)</span> dividend yield.</p>
</div>
</div>
</section>
<section id="sec-s_currencyforwards" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="sec-s_currencyforwards"><span class="header-section-number">7.4</span> Currency Forwards and Futures</h2>
<p>Consider a forward contract maturing at some date <span class="math inline">\(T\)</span> on one unit of foreign currency. In keeping with our convention for options, we will always assume (without loss of generality) that a forward contract is written on a single unit of currency. Let <span class="math inline">\(F(t)\)</span> denote the forward price (in domestic currency) at date <span class="math inline">\(t\leq T\)</span>. This means that someone who purchases (goes long) the contract at date <span class="math inline">\(t\)</span> will receive a unit of foreign currency, worth <span class="math inline">\(X(T)\)</span>, at date <span class="math inline">\(T\)</span> and must pay <span class="math inline">\(F(t)\)</span> at date <span class="math inline">\(T\)</span>. The value of the long contract at date <span class="math inline">\(T\)</span> is therefore <span class="math inline">\(X(T) - F(t)\)</span>. The value at date <span class="math inline">\(T\)</span> of a short contract initiated at date <span class="math inline">\(t\)</span> is the opposite: <span class="math inline">\(F(t)-X(T)\)</span>. Naturally, the forward price <span class="math inline">\(F(t)\)</span> is called the forward exchange rate. </p>
<p>The deepest market for currency is the inter-bank forward market, but futures contracts are also traded on exchanges. The difference between forwards and futures is that futures are marked to market daily. Thus, there are daily cash flows with a futures contract, whereas the only cash flows on a forward contract occur at the maturity of the forward. In both cases, there is no cash flow at the time the contract is bought/sold, so its market value is zero. In <a href="Chapter8.html#sec-s_futuresforwards" class="quarto-xref"><span>Section 8.6</span></a> we will discuss futures contracts further. In particular, we will show, assuming continuous marking to market, that if there is a constant (domestic) risk-free rate—or, more generally, if there is an instantaneous risk-free rate that changes over time in a non-random way—then futures prices must equal forward prices in the absence of arbitrage opportunities. Thus, our assumptions in this chapter imply that currency futures prices should equal currency forward prices. We will consider currency forwards in the remainder of this section.</p>
<p>A forward contract on a traded asset can always be created synthetically simply by buying the asset and holding it, using borrowed money to finance the purchase and to finance any storage costs, assuming the storage costs can be estimated in advance. If the asset pays dividends or generates other positive cash flows, then we do not need to purchase the entire amount covered by the forward contract, because we can accumulate additional amounts of the asset by reinvesting the dividends. There are no storage costs on currency and its dividend yield is equal to the foreign risk-free rate. A forward contract on one unit of foreign currency maturing at date <span class="math inline">\(T\)</span> can be created synthetically at date 0 by buying <span class="math inline">\(\mathrm{e}^{-r_fT}\)</span> units of foreign currency and borrowing the cost <span class="math inline">\(\mathrm{e}^{-r_fT}X(0)\)</span> at the domestic risk-free rate. This will lead to ownership of one unit of foreign currency at date <span class="math inline">\(T\)</span> and a liability, including interest, of <span class="math inline">\(\mathrm{e}^{(r-r_f)T}X(0)\)</span> at date <span class="math inline">\(T\)</span>. Thus, the forward price at date 0 must be <span class="math inline">\(F(0) = \mathrm{e}^{(r-r_f)T}X(0)\)</span>; otherwise, one could arbitrage by buying the forward and selling the synthetic forward, or vice versa. More generally,</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The forward exchange rate at date <span class="math inline">\(t\)</span>, for a contract maturing at <span class="math inline">\(T\)</span>, must be <span id="eq-forwardexchangerate"><span class="math display">\[
F(t) = \mathrm{e}^{(r-r_f)(T-t)}X(t)\;.
\tag{7.2}\]</span></span></p>
</div>
</div>
<p>The relation <a href="#eq-forwardexchangerate" class="quarto-xref">Equation&nbsp;<span>7.2</span></a> is called covered interest parity. The name stems from the fact that an investment in one of the risk-free assets (foreign or domestic) financed by borrowing in the other, with the currency risk hedged (covered) by a forward contract, is certain to generate zero value (otherwise, it would be an arbitrage opportunity).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> because ownership of the physical asset may produce abnormal profits during temporary shortages, an advantage that is not obtained by owning a forward contract on the asset, just as dividends are not received by the owner of a forward contract. Thus, one must consider the convenience of owning the physical asset as an advantage analogous to dividends.</p>
<p>Suppose that one has made a commitment to pay a certain amount of foreign currency (perhaps to a foreign manufacturer) at some date in the future. The exchange rate risk that this commitment entails can obviously be hedged by buying the currency forward. However, one can also create a synthetic forward, by buying currency today and investing it in the foreign risk-free asset. The cash outflow can be incurred today, or it can be deferred by borrowing the cost of the currency at the domestic risk-free rate. In the latter case, we have created a true synthetic forward. In either case, we would call this a money market hedge because we have utilized the foreign money market (risk-free asset) to create the hedge.</p>
<p>Later in this chapter we will construct replicating strategies for various contracts using the foreign risk-free asset and the domestic risk-free asset. One can interpret these replicating strategies as money market hedges or synthetic currency forwards. In practice, it will often be more convenient to use actual forwards rather than using the foreign risk-free asset. Using actual currency forwards produces an equivalent (given that we are not considering transaction costs) replicating strategy. Here is, in abstract, the way we convert from money market hedges to hedges using forwards. As we have discussed, <span class="math display">\[\begin{align*}
\text{Long Currency Forward} &amp;= \text{Long Synthetic Currency Forward} \\
&amp;= \text{Long Foreign Risk-Free Asset} \\
&amp;\qquad + \text{Short Domestic Risk-Free Asset}\;.
\end{align*}\]</span> Subtracting a short position is the same as adding a long position, so we can rearrange this as <span class="math display">\[\begin{multline*}
\text{Long Currency Forward} + \text{Long Domestic Risk-Free Asset}\\=  \text{Long Foreign Risk-Free Asset} \; .
\end{multline*}\]</span> Thus, an investment in the foreign risk-free asset can be replaced in any replicating strategy by long currency forwards and an investment in the domestic risk-free asset.</p>
<p>To be more precise about the sizes of the investments, consider replacing a money market hedge with a forward hedge at some date <span class="math inline">\(t\)</span> prior to the maturity of the forward and analyze the replacement per unit of the money market hedge (per unit of foreign currency invested in the foreign risk-free asset). One unit of foreign currency invested in the foreign risk-free asset at date <span class="math inline">\(t\)</span> will grow to <span class="math inline">\(\mathrm{e}^{r_f(T-t)}\)</span> units by date <span class="math inline">\(T\)</span>. Thus, the corresponding forward contract should be on <span class="math inline">\(\mathrm{e}^{r_f(T-t)}\)</span> units of currency. The value at date <span class="math inline">\(t\)</span> of both sides of the above equation should be the same, and the value of a forward contract at the date of initiation is zero, so the investment in the domestic risk-free asset should be the domestic currency equivalent of one unit of foreign currency, which is the exchange rate <span class="math inline">\(X(t)\)</span>. Thus, we have</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-mmhedge"><span class="math display">\[
\begin{multline}
\text{$\mathrm{e}^{r_f(T-t)}$ Long Currency Forwards} \\+  \text{$X(t)$ Long in the Domestic Risk-Free Asset}\\
= \text{1 Unit of Foreign Currency Long in the Foreign Risk-Free Asset}\;.
\end{multline}
\tag{7.3}\]</span></span></p>
</div>
</div>
<p>To check this, consider holding the portfolios until date <span class="math inline">\(T\)</span>. As explained in the first paragraph of this section, the currency forwards will have value <span class="math inline">\(\mathrm{e}^{r_f(T-t)}[X(T)-F(t)]\)</span>, which by covered interest parity is <span class="math inline">\(\mathrm{e}^{r_f(T-t)}X(T)-\mathrm{e}^{r(T-t)}X(t)\)</span>. When we include the long position in the domestic risk-free asset with accumulated interest, the value at date <span class="math inline">\(T\)</span> of the portfolio on the left-hand side of <a href="#eq-mmhedge" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> is <span class="math inline">\(\mathrm{e}^{r_f(T-t)}X(T)\)</span>. On the other, the right-hand side of <a href="#eq-mmhedge" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> with accumulated interest will consist of <span class="math inline">\(\mathrm{e}^{r_f(T-t)}\)</span> units of foreign currency, also worth <span class="math inline">\(\mathrm{e}^{r_f(T-t)}X(T)\)</span>.</p>
</section>
<section id="sec-s_quantos" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="sec-s_quantos"><span class="header-section-number">7.5</span> Quantos</h2>
<p>A quanto is a derivative written on a foreign asset the value of which is converted to domestic currency at a fixed exchange rate. In other words, the contract pays in the domestic currency and the exchange rate is part of the contract. Such contracts are very useful for investors who want to bet on foreign assets but do not want exposure to exchange rate risk. Such an investor could simply buy the foreign asset and hedge the currency risk by selling currency futures or forwards, but doing so is a bit tricky because the amount of currency that needs to be hedged depends on how well the foreign asset does. Thus, quantos can be desirable contracts. Of course, when an investor purchases a quanto, the problem of hedging the exchange rate risk has simply been transferred to the seller. In this and the following section, we will see how to value and how to replicate a contract that pays the price of a foreign asset at some future date <span class="math inline">\(T\)</span> with the price translated into the domestic currency at a fixed exchange rate. The replicating strategy is the strategy that would be followed by the seller (or by an investor who wants to create a synthetic on his own). Specifically, in this section we will determine the value at date 0 (in domestic currency) of a contract that pays <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span>, where <span class="math inline">\(\bar{X}\)</span> is a fixed exchange rate. Later in the chapter, we will consider quanto forwards and quanto options.</p>
<p>In addition to being practically useful, this contract is an excellent example for demonstrating the methodology of pricing and hedging. The best way to proceed in problems of this general type is to first value the contract and then calculate the replicating strategy.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>: we first derived the Black-Scholes formula and then found the replicating strategy (delta hedge) by differentiating the formula. As discussed in <a href="Chapter2.html#sec-s_introoptions" class="quarto-xref"><span>Section 2.4</span></a>, valuation is simplified by choosing a numeraire that will cancel the randomness in the contract payoff. Our numeraire must be a non-dividend-paying (domestic) asset price, so we can choose <span class="math inline">\(Z(t)=X(t)\mathrm{e}^{qt}S(t)\)</span> to be the numeraire asset price. This is the value in the domestic currency of a strategy that is long one unit of the foreign asset at date 0 and which reinvests the dividends of the asset into new shares. As we will see immediately, using it as numeraire introduces randomness into the payoff through the exchange rate, and that poses some complications. Applying our fundamental pricing <a href="Chapter2.html#eq-formula" class="quarto-xref">Equation&nbsp;<span>2.29</span></a>, the value of the contract is</p>
<p><span class="math display">\[
Z(0) E^Z \left[\frac{\bar{X}S(T)}{Z(T)}\right] = \mathrm{e}^{-qT}X(0)S(0)E^Z \left[\frac{\bar{X}S(T)}{X(T)S(T)}\right]
\]</span> <span id="eq-quanto"><span class="math display">\[
= \mathrm{e}^{-qT}\bar{X}S(0)E^Z \left[\frac{X(0)}{X(T)}\right]\;.
\tag{7.4}\]</span></span></p>
<p>Now we need to evaluate <span class="math inline">\(E^Z[X(0)/X(T)]\)</span>, which is the expected growth of <span class="math inline">\(1/X\)</span> when <span class="math inline">\(Z\)</span> is used as the numeraire. We will show that <span id="eq-growthreciprocalX"><span class="math display">\[
E^Z \left[\frac{X(0)}{X(T)}\right] = \exp\left\{(r_f - r-\rho\sigma_x\sigma_s)T\right\}\;.
\tag{7.5}\]</span></span></p>
<p>This implies:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The value at date 0 of a contract that pays <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span>, where <span class="math inline">\(\bar{X}\)</span> is a fixed exchange rate and <span class="math inline">\(S\)</span> is the foreign price of an asset with a constant dividend yield <span class="math inline">\(q\)</span>, is <span id="eq-quanto1"><span class="math display">\[
\exp\left\{(r_f - r-q-\rho\sigma_x\sigma_s)T\right\}\bar{X}S(0)\;.
\tag{7.6}\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>##</p>
<p>We will now prove <a href="#eq-growthreciprocalX" class="quarto-xref">Equation&nbsp;<span>7.5</span></a>. The assumption that <span class="math inline">\(S\)</span> and <span class="math inline">\(X\)</span> have constant volatilities and correlation means that<br>
<span class="math display">\[\begin{align*}
\frac{\mathrm{d} X}{X} &amp;= \mu_x\,\mathrm{d} t+\sigma_x\,\mathrm{d} B_x\;,\\
\frac{\mathrm{d} S}{S} &amp;= \mu_s\,\mathrm{d} t+\sigma_s\,\mathrm{d} B_s\;,
\end{align*}\]</span> for some (possibly random) <span class="math inline">\(\mu_x\)</span> and <span class="math inline">\(\mu_s\)</span>, where <span class="math inline">\(B_s\)</span> and <span class="math inline">\(B_x\)</span> are Brownian motions with correlation equal to <span class="math inline">\(\rho\)</span>. From Ito’s formula, we have <span class="math display">\[\begin{align*}
\frac{\mathrm{d} Z}{Z} &amp;= q\,\mathrm{d} t + \frac{\mathrm{d} (XS)}{XS}\\
&amp;= \left(q+\mu_x +\mu_s+ \rho\sigma_x\sigma_s\right)\,\mathrm{d} t + \sigma_x\,\mathrm{d} B_x + \sigma_s\,\mathrm{d} B_s \\
&amp;= \left(q+\mu_x +\mu_s+ \rho\sigma_x\sigma_s\right)\,\mathrm{d} t + \sigma\left(\frac{\sigma_x}{\sigma}\,\mathrm{d} B_x + \frac{\sigma_s}{\sigma}\,\mathrm{d} B_s\right) \\
&amp;= \left(q+\mu_x +\mu_s+ \rho\sigma_x\sigma_s\right)\,\mathrm{d} t + \sigma\,\mathrm{d} B\;,
\end{align*}\]</span> where we define <span class="math inline">\(\sigma\)</span> in <a href="#eq-foreignoptiondomcurrencyvol" class="quarto-xref">Equation&nbsp;<span>7.1</span></a> and <span class="math inline">\(B\)</span> by <span class="math inline">\(B(0)=0\)</span> and <span class="math display">\[\mathrm{d} B = \frac{\sigma_x}{\sigma}\,\mathrm{d} B_x + \frac{\sigma_s}{\sigma}\,\mathrm{d} B_s\; .\]</span> As discussed in <a href="Chapter3.html#sec-s_volatilities" class="quarto-xref"><span>Section 3.12</span></a>, <span class="math inline">\(B\)</span> is a Brownian motion and <span class="math inline">\(\sigma\)</span> is the volatility of <span class="math inline">\(Z\)</span>. Notice that the correlation of <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span> is <span class="math display">\[\begin{align*}
(\mathrm{d} B)(\mathrm{d} B_x) &amp;= \left(\frac{\sigma_x}{\sigma}\,\mathrm{d} B_x + \frac{\sigma_s}{\sigma}\,\mathrm{d} B_s\right)(\mathrm{d} B_x)\\
&amp;= \frac{\sigma_x + \rho\sigma_s}{\sigma}\,\mathrm{d} t\;.
\end{align*}\]</span> Now we use <a href="Chapter3.html#eq-other11" class="quarto-xref">Equation&nbsp;<span>3.34</span></a> in <a href="Chapter3.html#sec-s_girsanov" class="quarto-xref"><span>Section 3.10</span></a> which gives the drift of an asset when another risky asset is used as the numeraire. We use <span class="math inline">\(Z\)</span> as the numeraire and <span class="math inline">\(X\)</span> as the other asset, regarding <span class="math inline">\(X\)</span> as the domestic price of an asset with dividend yield <span class="math inline">\(r_f\)</span> as before. Therefore, we substitute <span class="math inline">\(r_f\)</span> for <span class="math inline">\(q\)</span> in <a href="Chapter3.html#eq-other11" class="quarto-xref">Equation&nbsp;<span>3.34</span></a>, substitute <span class="math inline">\(\sigma\)</span> for the volatility of the numeraire asset price, substitute <span class="math inline">\(\sigma_x\)</span> for the volatility of the other asset, and substitute <span class="math inline">\((\sigma_x+\rho\sigma_s)/\sigma\)</span> for their correlation. This yields <span class="math display">\[\frac{\mathrm{d} X}{X} = \left(r-r_f+\sigma_x^2+\rho\sigma_x\sigma_s\right)\,\mathrm{d} t + \sigma_x\,\mathrm{d} B^*_x\; ,\]</span> where <span class="math inline">\(B^*_x\)</span> is a Brownian motion when <span class="math inline">\(Z\)</span> is the numeraire.<br>
Now we apply Ito’s formula for ratios to obtain <span class="math display">\[\begin{align*}
\frac{\mathrm{d} (1/X)}{1/X} &amp;= -\frac{\mathrm{d} X}{X} + \left(\frac{\mathrm{d} X}{X}\right)^2\\
&amp;= \left(r_f-r-\rho\sigma_x\sigma_s\right)\,\mathrm{d} t + \sigma_x\,\mathrm{d} B^*_x\;.
\end{align*}\]</span> This implies that <span class="math inline">\(1/X\)</span> is a geometric Brownian motion with growth rate <span class="math inline">\(r_f-r-\rho\sigma_x\sigma_s\)</span>, from which <a href="#eq-growthreciprocalX" class="quarto-xref">Equation&nbsp;<span>7.5</span></a> follows.</p>
</div>
</div>
</section>
<section id="sec-s_replicatingquantos" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="sec-s_replicatingquantos"><span class="header-section-number">7.6</span> Replicating Quantos</h2>
<p>The assets we will use to replicate the payoff <span class="math inline">\(\bar{X}S(T)\)</span> are the foreign asset with price <span class="math inline">\(S\)</span>, the foreign risk-free asset, and the domestic risk-free asset. At the end of this section, we will explain how to replace the foreign risk-free asset with currency forwards, as discussed in <a href="#sec-s_currencyforwards" class="quarto-xref"><span>Section 7.4</span></a>. Before beginning the calculations, we can make the following intuitive observations:</p>
<ul>
<li>The payoff <span class="math inline">\(\bar{X}S(T)\)</span> has exposure to the foreign asset price <span class="math inline">\(S\)</span>, so the replicating portfolio must be long the foreign asset.<br>
</li>
<li>The payoff <span class="math inline">\(\bar{X}S(T)\)</span> has no exposure to the exchange rate, so the replicating portfolio cannot have any exposure to the exchange rate either. Thus, the long position in the foreign risky asset must be offset by an equal short position in the foreign risk-free asset.<br>
</li>
<li>As a result of the previous observation, the value of the replicating portfolio, displayed in <a href="#eq-quanto1" class="quarto-xref">Equation&nbsp;<span>7.6</span></a>, will equal the investment in the domestic risk-free asset.</li>
</ul>
<p>Consequently, our real task is to compute the number of shares of the foreign asset that should be held, the remainder of the replicating portfolio being thereby determined.</p>
<p>The value of the replicating portfolio at any date <span class="math inline">\(t\leq T\)</span> must be the value at date <span class="math inline">\(t\)</span> of receiving the payoff <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span>. We have calculated this value at date 0, and, clearly, <a href="#eq-quanto1" class="quarto-xref">Equation&nbsp;<span>7.6</span></a> applies to general dates <span class="math inline">\(t\)</span>, when we replace the time <span class="math inline">\(T\)</span> to maturity by <span class="math inline">\(T-t\)</span> and the asset price <span class="math inline">\(S(0)\)</span> at the date of valuation by <span class="math inline">\(S(t)\)</span>. That is, the value of the portfolio at any date <span class="math inline">\(t\leq T\)</span> must be <span class="math inline">\(V(t)\)</span> defined as <span id="eq-quanto2"><span class="math display">\[
V(t) = \exp\left\{(r_f - r-q-\rho\sigma_x\sigma_s)(T-t)\right\}\bar{X}S(t)\;.
\tag{7.7}\]</span></span></p>
<p>As just noted, we will need to invest this amount in the domestic risk-free asset at date <span class="math inline">\(t\)</span>. What remains to be done is to calculate the size of the long position in the foreign risky asset and the offsetting short position in the foreign risk-free asset.</p>
<p>From Ito’s formula, we have <span id="eq-quanto21"><span class="math display">\[
\frac{\mathrm{d} V}{V} = -(r_f - r-q-\rho\sigma_x\sigma_s)\,\mathrm{d} t + \frac{\mathrm{d} S}{S}\;.
\tag{7.8}\]</span></span></p>
<p>Equivalently, <span id="eq-quanto5"><span class="math display">\[
\mathrm{d} V =(r+q-r_f+\rho\sigma_x\sigma_s)V\,\mathrm{d} t + V\frac{\mathrm{d} S}{S}\;.
\tag{7.9}\]</span></span></p>
<p>On the other hand, consider a strategy that invests <span class="math inline">\(a(t)\)</span> units of the domestic currency in the foreign asset, <span class="math inline">\(b(t)\)</span> units of the domestic currency in the foreign risk-free asset, and <span class="math inline">\(c(t)\)</span> units of the domestic currency in the domestic risk-free asset. Let <span class="math inline">\(W=a+b+c\)</span> denote the value of this portfolio. The return on the foreign asset, per unit of domestic currency invested, is</p>
<p><span class="math display">\[
\frac{\mathrm{d} (X\mathrm{e}^{qt}S)}{X\mathrm{e}^{qt}S} = q\,\mathrm{d} t+\frac{\mathrm{d} X}{X} + \frac{\mathrm{d} S}{S} + \left(\frac{\mathrm{d} X}{X} \right)\left( \frac{\mathrm{d} S}{S}\right)
\]</span> <span id="eq-quanto200"><span class="math display">\[
= (q+\rho\sigma_x\sigma_s)\,\mathrm{d} t+\frac{\mathrm{d} X}{X} + \frac{\mathrm{d} S}{S}\;.
\tag{7.10}\]</span></span></p>
<p>Similarly, the rate of return on the foreign risk-free asset is <span id="eq-quanto300"><span class="math display">\[
\frac{\mathrm{d} (\mathrm{e}^{r_ft}X)}{\mathrm{e}^{r_ft}X} = r_f\,\mathrm{d} t + \frac{\mathrm{d} X}{X}\;,
\tag{7.11}\]</span></span></p>
<p>and of course the rate of return on the domestic risk-free asset is <span class="math inline">\(r\,\mathrm{d} t\)</span>. Therefore, the change in the value of the portfolio will be</p>
<p><span class="math display">\[
\mathrm{d} W = a\left[(q+\rho\sigma_x\sigma_s)\,\mathrm{d} t+\frac{\mathrm{d} X}{X} + \frac{\mathrm{d} S}{S}\right] + b\left[r_f\,\mathrm{d} t + \frac{\mathrm{d} X}{X}\right] + cr\,\mathrm{d} t
\]</span> <span id="eq-quanto6"><span class="math display">\[
=( aq+a\rho\sigma_x\sigma_s + br_f+cr)\,\mathrm{d} t +  (a+b)\frac{\mathrm{d} X}{X} +a \frac{\mathrm{d} S}{S}\; .
\tag{7.12}\]</span></span></p>
<p>The change <a href="#eq-quanto6" class="quarto-xref">Equation&nbsp;<span>7.12</span></a> of the portfolio value will match the change <a href="#eq-quanto5" class="quarto-xref">Equation&nbsp;<span>7.9</span></a> of <span class="math inline">\(V\)</span> if and only if <span id="eq-quanto7"><span class="math display">\[
a= V, \qquad b= -V, \qquad c = V\;.
\tag{7.13}\]</span></span></p>
<p>This implies:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The strategy that replicates the payoff <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span> is to invest <span class="math inline">\(V(t)\)</span> units of domestic currency in the foreign asset, where <span class="math inline">\(V(t)\)</span> is defined in <a href="#eq-quanto2" class="quarto-xref">Equation&nbsp;<span>7.7</span></a>. This will purchase <span id="eq-quanto4"><span class="math display">\[
\frac{V(t)}{X(t)S(t)} = \frac{\bar{X}}{X(t)}\exp\left\{(r_f - r-q-\rho\sigma_x\sigma_s)(T-t)\right\}
\tag{7.14}\]</span></span></p>
<p>shares of the foreign asset. This position is financed entirely by borrowing at the foreign risk-free rate. On the other hand, the same amount <span class="math inline">\(V(t)\)</span> of the domestic currency is invested in the domestic risk-free asset.</p>
</div>
</div>
<p>From our analysis at the end of <a href="#sec-s_currencyforwards" class="quarto-xref"><span>Section 7.4</span></a>, we know that the foreign risk-free asset in this replicating strategy can be replaced by currency forwards. The strategy here involves borrowing at the foreign risk-free rate, so we should replace long by short in <a href="#eq-mmhedge" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>. Borrowing <span class="math inline">\(V(t)\)</span> units of domestic currency means borrowing <span class="math inline">\(V(t)/X(t)\)</span> units of the foreign currency. Therefore, <a href="#eq-mmhedge" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> gives us:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>An equivalent strategy for replicating the payoff <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span> is to invest <span class="math inline">\(V(t)\)</span> units of domestic currency in the foreign asset and to be short <span class="math inline">\(\mathrm{e}^{r_f(T-t)}V(t)/X(t)\)</span> currency forwards at date <span class="math inline">\(t\)</span>.</p>
</div>
</div>
<p>At the beginning of the previous section, we noted that an investor who wants to bet on a foreign asset but does not want the exchange rate exposure could simply buy the asset and sell the currency forward. This shows how much of the asset he should buy and how much currency he should sell forward.</p>
<p>It is important to note that this strategy involves continuously buying and selling forwards, just as it involves continuously trading the foreign asset. Buying at date <span class="math inline">\(t\)</span> a forward contract sold at date <span class="math inline">\(s&lt;t\)</span> cancels the delivery obligation on the contract sold at <span class="math inline">\(s\)</span> and leaves a cash flow of <span class="math inline">\(F(s)-F(t)\)</span> to be paid/received at the maturity date <span class="math inline">\(T\)</span>. Therefore, the strategy accumulates a liability or asset, depending on the direction the forward price moves, to be received at <span class="math inline">\(T\)</span>. On the other hand, maintaining an investment of <span class="math inline">\(V(t)\)</span> in the foreign asset will generate cash flows as the asset is sold or purchased over time. As <a href="#eq-quanto4" class="quarto-xref">Equation&nbsp;<span>7.14</span></a> shows, whether it is sold or purchased depends on the direction the exchange rate moves. These cash flows should be invested or borrowed at the domestic risk-free rate. Thus, there is a liability or asset to be received at date <span class="math inline">\(T\)</span> that is not shown in the boxed statement immediately above, and there is an investment or liability in the domestic risk-free asset that is not shown. It can be demonstrated that these cancel each other: if profits are made from trading forwards, then they (more precisely, their present value) will be consumed by the cost of buying the foreign asset, and vice versa. Hedging with forwards (and with futures) is considered in more detail in <a href="Chapter8.html#sec-s_hedgingforwards" class="quarto-xref"><span>Section 8.9</span></a>.</p>
</section>
<section id="sec-s_quantoforwards" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="sec-s_quantoforwards"><span class="header-section-number">7.7</span> Quanto Forwards</h2>
<p>In this section, we consider a contract similar to that of the previous section, except that it is a pure forward, meaning that the payment for the contract occurs at date <span class="math inline">\(T\)</span>. We maintain all of the assumptions of the previous section. The payment at date <span class="math inline">\(T\)</span> is in domestic currency, and we define the quanto forward price in units of domestic currency. Specifically, a long quanto forward contract, initiated at date <span class="math inline">\(t\)</span> and maturing at date <span class="math inline">\(T\)</span> and initiated at the forward price <span class="math inline">\(F^*(t)\)</span> will pay <span class="math display">\[\bar{X}S(T)-F^*(t)\]</span> at date <span class="math inline">\(T\)</span>. The forward price <span class="math inline">\(F^*(t)\)</span> should be the price that makes this contract have a value of 0 at date <span class="math inline">\(t\)</span>.</p>
<p>We already know how to replicate the underlying payoff <span class="math inline">\(\bar{X}S(T)\)</span> of the forward contract at the cost <span class="math inline">\(V(t)\)</span> defined in <a href="#eq-quanto2" class="quarto-xref">Equation&nbsp;<span>7.7</span></a>. Thus, the synthetic quanto forward is to purchase the replicating strategy and to borrow the cost <span class="math inline">\(V(t)\)</span> at the domestic risk-free rate. This leads to the liability <span class="math inline">\(\mathrm{e}^{r(T-t)}V(t)\)</span> at date <span class="math inline">\(T\)</span>. Therefore, we have:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The quanto forward price is <span id="eq-quantoforward0"><span class="math display">\[
F^*(t) = \mathrm{e}^{r(T-t)}V(t) = \exp\left\{(r_f - q-\rho\sigma_x\sigma_s)(T-t)\right\}\bar{X}S(t)\;.
\tag{7.15}\]</span></span></p>
</div>
</div>
<p>Notice that borrowing <span class="math inline">\(V\)</span> in domestic currency to finance the replicating strategy of the previous section — i.e., the domestic currency investments described in <a href="#eq-quanto7" class="quarto-xref">Equation&nbsp;<span>7.13</span></a> — means eliminating the domestic risk-free investment <span class="math inline">\(c=V\)</span> required in the previous section. The replicating strategy for the quanto forward is simply to invest <span class="math inline">\(V\)</span> in the foreign asset and to finance the investment entirely by borrowing at the foreign risk-free rate. As in the previous section, borrowing at the foreign risk-free rate can be replaced by borrowing at the domestic risk-free rate and selling currency forwards.</p>
</section>
<section id="sec-s_quantooptions" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="sec-s_quantooptions"><span class="header-section-number">7.8</span> Quanto Options</h2>
<p>Consider now a European call option on a foreign asset, with strike <span class="math inline">\(K\)</span> set in the domestic currency and the value of the foreign asset being converted to domestic currency at a fixed exchange rate <span class="math inline">\(\bar{X}\)</span>. This is called a quanto call. We maintain all the assumptions of the previous two sections.</p>
<p>The value of the quanto call at maturity is <span class="math inline">\(\max(0, \bar{X}S(T)-K)\)</span>. To value this, we make use of what we learned in <a href="#sec-s_quantos" class="quarto-xref"><span>Section 7.5</span></a>. Namely, the portfolio with value <span class="math inline">\(V\)</span> defined in <a href="#eq-quanto2" class="quarto-xref">Equation&nbsp;<span>7.7</span></a> replicates the payoff <span class="math inline">\(\bar{X}S(T)\)</span>: in each state of the world, <span class="math inline">\(V(T) = \bar{X}S(T)\)</span>. Therefore, the quanto call is equivalent to a standard European call on the portfolio with domestic currency price <span class="math inline">\(V\)</span>. The value is therefore given by the Black-Scholes formula. From <a href="#eq-quanto21" class="quarto-xref">Equation&nbsp;<span>7.8</span></a> for the dynamics of <span class="math inline">\(V\)</span>, we see that the volatility of <span class="math inline">\(V\)</span> is the same as that of <span class="math inline">\(S\)</span>; therefore, we should input <span class="math inline">\(\sigma_s\)</span> as the volatility in the Black-Scholes formula. Furthermore, the portfolio <span class="math inline">\(V\)</span> is non-dividend-paying (it is the value of a claim to <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span> with no interim cash flows), so the dividend rate in the Black-Scholes formula should be zero. Thus, we have:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The value of a quanto call is</p>
<p><span class="math display">\[\begin{multline}
V(0)\mathrm{N}(d_1) - \mathrm{e}^{-rT}K\mathrm{N}(d_2) \\= \exp\left\{(r_f - r-q-\rho\sigma_x\sigma_s)T\right\}\bar{X}S(0)\mathrm{N}(d_1) - \mathrm{e}^{-rT}K\mathrm{N}(d_2)\;,
\end{multline}\]</span> {#eq-quantocall21}</p>
<p>where</p>
<p><span class="math display">\[
d_1 = \frac{\log\left(\frac{V(0)}{K}\right)+\left(r+\frac{1}{2}\sigma_s^2\right)T}{\sigma_s\sqrt{T}}
\]</span> <span class="math display">\[
= \frac{\log\left(\frac{\bar{X}S(0)}{K}\right)+\left(r_f-q-\rho\sigma_x\sigma_s+\frac{1}{2}\sigma_s^2\right)T}{\sigma_s\sqrt{T}}\; ,
\]</span> <span class="math display">\[
d_2 = d_1 - \sigma_s\sqrt{T}\;.
\]</span></p>
<p>Likewise, the value of a quanto put is given by the Black-Scholes formula: <span class="math display">\[\mathrm{e}^{-rT}K\mathrm{N}(-d_2) - V(0)\mathrm{N}(-d_1)\; .\]</span></p>
</div>
</div>
<p>Notice that this is simply the Black-Scholes call option formula with inputs <span class="math inline">\(V(0)=\)</span> initial asset price, <span class="math inline">\(K=\)</span> exercise price, <span class="math inline">\(r=\)</span> interest rate, <span class="math inline">\(\sigma_s=\)</span> volatility, <span class="math inline">\(0=\)</span> dividend yield, and <span class="math inline">\(T=\)</span> time to maturity.</p>
<p>We can hedge a written quanto call the same way we hedge a written ordinary call: we buy delta shares of the underlying and borrow the difference between the cost of the delta shares and the option value. However, for the quanto call, the underlying should be regarded as the portfolio with value <span class="math inline">\(V\)</span> described in <a href="#sec-s_quantos" class="quarto-xref"><span>Section 7.5</span></a>. This portfolio consists of investing <span class="math inline">\(V(0)\)</span> units of domestic currency in the foreign asset, borrowing the same amount at the foreign risk-free rate, and investing <span class="math inline">\(V(0)\)</span> units of domestic currency in the domestic risk-free asset. The delta of the call is <span class="math inline">\(\mathrm{N}(d_1)\)</span>, so the hedge consists of investing <span class="math inline">\(\mathrm{N}(d_1)V(0)\)</span> units of domestic currency in the foreign asset, borrowing the same amount at the foreign risk-free rate, and investing <span class="math inline">\(\mathrm{N}(d_1)V(0)\)</span> in the domestic risk-free asset. The difference between the cost of this portfolio and the value of the option is <span class="math display">\[\mathrm{N}(d_1)V(0) - [V(0)\mathrm{N}(d_1) - \mathrm{e}^{-rT}K\mathrm{N}(d_2)] = \mathrm{e}^{-rT}K\mathrm{N}(d_2)\; .\]</span> This amount is to be borrowed at the domestic risk-free rate. Thus, the net investment in the domestic risk-free asset is <span class="math display">\[\mathrm{N}(d_1)V(0) - \mathrm{e}^{-rT}K\mathrm{N}(d_2)\; ,\]</span> which is just the value of the option. To summarize:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To delta-hedge a written quanto call, one should invest <span class="math inline">\(\mathrm{N}(d_1)V(0)\)</span> units of domestic currency in the foreign asset, borrow the same amount at the foreign risk-free rate, and invest the value of the option in the domestic risk-free asset.</p>
</div>
</div>
<p>As in <a href="#sec-s_replicatingquantos" class="quarto-xref"><span>Section 7.6</span></a>, borrowing <span class="math inline">\(\mathrm{N}(d_1)V(0)\)</span> units of domestic currency at the foreign risk-free rate can be replaced by borrowing the same amount at the domestic risk-free rate and selling <span class="math inline">\(\mathrm{e}^{r_fT}\mathrm{N}(d_1)V(0)/X(0)\)</span> currency forwards. This results in:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>An equivalent delta hedge for a written quanto call is to invest <span class="math inline">\(\mathrm{N}(d_1)V(0)\)</span> units of domestic currency in the foreign asset, sell <span class="math inline">\(\mathrm{e}^{r_fT}\mathrm{N}(d_1)V(0)/X(0)\)</span> currency forward contracts at the market forward price <span class="math inline">\(F(0)\)</span>, and borrow <span class="math inline">\(\mathrm{e}^{-rT}K\mathrm{N}(d_2)\)</span> at the domestic risk-free rate.</p>
</div>
</div>
</section>
<section id="sec-s_returnswaps" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="sec-s_returnswaps"><span class="header-section-number">7.9</span> Return Swaps</h2>
<p>There are many types and applications of return swaps, but here is one important example that involves the concepts discussed in this chapter. Suppose an investor wants to receive at date <span class="math inline">\(T\)</span> the difference in the rates of return of two assets that are denominated in different currencies. The return will be calculated on a given notional principal. For example, an investor may want to receive at the end of a year the Nikkei rate of return minus the rate of return on the S&amp;P 500, calculated on a $1 million notional principal. If the Nikkei earns 15% over the year and the S&amp;P earns 10%, then the payment to the investor is 5% of $1 million. If the reverse happens—the Nikkei earns 10% and the S&amp;P earns 15%—then the investor must pay 5% of $1 million to the counterparty.</p>
<p>To model this, let <span class="math inline">\(S_f\)</span> denote the price of a foreign asset and <span class="math inline">\(S_d\)</span> the price of a domestic asset. Assume they have constant dividend yields <span class="math inline">\(q_f\)</span> and <span class="math inline">\(q_d\)</span>. If the returns are calculated excluding dividends, as is likely to be the case, then the payment to the investor is <span class="math display">\[\left(\frac{S_f(T)-S_f(0)}{S_f(0)} - \frac{S_d(T)-S_d(0)}{S_d(0)}\right)  A = \left(\frac{S_f(T)}{S_f(0)} - \frac{S_d(T)}{S_d(0)}\right)  A\; ,\]</span> where <span class="math inline">\(A\)</span> denotes the notional principal. Of course, the investor may want the reverse swap, and we consider this particular case only for concreteness.</p>
<p>The swap may have nonzero market value at date 0, which means that some payment will have to be made upfront. To eliminate this, we can add a swap spread into the contract, affecting the cash flow at date <span class="math inline">\(T\)</span>. This is a constant number <span class="math inline">\(a\)</span> (which may be positive or negative), and including it changes the payment to the investor to <span id="eq-returnswap1"><span class="math display">\[
\left(a+\frac{S_f(T)}{S_f(0)} - \frac{S_d(T)}{S_d(0)}\right)  A\;.
\tag{7.16}\]</span></span></p>
<p>The question we will address here is: what is the fair swap spread; i.e., for what number <span class="math inline">\(a\)</span> does the cash flow <a href="#eq-returnswap1" class="quarto-xref">Equation&nbsp;<span>7.16</span></a> have zero market value at date 0?</p>
<p>If the value is zero, then it is zero for any notional principal <span class="math inline">\(A\)</span>, so we can conveniently take <span class="math inline">\(A=1\)</span>. The cash flow consists of three pieces, all of which are to be received/paid at date <span class="math inline">\(T\)</span>: the constant <span class="math inline">\(a\)</span>, the gross return on the foreign asset, and the gross return on the domestic asset. The value at date 0 of receiving <span class="math inline">\(a\)</span> units of domestic currency is obviously <span class="math inline">\(\mathrm{e}^{-rT}a\)</span>. As we have observed several times before, the value at date 0 of receiving <span class="math inline">\(S_d(T)\)</span> units of domestic currency at date <span class="math inline">\(T\)</span> is <span class="math inline">\(\mathrm{e}^{-q_d t}S_d(0)\)</span>, because this is the cost of enough shares to accumulate to one share at date <span class="math inline">\(T\)</span> via reinvestment of dividends. Therefore, the value at date 0 of receiving <span class="math inline">\(S_d(T)/S_d(0)\)</span> at date <span class="math inline">\(T\)</span> is <span class="math inline">\(\mathrm{e}^{-q_dT}S_d(0)/S_d(0) = \mathrm{e}^{-q_dT}\)</span>.</p>
<p>What remains is to calculate the value of receiving <span class="math inline">\(S_f(T)/S_f(0)\)</span> units of domestic currency at date <span class="math inline">\(T\)</span>. We can do this by interpreting <span class="math inline">\(1/S_f(0)\)</span> as the fixed exchange rate <span class="math inline">\(\bar{X}\)</span> in the definition of a quanto.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> We need to assume as before that the foreign asset price <span class="math inline">\(S_f\)</span> and the exchange rate have constant volatilities and a constant correlation. Denoting the volatilities by <span class="math inline">\(\sigma_s\)</span> and <span class="math inline">\(\sigma_x\)</span> and the correlation by <span class="math inline">\(\rho\)</span> as before, equation~<a href="#eq-quanto1" class="quarto-xref">Equation&nbsp;<span>7.6</span></a> shows that the value of receiving <span class="math inline">\(\bar{X}S_f(T) = S_f(T)/S_f(0)\)</span> units of domestic currency at date <span class="math inline">\(T\)</span> is <span class="math display">\[\exp\left\{(r_f - r-q_f-\rho\sigma_x\sigma_s)T\right\}\; .\]</span> Adding up the pieces, the value at date 0 of the cash flow <a href="#eq-returnswap1" class="quarto-xref">Equation&nbsp;<span>7.16</span></a> (with <span class="math inline">\(A=1\)</span>) is <span class="math display">\[\mathrm{e}^{-rT}a + \exp\left\{(r_f - r-q_f-\rho\sigma_x\sigma_s)T\right\} - \mathrm{e}^{-q_dT}\; ,\]</span> so we conclude:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The fair swap spread, which equates the value at date 0 of receiving the cash flow <a href="#eq-returnswap1" class="quarto-xref">Equation&nbsp;<span>7.16</span></a> at date T to zero, is <span id="eq-fairswapspread"><span class="math display">\[
a = \exp\left\{(r-q_d)T\right\} - \exp\left\{(r_f -q_f-\rho\sigma_x\sigma_s)T\right\}\;.
\tag{7.17}\]</span></span></p>
</div>
</div>
<p>When we use numerical methods to value American and path-dependent options, as in <a href="Chapter6.html" class="quarto-xref"><span>Chapter 6</span></a>, we typically focus on the dynamics of asset prices under the risk-neutral measure. To apply these results to currency options or options on foreign assets, we need to know the dynamics of the exchange rate under the risk-neutral measure. Because we can view the exchange rate as the domestic price of an asset with the foreign risk-free rate <span class="math inline">\(r_f\)</span> being its dividend yield, we have already calculated these dynamics in equation~<a href="Chapter3.html#eq-riskneutral11" class="quarto-xref">Equation&nbsp;<span>3.32</span></a> of <a href="Chapter3.html#sec-s_girsanov" class="quarto-xref"><span>Section 3.10</span></a>. The result is:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The exchange rate <span class="math inline">\(X\)</span> must satisfy <span id="eq-uncoveredparity"><span class="math display">\[
\frac{\mathrm{d} X}{X} = (r-r_f)\,\mathrm{d} t + \sigma_x\,\mathrm{d} B^*_x
\tag{7.18}\]</span></span></p>
<p>for some process <span class="math inline">\(\sigma_x\)</span>, where <span class="math inline">\(B^*_x\)</span> is a Brownian motion under the risk-neutral measure.</p>
</div>
</div>
<p>This equation has an interesting interpretation in terms of uncovered interest parity, which is the theory that differences in interest rates across currencies will be offset on average by appreciation/depreciation of the currencies. In other words, it is the theory that the strategy of borrowing in low-interest-rate currencies to invest in high-interest-rate currencies will not earn money on average because of depreciation of the high-interest-rate currency relative to the low-interest-rate currency. It is well known that this theory is not always true in reality. However, equation~<a href="#eq-uncoveredparity" class="quarto-xref">Equation&nbsp;<span>7.18</span></a> shows that it is true when we calculate expectations using the risk-neutral measure.</p>
<p>To see the interpretation of equation~<a href="#eq-uncoveredparity" class="quarto-xref">Equation&nbsp;<span>7.18</span></a> as uncovered interest parity, suppose that the foreign interest rate <span class="math inline">\(r_f\)</span> is lower than the domestic rate <span class="math inline">\(r\)</span>. Then one may be tempted to borrow at the foreign rate and invest at the domestic rate. This would create a short position in the foreign currency. <a href="#eq-uncoveredparity" class="quarto-xref">Equation&nbsp;<span>7.18</span></a> states that the exchange rate is expected (under the risk-neutral measure) to appreciate at the rate <span class="math inline">\(r-r_f\)</span>; thus, repayment of the foreign currency will be more expensive in terms of domestic currency, offsetting the interest rate differential.</p>
</section>
<section id="exercises" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="exercises"><span class="header-section-number">7.10</span> Exercises</h2>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.1</strong></span> Create a python code to compare the values of call options on foreign assets that are (i) struck in foreign currency or (ii) struck in domestic currency. Prompt the user to input <span class="math inline">\(X(0)\)</span>, <span class="math inline">\(S(0)\)</span>, <span class="math inline">\(K\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(r_f\)</span>, <span class="math inline">\(\sigma_x\)</span>, <span class="math inline">\(\sigma_s\)</span>, <span class="math inline">\(\rho\)</span>, <span class="math inline">\(q\)</span> and <span class="math inline">\(T\)</span>. Take the strike price of the option struck in foreign currency to be <span class="math inline">\(K\)</span> and take the strike price of the option struck in domestic currency to be <span class="math inline">\(X(0)K\)</span> (so <span class="math inline">\(K\)</span> is interpreted as an amount in foreign currency). You should be able to confirm, for example, that if <span class="math inline">\(r=r_f\)</span> and <span class="math inline">\(\rho \geq 0\)</span> then the option struck in domestic currency is more valuable.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.2</strong></span> Repeat the preceding problem comparing (i) call options struck in foreign currency, versus (ii) quanto call options. Use the same inputs as in the preceding problem and take the fixed exchange rate in the quanto to be <span class="math inline">\(\bar{X}=X(0)\)</span>. You should be able to confirm, for example, that if <span class="math inline">\(r=r_f\)</span> and <span class="math inline">\(\rho \geq 0\)</span> then the option struck in foreign currency is more valuable.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.3</strong></span> Create a python code in which the user inputs <span class="math inline">\(r\)</span> and <span class="math inline">\(r_f\)</span> and the exchange rate. Compute the forward exchange rate at maturities <span class="math inline">\(T=0.1, 0.2, \dots, 2.0\)</span> and plot the forward rate against the maturity in a scatter plot. A market is said to be in contango if this curve is upward sloping and to be in backwardation if this curve is downward sloping. For currencies, what determines whether the market is in contango or in backwardation?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.4</strong></span> Create a Python function to simulate a path of the exchange rate and the forward exchange rate under the risk-neutral measure, prompting the user to input <span class="math inline">\(X(0)\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(r_f\)</span>, <span class="math inline">\(\sigma_x\)</span>, and the maturity <span class="math inline">\(T\)</span> of the forward contract.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.5</strong></span> Create a Python function to simulate a path of the exchange rate under the actual probability measure, prompting the user to input <span class="math inline">\(X(0)\)</span>, <span class="math inline">\(\sigma_x\)</span>, and the expected rate of growth <span class="math inline">\(\mu\)</span> of the exchange rate under the actual probability measure. Prompt the user also to input <span class="math inline">\(S(0)\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(r_f\)</span>, <span class="math inline">\(\sigma_s\)</span>, <span class="math inline">\(q\)</span>, <span class="math inline">\(\rho\)</span>, a fixed exchange rate <span class="math inline">\(\bar{X}\)</span>, a maturity <span class="math inline">\(T\)</span>, and a number of periods <span class="math inline">\(N\)</span>. Calculate the gain/loss from the portfolio that promises to pay <span class="math inline">\(\bar{X}S(T)\)</span> at date <span class="math inline">\(T\)</span> and uses a discretely rebalanced hedge, rebalancing at dates <span class="math inline">\(t_1,\ldots t_N=T\)</span>, where <span class="math inline">\(t_i-t_{i-1} = T/N\)</span>, similar to the calculation in the function <code>Simulated_Delta_Hedge_Profit</code>. Use the money-market hedge, which means investing <span class="math inline">\(V(0)\)</span> at date 0, holding the number of shares of the foreign asset shown in <a href="#eq-quanto4" class="quarto-xref">Equation&nbsp;<span>7.14</span></a> at each date <span class="math inline">\(t_i\)</span>, and having a short position in the foreign risk-free asset of the same value at each date <span class="math inline">\(t_i\)</span>. Cash flows generated at each date from buying/selling the foreign asset and lending/borrowing at the foreign risk-free rate should be withdrawn/deposited in the domestic risk-free asset. Note: Because of discrete rebalancing, this is not a perfect hedge, and the investment in the domestic risk-free asset will not always equal <span class="math inline">\(V(t)\)</span>.</p>
</div>
<div id="exr-e_forwardhedging" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.6</strong></span> Repeat the previous exercise using the forward contract hedge discussed in <a href="#sec-s_replicatingquantos" class="quarto-xref"><span>Section 7.6</span></a>. The cash flows generated from trading forwards cannot be withdrawn/deposited in the domestic risk-free asset, because they do not materialize until the maturity of the forward. You will have to create a variable to keep track of the net asset/liability and include it in the valuation at date <span class="math inline">\(T\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.7</strong></span> Derive the money-market hedge and the forward contract hedge for a written quanto put.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.8</strong></span> Suppose a customer has contracted with you for a return swap in which the customer will receive the cash flow <a href="#eq-returnswap1" class="quarto-xref">Equation&nbsp;<span>7.16</span></a> for some number <span class="math inline">\(a\)</span>, where <span class="math inline">\(A=1\)</span>. How can you hedge this?</p>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p> A relation analogous to covered interest parity holds for any forward contract if the underlying asset has a constant dividend yield and storage costs that are a constant proportion of the value of the units stored. For commodities, the term dividend yield must be interpreted in a broad sense, and is usually called convenience yield, <a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We did the same thing in <a href="Chapter4.html" class="quarto-xref"><span>Chapter 4</span></a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>To make sense of the units, note that the cash flow of <span class="math inline">\(S_f(T)/S_f(0)\)</span> units of domestic currency can be calculated as <span class="math inline">\(S_f(T)\)</span> units of foreign currency times <span class="math inline">\(1/S_f(0)\)</span> units of domestic currency per unit of foreign currency. Therefore, the units of <span class="math inline">\(1/S_f(0)\)</span> can be taken to be the units of an exchange rate.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter6.html" class="pagination-link" aria-label="Monte Carlo and Binomial Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Monte Carlo and Binomial Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter8.html" class="pagination-link" aria-label="Forward, Futures, and Exchange Options">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>