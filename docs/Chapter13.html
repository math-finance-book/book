<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Finance Book - 13&nbsp; Valuing Derivatives in the Extended Vasicek Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter14.html" rel="next">
<link href="./Chapter12.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Finance Book</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Asset Pricing Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Continuous-Time Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Black-Scholes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimating and Modelling Volatility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo and Binomial Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Monte Carlo and Binomial Valuation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter14.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#s_vasicek1" id="toc-s_vasicek1" class="nav-link active" data-scroll-target="#s_vasicek1"><span class="toc-section-number">14</span>  The Short Rate and Discount Bond Prices</a></li>
  <li><a href="#s_vasicek" id="toc-s_vasicek" class="nav-link" data-scroll-target="#s_vasicek"><span class="toc-section-number">15</span>  The Vasicek Model</a></li>
  <li><a href="#estimating-the-vasicek-model" id="toc-estimating-the-vasicek-model" class="nav-link" data-scroll-target="#estimating-the-vasicek-model"><span class="toc-section-number">16</span>  Estimating the Vasicek Model</a></li>
  <li><a href="#s_vasicekhedging" id="toc-s_vasicekhedging" class="nav-link" data-scroll-target="#s_vasicekhedging"><span class="toc-section-number">17</span>  Hedging in the Vasicek Model</a></li>
  <li><a href="#extensions-of-the-vasicek-model" id="toc-extensions-of-the-vasicek-model" class="nav-link" data-scroll-target="#extensions-of-the-vasicek-model"><span class="toc-section-number">18</span>  Extensions of the Vasicek Model</a></li>
  <li><a href="#s_vasicek_fitting" id="toc-s_vasicek_fitting" class="nav-link" data-scroll-target="#s_vasicek_fitting"><span class="toc-section-number">19</span>  Fitting Discount Bond Prices and Forward Rates</a></li>
  <li><a href="#s_vasicek_discounts" id="toc-s_vasicek_discounts" class="nav-link" data-scroll-target="#s_vasicek_discounts"><span class="toc-section-number">20</span>  Discount Bond Options, Caps and Floors</a></li>
  <li><a href="#s_vasicek_swaptions" id="toc-s_vasicek_swaptions" class="nav-link" data-scroll-target="#s_vasicek_swaptions"><span class="toc-section-number">21</span>  Coupon Bond Options and Swaptions</a></li>
  <li><a href="#s_captions" id="toc-s_captions" class="nav-link" data-scroll-target="#s_captions"><span class="toc-section-number">22</span>  Captions and Floortions</a></li>
  <li><a href="#s_HW_yields" id="toc-s_HW_yields" class="nav-link" data-scroll-target="#s_HW_yields"><span class="toc-section-number">23</span>  Yields and Yield Volatilities</a></li>
  <li><a href="#s_generalHW" id="toc-s_generalHW" class="nav-link" data-scroll-target="#s_generalHW"><span class="toc-section-number">24</span>  The General Hull-White Model</a></li>
  <li><a href="#calculations-in-vba" id="toc-calculations-in-vba" class="nav-link" data-scroll-target="#calculations-in-vba"><span class="toc-section-number">25</span>  Calculations in VBA</a>
  <ul class="collapse">
  <li><a href="#discount-bond-options" id="toc-discount-bond-options" class="nav-link" data-scroll-target="#discount-bond-options">Discount Bond Options</a></li>
  <li><a href="#caps" id="toc-caps" class="nav-link" data-scroll-target="#caps">Caps</a></li>
  <li><a href="#coupon-bond-options-in-the-hull-white-model" id="toc-coupon-bond-options-in-the-hull-white-model" class="nav-link" data-scroll-target="#coupon-bond-options-in-the-hull-white-model">Coupon Bond Options in the Hull-White Model</a></li>
  </ul></li>
  <li><a href="#problems" id="toc-problems" class="nav-link" data-scroll-target="#problems">Problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-c_vasicek" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>In the preceding chapter, we presented models for valuing swaptions, caps, and floors based on assumptions that certain forward rates have constant volatilities. As noted, the assumptions used to value swaptions on the one hand and caps and floors on the other are inconsistent. Because the values of fixed-income derivatives are derived from the yield curve, one can obtain a consistent model by developing a model of how the yield curve will evolve over time. In this chapter, we will give a fairly full account of one popular and relatively simple model. The next chapter contains much briefer descriptions of other models.</p>
<p>We will begin by describing the basic Vasicek model. The extended Vasicek model (of which there are several versions) includes time-dependent parameters, so that it can be fit to the yield curve at the time it is used and possibly also to other market variables, such as cap prices or yield volatilities.</p>
<section id="s_vasicek1" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> The Short Rate and Discount Bond Prices</h1>
<p>An assumption of the Vasicek model and related models discussed in the next chapter is that there is an instantaneously risk-free rate. Letting <span class="math inline">\(r(s)\)</span> denote this rate at date <span class="math inline">\(s\)</span>, the meaning of this assumption, as discussed in Sect. <a href="#s_continuouscompounding" data-reference-type="ref" data-reference="s_continuouscompounding">[s_continuouscompounding]</a>, is that there is an asset with price process <span class="math display">\[R(t) = \exp\left(\int_0^t r(s)\,\D s\right)\; .\]</span> The instantaneous rate of return on this asset is <span class="math display">\[\frac{\D R(t)}{R(t)} = r(t)\,\D t\; .\]</span> There is no random term (of the form <span class="math inline">\(\sigma\,\D B\)</span>) in this rate of return; thus, we view the return as known at date <span class="math inline">\(t\)</span>, whence the name “instantaneously risk-free.” If there were another instantaneously risk-free asset with rate of return <span class="math inline">\(\hat{r}(t)\)</span> which differed from <span class="math inline">\(r(t)\)</span> on a non-negligible set of dates and states of the world, there would be an arbitrage opportunity. Hence, we will assume there is a unique instantaneously risk-free rate. We will call this rate the “short rate.” The interpretation of the price <span class="math inline">\(R(t)\)</span> is that it is the amount that would be accumulated by date <span class="math inline">\(t\)</span>, beginning with $1 at date 0 and continuously rolling over the investment in the instantaneously risk-free asset. It is conceptually similar to the net asset value of a money market fund, so <span class="math inline">\(R\)</span> is sometimes called the price of a money market account. We will also call it an “accumulation factor.”</p>
<p>The probability measure associated with <span class="math inline">\(R\)</span> being the numeraire is called the risk-neutral measure, just as when the short rate is constant. Under the risk-neutral measure, the price <span class="math inline">\(P(t,u)\)</span> at date <span class="math inline">\(t\)</span> of a discount bond maturing at <span class="math inline">\(u\)</span> must be <span class="math display">\[\begin{equation}\label{basicbondprice}
P(t,u) = R(t) E^R_t \left[\frac{1}{R(u)}\right] = E^R_t \left[ \exp\left(-\int_t^u r(s)\,\D s\right)\right]\;,
\end{equation}\]</span> the first equality being a result of our fundamental pricing formula <a href="#formula" data-reference-type="eqref" data-reference="formula">[formula]</a> and the fact that the discount bond pays $1 at maturity and the second equality following from the definition of <span class="math inline">\(R\)</span>. Thus, a model for the evolution of the short rate under the risk-neutral measure implies a model for discount bond prices and hence the yield curve.</p>
</section>
<section id="s_vasicek" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> The Vasicek Model</h1>
<p>In the basic Vasicek model, it is assumed that <span class="math display">\[\begin{equation}\label{vasicek}
\D r(t) = \kappa\big[\theta-r(t)\big]\,\D t+\sigma\,\D B(t)
\end{equation}\]</span> for constants <span class="math inline">\(\kappa\geq 0\)</span>, <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\sigma\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. In this model, <span class="math inline">\(\theta\)</span> is the long-run mean of the short rate process and <span class="math inline">\(\kappa\)</span> is interpreted as the rate of mean reversion. When <span class="math inline">\(r(t) &gt;\theta\)</span>, the drift term will be negative and push <span class="math inline">\(r\)</span> down towards <span class="math inline">\(\theta\)</span>. Likewise, when <span class="math inline">\(r(t) &lt;\theta\)</span>, the drift term will be positive and push <span class="math inline">\(r\)</span> up towards <span class="math inline">\(\theta\)</span>. The rate at which <span class="math inline">\(r\)</span> drifts towards <span class="math inline">\(\theta\)</span> is obviously determined by <span class="math inline">\(\kappa\)</span>. <strong>We are going to depart from our convention and call <span class="math inline">\(\sigma\)</span> the “volatility” of the short rate</strong> even though <span class="math inline">\(\sigma^2\,\D t\)</span> is the instantaneous variance of <span class="math inline">\(\D r\)</span> rather than <span class="math inline">\(\D r/r\)</span>.</p>
<p>The short rate is normally distributed in the Vasicek model. Given information at date~<span class="math inline">\(t\)</span>—i.e., knowledge of <span class="math inline">\(r(t)\)</span>—then, if <span class="math inline">\(\kappa&gt;0\)</span>, the rate <span class="math inline">\(r(s)\)</span> for <span class="math inline">\(s&gt;t\)</span> is normally distributed with mean <span class="math display">\[\begin{equation}\label{vasicekmean}
\theta + \E^{-\!\kappa (s-t)}\big[r(t)-\theta\big]
\end{equation}\]</span> and variance <span class="math display">\[\begin{equation}\label{vasicekvariance}
\frac{\sigma^2\left(1-\E^{-2\kappa(s-t)}\right)}{2\kappa}\;.
\end{equation}\]</span> For any <span class="math inline">\(r(t)\)</span>, the mean converges to <span class="math inline">\(\theta\)</span> at long horizons (i.e., as <span class="math inline">\(s \rightarrow \infty\)</span>), justifying the interpretation of <span class="math inline">\(\theta\)</span> as the long run mean. In fact, the mean converges exponentially to <span class="math inline">\(\theta\)</span> at rate <span class="math inline">\(\kappa\)</span>. The variance at long horizons is <span class="math inline">\(\sigma^2/2\kappa\)</span>. On the other hand, if <span class="math inline">\(\kappa=0\)</span>, then the short rate is a Brownian motion with volatility <span class="math inline">\(\sigma\)</span>. The mean of <span class="math inline">\(r(s)\)</span> is <span class="math inline">\(r(t)\)</span> for <span class="math inline">\(s&gt;t\)</span>, and the variance of <span class="math inline">\(r(s)\)</span> is <span class="math inline">\((s-t)\sigma^2\)</span>. Thus, the uncertainty at long horizons, as measured by the variance, is unbounded when <span class="math inline">\(\kappa=0\)</span>. Whether <span class="math inline">\(\kappa\)</span> is positive or not, an implication of the normal distribution is that there is a positive probability of the short rate <span class="math inline">\(r(s)\)</span> being negative at any date <span class="math inline">\(s&gt;t\)</span>, which should not be the case for (nominal) interest rates. However, the probability of negative rates over any given horizon will be small if the variance is sufficiently small. From the formula <a href="#vasicekvariance" data-reference-type="eqref" data-reference="vasicekvariance">[vasicekvariance]</a>, we see that, when <span class="math inline">\(\kappa&gt;0\)</span>, the variance will be small if either the volatility <span class="math inline">\(\sigma\)</span> is small or the rate of mean reversion <span class="math inline">\(\kappa\)</span> is large.</p>
<p>These facts about the distribution of the short rate demonstrate the importance of assuming mean reversion (<span class="math inline">\(\kappa&gt;0\)</span>). If <span class="math inline">\(\kappa=0\)</span>, the short rate (because it is a Brownian motion) has the property that for any real number <span class="math inline">\(K\)</span>, with probability one there will be some date <span class="math inline">\(s&gt;t\)</span> such that <span class="math inline">\(r(s)&gt;K\)</span>, irrespective of the starting position <span class="math inline">\(r(t)\)</span>. Likewise, there will be some date <span class="math inline">\(s'&gt;t\)</span> such that <span class="math inline">\(r(s')&lt;-K\)</span>. Thus, the short rate “wanders” off in both directions in an unbounded way. This property may be reasonable for the logarithm of a stock price, because a stock price may become arbitrarily high or arbitrarily close to zero (implying that the logarithm is unbounded both above and below). However, it is not reasonable for an interest rate, which should exhibit more stability. The assumption of mean reversion (<span class="math inline">\(\kappa&gt;0\)</span>) provides this stability, guaranteeing that the uncertainty at long horizons is bounded and that on average the short rate will converge back to a finite long-run mean. Nevertheless, we will give results in this chapter for the case <span class="math inline">\(\kappa=0\)</span>, because this is a particularly simple model and because it is the basic building block for what is called the “continuous-time Ho-Lee model.” The actual Ho-Lee model, which is a binomial model, will be discussed in the following chapter.</p>
<p>The relative simplicity of the Vasicek model stems from the fact that under assumption <a href="#vasicek" data-reference-type="eqref" data-reference="vasicek">[vasicek]</a> the accumulation factor <span class="math inline">\(R\)</span> is lognormally distributed. Specifically, at any date <span class="math inline">\(t\)</span> and given any date <span class="math inline">\(u&gt;t\)</span>, the random variable <span class="math display">\[\int_t^u r(s)\,\D s\]</span> is normally distributed. Its mean and variance depend on the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\sigma\)</span> and the length of the time interval <span class="math inline">\(u-t\)</span>. The mean also depends on the short rate <span class="math inline">\(r(t)\)</span> at date~<span class="math inline">\(t\)</span>. Therefore, the discount bond price depends on the same things.</p>
<p>We will now present an explicit formula for discount bond prices, based on the fundamental formula <a href="#basicbondprice" data-reference-type="eqref" data-reference="basicbondprice">[basicbondprice]</a>. By taking the Itô differential of <span class="math inline">\(r(s)\)</span> in the following, one can verify that it is the solution of the Vasicek model <span class="math inline">\(\eqref{vasicek}\)</span>: <span class="math display">\[\begin{equation}\label{vasicek_sol}
r(s) =  \theta - \E^{-\!\kappa (s-t)}\big[\theta-r(t)\big]+ \sigma
\int_t^s \E^{-\!\kappa (s-y)} \,\D B(y).
\end{equation}\]</span> If <span class="math inline">\(\kappa=0\)</span>, this simplifies to <span class="math display">\[\begin{equation}\label{vasicek_sol2}
r(s) = r(t) + \sigma\int_t^s\D B(y)= r(t) + \sigma[B(s)-B(t)]\;. \tag{\ref{vasicek_sol}$'$}
\end{equation}\]</span> These equations imply the following. </p>
</section>
<section id="estimating-the-vasicek-model" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Estimating the Vasicek Model</h1>
<p>One way to choose the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span> of the Vasicek model is to imply them from market bond prices and the formula <a href="#vasicekbondcombined" data-reference-type="eqref" data-reference="vasicekbondcombined">[vasicekbondcombined]</a>. This is analogous to implying the volatility of a stock from market option prices and the Black-Scholes formula. This can also be viewed as an alternative to fitting a cubic spline, as discussed in Chap. <a href="#c_fixedincomeconcepts" data-reference-type="ref" data-reference="c_fixedincomeconcepts">[c_fixedincomeconcepts]</a>. Rather than selecting the parameters of the cubic spline to provide the best approximation to market bond prices, one can choose the Vasicek parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span>. The formula <a href="#basicbondprice" data-reference-type="eqref" data-reference="basicbondprice">[basicbondprice]</a> will then give prices of discount bonds of all maturities.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>An alternative procedure is to estimate the parameters from historical data on the short rate. The short rate is a theoretical construct and one must choose some proxy to use for empirical work, for example, the Federal Funds rate, or the yield of a short-term (typically one-month or three-month) Treasury bill. One also needs to use a proxy for the short rate when implying the parameters from market bond prices as described in the previous paragraph (or one could view the short rate as one of the parameters to be implied).</p>
<p>An issue that arises when estimating the model from historical data is that the Vasicek equation <span class="math inline">\(\eqref{vasicek}\)</span> characterizes the evolution of the short rate relative to a Brownian motion under the risk-neutral measure, whereas the historical data is governed by the actual measure. Vasicek actually assumed that <span class="math inline">\(\eqref{vasicek}\)</span> holds relative to a Brownian motion under the actual probability measure. We will write his assumption as <span class="math display">\[\begin{equation}\label{vasicekactual}
\D r(t) = \kappa^*[\theta^*-r(t)]\,\D t + \sigma^*\,\D B^*(t)\;,
\end{equation}\]</span> where <span class="math inline">\(\kappa^*\)</span>, <span class="math inline">\(\theta^*\)</span>, <span class="math inline">\(\sigma^*\)</span> are constants and <span class="math inline">\(B^*\)</span> is a Brownian motion under the actual probability measure.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Vasicek then assumed a constant “market price of risk” <span class="math inline">\(\lambda\)</span> and deduced that<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>We can estimate the parameters of <a href="#vasicekactual" data-reference-type="eqref" data-reference="vasicekactual">[vasicekactual]</a> by linear regression. Suppose we have data on a proxy for the short rate at dates <span class="math inline">\(t_0, t_1, \ldots, t_N\)</span>, with <span class="math inline">\(t_{i}-t_{i-1}=\varDelta t\)</span> for each <span class="math inline">\(i\)</span>. The solution <a href="#vasicek_sol" data-reference-type="eqref" data-reference="vasicek_sol">[vasicek_sol]</a> of the Vasicek equation <a href="#vasicek" data-reference-type="eqref" data-reference="vasicek">[vasicek]</a> for the short rate, adapted to <a href="#vasicekactual" data-reference-type="eqref" data-reference="vasicekactual">[vasicekactual]</a>, implies the following equation for the changes in the short rate:</p>
<p><span class="math display">\[\begin{multline*}
r(t_i) - r(t_{i-1}) = \left(1- \E^{-\!\kappa^* \varDelta t}\right)\theta^* -\left(1- \E^{-\!\kappa^* \varDelta t}\right)r(t_{i-1}) \\+ \sigma^*
\int_{t_{i-1}}^{t_i} \E^{-\!\kappa^* (t_i-a)} \,\D B^*(a)\; .
\end{multline*}\]</span> We can write this as <span class="math display">\[r(t_i) - r(t_{i-1}) = a + b\,r(t_{i-1}) + \varepsilon\]</span> where <span class="math inline">\(\varepsilon\)</span> is a normally distributed random variable, independent of <span class="math inline">\(r(t_{i-1})\)</span>, with mean zero and variance <span class="math display">\[\sigma^{*2}
\int_{t_{i-1}}^{t_i} \E^{-2\kappa^* (t_i-a)}\,\D a = \frac{\sigma^{*2}\left(1-\E^{-2\kappa^*\varDelta t}\right)}{2\kappa^*}\; .\]</span> We can estimate <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and the variance of <span class="math inline">\(\varepsilon\)</span> by linear regression and then obtain <span class="math inline">\(\kappa^*\)</span>, <span class="math inline">\(\theta^*\)</span> and <span class="math inline">\(\sigma^*\)</span> from the equations <span class="math display">\[\begin{align*}
a&amp; = \left(1- \E^{-\!\kappa^* \varDelta t}\right)\theta^*\; ,\\
b&amp;= -\left(1- \E^{-\!\kappa^* \varDelta t}\right)\; ,\\
\text{var}(\varepsilon) &amp;= \frac{\sigma^{*2}\left(1-\E^{-2\kappa^*\varDelta t}\right)}{2\kappa^*}\;.
\end{align*}\]</span></p>
</section>
<section id="s_vasicekhedging" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Hedging in the Vasicek Model</h1>
<p>Because the Brownian motion driving the short rate also drives all the discount bond prices, the bond prices are (instantaneously) perfectly correlated in the Vasicek model (and also in the extensions we will consider next). This is true in any model in which there is a single factor, such as the short rate, that determines all bond prices. The volatilities of the bond returns determine the hedge ratios for hedging one bond with another.</p>
<p>Equation <a href="#vasicekbond" data-reference-type="eqref" data-reference="vasicekbond">[vasicekbond]</a> and Itô’s formula (the rule that, if <span class="math inline">\(P=\E^X\)</span>, then <span class="math inline">\(\D P/P = dX + (dX)^2/2\)</span>) imply that for any date <span class="math inline">\(t\)</span> and any fixed maturity date <span class="math inline">\(u&gt;t\)</span>, we have <span class="math display">\[\begin{equation}\label{vasicekbondreturn}
\frac{\D P(t,u)}{P(t,u)} = r(t)\,\D t - \sigma b(u\!-\!t)\,\D B(t)\;.
\end{equation}\]</span> Because <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure, this equation implies that the expected rate of return on a discount bond under the risk-neutral measure is the short rate. This is not a surprise, because it is true for every asset under the risk-neutral measure. What is important in this equation is that the volatility is a non-random function of the date <span class="math inline">\(t\)</span>, given the maturity <span class="math inline">\(u\)</span>.</p>
<p>As an example, consider hedging a short two-year bond with a long position in a one-year bond at some date~<span class="math inline">\(t\)</span>.<br>
According to the formula <a href="#vasicekbondreturn" data-reference-type="eqref" data-reference="vasicekbondreturn">[vasicekbondreturn]</a>, the change in the value of the short position in the two-year bond will be <span class="math display">\[-P(t,t+2)r(t)\,\D t-P(t,t+2)\sigma b(2)\,\D B(t)\]</span> Suppose we hold <span class="math inline">\(x\)</span> units of the one-year bond as a hedge and borrow <span class="math display">\[xP(t,t+1)-P(t,t+2)\]</span> dollars at the instantaneously risk-free rate to finance the hedge. Then the change in the value of the portfolio will be <span class="math display">\[\begin{multline*}
xP(t,t+1)r(t)\,\D t+xP(t,t+1)\sigma b(1)\,\D B(t) \\- P(t,t+2)r(t)\,\D t-P(t,t+2)\sigma b(2)\,\D B(t) \\- [xP(t,t+1)-P(t,t+2)]\,r\D t \\= xP(t,t+1)\sigma b(1) \,\D B(t) -P(t,t+2)\sigma b(2)\,\D B(t)\;,
\end{multline*}\]</span> so a perfect hedge is obtained by setting <span class="math display">\[x = \frac{b(2)P(t,t+2)}{b(1)P(t,t+1)}\; .\]</span> In the case <span class="math inline">\(\kappa=0\)</span>, this simplifies to <span class="math inline">\(x=2P(t,t+2)/P(t,t+1)\)</span>, which means that the dollar value <span class="math inline">\(xP(t,t+1)\)</span> of the holding in the one-year bond is twice the dollar value of the short position in the two-year bond. One holds twice as much of the one-year bond, because it is half as volatile as the two-year bond in this model.</p>
<p>By this same reasoning, one can compute a perfect hedge for any discount bond by using another discount bond of any maturity. In fact, one can hedge any term structure derivative in this model by investing the right amount in a bond of any maturity. This is clearly overly simplistic, and such arbitrary hedges would not be used in practice.</p>
<p>There is a close connection between hedging in this model and duration hedging, as discussed in Sect.~<span class="math inline">\(\ref{s_duration}\)</span>. To see this, consider a coupon bond that at date <span class="math inline">\(t\)</span> has remaining cash flows <span class="math inline">\(C_1, ..., C_n\)</span> at dates <span class="math inline">\(t+\tau_1 &lt; \cdots &lt; t+\tau_n\)</span> and price <span class="math inline">\(P(t)\)</span>. Its price should satisfy <span class="math display">\[
P(t) = \sum_{j=1}^n C_jP(t,t+\tau_j)\;.
\]</span> In the Vasicek model, the random part of the change in the price of the coupon bond is <span class="math display">\[-\sigma\left(\sum_{j=1}^n b(\tau_j)C_jP(t,t+\tau_j)\right)\,\D B(t) \; ,\]</span> and the random part of the return is <span class="math display">\[\begin{equation}\label{vasicekcouponreturn}
-\sigma\left(\sum_{j=1}^n \frac{b(\tau_j)C_jP(t,t+\tau_j)}{P(t)}\right)\,\D B(t)\;.
\end{equation}\]</span></p>
<p>Consider the case <span class="math inline">\(\kappa=0\)</span>. Then <span class="math inline">\(b(\tau_j)=\tau_j\)</span>, so the random part of the return of the coupon bond is <span class="math display">\[-\sigma\left(\sum_{j=1}^n \frac{\tau_jC_jP(t,t+\tau_j)}{P(t)}\right)\,\D B(t)\; .\]</span> The factor in parentheses is Duration<span class="math inline">\('\)</span> defined in <a href="#newduration100" data-reference-type="eqref" data-reference="newduration100">[newduration100]</a>. Denoting it now as <span class="math inline">\(D(t)\)</span> and recognizing that the expected rate of return of the bond must be the short rate, we have, in the Vasicek model with <span class="math inline">\(\kappa=0\)</span>, <span class="math display">\[\frac{\D P(t)}{P(t)} = r(t)\,\D t - \sigma D(t)\,\D B(t)\; .\]</span> It follows that in this model one can hedge any fixed-income liability by holding enough of any coupon bond such that the dollar value multiplied by its duration equals the dollar value of the liability multiplied by its duration. In Sect. <a href="Chapter11.html#s_duration" data-reference-type="ref" data-reference="s_duration">[s_duration]</a>, we noted that duration matching works for parallel shifts in the yield curve. Later, we will see that in the Vasicek model with <span class="math inline">\(\kappa=0\)</span> only parallel shifts in the yield curve are possible. Therefore, it should not be surprising that duration matching works in this model.</p>
<p>In the case <span class="math inline">\(\kappa&gt;0\)</span>, one can interpret the volatility of the coupon bond similarly. The analogue to duration for this model is the weighted average of the function <span class="math inline">\(b(\tau_j)\)</span> of the times to maturity, as the formula <a href="#vasicekcouponreturn" data-reference-type="eqref" data-reference="vasicekcouponreturn">[vasicekcouponreturn]</a> shows. The weights again are the fractions of the bond value that each cash flow contributes.</p>
</section>
<section id="extensions-of-the-vasicek-model" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Extensions of the Vasicek Model</h1>
<p>To fit the model to current market conditions at the time the model is being used, the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span> can be taken to be time-dependent. The model with time-dependent parameters is studied in Hull and White <span class="citation" data-cites="HW">[@HW]</span> and is usually called the Hull-White model. It is convenient to denote by <span class="math inline">\(\theta(t)\)</span> the time-dependent function replacing the constant <span class="math inline">\(\kappa\theta\)</span> in the definition of the Vasicek model <a href="#vasicek" data-reference-type="eqref" data-reference="vasicek">[vasicek]</a>; that is, we redefine as <span class="math inline">\(\theta\)</span> what was previously <span class="math inline">\(\kappa\theta\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> As usual, we will let date 0 be the date at which we are using the model. The model is then, for <span class="math inline">\(t&gt;0\)</span>,</p>
<p>We will focus on the simplest case, in which <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span> are constants, deferring discussion of the general case to the last section of this chapter. The general case is quite similar, with the formulas being only slightly more complicated. So, we assume now that <span class="math display">\[\begin{equation}\label{hw5000}
\D r(t) = \theta(t)\,\D t - \kappa r(t)\,\D t + \sigma \,\D B(t)\;. \tag{\ref{hw500}$'$}
\end{equation}\]</span> for a non-random function <span class="math inline">\(\theta\)</span>.<br>
We will call this model with <span class="math inline">\(\kappa&gt;0\)</span> the Hull-White model. The model with <span class="math inline">\(\kappa=0\)</span> (i.e., in the absence of mean reversion) is called the continuous-time Ho-Lee model. We will refer to the general case <a href="#hw500" data-reference-type="eqref" data-reference="hw500">[hw500]</a> as the general Hull-White model, and we will discuss it in Sect. <a href="#s_generalHW" data-reference-type="ref" data-reference="s_generalHW">[s_generalHW]</a>. In the Hull-White model, we can interpret <span class="math inline">\(\theta(t)/\kappa\)</span> as a time-varying long-run mean of the short rate process, because we have <span class="math display">\[\D r(t) = \kappa\left[ \frac{\theta(t)}{\kappa} - r(t)\right]\,\D t + \sigma\,\D B(t)\; .\]</span></p>
<p>One can show by the following by directly differentiating. Note that <span class="math inline">\(\eqref{rhat102}\)</span> and <span class="math inline">\(\eqref{rhat103}\)</span> imply <span class="math display">\[\begin{equation}\label{rhat10001}
\D\hat{r}(t) = -\kappa \hat{r}(t)\,\D t + \sigma\,\D B(t)\; ,
\end{equation}\]</span> where <span class="math inline">\(\kappa=0\)</span> for <span class="math inline">\(\eqref{rhat103}\)</span>. Thus, <span class="math inline">\(\hat{r}\)</span> is a Vasicek short-rate process having a long-run mean of zero.</p>
<p>The virtue of the expression for <span class="math inline">\(r\)</span> given in <a href="#vasicekextension_solcombined" data-reference-type="eqref" data-reference="vasicekextension_solcombined">[vasicekextension_solcombined]</a> is that the basic bond pricing equation <a href="#basicbondprice" data-reference-type="eqref" data-reference="basicbondprice">[basicbondprice]</a> now gives us <span class="math display">\[\begin{align}
P(t,u) &amp;= E^R_t \left[ \exp\left(-\int_t^u r(s)\,\D s\right)\right]\notag\\
&amp;= E^R_t \left[ \exp\left(-\int_t^u \phi(s) + \hat{r}(s)\,\D s\right)\right]\notag\\
&amp;= E^R_t \left[ \exp\left(-\int_t^u \phi(s)\,\D s\right)\exp\left(-\int_t^u  \hat{r}(s)\,\D s\right)\right]\notag\\
&amp;= \exp\left(-\int_t^u \phi(s)\,\D s\right)E^R_t \left[ \exp\left(-\int_t^u \hat{r}(s)\,\D s\right)\right]\;.\label{vasicekpullsout}
\end{align}\]</span> Thus, the non-random part <span class="math inline">\(\phi(s)\)</span> of the short-rate process “pulls out” of the expectation in the pricing formula. Furthermore, we have already calculated the expectation in <a href="#vasicekpullsout" data-reference-type="eqref" data-reference="vasicekpullsout">[vasicekpullsout]</a> because it is the discount bond price in the Vasicek model with a long-run mean of zero. This yields the following.</p>
<p>Using the fact that the expected rate of return on a discount bond must be the short rate under the risk-neutral measure, we obtain from <a href="#extendedvasicekbond" data-reference-type="eqref" data-reference="extendedvasicekbond">[extendedvasicekbond]</a> and <a href="#rhat10001" data-reference-type="eqref" data-reference="rhat10001">[rhat10001]</a> that, for each fixed maturity date <span class="math inline">\(u\)</span>,</p>
<p><span class="math display">\[\begin{equation}\label{extendedvasicekbondreturn}
\frac{\D P(t,u)}{P(t,u)} = r(t)\,\D t - \sigma b(\tau)\,\D B(t)\;.
\end{equation}\]</span> Thus, the volatilities are determined by the function <span class="math inline">\(b\)</span>, just as in the basic Vasicek model. The computation of hedge ratios is therefore analogous to the computations presented in Sect. <a href="#s_vasicekhedging" data-reference-type="ref" data-reference="s_vasicekhedging">[s_vasicekhedging]</a> for the basic Vasicek model. In fact, the volatilities of discount bond returns in the Hull-White model are the same as in the Vasicek model with <span class="math inline">\(\kappa&gt;0\)</span>, and the volatilities in the continuous-time Ho-Lee model are the same as in the Vasicek model with <span class="math inline">\(\kappa=0\)</span>.</p>
</section>
<section id="s_vasicek_fitting" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Fitting Discount Bond Prices and Forward Rates</h1>
<p>It is simple to fit the Hull-White model and continuous-time Ho-Lee model to market discount bond prices by choosing the function <span class="math inline">\(\phi\)</span>. We will use the superscript “mkt” to denote market prices. Letting date 0 denote the date at which we are fitting the model, we want to have <span class="math display">\[P^{\text{mkt}}(0,u) = P(0,u)\]</span> for all maturities <span class="math inline">\(u\)</span>, where <span class="math inline">\(P(0,u)\)</span> denotes the model prices given in <a href="#extendedvasicekbond" data-reference-type="eqref" data-reference="extendedvasicekbond">[extendedvasicekbond]</a> as <span class="math display">\[P(0,u) = \exp\left(-\int_0^u \phi(s)\,\D s-a(u)-b(u)r(0)\right)\; .\]</span> The functions <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> depend on <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span>, but we regard them now as having already been chosen. Therefore, to match the model prices to market prices, we simply have to set <span class="math display">\[\begin{equation}\label{vasicekcalibration101}
\exp\left(-\int_0^u \phi(s)\right) = \exp\left(a(u)+b(u)r(0)\right)P^{\text{mkt}}(0,u)\;.
\end{equation}\]</span></p>
<p>Usually we will only need to solve <a href="#vasicekcalibration101" data-reference-type="eqref" data-reference="vasicekcalibration101">[vasicekcalibration101]</a> for a finite number of maturities <span class="math inline">\(u\)</span> in order to calibrate the model sufficiently. We will illustrate this in the analysis of coupon bond options in Sect. <a href="#s_vasicek_swaptions" data-reference-type="ref" data-reference="s_vasicek_swaptions">[s_vasicek_swaptions]</a>. However, the equation can be solved in principle for each maturity <span class="math inline">\(u\)</span> as follows: take the natural logarithm of both sides, multiply by minus 1, and differentiate with respect to <span class="math inline">\(u\)</span> to obtain <span class="math display">\[\begin{equation}\label{extendedvasicekforwards1}
\phi(u) = -\frac{\partial a(u)}{\partial u} - \frac{\partial b(u)}{\partial u}r(0) - \frac{ \partial \log P^{\text{mkt}}(0,u)}{\partial u}\;.
\end{equation}\]</span></p>
<p>Equation <span class="math inline">\(\eqref{extendedvasicekforwards1}\)</span> gives the solution of the model for <span class="math inline">\(\phi(u)\)</span>, and it also has an important interpretation. We can obviously rearrange it as <span class="math display">\[\begin{equation}\label{extendedvasicekforwards}
\phi(u) +\frac{\partial a(u)}{\partial u} + \frac{\partial b(u)}{\partial u}r(0) = -\frac{ \partial \log P^{\text{mkt}}(0,u)}{\partial u}\;. \tag{\ref{extendedvasicekforwards1}$'$}
\end{equation}\]</span> The expression <span class="math display">\[-\frac{\partial \log P^{\text{mkt}}(0,u)}{\partial u}\]</span> is the <em>market</em> instantaneous forward rate at date 0 for maturity <span class="math inline">\(u\)</span>. The left-hand side of <a href="#extendedvasicekforwards" data-reference-type="eqref" data-reference="extendedvasicekforwards">[extendedvasicekforwards]</a> is equal to <span class="math display">\[-\frac{\partial \log P(0,u)}{\partial u}\; ,\]</span> and hence is the <em>model</em> instantaneous forward rate at date 0 for maturity <span class="math inline">\(u\)</span>. Therefore, fitting the model to the yield curve is equivalent to fitting model forward rates to market forward rates.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>It is very important to note that if we choose the function <span class="math inline">\(\phi(t)\)</span> at date 0 to match the market, then when we want to recalibrate the model at some later date to match the market at that date, we will have to select a different <span class="math inline">\(\phi\)</span> function at the later date. In other words, we use a model today that we know we will discard as incorrect tomorrow. The <span class="math inline">\(\phi\)</span> function (as well as the <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span> functions in the general Hull-White model) is continually discarded and refit to match the market. This is an unpleasant reality, but it is not really too different from using implied volatilities in the Black-Scholes formula. We know that the implied volatility curve changes over time, so the volatility we use tomorrow may well be different from the volatility we use today. No model is every a literally correct description of the real world. As has been said, the test of the pudding is in the tasting. The test of a model is whether it generates reasonably correct values and hedges. This is an empirical question, and it is not equivalent to the question of whether the assumptions of the model are correct.</p>
</section>
<section id="s_vasicek_discounts" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Discount Bond Options, Caps and Floors</h1>
<p>We can use Black’s formula to value discount bond options in the Vasicek model and in its extensions. As explained in the previous chapter, caps and floors are portfolios of discount bond options, so the values of caps (floors) can be computed by summing the values of the individual caplets (floorlets). The reason we can apply Black’s formula is that the volatility of the forward price of a discount bond is non-random in the Vasicek model and its extensions.</p>
<p>Consider valuing at date 0 an option maturing at date <span class="math inline">\(T\)</span> on a discount bond maturing at <span class="math inline">\(u&gt;T\)</span>. Because forward must equal spot at maturity, an option written on a forward contract maturing at <span class="math inline">\(T\)</span> is equivalent.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> The forward price of the discount bond at date <span class="math inline">\(t \leq T\)</span> for a forward contract maturing at <span class="math inline">\(T\)</span> is given by</p>
<p>In the continuous-time Ho-Lee model, we have <span class="math display">\[b(u-t)-b(T-t) = u-T\; .\]</span> Therefore, the forward price has a constant volatility equal to <span class="math inline">\((u-T)\sigma\)</span>. In the Hull-White model, we have <span class="math display">\[b(u-t)-b(T-t) = \frac{1}{\kappa}\left(\E^{-\kappa(T-t)}-\E^{-\kappa(u-t)}\right) = \frac{\left(\E^{-\kappa T} - \E^{-\kappa u}\right)\E^{\kappa t}}{\kappa} \; .\]</span> Thus, the volatility is time varying (it depends on <span class="math inline">\(t\)</span>), so we compute the average volatility as in Sects.~<span class="math inline">\(\ref{s_timevaryingvolatility}\)</span> and~<span class="math inline">\(\ref{s_volatility}\)</span>. Specifically, <span class="math display">\[\begin{align}
\sigma_{\text{avg}} &amp;= \frac{\sigma\left(\E^{-\kappa T} - \E^{-\kappa u}\right)}{\kappa} \sqrt{\frac{1}{T}\int_0^T \E^{2\kappa t}\,\D t}\notag\\
&amp;=\frac{\sigma\left(\E^{-\kappa T} - \E^{-\kappa u}\right)}{\kappa}\sqrt{\frac{\E^{2\kappa T}-1}{2\kappa T}}\;.\label{vasiceksigmaavg}
\end{align}\]</span></p>
<p>Substituting <span class="math inline">\(P^{\text{mkt}}(0,u)/P^{\text{mkt}}(0,T)\)</span> as the forward price of the discount bond maturing at <span class="math inline">\(u\)</span> in Black’s formula gives the following.</p>
<p>As our notation indicates, the discount bond prices appearing in these formulas should be taken to be the <em>market</em> prices of the bonds at the date the options are valued, rather than the <em>model</em> prices. Of course, if we have fit the model to the market prices of discount bonds, there is no distinction. Using model prices that are different from market prices would be similar to inputting a stock price in the Black-Scholes formula obtained from a discounted-cash-flow analysis rather than using the market price of the stock. This is not something that one would normally do.</p>
<p>Because the discount bond volatilities are the same in the continuous-time Ho-Lee model as in the basic Vasicek model with <span class="math inline">\(\kappa=0\)</span> and are the same in the Hull-White model as in the basic Vasicek model with <span class="math inline">\(\kappa&gt;0\)</span>, the formulas for the values of discount bond options are the same in the corresponding models. These extensions of the basic Vasicek model permit one to match model bond prices to market bond prices, but they have no effect on the values of discount bond options, provided we remember to use the market prices in <a href="#vasicekdiscountcallput" data-reference-type="eqref" data-reference="vasicekdiscountcallput">[vasicekdiscountcallput]</a>.</p>
<p>As noted before, these option pricing formulas can be used to value caplets and floorlets. A caplet with reset date <span class="math inline">\(t_i\)</span> and payment date <span class="math inline">\(t_{i+1}\)</span> is equivalent, as discussed in Sect. <a href="Chapter12.html#s_caps2" data-reference-type="ref" data-reference="s_caps2">[s_caps2]</a>, to <span class="math inline">\(1+\bar{R}\,\varDelta\)</span> put options maturing at <span class="math inline">\(t_i\)</span> on the discount bond maturing at <span class="math inline">\(t_{i+1}\)</span>, with the exercise price of each option being <span class="math inline">\(1/(1+\bar{R}\,\varDelta t)\)</span>. When we make these substitutions in the above formulas (and the same for floorlets) we obtain the following. </p>
<p>A reasonable way to choose the parameter <span class="math inline">\(\sigma\)</span> in the continuous-time Ho-Lee model and the parameters <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span> in the Hull-White model would be to fit the model as well as possible to market prices of caps and/or floors. The function <span class="math inline">\(\phi(t)\)</span> can then be chosen as discussed in the preceding section.</p>
<p>We also used Black’s formula to value caplets and floorlets in Sect. <a href="Chapter12.html#s_valuingcaps" data-reference-type="ref" data-reference="s_valuingcaps">[s_valuingcaps]</a>. However, the formulas in this section and the formulas in Sect. <a href="Chapter12.html#s_valuingcaps" data-reference-type="ref" data-reference="s_valuingcaps">[s_valuingcaps]</a> give different values, because they are based on different assumptions. In the Vasicek model and its extensions, the forward price <span class="math display">\[F(t) = \frac{P(t,t_{i+1})}{P(t,t_i)}\]</span> of the discount bond corresponding to the caplet with payment date <span class="math inline">\(t_{i+1}\)</span> has a non-random volatility, and this is the assumption on which <a href="#vasicekcapletfloorlet" data-reference-type="eqref" data-reference="vasicekcapletfloorlet">[vasicekcapletfloorlet]</a> is based. In Sect. <a href="Chapter12.html#s_valuingcaps" data-reference-type="ref" data-reference="s_valuingcaps">[s_valuingcaps]</a>, we assumed the forward LIBOR rate had a non-random volatility. The definition <a href="#forward2" data-reference-type="eqref" data-reference="forward2">[forward2]</a> of the forward rate is <span class="math display">\[R_i(t) = \frac{P(t,t_i)}{P(t,t_{i+1})} - 1 = \frac{1}{F(t)}-1\; .\]</span> If the forward price has a non-random volatility, then the forward rate is the sum of a variable (<span class="math inline">\(1/F(t)\)</span>) with a constant volatility and a constant (<span class="math inline">\(-1\)</span>) and hence will have a random volatility. Likewise, if the forward rate has a non-random volatility, then the forward price will have a random volatility. Therefore, the assumptions of the two models are inconsistent.</p>
</section>
<section id="s_vasicek_swaptions" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Coupon Bond Options and Swaptions</h1>
<p>In this section, we will discuss the valuation of coupon bond options in the extended Vasicek models. As discussed in Sect. <a href="Chapter12.html#s_swaptionscouponbondoptions" data-reference-type="ref" data-reference="s_swaptionscouponbondoptions">[s_swaptionscouponbondoptions]</a>, swaptions are equivalent to options on coupon bonds, so the valuation methods can also be applied to swaptions.</p>
<p>Consider a bond paying a coupon of $<span class="math inline">\(c\)</span> at dates <span class="math inline">\(t_1, t_2, \ldots, t_N\)</span> and its face value of $1 at date <span class="math inline">\(t_N\)</span>. Consider a European call option on the bond maturing at date <span class="math inline">\(T\)</span>. In the case of a European swaption, all of the coupon payment dates occur after the option maturity (<span class="math inline">\(t_i &gt; T\)</span> for <span class="math inline">\(i=1,\ldots,N\)</span>), and the coupon is taken to be <span class="math inline">\(c=\bar{R}\,\varDelta t\)</span>, where <span class="math inline">\(\bar{R}\)</span> is the swap rate. In the case of an option on a coupon bond, some of the coupons may occur before the option maturity, but naturally the value of the option depends only on the coupons that occur after the option matures, because those are the only coupons to which an exerciser of the option would be entitled. By focusing only on those coupons, we can take <span class="math inline">\(t_i &gt; T\)</span> for <span class="math inline">\(i=1,\ldots,N\)</span>.</p>
<p>A coupon bond is a portfolio of discount bonds, so an option on a coupon bond is an option on a portfolio of discount bonds. In general, an option on a portfolio is worth less than a portfolio of options, so an option on a coupon bond should be worth less than a portfolio of discount bond options. However, in any “single-factor” model, it is possible to define the strike prices of the discount bond options so that the option on the coupon bond is worth exactly the same as a portfolio of discount bond options.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> This reduces the valuation problem for coupon bond options to the problem of valuing discount bond options, which we have already solved for this model. We will use the same technique in Sect. <a href="#s_captions" data-reference-type="ref" data-reference="s_captions">[s_captions]</a> to value options on caps (“captions”) and options on floors (“floortions”).</p>
<p>As shown in <a href="#extendedvasicekbond" data-reference-type="eqref" data-reference="extendedvasicekbond">[extendedvasicekbond]</a>, the single factor that determines all discount bond prices in this model is the random variable <span class="math inline">\(\hat{r}\)</span>. We let <span class="math inline">\(r^*\)</span> denote the value of <span class="math inline">\(\hat{r}(T)\)</span> such that, according to the model, the coupon bond option will be at the money at maturity when <span class="math inline">\(\hat{r}(T)=r^*\)</span>. Being at the money means of course that <span class="math display">\[\begin{equation}\label{swaptions101}
\sum_{i=1}^N cP(T,t_i) + P(T,t_N) = K\;.
\end{equation}\]</span> Thus, based on the formula <span class="math inline">\(\eqref{extendedvasicekbond}\)</span> for the discount bond prices, we define~<span class="math inline">\(r^*\)</span> by <span class="math display">\[\begin{multline}\label{swaptions102}
\sum_{i=1}^N c\exp\left(-\int_T^{t_i} \phi(s)\,\D s-a(t_i-T)-b(t_i-T)r^*\right) \\+ \exp\left(-\int_T^{t_N} \phi(s)\,\D s-a(t_N-T)-b(t_N-T)r^*\right) = K\;. \tag{\ref{swaptions101}$'$}
\end{multline}\]</span> According to the model, if <span class="math inline">\(\hat{r}(T)\)</span> is lower than <span class="math inline">\(r^*\)</span>, then the bond prices will be higher and the call option will be in the money; conversely, if <span class="math inline">\(\hat{r}(T)\)</span> is higher than <span class="math inline">\(r^*\)</span>, then the bond prices will be lower and the call option will be out of the money.</p>
<p>For <span class="math inline">\(i=1,\ldots,N\)</span>, define <span class="math inline">\(K_i\)</span> to be the model value of the discount bond price <span class="math inline">\(P(T,t_i)\)</span> when <span class="math inline">\(\hat{r}(T)=r^*\)</span>. In other words, define <span class="math inline">\(K_i\)</span> as <span class="math display">\[\begin{equation}\label{swaptions103}
K_i = \exp\left(-\int_T^{t_i} \phi(s)\,\D s-a(t_i-T)-b(t_i-T)r^*\right)\;.
\end{equation}\]</span> Note that equations <span class="math inline">\(\eqref{swaptions102}\)</span> and <span class="math inline">\(\eqref{swaptions103}\)</span> imply <span class="math display">\[\begin{equation}\label{swaption100000}
\sum_{i=1}^N cK_i + K_N = K\; .
\end{equation}\]</span></p>
<p>Consider for each <span class="math inline">\(i\)</span> (<span class="math inline">\(i=1,\ldots,N\)</span>) a hypothetical call option maturing at~<span class="math inline">\(T\)</span> with the underlying for the option being the discount bond maturing at <span class="math inline">\(t_i\)</span>. Let <span class="math inline">\(K_i\)</span> be the exercise price of option <span class="math inline">\(i\)</span>. According to the model, the value of the underlying at date~<span class="math inline">\(T\)</span> for option~<span class="math inline">\(i\)</span> will be <span class="math display">\[P(T,t_i) = \exp\left(-\int_T^{t_i} \phi(s)\,\D s-a(t_i-T)-b(t_i-T)\hat{r}(T)\right)\; .\]</span> By the definition of <span class="math inline">\(K_i\)</span>, therefore, option~<span class="math inline">\(i\)</span> will be in the money if and only if <span class="math inline">\(\hat{r}(T) &lt; r^*\)</span>. Thus, all of the options are in (or out) of the money in the same circumstances.</p>
<p>Now consider the portfolio consisting of <span class="math inline">\(c\)</span> units of option <span class="math inline">\(i\)</span> for <span class="math inline">\(i=1,\ldots,N-1\)</span> and <span class="math inline">\(1+c\)</span> units of option <span class="math inline">\(N\)</span>. According to the model, the value of the portfolio will be zero at date <span class="math inline">\(T\)</span> if <span class="math inline">\(\hat{r}(T) \geq r^*\)</span>, and, if <span class="math inline">\(\hat{r}(T)&lt;r^*\)</span>, it follows from <a href="#swaption100000" data-reference-type="eqref" data-reference="swaption100000">[swaption100000]</a> that the value of the portfolio will be <span class="math display">\[
\sum_{i=1}^{N-1}c\big[P(t,t_i)-K_i\big]+ (1+c)\big[P(t,T_N)-K_N\big]
= \sum_{i=1}^NcP(t,t_i)+ P(t,T_N) - K,
\]</span> which is the intrinsic value of the coupon bond option when <span class="math inline">\(r(T)&lt;r^*\)</span>. Therefore, according to the model, the coupon bond option is equivalent to this portfolio of discount bond options. We can value the discount bond options from the formulas in the previous section and then value the portfolio and hence the coupon bond option by summing. The same type of reasoning also allows us to value put options on coupon bonds.</p>
<p>The only issue in implementing this method is that we need to compute the exercise prices <span class="math inline">\(K_i\)</span>. Of course, we define them by <a href="#swaptions103" data-reference-type="eqref" data-reference="swaptions103">[swaptions103]</a>, given <span class="math inline">\(r^*\)</span>. To do this requires that we calculate the factor <span class="math display">\[\begin{equation}\label{vasicekfactor100}
\exp\left(-\int_T^{t_i} \phi(s)\,\D s\right),
\end{equation}\]</span> by fitting the model to market bond prices, as discussed in Sect. <a href="#s_vasicek_fitting" data-reference-type="ref" data-reference="s_vasicek_fitting">[s_vasicek_fitting]</a>. We will explain this more explicitly in the next paragraph. In order to apply equation <a href="#swaptions103" data-reference-type="eqref" data-reference="swaptions103">[swaptions103]</a>, we need to compute <span class="math inline">\(r^*\)</span>, which is given by equation <a href="#swaptions102" data-reference-type="eqref" data-reference="swaptions102">[swaptions102]</a>. We can solve <a href="#swaptions102" data-reference-type="eqref" data-reference="swaptions102">[swaptions102]</a> for <span class="math inline">\(r^*\)</span> by bisection or some other root-finding method. Again, we need to know the factors <a href="#vasicekfactor100" data-reference-type="eqref" data-reference="vasicekfactor100">[vasicekfactor100]</a> in order to solve this equation.</p>
<p>To compute the factors <span class="math inline">\(\eqref{vasicekfactor100}\)</span>, we use <span class="math inline">\(\eqref{vasicekcalibration101}\)</span>. We repeat it here twice, for maturity dates <span class="math inline">\(t_i\)</span> and <span class="math inline">\(T\)</span>: <span class="math display">\[\begin{align*}
\exp\left(-\int_0^{t_i} \phi(s)\,\D s\right) &amp;= \exp\left(a(t_i)+b(t_i)r(0)\right)P^{\text{mkt}}(0,t_i)\; ,\\
\exp\left(-\int_0^{T} \phi(s)\,\D s\right) &amp;= \exp\left(a(T)+b(T)r(0)\right)P^{\text{mkt}}(0,T)\;.
\end{align*}\]</span> If we divide the top equation by the bottom, then on the left-hand side we obtain <span class="math display">\[\begin{align*}
\frac{\exp\left(-\int_0^{t_i} \phi(s)\,\D s\right)}{\exp\left(-\int_0^{T} \phi(s)\,\D s\right)} &amp;= \exp\left(-\int_0^{t_i} \phi(s)\,\D s + \int_0^{T} \phi(s)\,\D s\right) \\
&amp;= \exp\left(-\int_T^{t_i} \phi(s)\,\D s\right)\; ,
\end{align*}\]</span> which is the number we want. Hence, we obtain by dividing the right-hand sides of the above equations: <span class="math display">\[\begin{equation}\label{swaptions104}
\exp\left(-\int_T^{t_i} \phi(s)\,\D s\right) = \exp\left\{a(t_i)-a(T) + [b(t_i)-b(T)]r(0)\right\}\frac{P^{\text{mkt}}(0,t_i)}{P^{\text{mkt}}(0,T)}\;.
\end{equation}\]</span></p>
</section>
<section id="s_captions" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Captions and Floortions</h1>
<p>In this section, we will consider options on caps and floors, which are sometimes called “captions” and “floortions” respectively. For specificity, we will consider a call option on a cap. A cap is a portfolio of caplets, and each caplet is a call option on a spot rate. Therefore a call option on a cap is a call option on a portfolio of calls on spot rates and hence is a bet on (or insurance against) high spot rates.</p>
<p>Of course, high spot rates are equivalent to low bond prices, so a call on a cap can also be seen as a bet on low bond prices. We will actually take this latter approach and view a cap as a portfolio of put options on discount bonds, as in Sect. <a href="#s_vasicek_discounts" data-reference-type="ref" data-reference="s_vasicek_discounts">[s_vasicek_discounts]</a>. This means that we will analyze a call option on a cap as a call on a portfolio of puts. We will use the trick of the previous section and reduce this call on a portfolio of puts to a portfolio of calls on puts. Each call on a put is a compound option and can be valued as in Chap. <a href="#c_exotics" data-reference-type="ref" data-reference="c_exotics">[c_exotics]</a>. The assumptions made in Chap. <a href="#c_exotics" data-reference-type="ref" data-reference="c_exotics">[c_exotics]</a> for compound options are valid here, because the forward prices of the discount bonds (which are the underlyings for the puts) have non-random volatilities in the extended Vasicek models.</p>
<p>Consider a cap with reset dates <span class="math inline">\(t_0,\ldots t_{N-1}\)</span> and payment dates <span class="math inline">\(t_1,\ldots, t_N\)</span>, with <span class="math inline">\(t_{i+1}-t_i=\varDelta t\)</span> for each <span class="math inline">\(i\)</span>. Let <span class="math inline">\(\bar{R}\)</span> denote the fixed rate on the cap. We consider a call option on the cap maturing at date <span class="math inline">\(T \leq t_0\)</span> and having exercise price <span class="math inline">\(K\)</span>. In the model, the value of the cap at the option maturity will depend on the random variable <span class="math inline">\(\hat{r}(T)\)</span>. As in the previous section, we will let <span class="math inline">\(r^*\)</span> denote the value of <span class="math inline">\(\hat{r}(T)\)</span> such that the call option on the cap is at the money at date <span class="math inline">\(T\)</span> when <span class="math inline">\(\hat{r}(T)=r^*\)</span>. If <span class="math inline">\(\hat{r}(T)&gt;r^*\)</span> then the cap will be more valuable, so the call will be in the money; conversely if <span class="math inline">\(\hat{r}(T)&lt;r^*\)</span> the call will be out of the money. Also, similar again to the previous section, we will let <span class="math inline">\(K_i\)</span> denote the value of the caplet with reset date <span class="math inline">\(t_i\)</span> and payment date <span class="math inline">\(t_{i+1}\)</span> (<span class="math inline">\(i=0,\ldots,N-1\)</span>) when <span class="math inline">\(\hat{r}(T)=r^*\)</span>. We consider hypothetical call options on the individual caplets with exercise prices <span class="math inline">\(K_i\)</span>. If <span class="math inline">\(\hat{r}(T)&gt;r^*\)</span>, then, according to the model, all of the calls on the caplets will be in the money, and the sum of their values will equal the value of the call on the cap. On the other hand, if <span class="math inline">\(\hat{r}(T)&lt;r^*\)</span> then all of the calls on the caplets will be out of the money, as will be the call on the cap. Thus, the value of the call on the cap is the sum of the values of the calls on the caplets.</p>
<p>In order to apply the methods developed in Chap. <a href="#c_exotics" data-reference-type="ref" data-reference="c_exotics">[c_exotics]</a> for valuing compound options to value the calls on the caplets (i.e., the calls on puts on discount bonds), all we need to do is to calculate the rate <span class="math inline">\(r^*\)</span> and the exercise prices <span class="math inline">\(K_i\)</span>. We will explain this only briefly.</p>
<p>Consider the caplet with payment date <span class="math inline">\(t_{i+1}\)</span>. According to the valuation formula <a href="#vasicekcaplet" data-reference-type="eqref" data-reference="vasicekcaplet">[vasicekcaplet]</a>, the value of the caplet at date <span class="math inline">\(T\)</span>, when there is a remaining time to maturity of <span class="math inline">\(t_i-T\)</span>, will be<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
</section>
<section id="s_HW_yields" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Yields and Yield Volatilities</h1>
<p>We are denoting the price at date <span class="math inline">\(t\)</span> of a discount bond maturing at <span class="math inline">\(u\)</span>, with remaining time to maturity of <span class="math inline">\(\tau = u-t\)</span>, as <span class="math inline">\(P(t,u)\)</span>. However, as in Sect. <a href="Chapter11.html#s_yieldcurve" data-reference-type="ref" data-reference="s_yieldcurve">[s_yieldcurve]</a>, we will denote the corresponding yield as <span class="math inline">\(y(t,\tau)\)</span>. The yield is defined as <span class="math display">\[y(t,\tau) = \frac{-\log P(t,u)}{\tau}\; .\]</span> In the extended Vasicek model, the yield is given by the bond pricing formula <span class="math inline">\(\eqref{vasicekbond}\)</span> as <span class="math display">\[y(t,\tau) = \frac{\int_t^{t+\tau} \phi(s)\,\D s + a(\tau) + b(\tau)\hat{r}(t)}{\tau}\; .\]</span> Note that the component <span class="math display">\[\frac{a(\tau) + b(\tau)\hat{r}(t)}{\tau}\]</span> of the yield <span class="math inline">\(y(t,t+\tau)\)</span> is independent of <span class="math inline">\(t\)</span>, except for its dependence on <span class="math inline">\(\hat{r}(t)\)</span>. For example, in the continuous-time Ho-Lee model, this component equals <span class="math display">\[-\frac{\sigma^2\tau^2}{6} + \hat{r}(t)\; .\]</span> This is a decreasing function of the time to maturity <span class="math inline">\(\tau\)</span> with intercept equal to <span class="math inline">\(\hat{r}(t)\)</span>. At a different date <span class="math inline">\(t\)</span>, this component of the yield curve would be the same, except for having a different intercept. This is the reason for the statement in Sect.~<span class="math inline">\(\ref{s_vasicekhedging}\)</span> that only parallel shifts in the yield curve are possible in this model (and hence duration hedging works in the model).</p>
<p>The volatility at date <span class="math inline">\(t\)</span> of the yield at a fixed maturity <span class="math inline">\(\tau\)</span> is<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> <span class="math inline">\(\sigma b(\tau)/\tau\)</span>.</p>
</section>
<section id="s_generalHW" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> The General Hull-White Model</h1>
<p>We will briefly discuss the general Hull-White model, in which <span class="math display">\[\begin{equation}\label{hw600}
\D r(t) = \theta(t)\,\D t -\kappa(t)r(t)\,\D t + \sigma(t)\,\D B(t)\;.
\end{equation}\]</span> By differentiating the following, one can see that the short rate <span class="math inline">\(r\)</span> in the general Hull-White model satisfies As before, discount bond prices are <span class="math display">\[\begin{equation}\label{hw602}
P(t,u) = \exp\left(-\int_t^u \phi(s)\,\D s\right)E^R_t \left[ \exp\left(-\int_t^u \hat{r}(s)\,\D s\right)\right]\;.
\end{equation}\]</span> Moreover, <span class="math inline">\(\eqref{rhat101}\)</span> implies, for <span class="math inline">\(s&gt;t\)</span>, %<span class="math display">\[\begin{equation}\label{rhat1001}
$$\hat{r}(s) = \exp\left(-\int_t^s\kappa(x)\,\D x\right)\,\hat{r}(t)+\int_t^s\exp\left(-\int_y^s\kappa(x)\,\D x\right)\sigma(y)\,\D B(y)\;.
$$
Using this fact, the expectation in
[\[hw602\]](#hw602){reference-type="eqref" reference="hw602"} can be
calculated as before as the expectation of the exponential of a normally
distributed random variable, leading to the result
\begin{subequations}
\begin{equation}\label{hw603}
P(t,u) = \exp\left(-\int_t^u \phi(s)\,\D s-a(t,u)-b(t,u)\hat{r}(t)\right)\;,
\end{equation}\]</span> where <span class="math display">\[\begin{align}
b(t,u) &amp;= \int_t^u \exp\left(-\int_t^s\kappa(x)\,\D x\right)\,\D s\; ,\\
a(t,u) &amp;=  -\frac{1}{2}\int_t^u b(y,u)^2\sigma(y)^2\,\D y\;.
\end{align}\]</span> \end{subequations} Note that the functions <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> now depend on the date <span class="math inline">\(t\)</span> of valuation and the date <span class="math inline">\(u\)</span> of maturity rather than being determined entirely by the time to maturity <span class="math inline">\(u-t\)</span>. Note also that we can write <span class="math display">\[\begin{align}
b(t,u) &amp;= \exp\left(\int_0^t\kappa(x)\,\D x\right)\int_t^u\exp\left(-\int_0^s\kappa(x)\,\D x\right)\,\D s\notag\\
&amp;= \exp\left(\int_0^t\kappa(x)\,\D x\right)\\
&amp;\qquad \times\left[\int_0^u\exp\left(-\int_0^s\kappa(x)\,\D x\right)\,\D s - \int_0^t\exp\left(-\int_0^s\kappa(x)\,\D x\right)\,\D s\right]\notag\\
&amp;=\exp\left(\int_0^t\kappa(x)\,\D x\right)\big(b(0,u)-b(0,t)\big)\;.\label{hw2btu}
\end{align}\]</span> Therefore, we can recover the functions <span class="math inline">\(b(t,u)\)</span> and <span class="math inline">\(a(t,u)\)</span> from the functions <span class="math inline">\(b(0,t)\)</span>, <span class="math inline">\(\exp\left(\int_0^t\kappa(x)\,\D x\right)\)</span>, and <span class="math inline">\(\sigma(t)\)</span>.</p>
<p>The returns of discount bonds satisfy <span class="math display">\[\begin{equation}\label{extendedvasicekbondreturn2}
\frac{\D P(t,u)}{P(t,u)} = r(t)\,\D t - \sigma(t) b(t,u)\,\D B(t)\;.
\end{equation}\]</span> Hence, hedge ratios, which depend on relative volatilities, are determined by the function~<span class="math inline">\(b\)</span> as before. Given the functions <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span>, the model can be calibrated to market discount bond prices by choosing the function <span class="math inline">\(\phi\)</span> exactly as discussed in Sect.~<span class="math inline">\(\ref{s_vasicek_fitting}\)</span>.</p>
<p>The pricing of fixed-income derivatives discussed in Sects. [<span class="math display">\[s_vasicek_discounts\]</span>](#s_vasicek_discounts)reference-type="ref" reference="s_vasicek_discounts"–[<span class="math display">\[s_captions\]</span>](#s_captions)reference-type="ref" reference="s_captions" was based on forward prices of discount bonds having non-random volatilities. This is true also in the general Hull-White model. Given dates <span class="math inline">\(t&lt;T&lt;u\)</span>, the forward price at date <span class="math inline">\(t\)</span> of the discount bond maturing at date <span class="math inline">\(u\)</span>, when the forward contract matures at <span class="math inline">\(T\)</span>, is, as before, <span class="math inline">\(F(t)=P(t,u)/P(t,T)\)</span>. In the general Hull-White model, we have <span class="math display">\[\begin{align*}
\frac{\D F(t)}{F(t)} &amp;= \text{something}\,\D t + \frac{\D P(t,u)}{P(t,u)} - \frac{\D P(t,T)}{P(t,T)}\\
&amp;= \text{something}\,\D t -\sigma(t)[b(t,u)-b(t,T)]\,\D B(t)\\
&amp;= \text{something}\,\D t -\sigma(t)\exp\left(\int_0^t\kappa(x)\,\D x\right)\big[b(0,u)-b(0,T)\big]\,\D B(t)\;.
\end{align*}\]</span> Thus, the average volatility, from date 0 to date T, is <span class="math display">\[\sigma_{\text{avg}} = \big[b(0,u)-b(0,T)\big]\sqrt{\frac{1}{T}\int_0^T \sigma(t)^2\exp\left(2\int_0^t\kappa(x)\,\D x\right)\,\D t}\; .\]</span> With this substitution, the pricing of fixed-income derivatives is the same as in the basic Hull-White model discussed in Sects.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span>–<span class="math inline">\(\ref{s_captions}\)</span>.</p>
<p>The advantage of the general Hull-White model is that it allows more flexibility in fitting the model to current market conditions. This may (though there is certainly no guarantee) provide better pricing and hedging of interest-rate derivatives. Hull and White suggest choosing the volatility function <span class="math inline">\(\sigma\)</span> to fit anticipated future volatilities of the short rate and choosing the mean-reversion function <span class="math inline">\(\kappa\)</span> to fit market cap/floor prices or yield volatilities.<br>
We will assume that the volatility function <span class="math inline">\(\sigma\)</span> has been chosen, and we will describe how to choose the mean-reversion function to fit the model to estimated yield volatilities or cap prices. As usual, we let date~0 denote the date at which we are fitting the model.</p>
<p>The simplest approach is to take the function <span class="math inline">\(\kappa(t)\)</span> to be piecewise constant. Consider dates <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_M\)</span> with <span class="math inline">\(t_i-t_{i-1}=\varDelta t\)</span> for each <span class="math inline">\(i\)</span>. For valuing a swaption, for example, we would want <span class="math inline">\(t_M\)</span> to be the sum of the time to maturity of the swaption and the length of the swap. Thus, we are fitting the model until the end of the swap underlying the swaption. We want to find numbers <span class="math inline">\(\kappa_1,\ldots,\kappa_M\)</span> and will set the function <span class="math inline">\(\kappa\)</span> to equal <span class="math inline">\(\kappa_i\)</span> for~<span class="math inline">\(t\)</span> between <span class="math inline">\(t_{i-1}\)</span> and <span class="math inline">\(t_i\)</span>.</p>
<p>Given this definition, we have <span class="math display">\[\begin{align*}
\exp\left(-\int_0^{t_1}\kappa(x)\,\D x\right) &amp;= \E^{-\kappa_1\,\varDelta t}\; ,\\
\exp\left(-\int_0^{t_2}\kappa(x)\,\D x\right) &amp;= \E^{-\kappa_1\,\varDelta t}\E^{-\kappa_2\,\varDelta t}\; ,\\
\exp\left(-\int_0^{t_3}\kappa(x)\,\D x\right) &amp;= \E^{-\kappa_1\,\varDelta t}\E^{-\kappa_2\,\varDelta t}\E^{-\kappa_3\,\varDelta t}\;,
\end{align*}\]</span> etc. Furthermore, <span class="math display">\[\begin{align*}
b(0,t_1) &amp;= \E^{-\kappa_1\,\varDelta t}\varDelta t\; ,\\
b(0,t_2) &amp;= \E^{-\kappa_1\,\varDelta t}\,\varDelta t + \E^{-\kappa_1\,\varDelta t}\E^{-\kappa_2\,\varDelta t}\,\varDelta t\; ,\\
b(0,t_3) &amp;= \E^{-\kappa_1\,\varDelta t}\,\varDelta t + \E^{-\kappa_1\,\varDelta t}\E^{-\kappa_2\,\varDelta t}\,\varDelta t + \E^{-\kappa_1\,\varDelta t}\E^{-\kappa_2\,\varDelta t}\E^{-\kappa_3\,\varDelta t}\,\varDelta t\;,
\end{align*}\]</span> etc. This yields the following recursive structure for the <span class="math inline">\(b(0,t_i)\)</span>. </p>
<p>Matching the yield volatilities in the model to estimated market volatilities is extremely simple. The same analysis presented in Sect. <a href="#s_HW_yields" data-reference-type="ref" data-reference="s_HW_yields">[s_HW_yields]</a> for the basic Hull-White model shows that the volatility at date 0 of the yield at maturity <span class="math inline">\(t_i\)</span> in the general Hull-White model is <span class="math display">\[\frac{\sigma(0) b(0,t_i)}{t_i}\; .\]</span> Given the estimated yield volatility, we can define <span class="math inline">\(b(0,t_i)\)</span> by equating the model volatility to the estimated volatility. Using <span class="math inline">\(\eqref{generalhwrecursive}\)</span>, the <span class="math inline">\(\kappa_i\)</span> can be computed from the <span class="math inline">\(b(0,t_i)\)</span> for <span class="math inline">\(i=1,2,\ldots\)</span>.</p>
<p>It is equally easy to match the model to market cap or floor prices. Suppose we have estimated implied volatilities for caplets using the pricing formula <a href="#vasicekcapletfloorlet" data-reference-type="eqref" data-reference="vasicekcapletfloorlet">[vasicekcapletfloorlet]</a>. Suppose the first caplet has reset date <span class="math inline">\(t_1\)</span> and payment date <span class="math inline">\(t_2\)</span>, the second has reset date <span class="math inline">\(t_2\)</span> and payment date <span class="math inline">\(t_3\)</span>, etc. According to the model, the average volatility of the forward price of the discount bond underlying the caplet with reset date <span class="math inline">\(t_i\)</span> and payment date <span class="math inline">\(t_{i+1}\)</span> is <span class="math display">\[ \big[b(0,t_{i+1})-b(0,t_i)\big]\sqrt{\frac{1}{t_i}\int_0^{t_i} \sigma(t)^2\exp\left(2\int_0^t\kappa(x)\,\D x\right)\,\D t}\; .\]</span> Notice that everything in this expression, except <span class="math inline">\(b(0,t_{i+1})\)</span>, is determined by <span class="math inline">\(\kappa_1,\ldots,\kappa_i\)</span> and the <span class="math inline">\(\sigma\)</span> function. Therefore, we can select the number <span class="math inline">\(b(0,t_{i+1})\)</span> to match the model volatility to the implied volatility for this caplet. This defines <span class="math inline">\(\kappa_{i+1}\)</span> from <span class="math inline">\(\eqref{generalhwrecursive}\)</span>. Continuing in this way, we can successively define <span class="math inline">\(\kappa_1, \kappa_2, \ldots.\)</span></p>
</section>
<section id="calculations-in-vba" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Calculations in VBA</h1>
<section id="discount-bond-options" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="discount-bond-options">Discount Bond Options</h2>
<p>Rather than calculating <span class="math inline">\(\sigma_{\text{avg}}\)</span> from the volatility <span class="math inline">\(\sigma\)</span> of the short rate and the constant <span class="math inline">\(\kappa\)</span> or function <span class="math inline">\(\kappa(t)\)</span>, we will treat <span class="math inline">\(\sigma_{\text{avg}}\)</span> as an input into the option pricing formulas. This is necessary if one wants to use (i.e., invert) the following functions to imply <span class="math inline">\(\sigma_{\text{avg}}\)</span> from market prices and then used the implied <span class="math inline">\(\sigma_{\text{avg}}\)</span> to calibrate the model.</p>


</section>
<section id="caps" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="caps">Caps</h2>
<p>We input the first reset date <span class="math inline">\(t_0\)</span>, the time between payments <span class="math inline">\(\varDelta t\)</span>, the total number of payments <span class="math inline">\(N\)</span> and the cap rate <span class="math inline">\(\bar{\mathcal{R}}\)</span>. As in Sect. <a href="Chapter12.html#s_fixedincomederivatives_matlab" data-reference-type="ref" data-reference="s_fixedincomederivatives_matlab">[s_fixedincomederivatives_matlab]</a>, we input the price of the discount bond maturing at <span class="math inline">\(t_0\)</span> as <code>P0</code>, and we input a vector <code>P</code> containing the <span class="math inline">\(N\)</span> discount bond prices <span class="math inline">\(P(0,t_1),\ldots,P(0,t_{N})\)</span>. We will allow different volatilities for the different caplets. The input <code>sigavg</code> should have elements 1 through <span class="math inline">\(N\)</span>, with <code>sigavg(i)</code> being the average volatility of the forward price of the discount bond maturing at <span class="math inline">\(t_i\)</span>, where the forward contract matures at <span class="math inline">\(t_{i-1}\)</span>, and the average volatility is computed from date 0 to date <span class="math inline">\(t_{i-1}\)</span>, according to the formulas in Sect. <a href="#s_vasicek_discounts" data-reference-type="ref" data-reference="s_vasicek_discounts">[s_vasicek_discounts]</a>. Specifically, <code>sigavg(i)</code> should be <span class="math inline">\(\sigma\,\varDelta t\)</span> for the continuous-time Ho-Lee model, and <code>sigavg(i)</code> should be <span class="math display">\[\begin{equation}\label{vasicekvbacap}
\frac{\sigma \E^{-\kappa t_{i-1}}\left(1- \E^{-\kappa \,\varDelta t}\right) }{\kappa}\sqrt{\frac{\E^{2\kappa t_{i-1}}-1}{2\kappa t_{i-1}}}
\end{equation}\]</span> for the Hull-White model.</p>

</section>
<section id="coupon-bond-options-in-the-hull-white-model" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="coupon-bond-options-in-the-hull-white-model">Coupon Bond Options in the Hull-White Model</h2>
<p>We will value a European call option on a coupon bond. First we create functions to calculate <span class="math inline">\(a(\tau)\)</span> defined in <a href="#extendedvasicek_a" data-reference-type="eqref" data-reference="extendedvasicek_a">[extendedvasicek_a]</a>, <span class="math inline">\(b(\tau)\)</span> defined in <a href="#extendedvasicek_b" data-reference-type="eqref" data-reference="extendedvasicek_b">[extendedvasicek_b]</a>, and <span class="math inline">\(\sigma_{\text{avg}}\)</span> defined in <a href="#vasiceksigmaavg" data-reference-type="eqref" data-reference="vasiceksigmaavg">[vasiceksigmaavg]</a>.</p>



<p>We calculate the model value of the coupon bond at date <span class="math inline">\(T\)</span> (given by the left-hand side of <a href="#swaptions102" data-reference-type="eqref" data-reference="swaptions102">[swaptions102]</a> for <span class="math inline">\(r=r^*\)</span>) in the function <code>HW_Coup_Bond</code>. The vector <code>Cal</code> contains <span class="math inline">\(N\)</span> elements, and <code>Cal(i)</code> represents the calibration factor <span class="math inline">\(\E^{-\int_T^{t_i} \phi(s)\,\D s}\)</span>, which will be calculated from <a href="#swaptions104" data-reference-type="eqref" data-reference="swaptions104">[swaptions104]</a> in the main function <code>HW_Coup_Bond_Call</code>.</p>

In the main function <code>HW_Coupon_Bond_Call</code>, we input the coupon paid by the bond, the number <code>N</code> of coupon payments, the amount of time <code>t1</code> before the first coupon payment, the amount of time <code>dt</code> between coupon payments, the strike price <code>K</code> of the option, the price <code>MatDisc</code> of the discount bond maturing at the option maturity date <span class="math inline">\(T\)</span>, a vector <code>P</code> containing the <code>N</code> market prices of the discount bonds maturing at the coupon payment dates <span class="math inline">\(t_1, \ldots, t_N\)</span>, the current short rate <code>r</code>, the parameters <code>sigma</code> and <code>kappa</code> of the Vasicek model, and the amount of time <code>T</code> until the option matures.

</section>
</section>
<section id="problems" class="level1 unnumbered">
<h1 class="unnumbered">Problems</h1>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The price of risk is the new drift of <span class="math inline">\(B^*\)</span> when we change from the actual measure to the risk-neutral measure. See Appendix <a href="#a_girsanov" data-reference-type="ref" data-reference="a_girsanov">[a_girsanov]</a>. <span class="math display">\[\begin{equation}\label{vasicekpriceofrisk}
\D r(t) = \kappa^*[\theta^*-r(t)]\,\D t + \sigma^*\lambda\,\D t + \sigma^*\,\D B(t)\;, \tag{\ref{vasicek}$'$}
\end{equation}\]</span> where <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. This is the same as <a href="#vasicek" data-reference-type="eqref" data-reference="vasicek">[vasicek]</a> when we define <span class="math inline">\(\kappa=\kappa^*\)</span>, <span class="math inline">\(\sigma=\sigma^*\)</span>, and <span class="math inline">\(\theta = \theta^*+\sigma^*\lambda/\kappa^*\)</span>. This means that the mean-reversion and volatility parameters are the same under the actual and risk-neutral measures, whereas the long-run mean parameters <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\theta^*\)</span> are related via the market price of risk. Thus, to estimate <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span> in <a href="#vasicek" data-reference-type="eqref" data-reference="vasicek">[vasicek]</a>, we could estimate <span class="math inline">\(\kappa^*=\kappa\)</span>, <span class="math inline">\(\sigma^*=\sigma\)</span>, and <span class="math inline">\(\theta^*\)</span> from <a href="#vasicekactual" data-reference-type="eqref" data-reference="vasicekactual">[vasicekactual]</a> and historical data and then choose <span class="math inline">\(\theta\)</span> to best fit market bond prices.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>By “volatility” here we mean the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)\)</span> not the instantaneous standard deviation of <span class="math inline">\(\D y(t,\tau)/y(t,\tau)\)</span>. In the continuous-time Ho-Lee model, this is <span class="math inline">\(\sigma\)</span> and in the Hull-White model it is <span class="math inline">\(\sigma\left(1-\E^{-\kappa\tau}\right)/(\kappa\tau)\)</span>. In Sect.~<span class="math inline">\(\ref{s_vasicek_discounts}\)</span> we mentioned that one might choose the parameter~<span class="math inline">\(\sigma\)</span> in the Ho-Lee model and the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span> in the Hull-White model to fit cap or floor prices as well as possible. An alternative would be to choose them to match estimated yield volatilities. Of course the fit to either cap prices or yield volatilities will be of limited quality, given that there is only one or two parameters in these models. On the other hand, an exact fit can be obtained with the general Hull-White model.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter12.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter14.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>