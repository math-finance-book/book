<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Finance Book - 14&nbsp; A Brief Survey of Term Structure Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter13.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Finance Book</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Asset Pricing Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Continuous-Time Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Black-Scholes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimating and Modelling Volatility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo and Binomial Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Monte Carlo and Binomial Valuation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter14.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ho-lee" id="toc-ho-lee" class="nav-link active" data-scroll-target="#ho-lee"><span class="toc-section-number">15</span>  Ho-Lee</a></li>
  <li><a href="#black-derman-toy" id="toc-black-derman-toy" class="nav-link" data-scroll-target="#black-derman-toy"><span class="toc-section-number">16</span>  Black-Derman-Toy</a></li>
  <li><a href="#black-karasinski" id="toc-black-karasinski" class="nav-link" data-scroll-target="#black-karasinski"><span class="toc-section-number">17</span>  Black-Karasinski</a></li>
  <li><a href="#s_cir" id="toc-s_cir" class="nav-link" data-scroll-target="#s_cir"><span class="toc-section-number">18</span>  Cox-Ingersoll-Ross</a>
  <ul class="collapse">
  <li><a href="#discount-bond-prices-in-the-cir-model" id="toc-discount-bond-prices-in-the-cir-model" class="nav-link" data-scroll-target="#discount-bond-prices-in-the-cir-model">Discount Bond Prices in the CIR Model</a></li>
  <li><a href="#calibrating-the-cir-model-to-the-yield-curve" id="toc-calibrating-the-cir-model-to-the-yield-curve" class="nav-link" data-scroll-target="#calibrating-the-cir-model-to-the-yield-curve">Calibrating the CIR Model to the Yield Curve</a></li>
  <li><a href="#pricing-fixed-income-derivatives-in-the-cir-model" id="toc-pricing-fixed-income-derivatives-in-the-cir-model" class="nav-link" data-scroll-target="#pricing-fixed-income-derivatives-in-the-cir-model">Pricing Fixed-Income Derivatives in the CIR Model</a></li>
  </ul></li>
  <li><a href="#s_ls" id="toc-s_ls" class="nav-link" data-scroll-target="#s_ls"><span class="toc-section-number">19</span>  Longstaff-Schwartz</a></li>
  <li><a href="#s_hjm" id="toc-s_hjm" class="nav-link" data-scroll-target="#s_hjm"><span class="toc-section-number">20</span>  Heath-Jarrow-Morton</a></li>
  <li><a href="#market-models-again" id="toc-market-models-again" class="nav-link" data-scroll-target="#market-models-again"><span class="toc-section-number">21</span>  Market Models Again</a></li>
  <li><a href="#problems" id="toc-problems" class="nav-link" data-scroll-target="#problems">Problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="c_survey" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>This chapter presents very brief descriptions of several important models. The list of models is certainly not exhaustive, and our descriptions will be far from complete. As mentioned previously, there are many good references for this material in book form already, and our goal here is merely to provide a short introduction.</p>
<section id="ho-lee" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Ho-Lee</h1>
<p>The Ho-Lee <span class="citation" data-cites="HL">[@HL]</span> model is a binomial version of the Vasicek model without mean reversion, in which the one-period interest rate is assumed to have a deterministic drift. This was the first widely-used model that enabled one to fit the current yield curve.</p>
<p>Consider discrete times <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N\)</span> with <span class="math inline">\(t_{i}-t_{i-1}=\varDelta t\)</span> for each <span class="math inline">\(i\)</span>. We denote the one-period interest rate from date <span class="math inline">\(t_i\)</span> to <span class="math inline">\(t_{i+1}\)</span> by <span class="math inline">\(r(t_i)\)</span>. We express the rate as an annualized continuously compounded rate, so the one-period discount factor from date <span class="math inline">\(t_i\)</span> to <span class="math inline">\(t_{i+1}\)</span> is <span class="math inline">\(\E^{-r(t_i) \varDelta t}\)</span>. We could put this in a continuous-time framework by assuming the short rate is constant (<span class="math inline">\(= r(t_i)\)</span>) during each time interval <span class="math inline">\((t_i, t_{i+1})\)</span>. As always, the risk-neutral measure is the probability measure corresponding to the numeraire <span class="math display">\[\begin{equation}\label{holeeaccumulation}
R(t) = \exp\left(\int_0^t r(s)\,\D s\right)\; .
\end{equation}\]</span> However, we will only be doing valuation at the discrete dates <span class="math inline">\(t_0, \ldots, t_N\)</span> and at date <span class="math inline">\(t_i\)</span> the accumulation factor <a href="#holeeaccumulation" data-reference-type="eqref" data-reference="holeeaccumulation">[holeeaccumulation]</a> is <span class="math display">\[R(t_i) = \exp\left(\sum_{j=0}^{i-1} r(t_{j})\,\varDelta t\right)\; .\]</span> Thus, the continuous-time framework is not necessary.</p>
<p>The model assumes that over each time period <span class="math inline">\(t_{i}-t_{i-1}\)</span> the change <span class="math inline">\(\varDelta r(t_i) = r(t_i)-r(t_{i-1})\)</span> in the one-period rate is <span class="math display">\[ \varDelta r(t_i) = \theta(t_i)\,\varDelta t \pm \sigma \sqrt{\varDelta t}\; ,\]</span> where the risk-neutral probability of <code>$+$'' and</code><span class="math inline">\(-\)</span>’’ is <span class="math inline">\(1/2\)</span> each and <span class="math inline">\(\theta\)</span> is a non-random function.<br>
As in the discussion of the extended Vasicek model, it is convenient to define a random process~<span class="math inline">\(\hat{r}\)</span> by <span class="math inline">\(\hat{r}(0) = r(0)\)</span> and <span class="math display">\[\varDelta \hat{r}(t_i) = \pm \sigma \sqrt{\varDelta t}\]</span> for each <span class="math inline">\(i\)</span>. Also, define <span class="math inline">\(\phi(t_i) = \sum_{j=1}^i \theta(t_i)\)</span> for <span class="math inline">\(i \geq 1\)</span>. Then we have, for <span class="math inline">\(i &gt;0\)</span>, <span class="math display">\[r(t_i) = \phi(t_i) + \hat{r}(t_i)\; .\]</span></p>
<p>The following illustrates a three-period tree with initial one-period rate $r_0=$5%, <span class="math inline">\(\varDelta t=1\)</span>, <span class="math inline">\(\theta(t_i)=0\)</span> for all <span class="math inline">\(i\)</span>, and $=$1%.</p>
<p>To value a fixed-income derivative, we discount the terminal value backwards through the tree as in Chaps. <a href="Chapter5.html" data-reference-type="ref" data-reference="c_introcomputation">[c_introcomputation]</a> and <a href="Chapter9.html" data-reference-type="ref" data-reference="c_montecarlo">[c_montecarlo]</a>. The new feature is that the discount rate is changing over time. So, we now have three trees to consider: the tree for the underlying, the tree for the one-period interest rate, and the tree for the derivative value. However, the tree for the underlying can be created from the interest-rate tree, so the interest-rate tree is the basic input instead of the tree for the underlying.</p>
<p>To clarify this, we will start with the simplest example: valuing a discount bond. Consider the above interest-rate tree and a discount bond that matures at date 3. The value of the bond is 1 at maturity. Because we are using continuous compounding, the discount factor is <span class="math inline">\(\E^{-.07} = 0.932\)</span> at the top node at date 2. This is also the value of the discount bond at that node. Likewise, the value of the bond at the middle node at date 2 is <span class="math inline">\(\E^{-.05} = 0.951\)</span>. This implies that the value of the bond at the top node at date 1 is <span class="math display">\[\E^{-.06}\left(\frac{1}{2} \times 0.932 + \frac{1}{2} \times 0.951\right) = 0.887\; .\]</span> Continuing in this way, we derive the following tree for the discount bond, concluding that its price at date 0 should be $0.861.</p>
<p>In general, the price at date 0 of a discount bond maturing at date <span class="math inline">\(t_n\)</span> is <span class="math display">\[\begin{align}
P(0,t_n) &amp;= E^R\left[\exp\left(-\sum_{i=0}^{n-1} r(t_i)\,\varDelta t\right)\right]\notag\\
&amp;= E^R\left[\exp\left(-r(t_0)\,\varDelta t - \sum_{i=1}^{n-1} [\hat{r}(t_i) + \phi(t_i) ]\,\varDelta t\right)\right]\notag\\
&amp;= \exp\left(-r(t_0)\,\varDelta t-\sum_{i=1}^{n-1}\phi(t_i)\,\varDelta t \right)E^R\left[\exp\left(-\sum_{i=1}^{n-1} \hat{r}(t_i) \,\varDelta t\right)\right]\;. \label{holee1}
\end{align}\]</span> Given the parameter <span class="math inline">\(\sigma\)</span>, the expectation in the last line of the above can easily be computed.</p>
<p>The parameters <span class="math inline">\(\phi(t_n)\)</span> can be chosen to equate model prices of discount bonds maturing at <span class="math inline">\(t_1, \ldots, t_N\)</span> to market prices. This is done simply by choosing <span class="math inline">\(\phi(t_n)\)</span> to satisfy the following equation, which we will derive below: <span class="math display">\[\begin{equation}\label{holee3}
\E^{-\phi(t_n)\,\varDelta t} = \frac{2\E^{r(0)\,\varDelta t}}{ \E^{n\sigma\sqrt{\varDelta t}\,\varDelta t} +  \E^{-n\sigma\sqrt{\varDelta t}\,\varDelta t}}\times \frac{P^{\text{mkt}}(0,t_{n+1})}{P^{\text{mkt}}(0,t_{n})}.
\end{equation}\]</span> Because the ratio of market prices <span class="math inline">\(P^{\text{mkt}}(0,t_{i+1})/P^{\text{mkt}}(0,t_{i})\)</span> is the reciprocal of one plus the market forward rate at date 0 for loans from date <span class="math inline">\(t_i\)</span> to <span class="math inline">\(t_{i+1}\)</span>, this formula for the parameters <span class="math inline">\(\phi(t_i)\)</span> is equivalent to equating model forward rates to market forward rates, as was discussed for the Hull-White and continuous-time Ho-Lee models in Sect. <a href="Chapter13.html#s_vasicek_fitting" data-reference-type="ref" data-reference="s_vasicek_fitting">[s_vasicek_fitting]</a>. In fact, the fitting of the Ho-Lee model to market bond prices is often expressed by saying “the market forward rate curve is an input to the model.” This idea was developed further by Heath, Jarrow and Morton <span class="citation" data-cites="HJM">[@HJM]</span>—see Sect. <a href="#s_hjm" data-reference-type="ref" data-reference="s_hjm">[s_hjm]</a>.</p>
<p>As for options on equities and currencies, the binomial model for interest rates is especially useful for valuing early exercise features.<br>
However, it should be noted that, even though this model is very easy to use, it has important limitations. The assumption of a constant volatility for the one-period rate and no mean reversion implies excessive uncertainty about the level of the one-period rate at long horizons, as discussed in Sect. <a href="Chapter13.html#s_vasicek1" data-reference-type="ref" data-reference="s_vasicek1">[s_vasicek1]</a>. To offset this, one could use a smaller volatility when valuing long-maturity options. However, for options with early exercise features, this would imply too little uncertainty about the level of the one-period rate at short horizons and thereby undervalue the early exercise option.</p>
</section>
<section id="black-derman-toy" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Black-Derman-Toy</h1>
<p>The Black-Derman-Toy <span class="citation" data-cites="BDT">[@BDT]</span> model is, like the Ho-Lee model and the Black-Karasinski model discussed in the next section, a binomial model of the one-period interest rate. The model assumes that <span class="math display">\[\begin{equation}\label{bdt1}
\varDelta \log r(t_i) = \eta(t_i)\,\varDelta t \pm \sigma(t_i)\sqrt{\varDelta t},
\end{equation}\]</span> where “<span class="math inline">\(+\)</span>” and “<span class="math inline">\(-\)</span>” have probability one-half each under the risk-neutral measure. The volatility <span class="math inline">\(\sigma(t_i)\)</span> has the interpretation of the <em>percentage</em> volatility of the one-period rate (rather than the absolute volatility, as in the Vasicek and Ho-Lee models). The model implies that the one-period rate will always be nonnegative.</p>
A significant feature of the model is that the volatility is allowed to be time-varying. This would produce a non-recombining tree except that the drift <span class="math inline">\(\eta(t_i)\)</span> is allowed to vary across the date–<span class="math inline">\(t_{i-1}\)</span> nodes, i.e., to be a random variable, depending on the level of the one-period rate at date <span class="math inline">\(t_{i-1}\)</span>. To understand this, consider the following two-period tree. For convenience, we write <span class="math inline">\(a_i\)</span> for <span class="math inline">\(\eta(t_i)\,\varDelta t\)</span> and <span class="math inline">\(b_i\)</span> for <span class="math inline">\(\sigma(t_i)\sqrt{\varDelta t}\)</span>.
<p>We have written <span class="math inline">\(a_{2u}\)</span> and <span class="math inline">\(a_{2d}\)</span> to demonstrate that the drift between date 1 and date 2 can vary, depending on whether we are at the top or bottom node at date 1. If we arrive at the node marked with a question mark via a down move from the top node at date 1, the value will be <span class="math display">\[\log r(0)+a_1+b_1+a_{2u}-b_2\; .\]</span> On the other hand, if we arrive at it via an up move from the bottom node at date 1, the value will be <span class="math display">\[\log r(0) + a_1-b_1+a_{2d}+b_2\; .\]</span> For the tree to be recombining, these values must be the same, which implies <span class="math display">\[a_{2d} = a_{2u} + 2b_1-2b_2\; .\]</span> In general, at each date there are two free parameters: the volatility and the drift at one of the nodes, the drifts at the other nodes then being determined by the requirement that the tree be recombining.</p>
<p>The dependence of the drift on the node can be expressed as a linear dependence on the logarithm of the one-period rate. In other words, it is possible (and convenient) to write the Black-Derman-Toy model <span class="math inline">\(\eqref{bdt1}\)</span> as <span class="math display">\[\begin{equation}\label{bdt2}
\varDelta \log r(t_i) = \kappa(t_i)[\theta(t_i) - \log r(t_{i-1})]\,\varDelta t \pm \sigma(t_i)\sqrt{\varDelta t},
\end{equation}\]</span> where now the functions <span class="math inline">\(\kappa(t_i)\)</span>, <span class="math inline">\(\theta(t_i)\)</span>, and <span class="math inline">\(\sigma(t_i)\)</span> are deterministic—i.e., depending on time but constant across nodes at each date.</p>
<p>In the two-period example above, we have <span class="math display">\[a_{2u} = \kappa(t_2)[\theta(t_2) - \{\log r(t_0) +a_1+b_1\}]\,\varDelta t\; ,\]</span> and <span class="math display">\[a_{2d} = \kappa(t_2)[\theta(t_2) - \{\log r(t_0) +a_1-b_1\}]\,\varDelta t\; ,\]</span> so the relation <span class="math inline">\(a_{2d} = a_{2u} + 2b_1-2b_2\)</span> is equivalent to <span class="math display">\[\begin{equation}\label{bdt4}
\kappa(t_2) = \frac{b_1-b_2}{b_1\,\varDelta t} = - \frac{1}{\sigma(t_1)}\times\frac{\sigma(t_2)-\sigma(t_1)}{\varDelta t} = - \frac{1}{\sigma(t_1)}\times\frac{\varDelta \sigma(t_2)}{\varDelta t}.
\end{equation}\]</span> This same relationship holds at each node at each date (just consider the two-period example as two periods extending from any node in the tree); thus, in general, we have <span class="math display">\[\begin{equation}\label{bdt3}
\kappa(t_i) = - \frac{1}{\sigma(t_{i-1})}\times\frac{\varDelta \sigma(t_i)}{\varDelta t}.
\end{equation}\]</span></p>
<p>Equations <a href="#bdt2" data-reference-type="eqref" data-reference="bdt2">[bdt2]</a> and <a href="#bdt3" data-reference-type="eqref" data-reference="bdt3">[bdt3]</a> define the Black-Derman-Toy model. The free parameters at each date are <span class="math inline">\(\sigma(t_i)\)</span> and <span class="math inline">\(\theta(t_i)\)</span>, and the parameter <span class="math inline">\(\kappa(t_i)\)</span> is defined by <a href="#bdt3" data-reference-type="eqref" data-reference="bdt3">[bdt3]</a>. Alternatively, one can view <span class="math inline">\(\kappa(t_i)\)</span> and <span class="math inline">\(\theta(t_i)\)</span> as free parameters and define <span class="math inline">\(\sigma(t_i)\)</span> from <a href="#bdt3" data-reference-type="eqref" data-reference="bdt3">[bdt3]</a>. Note that <span class="math inline">\(\kappa(t_i)\)</span> can be interpreted as a mean-reversion parameter for <span class="math inline">\(\log r(t_i)\)</span>, at least when it is positive (i.e., when <span class="math inline">\(\varDelta \sigma(t_i)&lt;0\)</span>). Because there are two free parameters at each date rather than one (as in the Ho-Lee model) it is possible to match both market bond prices and market yield volatilities or cap prices.</p>
<p>In continuous time, we would write <span class="math inline">\(\eqref{bdt3}\)</span> as <span class="math display">\[\kappa(t) = -\frac{\D \log \sigma(t)}{\D t}\; .\]</span> Therefore, the continuous-time version of the Black-Derman-Toy model is <span class="math display">\[\D \log r(t) = -\frac{\D \log \sigma(t)}{\D t}[\theta(t)-\log r(t)]\,\D t + \sigma(t)\,\D B(t)\; ,\]</span> with <span class="math inline">\(B\)</span> being a Brownian motion under the risk-neutral measure.</p>
</section>
<section id="black-karasinski" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Black-Karasinski</h1>
<p>The Black-Karasinski <span class="citation" data-cites="BK">[@BK]</span> model is similar to the Black-Derman-Toy model—it assumes <a href="#bdt2" data-reference-type="eqref" data-reference="bdt2">[bdt2]</a> for the changes in the logarithm of the one-period rate—but it removes the linkage <a href="#bdt3" data-reference-type="eqref" data-reference="bdt3">[bdt3]</a> between the mean-reversion parameter and the volatility. It does this by allowing the lengths of the time steps to vary. Denote the length of the time-step <span class="math inline">\(t_i-t_{i-1}\)</span> by <span class="math inline">\(\tau_i\)</span>. Consider again the two-period example of the previous section. As a necessary condition for the tree to be recombining, we deduced (in <a href="#bdt4" data-reference-type="eqref" data-reference="bdt4">[bdt4]</a>) that <span class="math display">\[\kappa(t_2) = \frac{b_1-b_2}{b_1\,\tau_2}\; .\]</span> In this model, we have <span class="math inline">\(b_i = \sigma(t_i)\sqrt{\tau_i}\)</span>. Making this substitution, we obtain <span class="math display">\[\kappa(t_2) = \frac{\sigma(t_1)\sqrt{\tau_1} - \sigma(t_2)\sqrt{\tau_2}}{\sigma(t_1)\sqrt{\tau_1}\tau_2}\; ,\]</span> which we can rewrite as <span class="math display">\[\kappa(t_2)\sigma(t_1)\sqrt{\tau_1}\tau_2 + \sigma(t_2)\sqrt{\tau_2} - \sigma(t_1)\sqrt{\tau_1} = 0\; .\]</span> This is a quadratic equation in the unknown <span class="math inline">\(\sqrt{\tau_2}\)</span> with the unique positive solution (assuming <span class="math inline">\(\kappa(t_2)&gt;0\)</span>) <span class="math display">\[\sqrt{\tau_2} = \frac{\sqrt{\sigma(t_2)^2 + 4\kappa(t_2)\sigma(t_1)^2\sqrt{\tau_1}} - \sigma(t_2)}{2\kappa(t_2)\sigma(t_1)\sqrt{\tau_1}}\; .\]</span> This relation must hold at each date. Thus, squaring both sides, we obtain the general formula <span class="math display">\[\begin{equation}\label{bk1}
\tau_i = \frac{\left[\sqrt{\sigma(t_i)^2 + 4\kappa(t_i)\sigma(t_{i-1})^2\sqrt{\tau_{i-1}}} - \sigma(t_i)\right]^2}{4\kappa(t_i)^2\sigma(t_{i-1})^2 \tau_{i-1}}.
\end{equation}\]</span></p>
<p>To summarize, the Black-Karasinski model is given by <span class="math inline">\(\eqref{bdt2}\)</span> with three free parameters—<span class="math inline">\(\kappa(t_i)\)</span>, <span class="math inline">\(\theta(t_i)\)</span>, and <span class="math inline">\(\sigma(t_i)\)</span>—at each date. It is implemented in a recombining tree by defining the length of each time step <span class="math inline">\(\tau_i = t_i-t_{i-1}\)</span> for <span class="math inline">\(i \geq 2\)</span> according to the formula <span class="math inline">\(\eqref{bk1}\)</span>. The length of the first time step <span class="math inline">\(\tau_1\)</span> can be chosen arbitrarily.</p>
</section>
<section id="s_cir" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Cox-Ingersoll-Ross</h1>
<p>Cox, Ingersoll, and Ross <span class="citation" data-cites="CIR">[@CIR]</span> introduced a continuous-time model<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>: Cox, Ingersoll and Ross (hereafter CIR) also discuss a variety of other continuous-time models, but this particular model is so well known that it is often simply called <em>the</em> CIR model. in which the short rate satisfies <span class="math display">\[\begin{equation}\label{cir}
\D r(t)=\kappa [\theta-r(t)]\,\D t+\sigma \sqrt{r(t)}\,\D B(t),
\end{equation}\]</span> where <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\sigma\)</span> are positive constants and <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. Like the Vasicek model, this short rate process has a long-run mean of <span class="math inline">\(\theta\)</span>. The difference between the CIR model and the Vasicek model is that the volatility in the CIR model is proportional to the square root of the short rate rather than being constant. Because of this fact, the short rate can never be negative. Intuitively, the reason is that the volatility <span class="math inline">\(\sigma\sqrt{r(t)}\)</span> is very small if <span class="math inline">\(r(t)\)</span> is near zero, so the drift will dominate the change in <span class="math inline">\(r(t)\)</span>, pushing it upwards towards <span class="math inline">\(\theta\)</span>. This interest rate model was mimicked by Heston in his stochastic volatility model discussed in Chap.~<span class="math inline">\(\ref{c_stochasticvolatility}\)</span>. We will briefly discuss three topics in connection with this model: discount bond prices, calibrating the model to the current market, and pricing fixed-income derivatives.</p>
<section id="discount-bond-prices-in-the-cir-model" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="discount-bond-prices-in-the-cir-model">Discount Bond Prices in the CIR Model</h2>
<p>Discount bond prices can be most easily computed in the CIR model by solving the fundamental partial differential equation (pde) discussed in Chap. <a href="Chapter10.html" data-reference-type="ref" data-reference="c_pde">[c_pde]</a>. Let <span class="math inline">\(P(t,u)\)</span> denote the price at date <span class="math inline">\(t\)</span> of a discount bond maturing at date <span class="math inline">\(u\)</span>, having remaining time to maturity of <span class="math inline">\(\tau = u-t\)</span>. The discount bond price will depend on the remaining time to maturity and the short rate at date <span class="math inline">\(t\)</span>, because, as in the Vasicek model, the short rate is the only random factor in this model. Thus, there must be some deterministic function <span class="math inline">\(f\)</span> such that <span class="math inline">\(P(t,u) = f(r(t),\tau).\)</span> As in Chap. <a href="Chapter10.html" data-reference-type="ref" data-reference="c_pde">[c_pde]</a>, the fundamental pde is obtained by applying Itô’s formula to <span class="math inline">\(f\)</span> to compute <span class="math inline">\(\D f\)</span> in terms of the partial derivatives of <span class="math inline">\(f\)</span> and then using the fact that the expected return of the discount bond (hence the drift of <span class="math inline">\(\D f/f\)</span>) must equal the short rate under the risk-neutral measure.</p>
<p>From Itô’s formula and the definition <a href="#cir" data-reference-type="eqref" data-reference="cir">[cir]</a> of <span class="math inline">\(\D r\)</span>, we have <span class="math display">\[\begin{align}
\D f &amp;= \frac{\partial f}{\partial \tau}\,\D \tau + \frac{\partial f}{\partial r}\,\D r + \frac{1}{2}\frac{\partial^2 f}{\partial r^2}\,(\D r)^2\notag\\
&amp; = - \frac{\partial f}{\partial \tau} \,\D t + \frac{\partial f}{\partial r}\left\{\kappa [\theta-r]\,\D t+\sigma \sqrt{r}\,\D B\right\} + \frac{1}{2}\frac{\partial^2f}{\partial r^2}\sigma^2r\,\D t\notag\\
&amp;= \left(- \frac{\partial f}{\partial \tau} + \frac{\partial f}{\partial r}\kappa [\theta-r] + \frac{1}{2}\frac{\partial^2f}{\partial r^2}\sigma^2r\right)\,\D t + \frac{\partial f}{\partial r} \sigma\sqrt{r}\,\D B\;.\label{cir10}
\end{align}\]</span> Equating the drift to <span class="math inline">\(rf\,\D t\)</span> gives us the fundamental pde: <span class="math display">\[\begin{equation}\label{cir2}
- \frac{\partial f}{\partial \tau} + \frac{\partial f}{\partial r}\kappa [\theta-r] + \frac{1}{2}\frac{\partial^2f}{\partial r^2}\sigma^2r = rf\;.
\end{equation}\]</span> This equation should be solved for the function <span class="math inline">\(f\)</span> subject to the boundary condition that the value of the discount bond is one at maturity; i.e., <span class="math inline">\(f(r,0)=1\)</span> for all <span class="math inline">\(r\)</span>.</p>
<p>The solution can be obtained by “guessing” a solution of the same form as the Vasicek bond pricing formula <a href="#vasicekbond" data-reference-type="eqref" data-reference="vasicekbond">[vasicekbond]</a>, namely<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span class="math display">\[\begin{equation}\label{cir3}
f(r,\tau) = \exp\left(-a(\tau)-b(\tau)r\right)
\end{equation}\]</span> for deterministic functions <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. The boundary condition <span class="math display">\[f(r,0)= \exp\left(-a(0)-b(0)r\right) = 1\]</span> for all <span class="math inline">\(r\)</span> implies <span class="math inline">\(a(0)=b(0)=0\)</span>, and it can easily be checked that the fundamental pde is equivalent to where the “primes” denote derivatives. By differentiating, one can verify that the solution of <a href="#betaprime" data-reference-type="eqref" data-reference="betaprime">[betaprime]</a> (which is called a “Riccati equation”) with the boundary condition <span class="math inline">\(b(0)=0\)</span> is To summarize, </p>
<p>Note that <span class="math inline">\(\eqref{cir3}\)</span> implies <span class="math inline">\(\partial f/\partial r = - b(\tau)f\)</span>. Substituting this into <a href="#cir10" data-reference-type="eqref" data-reference="cir10">[cir10]</a> gives us the discount bond return as <span class="math display">\[\begin{equation}\label{cirdpp}
\frac{\D P(t,u)}{P(t,u)} =\frac{\D f}{f} =   r(t)\,\D t - b(\tau)\sigma\sqrt{r(t)}\,\D B(t)\;.
\end{equation}\]</span> This is again similar to the Vasicek model except for the appearance of the <span class="math inline">\(\sqrt{\,r}\)</span> factor in the volatility. Because of this factor, the volatility is random. Thus, the option pricing formulas of previous chapters cannot be directly applied to price discount bond options (and hence caps, floors, coupon bond options, and swaptions). Nevertheless, the ideas underlying those formulas can be applied to obtain similar valuation formulas.</p>
<p>Hedge ratios depend on relative volatilities, so they are determined by the function <span class="math inline">\(b\)</span>, just as discussed in Sect. <a href="Chapter13.html#s_vasicekhedging" data-reference-type="ref" data-reference="s_vasicekhedging">[s_vasicekhedging]</a> for the Vasicek model.</p>
</section>
<section id="calibrating-the-cir-model-to-the-yield-curve" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="calibrating-the-cir-model-to-the-yield-curve">Calibrating the CIR Model to the Yield Curve</h2>
<p>The CIR model can be calibrated to current market conditions by taking one or more of the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span> to be time-varying, as in the extended Vasicek model. This was suggested by Cox, Ingersoll and Ross. However, the simplest way to calibrate the model to discount bond prices, which was also suggested by Cox, Ingersoll and Ross, is to take the short rate to be the sum of a non-random function of time and a square-root process as defined in <a href="#cir" data-reference-type="eqref" data-reference="cir">[cir]</a>. Specifically, let <span class="math display">\[r(t) = \phi(t) + \hat{r}(t)\; ,\]</span> where <span class="math inline">\(\phi\)</span> is a non-random function and <span class="math inline">\(\hat{r}\)</span> satisfies <span class="math display">\[\begin{equation}\label{cirrhat}
\D \hat{r}(t)=\kappa [\theta-\hat{r}(t)]\,\D t+\sigma \sqrt{\hat{r}(t)}\,\D B(t)\;,
\end{equation}\]</span> with <span class="math inline">\(\hat{r}(0) = r(0)\)</span>. Then, as in the Hull-White model, discount bond prices are given by <span class="math display">\[P(t,u) = \exp\left(-\int_t^u \phi(s)\,\D s\right)E^R_t\left[\exp\left(-\int_t^u\hat{r}(s)\,\D s\right)\right]\; .\]</span> Moreover, the expectation in this equation is the discount bond pricing function calculated in the previous subsection, so we have <span class="math display">\[\begin{equation}\label{cirPcal}
P(t,u) = \exp\left(-\int_t^u \phi(s)\,\D s\right)\exp\left(-a(\tau)-b(\tau)\hat{r}(t)\right)\;.
\end{equation}\]</span> In particular, discount bond prices at date 0 are <span class="math display">\[P(0,u) = \exp\left(-\int_0^u \phi(s)\,\D s\right)\exp\left(-a(u)-b(u)r(0)\right)\; ,\]</span> so the model can be calibrated to market prices <span class="math inline">\(P^{\text{mkt}}(0,u)\)</span> by setting <span class="math display">\[\begin{equation}\label{circalibration}
\exp\left(-\int_0^u \phi(s)\,\D s\right) = \exp\left(a(u)+b(u)r(0)\right)P^{\text{mkt}}(0,u)
\end{equation}\]</span> for each <span class="math inline">\(u\)</span>. Note that the calibration does not affect discount bond returns: the expected return under the risk-neutral measure must still be the short rate and the volatility is unaffected by a deterministic factor. Therefore, we have, as in <span class="math inline">\(\eqref{cirdpp}\)</span>, <span class="math display">\[\begin{equation}\label{cirdpp2}
\frac{\D P(t,u)}{P(t,u)}  =   r(t)\,\D t - b(\tau)\sigma\sqrt{\hat{r}(t)}\,\D B(t)\;.
\end{equation}\]</span> This can be verified by applying It^o’s formula to <span class="math inline">\(\eqref{cirPcal}\)</span>.</p>
</section>
<section id="pricing-fixed-income-derivatives-in-the-cir-model" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="pricing-fixed-income-derivatives-in-the-cir-model">Pricing Fixed-Income Derivatives in the CIR Model</h2>
<p>In the previous chapter, it was shown for the extended Vasicek model that pricing formulas for caps, floors, coupon bond options, and swaptions can be derived from a pricing formula for discount bond options. The same is true in the CIR model — caps and floors are of course portfolios of discount bond options and, in a single-factor model such as the Vasicek or CIR model, coupon bond options and swaptions can also be priced as portfolios of discount bond options. Here we will explain briefly how to price discount bond options in the CIR model.</p>
<p>Consider a call option maturing at date <span class="math inline">\(T\)</span> with the underlying being a discount bond maturing at <span class="math inline">\(u&gt;T\)</span>. Let <span class="math inline">\(K\)</span> denote the strike price. From our fundamental pricing formula <span class="math inline">\(\eqref{formula}\)</span>, the value at date~0 of the option is <span class="math display">\[\begin{equation}\label{ciroptionprice}
P(0,u)\times\text{prob}^u\big(P(T,u)&gt;K\big) - P(0,T)\times\text{prob}^T\big(P(T,u)&gt;K\big)\;,
\end{equation}\]</span> where <span class="math inline">\(\text{prob}^u\)</span> denotes the probability measure using the discount bond maturing at <span class="math inline">\(u\)</span> as numeraire and <span class="math inline">\(\text{prob}^T\)</span> denotes the probability measure using the discount bond maturing at <span class="math inline">\(T\)</span> as the numeraire. Using the calibration of the previous subsection, the price of the underlying at date <span class="math inline">\(T\)</span> will be, according to the model, <span class="math display">\[P(T,u)  = \exp\left(-\int_T^u \phi(s)\,\D s-a(u-T)-b(u-T)\hat{r}(T)\right)\; .\]</span> Therefore, the option will finish in the money if and only if <span class="math display">\[\begin{equation}\label{ciroptionprice2}
\frac{-\int_T^u \phi(s)\,\D s-a(u-T)-\log K}{b(u-T)} &gt; \hat{r}(T)\;.
\end{equation}\]</span> Thus, to price discount bond options, we need to compute the probabilities that <span class="math inline">\(\hat{r}(T)\)</span> is less than a given number, using discount bonds as numeraires.</p>
<p>Consider the discount bond maturing at <span class="math inline">\(u\)</span>. The calculation for the discount bond maturing at <span class="math inline">\(T\)</span> can be done in the same way. We use the fact that <span class="math display">\[\frac{\E^{\int_0^t r(s)\,\D s}}{P(t,u)}\]</span> is a martingale, when <span class="math inline">\(P(t,u)\)</span> is used as the numeraire, for <span class="math inline">\(t \leq u\)</span>. Let <span class="math inline">\(Z(t)\)</span> denote this ratio and apply Itô’s formula for ratios to derive <span class="math display">\[\frac{\D Z(t)}{Z(t)} = r(t)\,\D t - \frac{\D P(t,u)}{P(t,u)} + \left(\frac{\D P(t,u)}{P(t,u)}\right)^2\; .\]</span> Substituting from <a href="#cirdpp2" data-reference-type="eqref" data-reference="cirdpp2">[cirdpp2]</a> now gives us <span class="math display">\[\begin{align*}
\frac{\D Z(t)}{Z(t)} &amp;= b(\tau)\sigma\sqrt{\hat{r}(t)}\,\D B(t) + b(\tau)^2\sigma^2\hat{r}(t)\,\D t\\
&amp;= b(\tau)\sigma\sqrt{\hat{r}(t)}\left[\D B(t) + b(\tau)\sigma\sqrt{\hat{r}(t)}\,\D t\right]\;.
\end{align*}\]</span> Given that <span class="math inline">\(Z\)</span> is a martingale, <span class="math inline">\(\D Z/Z\)</span> cannot have a drift, so it must be that~<span class="math inline">\(B^*\)</span> defined by <span class="math inline">\(B^*(0)=0\)</span> and <span class="math display">\[\D B^*(t) = \D B(t) + b(\tau)\sigma\sqrt{\hat{r}(t)}\,\D t\]</span> is a martingale, and hence a Brownian motion, when <span class="math inline">\(P(t,u)\)</span> is used as the numeraire. Substituting this into the definition <span class="math inline">\(\eqref{cirrhat}\)</span> of <span class="math inline">\(\hat{r}\)</span>, we have <span class="math display">\[\begin{align}
\D \hat{r}(t)&amp;=\kappa [\theta-\hat{r}(t)]\,\D t+\sigma \sqrt{\hat{r}(t)}\,\left[\D B^*(t) - b(\tau)\sigma\sqrt{\hat{r}(t)}\,\D t\right]\notag\\
&amp;= \kappa [\theta-\hat{r}(t)]\,\D t+\sigma \sqrt{\hat{r}(t)}\,\D B^*(t) - \sigma^2b(\tau)\hat{r}(t)\,\D t\notag\\
&amp;= \kappa^*(t)[\theta^*(t)-\hat{r}(t)]\,\D t +\sigma \sqrt{\hat{r}(t)}\,\D B^*(t)\;,\label{cirru}
\end{align}\]</span> where we define <span class="math display">\[
\kappa^*(t) = \kappa + \sigma^2b(u-t) \qquad \text{and} \qquad \theta^*(t) = \frac{\kappa\theta}{\kappa^*(t)}\; .\]</span> Thus, using a discount bond as numeraire, the process <span class="math inline">\(\hat{r}\)</span> is still a square root process, but now with a time-dependent long-run mean and mean-reversion rate.</p>
<p>The random variable <span class="math inline">\(\hat{r}(T)\)</span> defined by <span class="math inline">\(\hat{r}(0)=0\)</span> and equation <span class="math inline">\(\eqref{cirru}\)</span> for <span class="math inline">\(t \leq T\)</span> is a transformation of a random variable having what is called a ``non-central chi-square’’ distribution. See Appendix~<span class="math inline">\(\ref{a_bessel}\)</span> for further discussion and calculation of the probabilities <span class="math inline">\(\text{prob}^u\big(P(T,u)&gt;K\big)\)</span> and <span class="math inline">\(\text{prob}^T\big(P(T,u)&gt;K\big)\)</span>.</p>
</section>
</section>
<section id="s_ls" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Longstaff-Schwartz</h1>
<p>Cox, Ingersoll and Ross suggest adding two independent square-root processes to obtain a two-factor model. This means that we would take <span class="math inline">\(r(t)=x_1(t)+x_2(t)\)</span>, where <span class="math display">\[\begin{equation}\label{ls}
\D x_i(t) = \kappa_i[\theta_i-x_i(t)]\,\D t + \sigma_i\sqrt{x_i(t)}\,\D B_i(t)\;,
\end{equation}\]</span> where <span class="math inline">\(B_1\)</span> and <span class="math inline">\(B_2\)</span> are independent Brownian motions under the risk-neutral measure and <span class="math inline">\(\kappa_i\)</span>, <span class="math inline">\(\theta_i\)</span> and <span class="math inline">\(\sigma_i\)</span> are positive constants for <span class="math inline">\(i=1,2\)</span>. Longstaff and Schwartz <span class="citation" data-cites="LS92">[@LS92]</span> investigate this model further, including providing an “equilibrium” foundation, deriving discount bond option prices, and estimating the coefficients. The model is usually called the Longstaff-Schwartz model.</p>
<p>An important observation made by Longstaff and Schwartz is that the model can be rewritten so that the short rate and its volatility are the factors (rather than the unobservable <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>). Note that the instantaneous variance of <span class="math inline">\(r = x_1+x_2\)</span> is <span class="math display">\[\left( \sigma_1\sqrt{x_1(t)}\,\D B_1(t) +  \sigma_2\sqrt{x_2(t)}\,\D B_2(t)\right)^2 = \left(\sigma_1^2x_1(t) + \sigma_2^2x_2(t)\right)\,\D t\; .\]</span> Define <span class="math inline">\(V(t) = \sigma_1^2x_1(t) + \sigma_2^2x_2(t)\)</span>. We can solve for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> in terms of <span class="math inline">\(r\)</span> and~<span class="math inline">\(V\)</span> as provided <span class="math inline">\(\sigma_1\neq \sigma_2\)</span>. Making these substitutions for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> on the right-hand side of <span class="math inline">\(\eqref{ls}\)</span> and noting that <span class="math inline">\(\D r = \D x_1+\D x_2\)</span> and <span class="math inline">\(\D V = \sigma_1^2\,\D x_1 + \sigma_2^2\,\D x_2\)</span>, we obtain the following equations presented by Longstaff and Schwartz: where <span class="math inline">\(\delta=\kappa_1\)</span>, <span class="math inline">\(\xi=\kappa_2\)</span>, <span class="math inline">\(\alpha = \sigma_1^2\)</span>, <span class="math inline">\(\beta=\sigma_2^2\)</span>, <span class="math inline">\(\gamma = \kappa_1\theta_1/\sigma_1^2\)</span>, and <span class="math inline">\(\eta = \kappa_2\theta_2/\sigma_2^2\)</span>. Thus, this can be regarded as a two-factor model in which the factors are the short rate and its instantaneous variance, with the six parameters <span class="math inline">\(\delta\)</span>, <span class="math inline">\(\xi\)</span>, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>, and~<span class="math inline">\(\eta\)</span>.</p>
<p>The simplest way to compute discount bond prices in this model is to return to the definition <span class="math inline">\(r=x_1+x_2\)</span>. Discount bond prices are <span class="math display">\[\begin{align*}
P(t,u) &amp;= E_t\left[\exp\left(-\int_t^u r(s)\,\D s\right)\right]\\
&amp;= E_t\left[\exp\left(-\int_t^u x_1(s)\,\D s\right)\exp\left(-\int_t^u x_2(s)\,\D s\right)\right]\\
&amp;= E_t\left[\exp\left(-\int_t^u x_1(s)\,\D s\right)\right] E_t\left[\exp\left(-\int_t^u x_2(s)\,\D s\right)\right]\;,
\end{align*}\]</span> due to the independence of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Moreover, these expectations have the same form as discount bond prices in the CIR model, namely <span class="math display">\[\begin{equation}\label{lsdiscount}
E_t\left[\exp\left(-\int_t^u x_i(s)\,\D s\right)\right] = \exp\left(-a_i(\tau)-b_i(\tau)x_i(t)\right)\;,
\end{equation}\]</span> where the functions <span class="math inline">\(a_i\)</span> and <span class="math inline">\(b_i\)</span> are defined in <span class="math inline">\(\eqref{cirbondcombined}\)</span>, using the parameters <span class="math inline">\(\kappa_i\)</span>, <span class="math inline">\(\theta_i\)</span> and <span class="math inline">\(\sigma_i\)</span>. The expectations <span class="math inline">\(\eqref{lsdiscount}\)</span> can be written in terms of <span class="math inline">\(r(t)\)</span> and <span class="math inline">\(V(t)\)</span> by substituting from <span class="math inline">\(\eqref{x12lscombined}\)</span>.</p>
<p>The Vasicek, CIR and Longstaff-Schwartz models are examples of “affine models.” An affine model is defined by a set of factors <span class="math inline">\(x_1, \ldots, x_n\)</span>, where</p>
<ol type="1">
<li>The short rate is an affine function of the factors; i.e., <span class="math inline">\(r(t) = \alpha_0 + \sum_{i=1}^n \alpha_ix_i(t)\)</span> for constants <span class="math inline">\(\alpha_i\)</span>,</li>
<li>The drift of each factor is an affine function of the factors.</li>
<li>The instantaneous variance of each factor is an affine function of the factors.</li>
<li>The instantaneous covariance of each pair of factors is an affine function of the factors.</li>
</ol>
<p>In any affine model, discount bond prices are of the form <span class="math display">\[\begin{equation}\label{affine}
P(t,u) = \exp\left(-a(\tau)-\sum_{i=1}^n b_i(\tau)x_i(t)\right)
\end{equation}\]</span> for deterministic functions <span class="math inline">\(a\)</span> and <span class="math inline">\(b_i\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span>, as we have seen is true for the Vasicek, CIR, and Longstaff-Schwartz models. Most, but certainly not all, of the continuous-time models studied in the finance literature are affine.</p>
<p>In any single-factor affine model, the short rate can be used as the factor. Thus, the general affine one-factor model is of the form <span class="math display">\[\D r = \kappa(\theta-r)\,\D t + \sqrt{\alpha + \beta r}\,\D B\; ,\]</span> for constants <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. The Vasicek model is the special case <span class="math inline">\(\beta = 0\)</span> (<span class="math inline">\(\alpha\)</span> being the same as the parameter~<span class="math inline">\(\sigma^2\)</span>). The CIR model is the special case <span class="math inline">\(\alpha = 0\)</span> (<span class="math inline">\(\beta\)</span> being the same as the parameter <span class="math inline">\(\sigma^2\)</span>).</p>
<p>Because yields of discount bonds are affine functions of the factors in an affine model, as <a href="#affine" data-reference-type="eqref" data-reference="affine">[affine]</a> shows, the short rate and yields at <span class="math inline">\(n-1\)</span> fixed times-to-maturity <span class="math inline">\(\tau_i\)</span> can be chosen to be the <span class="math inline">\(n\)</span> factors (except in the rare case that the linear transformation from factors to the short rate and yields fails to be invertible). The transformation from factors to yields is analogous to the transformation from <span class="math inline">\((x_1,x_2)\)</span> to <span class="math inline">\((r,V)\)</span> in the Longstaff-Schwartz model. Important papers on affine models include Duffie and Kan <span class="citation" data-cites="DK">[@DK]</span> and Dai and Singleton <span class="citation" data-cites="DSing">[@DSing]</span>.</p>
</section>
<section id="s_hjm" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Heath-Jarrow-Morton</h1>
<p>Heath, Jarrow and Morton <span class="citation" data-cites="HJM">[@HJM]</span> propose an alternative framework for modelling. Rather than modelling the evolution of the short rate (and possibly other factors such as the volatility of the short rate or other yields), Heath, Jarrow and Morton (hereafter, HJM) propose modelling the evolution of instantaneous forward rates. They derive a formula for the drifts of instantaneous forward rates under the risk-neutral measure, in terms of the volatilities of the forward rates. A model is therefore completely defined by specifying the volatilities of forward rates. A model of this type is easily fit to market discount bond prices by simply using the initial term structure of forward rates as an input. By calibrating the volatility structure, the model can also be fit to other market prices. Any of the continuous-time models we have discussed can be written in the HJM form. The virtue of the HJM approach is that it facilitates the construction of new models. The disadvantage of the HJM approach is that models of this form will generally be path-dependent—bond prices and the prices of other fixed-income instruments at any point in time depend on the entire history of the forward rate processes, rather than depending only on the values of a small set of factors. This makes computation quite difficult, just as computation with non-recombining binomial trees is much more difficult than with recombining trees.</p>
<p>As discussed in Sect. <a href="Chapter13.html#s_vasicek_fitting" data-reference-type="ref" data-reference="s_vasicek_fitting">[s_vasicek_fitting]</a>, the forward rate at date <span class="math inline">\(t\)</span> for an instantaneous loan at date <span class="math inline">\(u \geq t\)</span> is <span class="math inline">\(f(t,u)\)</span> defined by <span class="math display">\[\begin{equation}\label{hjmforward}
f(t,u)= -\frac{  \D \,\log P(t,u)}{\D u}\;.
\end{equation}\]</span> The short rate at time <span class="math inline">\(t\)</span> is the forward rate for maturity date <span class="math inline">\(t\)</span>; i.e., <span class="math inline">\(r(t)=f(t,t)\)</span>. By integrating <span class="math inline">\(\eqref{hjmforward}\)</span>, one can see that discount bond prices are written in terms of forward rates as: <span class="math display">\[\begin{equation}\label{bondsandforwards}
P(t,u)= \exp\left( - \int _t^u f(t,s)\,\D s \right)\; .\tag{\ref{hjmforward}$'$}
\end{equation}\]</span> Heath, Jarrow and Morton use the definition <a href="#bondsandforwards" data-reference-type="eqref" data-reference="bondsandforwards">[bondsandforwards]</a> and the fact that the expected return of a discount bond under the risk-neutral measure must be the short rate to derive a formula for the drifts of forward rates under the risk-neutral measure.</p>
<p>Assume, for the sake of simplicity, that there is only a single source of uncertainty (i.e., a single Brownian motion) driving the yield curve.<br>
Then, for each fixed <span class="math inline">\(u\)</span>, the forward rate <span class="math inline">\(f(t,u)\)</span> at date <span class="math inline">\(t&lt;u\)</span> will evolve as <span class="math display">\[\begin{equation}\label{hjm100}
\D f(t,u)=\mu(t,u)\,\D t+\sigma(t,u)\,\D B(t)\;,
\end{equation}\]</span> for some <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. In general <span class="math inline">\(\mu(t,u)\)</span> and <span class="math inline">\(\sigma(t,u)\)</span> could depend on the entire history of the Brownian motion through date~<span class="math inline">\(t\)</span>. Heath, Jarrow and Morton show that <span class="math display">\[\begin{equation}\label{hjm}
\mu(t,u)=\sigma(t,u) \int_t^u \sigma(t,s)\,\D s\;.
\end{equation}\]</span> One can show that <span class="math inline">\(\int_t^u \sigma(t,s)\,\D s\)</span> is the volatility of <span class="math inline">\(P(t,u)\)</span>. Therefore, <span class="math inline">\(\eqref{hjm}\)</span> states that the drift of the forward rate is the product of the volatilities of the forward rate and the discount bond return. A model is fully specified by specifying initial forward rates—i.e., <span class="math inline">\(f(0,u)\)</span> for all <span class="math inline">\(u\)</span>—and the volatility processes <span class="math inline">\(\sigma(t,u)\)</span> for each <span class="math inline">\(u\)</span> and <span class="math inline">\(t \leq u\)</span>. The generalization to multiple Brownian motions is straightforward and allows for forward rates that are not instantaneously perfectly correlated. An important application of the HJM modelling framework is work by Brace, Gatarek and Musiela <span class="citation" data-cites="BGM">[@BGM]</span> and Miltersen, Sandmann, and Sondermann <span class="citation" data-cites="MSS">[@MSS]</span>, who derive conditions on the volatility processes <span class="math inline">\(\sigma(t,u)\)</span> that guarantee forward LIBOR rates of a fixed maturity (e.g., quarterly or semi-annual rates) have deterministic volatilities, thus justifying the use of Black’s formula in Sect. <a href="Chapter12.html#s_valuingcaps" data-reference-type="ref" data-reference="s_valuingcaps">[s_valuingcaps]</a> for valuing caps and floors.</p>
<p>To see how some of the models we have discussed can be written in the HJM form, let us re-examine the Hull-White model. From the Hull-White bond price formula <a href="#extendedvasicekbondcombined" data-reference-type="eqref" data-reference="extendedvasicekbondcombined">[extendedvasicekbondcombined]</a>, the instantaneous forward rate in the Hull-White model is <span class="math display">\[\begin{align*}
f(t,u) &amp; = \phi(u)  + \frac{\partial}{\partial u} a(u-t) + \hat{r}(t)\frac{\partial}{\partial u} b(u-t)\\
&amp;= \phi(u) -\frac{\sigma^2}{2\kappa^2}\left(1 + \E^{-2\kappa(u-t)} -2 \E^{-\kappa(u-t)}\right) + \E^{-\kappa(u-t)}\hat{r}(t)\;.
\end{align*}\]</span> Applying Itô’s formula yields <span class="math display">\[\D f(t,u) = -\frac{\sigma^2}{\kappa}\left(\E^{-2\kappa(u-t)}-\E^{-\kappa(u-t)}\right)\,\D t + \sigma \E^{-\kappa(u-t)}\,\D B\; .\]</span> Therefore, in the HJM notation, <span class="math display">\[\mu(t,u) = -\frac{\sigma^2}{\kappa}\left(\E^{-2\kappa(u-t)}-\E^{-\kappa(u-t)}\right) \qquad \text{and} \qquad \sigma(t,u) =  \sigma \E^{-\kappa(u-t)}\; .\]</span> A direct calculation shows that these functions <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> satisfy the HJM equation <a href="#hjm" data-reference-type="eqref" data-reference="hjm">[hjm]</a>, as we knew they must, given that the HJM equation is based only on the assumption that expected returns of discount bonds equal the short rate under the risk-neutral measure. The initial forward rate curve in the Hull-White model is <span class="math inline">\(f(0,u) = \phi(u)\)</span> which is chosen to fit the market forward rate curve, as discussed in Sect. <a href="Chapter13.html#s_vasicek_fitting" data-reference-type="ref" data-reference="s_vasicek_fitting">[s_vasicek_fitting]</a>. Thus, rather than defining the Hull-White model as we did in Chap. <a href="Chapter13.html" data-reference-type="ref" data-reference="c_vasicek">[c_vasicek]</a>, it could be defined alternatively as an HJM model in which the volatility process is the deterministic function <span class="math inline">\(\sigma(t,u) = \sigma \E^{-\kappa(u-t)}\)</span> for positive constants <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span>. The normal distribution of the short rate in the Hull-White model is a consequence of the volatility <span class="math inline">\(\sigma(t,u)\)</span> being non-random.</p>
<p>Likewise, the Cox-Ingersoll-Ross model fit to market bond prices as we discussed in Sect. <a href="#s_cir" data-reference-type="ref" data-reference="s_cir">[s_cir]</a> could be described as an HJM model. Calculations of the sort we have just done show that the volatility process in the CIR model is <span class="math inline">\(\sigma(t,u) = \sigma b'(\tau)\sqrt{\hat{r}}(t)\)</span>, where <span class="math inline">\(\tau = u-t\)</span> and the function <span class="math inline">\(b\)</span> is defined in <a href="#cirbondcombined" data-reference-type="eqref" data-reference="cirbondcombined">[cirbondcombined]</a>. In this case, the volatility is random, but it depends only on the short rate at date <span class="math inline">\(t\)</span>. Similarly, in any factor model, such as the Longstaff-Schwartz model, the volatilities <span class="math inline">\(\sigma(t,u)\)</span> of the forward rates will depend only on the factors at each date <span class="math inline">\(t\)</span>. As mentioned at the beginning of this section, such a factor structure simplifies calculations considerably.</p>
<p>HJM models are sometimes written in a slightly different fashion than we have done here. If we define <span class="math display">\[\Sigma(t,u) = \int_t^u \sigma(t,s)\,\D s\]</span> then we have <span class="math inline">\(\D \Sigma(t,u)/\D u = \sigma(t,u)\)</span>, and the HJM equation <span class="math inline">\(\eqref{hjm}\)</span> can be written as <span class="math display">\[\mu(t,u) = \Sigma(t,u)\frac{\D \Sigma(t,u)}{\D u}\; ,\]</span> so the evolution of forward rates can be written as <span class="math display">\[\D f(t,u) = \Sigma(t,u)\frac{\D \Sigma(t,u)}{\D u}\,\D t + \frac{\D \Sigma(t,u)}{\D u}\,\D B(t)\; .\]</span> For example, in the Hull-White model we have <span class="math inline">\(\Sigma(t,u) = \sigma b(\tau)\)</span> where <span class="math inline">\(b\)</span> is defined in <span class="math inline">\(\eqref{extendedvasicekbondcombined}\)</span>, and in the CIR model, we have <span class="math inline">\(\Sigma(t,u) = \sigma b(\tau)\sqrt{\hat{r}(t)}\)</span>, where <span class="math inline">\(b\)</span> is defined in <span class="math inline">\(\eqref{cirbondcombined}\)</span>.</p>
</section>
<section id="market-models-again" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Market Models Again</h1>
<p>Many fixed-income derivatives (e.g., caps, floors, and swaps) have cash flows that depend on simple interest rates (e.g., LIBOR). In this chapter and the preceding chapter, we discussed valuation formulas for fixed-income derivatives based on (i) models of the short rate or one-period rate and possibly other factors, or (ii) models of instantaneous forward rates. However, it is possible, and simpler for many purposes, to model simple interest rates directly. For example, we observed in Chap. <a href="Chapter12.html" data-reference-type="ref" data-reference="c_fixedincomederivatives">[c_fixedincomederivatives]</a> that Black’s formula can be applied to value caps and floors when the underlying simple interest rates have nonrandom volatilities. Models of this type are called “market models” or “LIBOR models” or, sometimes, “BGM models,” the last name referring to the paper of Brace, Gatarek and Musiela <span class="citation" data-cites="BGM">[@BGM]</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> This class of models has become quite popular in recent years. A thorough and very readable account is given by Rebonato <span class="citation" data-cites="Rebonato02">[@Rebonato02]</span>.</p>
<p>As in Chap. <a href="Chapter12.html" data-reference-type="ref" data-reference="c_fixedincomederivatives">[c_fixedincomederivatives]</a>, we will use “LIBOR” as a generic name for simple interest rates. One important fact about forward LIBOR rates that we have already essentially derived is that they are martingales under the corresponding forward measures. As was discussed in Sect. <a href="Chapter7.html#s_futuresforwards" data-reference-type="ref" data-reference="s_futuresforwards">[s_futuresforwards]</a>, a probability measure corresponding to a discount bond being the numeraire is called a “forward measure,” because the forward price of any contract maturing at the same time as the discount bond is a martingale under that measure. We showed in Sect. <a href="Chapter12.html#s_portfoliosspotrates" data-reference-type="ref" data-reference="s_portfoliosspotrates">[s_portfoliosspotrates]</a> that forward LIBOR rates are forward prices of portfolios that pay spot rates. Specifically, considering a LIBOR rate of term (also called “tenor”) <span class="math inline">\(\varDelta t\)</span> and the forward LIBOR rate corresponding to loans over a period <span class="math inline">\(u\)</span> to <span class="math inline">\(u+\varDelta t\)</span>, the forward LIBOR rate is a martingale under the measure corresponding to the discount bond maturing at <span class="math inline">\(u+\varDelta t\)</span>.</p>
<p>To price derivatives other than caps and floors (e.g., swaptions), it is important to know the dynamics of forward LIBOR rates under other probability measures as well—for example, it is useful to know the dynamics under the forward measures corresponding to discount bonds maturing at dates <span class="math inline">\(T \neq u+\varDelta t\)</span>, or under the risk-neutral measure, or under the measure that uses as numeraire the portfolio consisting of rolling over an investment at spot LIBOR rates.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> We will derive here the dynamics under different forward measures.</p>
<p>Consider dates <span class="math inline">\(t_1 &lt; t_2 &lt; \cdots &lt; t_N\)</span> with <span class="math inline">\(t_i-t_{i-1} = \varDelta t\)</span> for each <span class="math inline">\(i\)</span>. At dates <span class="math inline">\(t\leq t_i\)</span>, we denote the forward LIBOR rate for the time period <span class="math inline">\((t_i, t_{i+1} )\)</span> by <span class="math inline">\(\mathcal{R}_i(t)\)</span>. The forward LIBOR rate satisfies equation~<span class="math inline">\(\eqref{forward2}\)</span>, which we repeat here: <span class="math display">\[\begin{equation}\label{marketmodel1}
\frac{P(t,t_i)}{P(t,t_{i+1})}=1+\mathcal{R}_i(t)\,\varDelta t\;.
\end{equation}\]</span> Fix a date <span class="math inline">\(t_n\)</span>. We will compute the drift of each rate <span class="math inline">\(\mathcal{R}_i(t)\)</span> when we use the discount bond maturing at <span class="math inline">\(t_{n}\)</span> as the numeraire.</p>
<p>Let <span class="math inline">\(\sigma_i(t)\)</span> denote the volatility of rate <span class="math inline">\(\mathcal{R}_i(t)\)</span> at date <span class="math inline">\(t\)</span>. This means that <span class="math display">\[\begin{equation}\label{marketmodel3}
\frac{\D \mathcal{R}_i(t)}{\mathcal{R}_i(t)} = \mu_i(t)\,\D t + \sigma_i(t)\,\D B_i(t)\;,
\end{equation}\]</span> for some <span class="math inline">\(\mu_i\)</span>, where the <span class="math inline">\(B_i\)</span> are Brownian motions when <span class="math inline">\(P(t,t_n)\)</span> is used as the numeraire. The different rates should be correlated, so the Brownian motions will be correlated. Let <span class="math inline">\(\rho_{ij}\)</span> denote the correlation of <span class="math inline">\(B_i\)</span> and <span class="math inline">\(B_j\)</span>. We will show that the drifts <span class="math inline">\(\mu_i\)</span> are determined by the volatilities and correlations, in analogy to the HJM result for instantaneous forward rates.<br>
Specifying the volatilities and correlations of forward rates, and inputting initial forward rates, must therefore determine the value of any security whose cash flows depend on the LIBOR rates of term <span class="math inline">\(\varDelta t\)</span> at the dates <span class="math inline">\(t_1, \ldots, t_N\)</span>. Of course, this does not mean that there are simple formulas. Obviously, the easiest case is when the volatilities and correlations are nonrandom. In this case, we can use Black’s formula to price caps and floors as in Chap. <a href="Chapter12.html" data-reference-type="ref" data-reference="c_fixedincomederivatives">[c_fixedincomederivatives]</a>. However, even when the <span class="math inline">\(\sigma_i\)</span> are nonrandom, forward swap rates will have random volatilities, as mentioned in Sect.~<span class="math inline">\(\ref{s_consistency}\)</span>.</p>
<p>If <span class="math inline">\(i = n-1\)</span>, then <span class="math inline">\(\eqref{marketmodel1}\)</span> implies <span class="math display">\[\mathcal{R}_i(t) = \frac{P(t,t_{n-1})-P(t,t_n)}{P(t,t_n)\,\varDelta t}\; .\]</span> Hence, it is the ratio of a non-dividend-paying asset (portfolio) price to the price of the numeraire asset. Consequently, it is a martingale, and we have <span class="math inline">\(\mu_{n-1}=0\)</span>. This is the case discussed in the second paragraph of this section. Consider now <span class="math inline">\(i \neq n-1\)</span>.</p>
<p>Define <span class="math display">\[\begin{equation}\label{marketmodely}
Y(t) = \frac{P(t,t_{i+1})}{P(t,t_n)}\;,
\end{equation}\]</span> and <span class="math display">\[\begin{equation}\label{marketmodelz}
Z(t) = \mathcal{R}_i(t)Y(t)\;.
\end{equation}\]</span> Note that <span class="math inline">\(Y\)</span> is the ratio of a non-dividend-paying asset price to the price of the numeraire asset and hence is a martingale. Furthermore, <span class="math inline">\(\eqref{marketmodel1}\)</span> gives us <span class="math display">\[ Z(t) = \frac{P(t,t_{i})-P(t,t_{i+1})}{P(t,t_n)\,\varDelta t}\; ,\]</span> and hence <span class="math inline">\(Z\)</span> is also the ratio of a non-dividend-paying asset (portfolio) price to the price of the numeraire asset and consequently a martingale.<br>
It^o’s formula applied to <span class="math inline">\(\eqref{marketmodelz}\)</span> yields <span class="math display">\[\frac{\D Z}{Z} = \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i} + \frac{\D Y}{Y} + \left( \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\D Y}{Y}\right)\; .\]</span> Because both <span class="math inline">\(Z\)</span> and <span class="math inline">\(Y\)</span> are martingales, the drift of <span class="math inline">\(\D \,\mathcal{R}_i/\mathcal{R}_i\)</span> must cancel the product (covariance) term in this equation, implying <span class="math display">\[\begin{equation}\label{marketmodel4}
\mu_i\,\D t = - \left( \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\D Y}{Y}\right)\;.
\end{equation}\]</span></p>
<p>To compute the covariance, it is helpful to define <span class="math display">\[\begin{equation}\label{marketmodelx}
X_j(t) = 1+ \mathcal{R}_j(t)\,\varDelta t
\end{equation}\]</span> for <span class="math inline">\(j = 1, \ldots , N\)</span>. Then we have <span class="math display">\[\begin{equation}\label{marketmodel5}
\frac{\D X_j}{X_j} = \left(\frac{\mathcal{R}_j\,\varDelta t}{1+\mathcal{R}_j\,\varDelta t}\right)\big(\mu_j\,\D t + \sigma_j\,\D B_j\big)\;.
\end{equation}\]</span> We distinguish two cases. If <span class="math inline">\(i &lt; n-1\)</span>, then the definitions <span class="math inline">\(\eqref{marketmodel1}\)</span>, <span class="math inline">\(\eqref{marketmodely}\)</span> and <span class="math inline">\(\eqref{marketmodelx}\)</span> imply <span class="math display">\[\begin{align*}
Y(t) &amp;= \frac{P(t,t_{i+1})}{P(t,t_{i+2})} \times \frac{P(t,t_{i+2})}{P(t,t_{i+3})} \cdots \times \frac{P(t,t_{n-1})}{P(t,t_n)}\\
&amp;= X_{i+1}(t)\times X_{i+2}(t) \times \cdots \times X_{n-1}(t)\;.
\end{align*}\]</span> In this case, <span class="math inline">\(\eqref{marketmodel3}\)</span> and <span class="math inline">\(\eqref{marketmodel5}\)</span> yield <span class="math display">\[\begin{align*}
\left( \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\D Y}{Y}\right) &amp;= \sum_{j=i+1}^{n-1} \left( \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\D X_j}{X_j}\right)\\
&amp;= \sum_{j=i+1}^{n-1} \left(\frac{\mathcal{R}_j\,\varDelta t}{1+\mathcal{R}_j\,\varDelta t}\right)\sigma_i\sigma_j\rho_{ij}\,\D t\;.
\end{align*}\]</span> On the other hand, if <span class="math inline">\(i &gt; n-1\)</span>, then the definitions <span class="math inline">\(\eqref{marketmodel1}\)</span>, <span class="math inline">\(\eqref{marketmodely}\)</span> and <span class="math inline">\(\eqref{marketmodelx}\)</span> imply <span class="math display">\[\begin{align*}
\frac{1}{Y(t)} &amp;= \frac{P(t,t_{n})}{P(t,t_{n+1})} \times \frac{P(t,t_{n+1})}{P(t,t_{n+2})} \times \cdots \times \frac{P(t,t_{i})}{P(t,t_{i+1})}\\
&amp;= X_{n}(t)\times X_{n+1}(t) \times \cdots \times X_{i}(t)\;.
\end{align*}\]</span> In this case, <span class="math inline">\(\eqref{marketmodel3}\)</span> and <span class="math inline">\(\eqref{marketmodel5}\)</span> yield <span class="math display">\[\begin{align*}
\left( \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\D Y}{Y}\right) &amp;= -\sum_{j=n}^{i} \left( \frac{\D \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\D X_j}{X_j}\right)\\
&amp;= -\sum_{j=n}^{i} \left(\frac{\mathcal{R}_j\,\varDelta t}{1+\mathcal{R}_j\,\varDelta t}\right)\sigma_i\sigma_j\rho_{ij}\,\D t\;.
\end{align*}\]</span> We conclude: </p>
</section>
<section id="problems" class="level1 unnumbered">
<h1 class="unnumbered">Problems</h1>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Actually, for this theory, it is not even necessary that the short rate exist, so the risk-neutral measure may not even be defined. The risk-neutral measure uses as numeraire the portfolio that consists of continuously rolling over an investment at the instantaneously risk-free rate, and the more natural object in a market model is the portfolio that consists of rolling over an investment at spot LIBOR rates.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Actually, for this theory, it is not even necessary that the short rate exist, so the risk-neutral measure may not even be defined. The risk-neutral measure uses as numeraire the portfolio that consists of continuously rolling over an investment at the instantaneously risk-free rate, and the more natural object in a market model is the portfolio that consists of rolling over an investment at spot LIBOR rates.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Actually, for this theory, it is not even necessary that the short rate exist, so the risk-neutral measure may not even be defined. The risk-neutral measure uses as numeraire the portfolio that consists of continuously rolling over an investment at the instantaneously risk-free rate, and the more natural object in a market model is the portfolio that consists of rolling over an investment at spot LIBOR rates.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Actually, for this theory, it is not even necessary that the short rate exist, so the risk-neutral measure may not even be defined. The risk-neutral measure uses as numeraire the portfolio that consists of continuously rolling over an investment at the instantaneously risk-free rate, and the more natural object in a market model is the portfolio that consists of rolling over an investment at spot LIBOR rates.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter13.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>