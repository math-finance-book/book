<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Pricing and Hedging Derivative Securities - 14&nbsp; A Brief Survey of Term Structure Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter13.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter14.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pricing and Hedging Derivative Securities</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Asset Pricing Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Continuous-Time Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimating and Modelling Volatility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Monte Carlo and Binomial Valuation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">The Yield Curve</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter14.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ho-lee" id="toc-ho-lee" class="nav-link active" data-scroll-target="#ho-lee"><span class="header-section-number">14.1</span> Ho-Lee</a></li>
  <li><a href="#black-derman-toy" id="toc-black-derman-toy" class="nav-link" data-scroll-target="#black-derman-toy"><span class="header-section-number">14.2</span> Black-Derman-Toy</a></li>
  <li><a href="#black-karasinski" id="toc-black-karasinski" class="nav-link" data-scroll-target="#black-karasinski"><span class="header-section-number">14.3</span> Black-Karasinski</a></li>
  <li><a href="#sec-s_cir" id="toc-sec-s_cir" class="nav-link" data-scroll-target="#sec-s_cir"><span class="header-section-number">14.4</span> Cox-Ingersoll-Ross</a>
  <ul class="collapse">
  <li><a href="#discount-bond-prices-in-the-cir-model" id="toc-discount-bond-prices-in-the-cir-model" class="nav-link" data-scroll-target="#discount-bond-prices-in-the-cir-model">Discount Bond Prices in the CIR Model</a></li>
  <li><a href="#calibrating-the-cir-model-to-the-yield-curve" id="toc-calibrating-the-cir-model-to-the-yield-curve" class="nav-link" data-scroll-target="#calibrating-the-cir-model-to-the-yield-curve">Calibrating the CIR Model to the Yield Curve</a></li>
  <li><a href="#pricing-fixed-income-derivatives-in-the-cir-model" id="toc-pricing-fixed-income-derivatives-in-the-cir-model" class="nav-link" data-scroll-target="#pricing-fixed-income-derivatives-in-the-cir-model">Pricing Fixed-Income Derivatives in the CIR Model</a></li>
  </ul></li>
  <li><a href="#sec-s_ls" id="toc-sec-s_ls" class="nav-link" data-scroll-target="#sec-s_ls"><span class="header-section-number">14.5</span> Longstaff-Schwartz</a></li>
  <li><a href="#sec-s_hjm" id="toc-sec-s_hjm" class="nav-link" data-scroll-target="#sec-s_hjm"><span class="header-section-number">14.6</span> Heath-Jarrow-Morton</a></li>
  <li><a href="#market-models-again" id="toc-market-models-again" class="nav-link" data-scroll-target="#market-models-again"><span class="header-section-number">14.7</span> Market Models Again</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">14.8</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-c_survey" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This chapter presents very brief descriptions of several important models. The list of models is certainly not exhaustive, and our descriptions will be far from complete. As mentioned previously, there are many good references for this material in book form already, and our goal here is merely to provide a short introduction.</p>
<section id="ho-lee" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="ho-lee"><span class="header-section-number">14.1</span> Ho-Lee</h2>
<p>The Ho-Lee <span class="citation" data-cites="HL">(<a href="#ref-HL" role="doc-biblioref">Ho and Lee 1986</a>)</span> model is a binomial version of the Vasicek model without mean reversion, in which the one-period interest rate is assumed to have a deterministic drift. This was the first widely-used model that enabled one to fit the current yield curve.</p>
<p>Consider discrete times <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N\)</span> with <span class="math inline">\(t_{i}-t_{i-1}=\Delta t\)</span> for each~<span class="math inline">\(i\)</span>. We denote the one-period interest rate from date <span class="math inline">\(t_i\)</span> to <span class="math inline">\(t_{i+1}\)</span> by <span class="math inline">\(r(t_i)\)</span>. We express the rate as an annualized continuously compounded rate, so the one-period discount factor from date <span class="math inline">\(t_i\)</span> to <span class="math inline">\(t_{i+1}\)</span> is <span class="math inline">\(\mathrm{e}^{-r(t_i) \Delta t}\)</span>. We could put this in a continuous-time framework by assuming the short rate is constant (<span class="math inline">\(= r(t_i)\)</span>) during each time interval <span class="math inline">\((t_i, t_{i+1})\)</span>. As always, the risk-neutral measure is the probability measure corresponding to the numeraire <span id="eq-holeeaccumulation"><span class="math display">\[
R(t) = \exp\left(\int_0^t r(s)\,\mathrm{d} s\right)\; .
\tag{14.1}\]</span></span></p>
<p>However, we will only be doing valuation at the discrete dates <span class="math inline">\(t_0, \ldots, t_N\)</span> and at date <span class="math inline">\(t_i\)</span> the accumulation factor <a href="#eq-holeeaccumulation">Equation&nbsp;<span>14.1</span></a> is <span class="math display">\[R(t_i) = \exp\left(\sum_{j=0}^{i-1} r(t_{j})\,\Delta t\right)\; .\]</span> Thus, the continuous-time framework is not necessary.</p>
<p>The model assumes that over each time period <span class="math inline">\(t_{i}-t_{i-1}\)</span> the change <span class="math inline">\(\Delta r(t_i) = r(t_i)-r(t_{i-1})\)</span> in the one-period rate is <span class="math display">\[ \Delta r(t_i) = \theta(t_i)\,\Delta t \pm \sigma \sqrt{\Delta t}\; ,\]</span> where the risk-neutral probability of <span class="math inline">\(+\)</span> and <span class="math inline">\(-\)</span> is <span class="math inline">\(1/2\)</span> each and <span class="math inline">\(\theta\)</span> is a non-random function.<br>
As in the discussion of the extended Vasicek model, it is convenient to define a random process~<span class="math inline">\(\hat{r}\)</span> by <span class="math inline">\(\hat{r}(0) = r(0)\)</span> and <span class="math display">\[\Delta \hat{r}(t_i) = \pm \sigma \sqrt{\Delta t}\]</span> for each <span class="math inline">\(i\)</span>. Also, define <span class="math inline">\(\phi(t_i) = \sum_{j=1}^i \theta(t_i)\)</span> for <span class="math inline">\(i \geq 1\)</span>. Then we have, for <span class="math inline">\(i &gt;0\)</span>, <span class="math display">\[r(t_i) = \phi(t_i) + \hat{r}(t_i)\; .\]</span></p>
<p>The following illustrates a three-period tree with initial one-period rate $r_0=$5%, <span class="math inline">\(\Delta t=1\)</span>, <span class="math inline">\(\theta(t_i)=0\)</span> for all <span class="math inline">\(i\)</span>, and $=$1%.</p>
<p>To value a fixed-income derivative, we discount the terminal value backwards through the tree as in Chaps.~<span class="math inline">\(\ref{c_introcomputation}\)</span> and~<span class="math inline">\(\ref{c_montecarlo}\)</span>. The new feature is that the discount rate is changing over time. So, we now have three trees to consider: the tree for the underlying, the tree for the one-period interest rate, and the tree for the derivative value. However, the tree for the underlying can be created from the interest-rate tree, so the interest-rate tree is the basic input instead of the tree for the underlying.</p>
<p>To clarify this, we will start with the simplest example: valuing a discount bond. Consider the above interest-rate tree and a discount bond that matures at date 3. The value of the bond is 1 at maturity. Because we are using continuous compounding, the discount factor is <span class="math inline">\(\mathrm{e}^{-.07} = 0.932\)</span> at the top node at date 2. This is also the value of the discount bond at that node. Likewise, the value of the bond at the middle node at date 2 is <span class="math inline">\(\mathrm{e}^{-.05} = 0.951\)</span>. This implies that the value of the bond at the top node at date 1 is <span class="math display">\[\mathrm{e}^{-.06}\left(\frac{1}{2} \times 0.932 + \frac{1}{2} \times 0.951\right) = 0.887\; .\]</span> Continuing in this way, we derive the following tree for the discount bond, concluding that its price at date 0 should be $0.861.</p>
<p>In general, the price at date 0 of a discount bond maturing at date <span class="math inline">\(t_n\)</span> is <span class="math display">\[
P(0,t_n) = E^R\left[\exp\left(-\sum_{i=0}^{n-1} r(t_i)\,\Delta t\right)\right]\mathrm{n}otag
\]</span> <span class="math display">\[
= E^R\left[\exp\left(-r(t_0)\,\Delta t - \sum_{i=1}^{n-1} [\hat{r}(t_i) + \phi(t_i) ]\,\Delta t\right)\right]\mathrm{n}otag
\]</span> <span id="eq-holee1"><span class="math display">\[
= \exp\left(-r(t_0)\,\Delta t-\sum_{i=1}^{n-1}\phi(t_i)\,\Delta t \right)E^R\left[\exp\left(-\sum_{i=1}^{n-1} \hat{r}(t_i) \,\Delta t\right)\right]\;.
\tag{14.2}\]</span></span></p>
<p>Given the parameter <span class="math inline">\(\sigma\)</span>, the expectation in the last line of the above can easily be computed.</p>
<p>The parameters <span class="math inline">\(\phi(t_n)\)</span> can be chosen to equate model prices of discount bonds maturing at <span class="math inline">\(t_1, \ldots, t_N\)</span> to market prices. This is done simply by choosing <span class="math inline">\(\phi(t_n)\)</span> to satisfy the following equation, which we will derive below: <span id="eq-holee3"><span class="math display">\[
\mathrm{e}^{-\phi(t_n)\,\Delta t} = \frac{2\mathrm{e}^{r(0)\,\Delta t}}{ \mathrm{e}^{n\sigma\sqrt{\Delta t}\,\Delta t} +  \mathrm{e}^{-n\sigma\sqrt{\Delta t}\,\Delta t}}\times \frac{P^{\text{mkt}}(0,t_{n+1})}{P^{\text{mkt}}(0,t_{n})}.
\tag{14.3}\]</span></span></p>
<p>Because the ratio of market prices <span class="math inline">\(P^{\text{mkt}}(0,t_{i+1})/P^{\text{mkt}}(0,t_{i})\)</span> is the reciprocal of one plus the market forward rate at date 0 for loans from date <span class="math inline">\(t_i\)</span> to <span class="math inline">\(t_{i+1}\)</span>, this formula for the parameters <span class="math inline">\(\phi(t_i)\)</span> is equivalent to equating model forward rates to market forward rates, as was discussed for the Hull-White and continuous-time Ho-Lee models in Sect.~<span class="math inline">\(\ref{s_vasicek_fitting}\)</span>. In fact, the fitting of the Ho-Lee model to market bond prices is often expressed by saying the market forward rate curve is an input to the model. This idea was developed further by Heath, Jarrow and Morton <span class="citation" data-cites="HJM">(<a href="#ref-HJM" role="doc-biblioref">Heath, Jarrow, and Morton 1992</a>)</span>—see Sect.~<span class="math inline">\(\ref{s_hjm}\)</span>.</p>
<p>As for options on equities and currencies, the binomial model for interest rates is especially useful for valuing early exercise features.<br>
However, it should be noted that, even though this model is very easy to use, it has important limitations. The assumption of a constant volatility for the one-period rate and no mean reversion implies excessive uncertainty about the level of the one-period rate at long horizons, as discussed in Sect.~<span class="math inline">\(\ref{s_vasicek1}\)</span>. To offset this, one could use a smaller volatility when valuing long-maturity options. However, for options with early exercise features, this would imply too little uncertainty about the level of the one-period rate at short horizons and thereby undervalue the early exercise option.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>## We will conclude this section with a proof of formula <a href="#eq-holee3">Equation&nbsp;<span>14.3</span></a>. Let <span class="math inline">\(\mathrm{var}epsilon(t_i)\)</span> denote independent random variables that equal <span class="math inline">\(\pm \sigma \sqrt{\Delta t}\)</span> with probability <span class="math inline">\(1/2\)</span> each under the risk-neutral measure. Then we can write <span class="math display">\[\hat{r}(t_i) = r(0) + \sum_{j=1}^i \mathrm{var}epsilon(t_j)\; .\]</span> This implies that <span class="math display">\[
\sum_{i=0}^{n-1}\hat{r}(t_i)  
= (n-1)r(0) + \sum_{i=1}^{n-1}\sum_{j=1}^i \mathrm{var}epsilon(t_j)
\]</span> <span class="math display">\[
= (n-1)r(0) + (n-1)\mathrm{var}epsilon(t_1) + (n-2)\mathrm{var}epsilon(t_2) + \cdots + \mathrm{var}epsilon(t_{n-1})
\]</span> <span class="math display">\[
= (n-1)r(0) + \sum_{i=1}^{n-1} (n-i)\mathrm{var}epsilon(t_i)\;.
\]</span> Therefore, <a href="#eq-holee1">Equation&nbsp;<span>14.2</span></a> gives us <span class="math display">\[
P(0,t_n) = \exp\left(-nr(0)\,\Delta t-\sum_{i=1}^{n-1}\phi(t_i)\,\Delta t \right)E^R\left[\exp\left(-\sum_{i=1}^{n-1} (n-i)\mathrm{var}epsilon(t_i)\Delta t\right)\right]\;.
\]</span> Moreover, <span class="math display">\[\begin{multline*}
E^R\left[\exp\left(-\sum_{i=1}^{n-1}(n-i)\mathrm{var}epsilon(t_i)\,\Delta t\right)\right]  = E^R \left[ \prod_{i=1}^{n-1}\exp\left(-(n-i)\mathrm{var}epsilon(t_i)\,\Delta t\right)\right]
$$
$$
= \prod_{i=1}^{n-1} E^R \left[ \exp\left(-(n-i)\mathrm{var}epsilon(t_i)\,\Delta t\right)\right]
$$
$$
= \prod_{i=1}^{n-1} \left( \frac{1}{2} \exp\left((n-i)\sigma\sqrt{\Delta t}\,\Delta t\right) + \frac{1}{2} \exp\left(-(n-i)\sigma\sqrt{\Delta t}\,\Delta t\right)\right)\;.
\end{multline*}\]</span> Thus, <span class="math display">\[\begin{multline*}
P(0,t_n) = \exp\left(-nr(0)\,\Delta t-\sum_{i=1}^{n-1}\phi(t_i)\,\Delta t\right)
$$
$$
\times \prod_{i=1}^{n-1} \left( \frac{1}{2} \exp\left((n-i)\sigma\sqrt{\Delta t}\,\Delta t\right) + \frac{1}{2} \exp\left(-(n-i)\sigma\sqrt{\Delta t}\,\Delta t\right)\right).
\end{multline*}\]</span> Likewise, <span class="math display">\[\begin{multline*}
P(0,t_{n+1})  = \exp\left(-(n+1)r(0)\,\Delta t-\sum_{i=1}^n\phi(t_i)\,\Delta t\right)
$$
$$
\times \prod_{i=1}^n \left( \frac{1}{2} \exp\left((n+1-i)\sigma\sqrt{\Delta t}\,\Delta t\right) + \frac{1}{2} \exp\left(-(n+1-i)\sigma\sqrt{\Delta t}\,\Delta t\right)\right)\; ,
\end{multline*}\]</span> which we can write as <span class="math display">\[\begin{multline*}
\exp\left(-(n+1)r(0)\,\Delta t-\sum_{i=1}^n\phi(t_i)\,\Delta t\right)
$$
$$
\times \prod_{i=0}^{n-1} \left( \frac{1}{2} \exp\left((n-i)\sigma\sqrt{\Delta t}\,\Delta t\right) + \frac{1}{2} \exp\left(-(n-i)\sigma\sqrt{\Delta t}\,\Delta t\right)\right)

$$
$$= \exp\left(-r(0)\,\Delta t-\phi(t_n)\,\Delta t\right)
$$
$$
\times \left( \frac{1}{2} \exp\left(n\sigma\sqrt{\Delta t}\,\Delta t\right) + \frac{1}{2} \exp\left(-n\sigma\sqrt{\Delta t}\,\Delta t\right)\right)P(0,t_n)\;.
\end{multline*}\]</span> Thus, the ratio of model prices is <span class="math display">\[\begin{multline*}
\frac{P(0,t_{n+1})}{P(0,t_n)} = \exp\left(-r(0)\,\Delta t-\phi(t_n)\,\Delta t\right)
$$
$$
\times \left( \frac{1}{2} \exp\left(n\sigma\sqrt{\Delta t}\,\Delta t\right) + \frac{1}{2} \exp\left(-n\sigma\sqrt{\Delta t}\,\Delta t\right)\right)\; .
\end{multline*}\]</span> Equating this to the ratio of market prices <span class="math inline">\(P^{\text{mkt}}(0,t_{n+1})/P^{\text{mkt}}(0,t_{n})\)</span> gives the formula <a href="#eq-holee3">Equation&nbsp;<span>14.3</span></a>.</p>
</div>
</div>
</section>
<section id="black-derman-toy" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="black-derman-toy"><span class="header-section-number">14.2</span> Black-Derman-Toy</h2>
<p>The Black-Derman-Toy <span class="citation" data-cites="BDT">(<a href="#ref-BDT" role="doc-biblioref">Black, Derman, and Toy 1990</a>)</span> model is, like the Ho-Lee model and the Black-Karasinski model discussed in the next section, a binomial model of the one-period interest rate. The model assumes that <span id="eq-bdt1"><span class="math display">\[
\Delta \log r(t_i) = \eta(t_i)\,\Delta t \pm \sigma(t_i)\sqrt{\Delta t},
\tag{14.4}\]</span></span></p>
<p>where <span class="math inline">\(+\)</span> and <span class="math inline">\(-\)</span> have probability one-half each under the risk-neutral measure. The volatility <span class="math inline">\(\sigma(t_i)\)</span> has the interpretation of the volatility of the one-period rate (rather than the absolute volatility, as in the Vasicek and Ho-Lee models). The model implies that the one-period rate will always be nonnegative.</p>
A significant feature of the model is that the volatility is allowed to be time-varying. This would produce a non-recombining tree except that the drift <span class="math inline">\(\eta(t_i)\)</span> is allowed to vary across the date–<span class="math inline">\(t_{i-1}\)</span> nodes, i.e., to be a random variable, depending on the level of the one-period rate at date <span class="math inline">\(t_{i-1}\)</span>. To understand this, consider the following two-period tree. For convenience, we write <span class="math inline">\(a_i\)</span> for <span class="math inline">\(\eta(t_i)\,\Delta t\)</span> and <span class="math inline">\(b_i\)</span> for <span class="math inline">\(\sigma(t_i)\sqrt{\Delta t}\)</span>.
<p>We have written <span class="math inline">\(a_{2u}\)</span> and <span class="math inline">\(a_{2d}\)</span> to demonstrate that the drift between date 1 and date 2 can vary, depending on whether we are at the top or bottom node at date 1. If we arrive at the node marked with a question mark via a down move from the top node at date 1, the value will be <span class="math display">\[\log r(0)+a_1+b_1+a_{2u}-b_2\; .\]</span> On the other hand, if we arrive at it via an up move from the bottom node at date 1, the value will be <span class="math display">\[\log r(0) + a_1-b_1+a_{2d}+b_2\; .\]</span> For the tree to be recombining, these values must be the same, which implies <span class="math display">\[a_{2d} = a_{2u} + 2b_1-2b_2\; .\]</span> In general, at each date there are two free parameters: the volatility and the drift at one of the nodes, the drifts at the other nodes then being determined by the requirement that the tree be recombining.</p>
<p>The dependence of the drift on the node can be expressed as a linear dependence on the logarithm of the one-period rate. In other words, it is possible (and convenient) to write the Black-Derman-Toy model <a href="#eq-bdt1">Equation&nbsp;<span>14.4</span></a> as <span id="eq-bdt2"><span class="math display">\[
\Delta \log r(t_i) = \kappa(t_i)[\theta(t_i) - \log r(t_{i-1})]\,\Delta t \pm \sigma(t_i)\sqrt{\Delta t},
\tag{14.5}\]</span></span></p>
<p>where now the functions <span class="math inline">\(\kappa(t_i)\)</span>, <span class="math inline">\(\theta(t_i)\)</span>, and <span class="math inline">\(\sigma(t_i)\)</span> are deterministic—i.e., depending on time but constant across nodes at each date.</p>
<p>In the two-period example above, we have <span class="math display">\[a_{2u} = \kappa(t_2)[\theta(t_2) - \{\log r(t_0) +a_1+b_1\}]\,\Delta t\; ,\]</span> and <span class="math display">\[a_{2d} = \kappa(t_2)[\theta(t_2) - \{\log r(t_0) +a_1-b_1\}]\,\Delta t\; ,\]</span> so the relation <span class="math inline">\(a_{2d} = a_{2u} + 2b_1-2b_2\)</span> is equivalent to <span id="eq-bdt4"><span class="math display">\[
\kappa(t_2) = \frac{b_1-b_2}{b_1\,\Delta t} = - \frac{1}{\sigma(t_1)}\times\frac{\sigma(t_2)-\sigma(t_1)}{\Delta t} = - \frac{1}{\sigma(t_1)}\times\frac{\Delta \sigma(t_2)}{\Delta t}.
\tag{14.6}\]</span></span></p>
<p>This same relationship holds at each node at each date (just consider the two-period example as two periods extending from any node in the tree); thus, in general, we have <span id="eq-bdt3"><span class="math display">\[
\kappa(t_i) = - \frac{1}{\sigma(t_{i-1})}\times\frac{\Delta \sigma(t_i)}{\Delta t}.
\tag{14.7}\]</span></span></p>
<p>Equations <a href="#eq-bdt2">Equation&nbsp;<span>14.5</span></a> and <a href="#eq-bdt3">Equation&nbsp;<span>14.7</span></a> define the Black-Derman-Toy model. The free parameters at each date are <span class="math inline">\(\sigma(t_i)\)</span> and <span class="math inline">\(\theta(t_i)\)</span>, and the parameter <span class="math inline">\(\kappa(t_i)\)</span> is defined by <a href="#eq-bdt3">Equation&nbsp;<span>14.7</span></a>. Alternatively, one can view <span class="math inline">\(\kappa(t_i)\)</span> and <span class="math inline">\(\theta(t_i)\)</span> as free parameters and define <span class="math inline">\(\sigma(t_i)\)</span> from <a href="#eq-bdt3">Equation&nbsp;<span>14.7</span></a>. Note that <span class="math inline">\(\kappa(t_i)\)</span> can be interpreted as a mean-reversion parameter for <span class="math inline">\(\log r(t_i)\)</span>, at least when it is positive (i.e., when <span class="math inline">\(\Delta \sigma(t_i)&lt;0\)</span>). Because there are two free parameters at each date rather than one (as in the Ho-Lee model) it is possible to match both market bond prices and market yield volatilities or cap prices.</p>
<p>In continuous time, we would write <a href="#eq-bdt3">Equation&nbsp;<span>14.7</span></a> as <span class="math display">\[\kappa(t) = -\frac{\mathrm{d} \log \sigma(t)}{\mathrm{d} t}\; .\]</span> Therefore, the continuous-time version of the Black-Derman-Toy model is <span class="math display">\[\mathrm{d} \log r(t) = -\frac{\mathrm{d} \log \sigma(t)}{\mathrm{d} t}[\theta(t)-\log r(t)]\,\mathrm{d} t + \sigma(t)\,\mathrm{d} B(t)\; ,\]</span> with <span class="math inline">\(B\)</span> being a Brownian motion under the risk-neutral measure.</p>
</section>
<section id="black-karasinski" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="black-karasinski"><span class="header-section-number">14.3</span> Black-Karasinski</h2>
<p>The Black-Karasinski <span class="citation" data-cites="BK">(<a href="#ref-BK" role="doc-biblioref">Black and Karasinski 1991</a>)</span> model is similar to the Black-Derman-Toy model—it assumes <a href="#eq-bdt2">Equation&nbsp;<span>14.5</span></a> for the changes in the logarithm of the one-period rate—but it removes the linkage <a href="#eq-bdt3">Equation&nbsp;<span>14.7</span></a> between the mean-reversion parameter and the volatility. It does this by allowing the lengths of the time steps to vary. Denote the length of the time-step <span class="math inline">\(t_i-t_{i-1}\)</span> by~<span class="math inline">\(\tau_i\)</span>. Consider again the two-period example of the previous section. As a necessary condition for the tree to be recombining, we deduced (in <a href="#eq-bdt4">Equation&nbsp;<span>14.6</span></a>) that <span class="math display">\[\kappa(t_2) = \frac{b_1-b_2}{b_1\,\tau_2}\; .\]</span> In this model, we have <span class="math inline">\(b_i = \sigma(t_i)\sqrt{\tau_i}\)</span>. Making this substitution, we obtain <span class="math display">\[\kappa(t_2) = \frac{\sigma(t_1)\sqrt{\tau_1} - \sigma(t_2)\sqrt{\tau_2}}{\sigma(t_1)\sqrt{\tau_1}\tau_2}\; ,\]</span> which we can rewrite as <span class="math display">\[\kappa(t_2)\sigma(t_1)\sqrt{\tau_1}\tau_2 + \sigma(t_2)\sqrt{\tau_2} - \sigma(t_1)\sqrt{\tau_1} = 0\; .\]</span> This is a quadratic equation in the unknown <span class="math inline">\(\sqrt{\tau_2}\)</span> with the unique positive solution (assuming <span class="math inline">\(\kappa(t_2)&gt;0\)</span>) <span class="math display">\[\sqrt{\tau_2} = \frac{\sqrt{\sigma(t_2)^2 + 4\kappa(t_2)\sigma(t_1)^2\sqrt{\tau_1}} - \sigma(t_2)}{2\kappa(t_2)\sigma(t_1)\sqrt{\tau_1}}\; .\]</span> This relation must hold at each date. Thus, squaring both sides, we obtain the general formula <span id="eq-bk1"><span class="math display">\[
\tau_i = \frac{\left[\sqrt{\sigma(t_i)^2 + 4\kappa(t_i)\sigma(t_{i-1})^2\sqrt{\tau_{i-1}}} - \sigma(t_i)\right]^2}{4\kappa(t_i)^2\sigma(t_{i-1})^2 \tau_{i-1}}.
\tag{14.8}\]</span></span></p>
<p>To summarize, the Black-Karasinski model is given by <a href="#eq-bdt2">Equation&nbsp;<span>14.5</span></a> with three free parameters—<span class="math inline">\(\kappa(t_i)\)</span>, <span class="math inline">\(\theta(t_i)\)</span>, and <span class="math inline">\(\sigma(t_i)\)</span>—at each date. It is implemented in a recombining tree by defining the length of each time step <span class="math inline">\(\tau_i = t_i-t_{i-1}\)</span> for <span class="math inline">\(i \geq 2\)</span> according to the formula <a href="#eq-bk1">Equation&nbsp;<span>14.8</span></a>. The length of the first time step <span class="math inline">\(\tau_1\)</span> can be chosen arbitrarily.</p>
</section>
<section id="sec-s_cir" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="sec-s_cir"><span class="header-section-number">14.4</span> Cox-Ingersoll-Ross</h2>
<p>Cox, Ingersoll, and Ross <span class="citation" data-cites="CIR">(<a href="#ref-CIR" role="doc-biblioref">Cox, Ingersoll, and Ross 1985</a>)</span> introduced a continuous-time model^[Cox, Ingersoll and Ross (hereafter CIR) also discuss a variety of other continuous-time models, but this particular model is so well known that it is often simply called in which the short rate satisfies <span id="eq-cir"><span class="math display">\[
\mathrm{d} r(t)=\kappa [\theta-r(t)]\,\mathrm{d} t+\sigma \sqrt{r(t)}\,\mathrm{d} B(t),
\tag{14.9}\]</span></span></p>
<p>where <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\sigma\)</span> are positive constants and <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. Like the Vasicek model, this short rate process has a long-run mean of <span class="math inline">\(\theta\)</span>. The difference between the CIR model and the Vasicek model is that the volatility in the CIR model is proportional to the square root of the short rate rather than being constant. Because of this fact, the short rate can never be negative. Intuitively, the reason is that the volatility <span class="math inline">\(\sigma\sqrt{r(t)}\)</span> is very small if <span class="math inline">\(r(t)\)</span> is near zero, so the drift will dominate the change in <span class="math inline">\(r(t)\)</span>, pushing it upwards towards <span class="math inline">\(\theta\)</span>. This interest rate model was mimicked by Heston <span class="citation" data-cites="Heston">(<a href="#ref-Heston" role="doc-biblioref">Heston 1993</a>)</span> in his stochastic volatility model discussed in <a href="Chapter4.html"><span>Chapter&nbsp;4</span></a>. We will briefly discuss three topics in connection with this model: discount bond prices, calibrating the model to the current market, and pricing fixed-income derivatives.</p>
<section id="discount-bond-prices-in-the-cir-model" class="level3">
<h3 class="anchored" data-anchor-id="discount-bond-prices-in-the-cir-model">Discount Bond Prices in the CIR Model</h3>
<p>Discount bond prices can be most easily computed in the CIR model by solving the fundamental partial differential equation (pde) discussed in <a href="Chapter10.html"><span>Chapter&nbsp;10</span></a>. Let <span class="math inline">\(P(t,u)\)</span> denote the price at date <span class="math inline">\(t\)</span> of a discount bond maturing at date <span class="math inline">\(u\)</span>, having remaining time to maturity of <span class="math inline">\(\tau = u-t\)</span>. The discount bond price will depend on the remaining time to maturity and the short rate at date <span class="math inline">\(t\)</span>, because, as in the Vasicek model, the short rate is the only random factor in this model. Thus, there must be some deterministic function <span class="math inline">\(f\)</span> such that <span class="math inline">\(P(t,u) = f(r(t),\tau).\)</span> As in <a href="Chapter10.html"><span>Chapter&nbsp;10</span></a>, the fundamental pde is obtained by applying Ito’s formula to <span class="math inline">\(f\)</span> to compute <span class="math inline">\(\mathrm{d} f\)</span> in terms of the partial derivatives of <span class="math inline">\(f\)</span> and then using the fact that the expected return of the discount bond (hence the drift of <span class="math inline">\(\mathrm{d} f/f\)</span>) must equal the short rate under the risk-neutral measure.</p>
<p>From Ito’s formula and the definition <a href="#eq-cir">Equation&nbsp;<span>14.9</span></a> of <span class="math inline">\(\mathrm{d} r\)</span>, we have <span class="math display">\[
\mathrm{d} f = \frac{\partial f}{\partial \tau}\,\mathrm{d} \tau + \frac{\partial f}{\partial r}\,\mathrm{d} r + \frac{1}{2}\frac{\partial^2 f}{\partial r^2}\,(\mathrm{d} r)^2\mathrm{n}otag
\]</span> <span class="math display">\[
= - \frac{\partial f}{\partial \tau} \,\mathrm{d} t + \frac{\partial f}{\partial r}\left\{\kappa [\theta-r]\,\mathrm{d} t+\sigma \sqrt{r}\,\mathrm{d} B\right\} + \frac{1}{2}\frac{\partial^2f}{\partial r^2}\sigma^2r\,\mathrm{d} t\mathrm{n}otag
\]</span> <span id="eq-cir10"><span class="math display">\[
= \left(- \frac{\partial f}{\partial \tau} + \frac{\partial f}{\partial r}\kappa [\theta-r] + \frac{1}{2}\frac{\partial^2f}{\partial r^2}\sigma^2r\right)\,\mathrm{d} t + \frac{\partial f}{\partial r} \sigma\sqrt{r}\,\mathrm{d} B\;.
\tag{14.10}\]</span></span></p>
<p>Equating the drift to <span class="math inline">\(rf\,\mathrm{d} t\)</span> gives us the fundamental pde: <span id="eq-cir2"><span class="math display">\[
- \frac{\partial f}{\partial \tau} + \frac{\partial f}{\partial r}\kappa [\theta-r] + \frac{1}{2}\frac{\partial^2f}{\partial r^2}\sigma^2r = rf\;.
\tag{14.11}\]</span></span></p>
<p>This equation should be solved for the function <span class="math inline">\(f\)</span> subject to the boundary condition that the value of the discount bond is one at maturity; i.e., <span class="math inline">\(f(r,0)=1\)</span> for all <span class="math inline">\(r\)</span>.</p>
<p>The solution can be obtained by guessing a solution of the same form as the Vasicek bond pricing formula <a href="Chapter13.html#eq-vasicekbond">Equation&nbsp;<span>13.7</span></a>, namely^[This guess works because the CIR model, like the Vasicek model, is an affine model. See Sect.~<span class="math inline">\(\ref{s_ls].}\)</span> <span id="eq-cir3"><span class="math display">\[
f(r,\tau) = \exp\left(-a(\tau)-b(\tau)r\right)
\tag{14.12}\]</span></span></p>
<p>for deterministic functions <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. The boundary condition <span class="math display">\[f(r,0)= \exp\left(-a(0)-b(0)r\right) = 1\]</span> for all <span class="math inline">\(r\)</span> implies <span class="math inline">\(a(0)=b(0)=0\)</span>, and it can easily be checked that the fundamental pde is equivalent to</p>
<p><span id="eq-betaprime"><span class="math display">\[
b '(\tau)=1-\kappa b (\tau)-\frac{ 1}{2}\sigma^2
b ^2(\tau)\;,
\tag{14.13}\]</span></span></p>
<p>and <span id="eq-alphaprime"><span class="math display">\[
a '(\tau)=\kappa \theta b (\tau)\;,  
\tag{14.14}\]</span></span></p>
<p>where the primes denote derivatives. By differentiating, one can verify that the solution of <a href="#eq-betaprime">Equation&nbsp;<span>14.13</span></a> (which is called a Riccati equation) with the boundary condition <span class="math inline">\(b(0)=0\)</span> is</p>
<p><span id="eq-cirbeta"><span class="math display">\[
b (\tau)=\frac{ 2 \left( \mathrm{e}^{\gamma \tau}-1 \right)}{c(\tau) }\;,
\tag{14.15}\]</span></span></p>
<p>where <span id="eq-candgamma"><span class="math display">\[
\gamma=\sqrt{ \kappa^2+2 \sigma^2 } \qquad \text{and} \qquad c(\tau) =(\kappa+\gamma) \left( \mathrm{e}^{\gamma \tau}-1 \right) + 2 \gamma\;.
\tag{14.16}\]</span></span></p>
<p>Integrating <a href="#eq-alphaprime">Equation&nbsp;<span>14.14</span></a> then gives <span id="eq-ciralpha"><span class="math display">\[
a (\tau )= -\frac{ 2 \kappa \theta}{\sigma^2 } \left[
\frac{ (\kappa +\gamma)\tau}{2}+\log \frac{ 2
\gamma}{c(\tau)}\right]\;.
\tag{14.17}\]</span></span></p>
<p>To summarize,</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<p>The price at date <span class="math inline">\(t\)</span> of a discount bond maturing at <span class="math inline">\(u&gt;t\)</span> in the CIR model is <span class="math display">\[
P(t,u) = \exp\left(-a(\tau)-b(\tau)r(t)\right)\;,
\]</span> where <span class="math inline">\(\tau = u-t\)</span> and <span class="math inline">\(a(\tau)\)</span> and <span class="math inline">\(b(\tau)\)</span> are defined in <span class="quarto-unresolved-ref">?eq-cirbondcombined</span>.</p>
</div>
</div>
<p>Note that <a href="#eq-cir3">Equation&nbsp;<span>14.12</span></a> implies <span class="math inline">\(\partial f/\partial r = - b(\tau)f\)</span>. Substituting this into <a href="#eq-cir10">Equation&nbsp;<span>14.10</span></a> gives us the discount bond return as <span id="eq-cirdpp"><span class="math display">\[
\frac{\mathrm{d} P(t,u)}{P(t,u)} =\frac{\mathrm{d} f}{f} =   r(t)\,\mathrm{d} t - b(\tau)\sigma\sqrt{r(t)}\,\mathrm{d} B(t)\;.
\tag{14.18}\]</span></span></p>
<p>This is again similar to the Vasicek model except for the appearance of the <span class="math inline">\(\sqrt{\,r}\)</span> factor in the volatility. Because of this factor, the volatility is random. Thus, the option pricing formulas of previous chapters cannot be directly applied to price discount bond options (and hence caps, floors, coupon bond options, and swaptions). Nevertheless, the ideas underlying those formulas can be applied to obtain similar valuation formulas.</p>
<p>Hedge ratios depend on relative volatilities, so they are determined by the function <span class="math inline">\(b\)</span>, just as discussed in Sect.~<span class="math inline">\(\ref{s_vasicekhedging}\)</span> for the Vasicek model.</p>
</section>
<section id="calibrating-the-cir-model-to-the-yield-curve" class="level3">
<h3 class="anchored" data-anchor-id="calibrating-the-cir-model-to-the-yield-curve">Calibrating the CIR Model to the Yield Curve</h3>
<p>The CIR model can be calibrated to current market conditions by taking one or more of the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span> to be time-varying, as in the extended Vasicek model. This was suggested by Cox, Ingersoll and Ross. However, the simplest way to calibrate the model to discount bond prices, which was also suggested by Cox, Ingersoll and Ross, is to take the short rate to be the sum of a non-random function of time and a square-root process as defined in <a href="#eq-cir">Equation&nbsp;<span>14.9</span></a>. Specifically, let <span class="math display">\[r(t) = \phi(t) + \hat{r}(t)\; ,\]</span> where <span class="math inline">\(\phi\)</span> is a non-random function and <span class="math inline">\(\hat{r}\)</span> satisfies <span id="eq-cirrhat"><span class="math display">\[
\mathrm{d} \hat{r}(t)=\kappa [\theta-\hat{r}(t)]\,\mathrm{d} t+\sigma \sqrt{\hat{r}(t)}\,\mathrm{d} B(t)\;,
\tag{14.19}\]</span></span></p>
<p>with <span class="math inline">\(\hat{r}(0) = r(0)\)</span>. Then, as in the Hull-White model, discount bond prices are given by <span class="math display">\[P(t,u) = \exp\left(-\int_t^u \phi(s)\,\mathrm{d} s\right)E^R_t\left[\exp\left(-\int_t^u\hat{r}(s)\,\mathrm{d} s\right)\right]\; .\]</span> Moreover, the expectation in this equation is the discount bond pricing function calculated in the previous subsection, so we have <span id="eq-cirPcal"><span class="math display">\[
P(t,u) = \exp\left(-\int_t^u \phi(s)\,\mathrm{d} s\right)\exp\left(-a(\tau)-b(\tau)\hat{r}(t)\right)\;.
\tag{14.20}\]</span></span></p>
<p>In particular, discount bond prices at date 0 are <span class="math display">\[P(0,u) = \exp\left(-\int_0^u \phi(s)\,\mathrm{d} s\right)\exp\left(-a(u)-b(u)r(0)\right)\; ,\]</span> so the model can be calibrated to market prices <span class="math inline">\(P^{\text{mkt}}(0,u)\)</span> by setting <span id="eq-circalibration"><span class="math display">\[
\exp\left(-\int_0^u \phi(s)\,\mathrm{d} s\right) = \exp\left(a(u)+b(u)r(0)\right)P^{\text{mkt}}(0,u)
\tag{14.21}\]</span></span></p>
<p>for each <span class="math inline">\(u\)</span>. Note that the calibration does not affect discount bond returns: the expected return under the risk-neutral measure must still be the short rate and the volatility is unaffected by a deterministic factor. Therefore, we have, as in <a href="#eq-cirdpp">Equation&nbsp;<span>14.18</span></a>, <span id="eq-cirdpp2"><span class="math display">\[
\frac{\mathrm{d} P(t,u)}{P(t,u)}  =   r(t)\,\mathrm{d} t - b(\tau)\sigma\sqrt{\hat{r}(t)}\,\mathrm{d} B(t)\;.
\tag{14.22}\]</span></span></p>
<p>This can be verified by applying Ito’s formula to <a href="#eq-cirPcal">Equation&nbsp;<span>14.20</span></a>.</p>
</section>
<section id="pricing-fixed-income-derivatives-in-the-cir-model" class="level3">
<h3 class="anchored" data-anchor-id="pricing-fixed-income-derivatives-in-the-cir-model">Pricing Fixed-Income Derivatives in the CIR Model</h3>
<p>In the previous chapter, it was shown for the extended Vasicek model that pricing formulas for caps, floors, coupon bond options, and swaptions can be derived from a pricing formula for discount bond options. The same is true in the CIR model — caps and floors are of course portfolios of discount bond options and, in a single-factor model such as the Vasicek or CIR model, coupon bond options and swaptions can also be priced as portfolios of discount bond options. Here we will explain briefly how to price discount bond options in the CIR model.</p>
<p>Consider a call option maturing at date <span class="math inline">\(T\)</span> with the underlying being a discount bond maturing at <span class="math inline">\(u&gt;T\)</span>. Let <span class="math inline">\(K\)</span> denote the strike price. From our fundamental pricing formula <a href="Chapter1.html#eq-formula">Equation&nbsp;<span>1.29</span></a>, the value at date~0 of the option is <span id="eq-ciroptionprice"><span class="math display">\[
P(0,u)\times\text{prob}^u\big(P(T,u)&gt;K\big) - P(0,T)\times\text{prob}^T\big(P(T,u)&gt;K\big)\;,
\tag{14.23}\]</span></span></p>
<p>where <span class="math inline">\(\text{prob}^u\)</span> denotes the probability measure using the discount bond maturing at <span class="math inline">\(u\)</span> as numeraire and <span class="math inline">\(\text{prob}^T\)</span> denotes the probability measure using the discount bond maturing at <span class="math inline">\(T\)</span> as the numeraire. Using the calibration of the previous subsection, the price of the underlying at date <span class="math inline">\(T\)</span> will be, according to the model, <span class="math display">\[P(T,u)  = \exp\left(-\int_T^u \phi(s)\,\mathrm{d} s-a(u-T)-b(u-T)\hat{r}(T)\right)\; .\]</span> Therefore, the option will finish in the money if and only if <span id="eq-ciroptionprice2"><span class="math display">\[
\frac{-\int_T^u \phi(s)\,\mathrm{d} s-a(u-T)-\log K}{b(u-T)} &gt; \hat{r}(T)\;.
\tag{14.24}\]</span></span></p>
<p>Thus, to price discount bond options, we need to compute the probabilities that <span class="math inline">\(\hat{r}(T)\)</span> is less than a given number, using discount bonds as numeraires.</p>
<p>Consider the discount bond maturing at <span class="math inline">\(u\)</span>. The calculation for the discount bond maturing at <span class="math inline">\(T\)</span> can be done in the same way. We use the fact that <span class="math display">\[\frac{\mathrm{e}^{\int_0^t r(s)\,\mathrm{d} s}}{P(t,u)}\]</span> is a martingale, when <span class="math inline">\(P(t,u)\)</span> is used as the numeraire, for <span class="math inline">\(t \leq u\)</span>. Let <span class="math inline">\(Z(t)\)</span> denote this ratio and apply Ito’s formula for ratios to derive <span class="math display">\[\frac{\mathrm{d} Z(t)}{Z(t)} = r(t)\,\mathrm{d} t - \frac{\mathrm{d} P(t,u)}{P(t,u)} + \left(\frac{\mathrm{d} P(t,u)}{P(t,u)}\right)^2\; .\]</span> Substituting from <a href="#eq-cirdpp2">Equation&nbsp;<span>14.22</span></a> now gives us <span class="math display">\[
\frac{\mathrm{d} Z(t)}{Z(t)} = b(\tau)\sigma\sqrt{\hat{r}(t)}\,\mathrm{d} B(t) + b(\tau)^2\sigma^2\hat{r}(t)\,\mathrm{d} t
\]</span> <span class="math display">\[
= b(\tau)\sigma\sqrt{\hat{r}(t)}\left[\mathrm{d} B(t) + b(\tau)\sigma\sqrt{\hat{r}(t)}\,\mathrm{d} t\right]\;.
\]</span> Given that <span class="math inline">\(Z\)</span> is a martingale, <span class="math inline">\(\mathrm{d} Z/Z\)</span> cannot have a drift, so it must be that~<span class="math inline">\(B^*\)</span> defined by <span class="math inline">\(B^*(0)=0\)</span> and <span class="math display">\[\mathrm{d} B^*(t) = \mathrm{d} B(t) + b(\tau)\sigma\sqrt{\hat{r}(t)}\,\mathrm{d} t\]</span> is a martingale, and hence a Brownian motion, when <span class="math inline">\(P(t,u)\)</span> is used as the numeraire. Substituting this into the definition <a href="#eq-cirrhat">Equation&nbsp;<span>14.19</span></a> of <span class="math inline">\(\hat{r}\)</span>, we have <span class="math display">\[
\mathrm{d} \hat{r}(t)=\kappa [\theta-\hat{r}(t)]\,\mathrm{d} t+\sigma \sqrt{\hat{r}(t)}\,\left[\mathrm{d} B^*(t) - b(\tau)\sigma\sqrt{\hat{r}(t)}\,\mathrm{d} t\right]\mathrm{n}otag
\]</span> <span class="math display">\[
= \kappa [\theta-\hat{r}(t)]\,\mathrm{d} t+\sigma \sqrt{\hat{r}(t)}\,\mathrm{d} B^*(t) - \sigma^2b(\tau)\hat{r}(t)\,\mathrm{d} t\mathrm{n}otag
\]</span> <span id="eq-cirru"><span class="math display">\[
= \kappa^*(t)[\theta^*(t)-\hat{r}(t)]\,\mathrm{d} t +\sigma \sqrt{\hat{r}(t)}\,\mathrm{d} B^*(t)\;,
\tag{14.25}\]</span></span></p>
<p>where we define <span class="math display">\[
\kappa^*(t) = \kappa + \sigma^2b(u-t) \qquad \text{and} \qquad \theta^*(t) = \frac{\kappa\theta}{\kappa^*(t)}\; .\]</span> Thus, using a discount bond as numeraire, the process <span class="math inline">\(\hat{r}\)</span> is still a square root process, but now with a time-dependent long-run mean and mean-reversion rate.</p>
<p>The random variable <span class="math inline">\(\hat{r}(T)\)</span> defined by <span class="math inline">\(\hat{r}(0)=0\)</span> and <a href="#eq-cirru">Equation&nbsp;<span>14.25</span></a> for <span class="math inline">\(t \leq T\)</span> is a transformation of a random variable having what is called a non-central chi-square distribution. See Appendix~<span class="math inline">\(\ref{a_bessel}\)</span> for further discussion and calculation of the probabilities <span class="math inline">\(\text{prob}^u\big(P(T,u)&gt;K\big)\)</span> and <span class="math inline">\(\text{prob}^T\big(P(T,u)&gt;K\big)\)</span>.</p>
</section>
</section>
<section id="sec-s_ls" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="sec-s_ls"><span class="header-section-number">14.5</span> Longstaff-Schwartz</h2>
<p>Cox, Ingersoll and Ross suggest adding two independent square-root processes to obtain a two-factor model. This means that we would take <span class="math inline">\(r(t)=x_1(t)+x_2(t)\)</span>, where <span id="eq-ls"><span class="math display">\[
\mathrm{d} x_i(t) = \kappa_i[\theta_i-x_i(t)]\,\mathrm{d} t + \sigma_i\sqrt{x_i(t)}\,\mathrm{d} B_i(t)\;,
\tag{14.26}\]</span></span></p>
<p>where <span class="math inline">\(B_1\)</span> and <span class="math inline">\(B_2\)</span> are independent Brownian motions under the risk-neutral measure and <span class="math inline">\(\kappa_i\)</span>, <span class="math inline">\(\theta_i\)</span> and <span class="math inline">\(\sigma_i\)</span> are positive constants for <span class="math inline">\(i=1,2\)</span>. Longstaff and Schwartz <span class="citation" data-cites="LS92">(<a href="#ref-LS92" role="doc-biblioref">Longstaff and Schwartz 1992</a>)</span> investigate this model further, including providing an equilibrium foundation, deriving discount bond option prices, and estimating the coefficients. The model is usually called the Longstaff-Schwartz model. </p>
<p>An important observation made by Longstaff and Schwartz is that the model can be rewritten so that the short rate and its volatility are the factors (rather than the unobservable <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Note that the instantaneous variance of <span class="math inline">\(r = x_1+x_2\)</span> is <span class="math display">\[\left( \sigma_1\sqrt{x_1(t)}\,\mathrm{d} B_1(t) +  \sigma_2\sqrt{x_2(t)}\,\mathrm{d} B_2(t)\right)^2 = \left(\sigma_1^2x_1(t) + \sigma_2^2x_2(t)\right)\,\mathrm{d} t\; .\]</span> Define <span class="math inline">\(V(t) = \sigma_1^2x_1(t) + \sigma_2^2x_2(t)\)</span>. We can solve for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> in terms of <span class="math inline">\(r\)</span> and~<span class="math inline">\(V\)</span> as</p>
<p><span id="eq-x1ls"><span class="math display">\[
x_1 = \frac{\sigma_2^2 r - V}{\sigma_2^2-\sigma_1^2}
\tag{14.27}\]</span></span></p>
<p><span id="eq-x2ls"><span class="math display">\[
x_2 = \frac{V-\sigma_1^2 r}{\sigma_2^2-\sigma_1^2}\;,
\tag{14.28}\]</span></span></p>
<p>provided <span class="math inline">\(\sigma_1\mathrm{n}eq \sigma_2\)</span>. Making these substitutions for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> on the right-hand side of <a href="#eq-ls">Equation&nbsp;<span>14.26</span></a> and noting that <span class="math inline">\(\mathrm{d} r = \mathrm{d} x_1+\mathrm{d} x_2\)</span> and <span class="math inline">\(\mathrm{d} V = \sigma_1^2\,\mathrm{d} x_1 + \sigma_2^2\,\mathrm{d} x_2\)</span>, we obtain the following equations presented by Longstaff and Schwartz:</p>
<p><span class="math display">\[\begin{multline}
\mathrm{d} r= \left(\alpha\gamma + \beta\eta - \frac{\beta\delta-\alpha\xi}{\beta-\alpha}r - \frac{\xi-\delta}{\beta-\alpha}V\right)\,\mathrm{d} t
$$
$$+ \alpha\sqrt{\frac{\beta r-V}{\alpha(\beta-\alpha)}}\,\mathrm{d} B_1 + \beta\sqrt{\frac{V-\alpha r}{\beta(\beta-\alpha)}}\,\mathrm{d} B_2\;,
\end{multline}\]</span> <span class="math display">\[\begin{multline}
\mathrm{d} V= \left(\alpha^2\gamma + \beta^2\eta - \frac{\alpha\beta(\delta-\xi)}{\beta-\alpha}r - \frac{\beta\xi-\alpha\delta}{\beta-\alpha}V\right)\,\mathrm{d} t
$$
$$+ \alpha^2\sqrt{\frac{\beta r-V}{\alpha(\beta-\alpha)}}\,\mathrm{d} B_1 + \beta^2\sqrt{\frac{V-\alpha r}{\beta(\beta-\alpha)}}\,\mathrm{d} B_2\;,
\end{multline}\]</span></p>
<p>where <span class="math inline">\(\delta=\kappa_1\)</span>, <span class="math inline">\(\xi=\kappa_2\)</span>, <span class="math inline">\(\alpha = \sigma_1^2\)</span>, <span class="math inline">\(\beta=\sigma_2^2\)</span>, <span class="math inline">\(\gamma = \kappa_1\theta_1/\sigma_1^2\)</span>, and <span class="math inline">\(\eta = \kappa_2\theta_2/\sigma_2^2\)</span>. Thus, this can be regarded as a two-factor model in which the factors are the short rate and its instantaneous variance, with the six parameters <span class="math inline">\(\delta\)</span>, <span class="math inline">\(\xi\)</span>, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>, and~<span class="math inline">\(\eta\)</span>.</p>
<p>The simplest way to compute discount bond prices in this model is to return to the definition <span class="math inline">\(r=x_1+x_2\)</span>. Discount bond prices are <span class="math display">\[
P(t,u) = E_t\left[\exp\left(-\int_t^u r(s)\,\mathrm{d} s\right)\right]
\]</span> <span class="math display">\[
= E_t\left[\exp\left(-\int_t^u x_1(s)\,\mathrm{d} s\right)\exp\left(-\int_t^u x_2(s)\,\mathrm{d} s\right)\right]
\]</span> <span class="math display">\[
= E_t\left[\exp\left(-\int_t^u x_1(s)\,\mathrm{d} s\right)\right] E_t\left[\exp\left(-\int_t^u x_2(s)\,\mathrm{d} s\right)\right]\;,
\]</span> due to the independence of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Moreover, these expectations have the same form as discount bond prices in the CIR model, namely <span id="eq-lsdiscount"><span class="math display">\[
E_t\left[\exp\left(-\int_t^u x_i(s)\,\mathrm{d} s\right)\right] = \exp\left(-a_i(\tau)-b_i(\tau)x_i(t)\right)\;,
\tag{14.29}\]</span></span></p>
<p>where the functions <span class="math inline">\(a_i\)</span> and <span class="math inline">\(b_i\)</span> are defined in <span class="quarto-unresolved-ref">?eq-cirbondcombined</span>, using the parameters <span class="math inline">\(\kappa_i\)</span>, <span class="math inline">\(\theta_i\)</span> and <span class="math inline">\(\sigma_i\)</span>. The expectations <a href="#eq-lsdiscount">Equation&nbsp;<span>14.29</span></a> can be written in terms of <span class="math inline">\(r(t)\)</span> and <span class="math inline">\(V(t)\)</span> by substituting from <span class="quarto-unresolved-ref">?eq-x12lscombined</span>.</p>
<p>The Vasicek, CIR and Longstaff-Schwartz models are examples of affine models. An affine model is defined by a set of factors <span class="math inline">\(x_1, \ldots, x_n\)</span>, where</p>
<ul>
<li>The short rate is an affine function of the factors;<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> i.e., <span class="math inline">\(r(t) = \alpha_0 + \sum_{i=1}^n \alpha_ix_i(t)\)</span> for constants <span class="math inline">\(\alpha_i\)</span>,</li>
<li>The drift of each factor is an affine function of the factors.</li>
<li>The instantaneous variance of each factor is an affine function of the factors.</li>
<li>The instantaneous covariance of each pair of factors is an affine function of the factors.</li>
</ul>
<p>In any affine model, discount bond prices are of the form <span id="eq-affine"><span class="math display">\[
P(t,u) = \exp\left(-a(\tau)-\sum_{i=1}^n b_i(\tau)x_i(t)\right)
\tag{14.30}\]</span></span></p>
<p>for deterministic functions <span class="math inline">\(a\)</span> and <span class="math inline">\(b_i\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span>, as we have seen is true for the Vasicek, CIR, and Longstaff-Schwartz models. Most, but certainly not all, of the continuous-time models studied in the finance literature are affine.</p>
<p>In any single-factor affine model, the short rate can be used as the factor. Thus, the general affine one-factor model is of the form <span class="math display">\[\mathrm{d} r = \kappa(\theta-r)\,\mathrm{d} t + \sqrt{\alpha + \beta r}\,\mathrm{d} B\; ,\]</span> for constants <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. The Vasicek model is the special case <span class="math inline">\(\beta = 0\)</span> (<span class="math inline">\(\alpha\)</span> being the same as the parameter~<span class="math inline">\(\sigma^2\)</span>). The CIR model is the special case <span class="math inline">\(\alpha = 0\)</span> (<span class="math inline">\(\beta\)</span> being the same as the parameter <span class="math inline">\(\sigma^2\)</span>).</p>
<p>Because yields of discount bonds are affine functions of the factors in an affine model, as <a href="#eq-affine">Equation&nbsp;<span>14.30</span></a> shows, the short rate and yields at <span class="math inline">\(n-1\)</span> fixed times-to-maturity <span class="math inline">\(\tau_i\)</span> can be chosen to be the <span class="math inline">\(n\)</span> factors (except in the rare case that the linear transformation from factors to the short rate and yields fails to be invertible). The transformation from factors to yields is analogous to the transformation from <span class="math inline">\((x_1,x_2)\)</span> to <span class="math inline">\((r,V)\)</span> in the Longstaff-Schwartz model. Important papers on affine models include Duffie and Kan <span class="citation" data-cites="DK">(<a href="#ref-DK" role="doc-biblioref">Duffie and Kan 1996</a>)</span> and Dai and Singleton <span class="citation" data-cites="DSing">(<a href="#ref-DSing" role="doc-biblioref">Dai and Singleton 2000</a>)</span>.</p>
</section>
<section id="sec-s_hjm" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="sec-s_hjm"><span class="header-section-number">14.6</span> Heath-Jarrow-Morton</h2>
<p>Heath, Jarrow and Morton <span class="citation" data-cites="HJM">(<a href="#ref-HJM" role="doc-biblioref">Heath, Jarrow, and Morton 1992</a>)</span> propose an alternative framework for modelling. Rather than modelling the evolution of the short rate (and possibly other factors such as the volatility of the short rate or other yields), Heath, Jarrow and Morton (hereafter, HJM) propose modelling the evolution of instantaneous forward rates. They derive a formula for the drifts of instantaneous forward rates under the risk-neutral measure, in terms of the volatilities of the forward rates. A model is therefore completely defined by specifying the volatilities of forward rates. A model of this type is easily fit to market discount bond prices by simply using the initial term structure of forward rates as an input. By calibrating the volatility structure, the model can also be fit to other market prices. Any of the continuous-time models we have discussed can be written in the HJM form. The virtue of the HJM approach is that it facilitates the construction of new models. The disadvantage of the HJM approach is that models of this form will generally be path-dependent—bond prices and the prices of other fixed-income instruments at any point in time depend on the entire history of the forward rate processes, rather than depending only on the values of a small set of factors. This makes computation quite difficult, just as computation with non-recombining binomial trees is much more difficult than with recombining trees.</p>
<p>As discussed in Sect.~<span class="math inline">\(\ref{s_vasicek_fitting}\)</span>, the forward rate at date <span class="math inline">\(t\)</span> for an instantaneous loan at date <span class="math inline">\(u \geq t\)</span> is <span class="math inline">\(f(t,u)\)</span> defined by <span id="eq-hjmforward"><span class="math display">\[
f(t,u)= -\frac{  \mathrm{d} \,\log P(t,u)}{\mathrm{d} u}\;.
\tag{14.31}\]</span></span></p>
<p>The short rate at time <span class="math inline">\(t\)</span> is the forward rate for maturity date <span class="math inline">\(t\)</span>; i.e., <span class="math inline">\(r(t)=f(t,t)\)</span>. By integrating <a href="#eq-hjmforward">Equation&nbsp;<span>14.31</span></a>, one can see that discount bond prices are written in terms of forward rates as: <span id="eq-bondsandforwards"><span class="math display">\[
P(t,u)= \exp\left( - \int _t^u f(t,s)\,\mathrm{d} s \right)\; .
\tag{14.32}\]</span></span></p>
<p>Heath, Jarrow and Morton use the definition <a href="#eq-bondsandforwards">Equation&nbsp;<span>14.32</span></a> and the fact that the expected return of a discount bond under the risk-neutral measure must be the short rate to derive a formula for the drifts of forward rates under the risk-neutral measure.</p>
<p>Assume, for the sake of simplicity, that there is only a single source of uncertainty (i.e., a single Brownian motion) driving the yield curve.<br>
Then, for each fixed <span class="math inline">\(u\)</span>, the forward rate <span class="math inline">\(f(t,u)\)</span> at date <span class="math inline">\(t&lt;u\)</span> will evolve as <span id="eq-hjm100"><span class="math display">\[
\mathrm{d} f(t,u)=\mu(t,u)\,\mathrm{d} t+\sigma(t,u)\,\mathrm{d} B(t)\;,
\tag{14.33}\]</span></span></p>
<p>for some <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion under the risk-neutral measure. In general <span class="math inline">\(\mu(t,u)\)</span> and <span class="math inline">\(\sigma(t,u)\)</span> could depend on the entire history of the Brownian motion through date~<span class="math inline">\(t\)</span>. Heath, Jarrow and Morton show that <span id="eq-hjm"><span class="math display">\[
\mu(t,u)=\sigma(t,u) \int_t^u \sigma(t,s)\,\mathrm{d} s\;.
\tag{14.34}\]</span></span></p>
<p>One can show that <span class="math inline">\(\int_t^u \sigma(t,s)\,\mathrm{d} s\)</span> is the volatility of <span class="math inline">\(P(t,u)\)</span>. Therefore, <a href="#eq-hjm">Equation&nbsp;<span>14.34</span></a> states that the drift of the forward rate is the product of the volatilities of the forward rate and the discount bond return. A model is fully specified by specifying initial forward rates—i.e., <span class="math inline">\(f(0,u)\)</span> for all <span class="math inline">\(u\)</span>—and the volatility processes <span class="math inline">\(\sigma(t,u)\)</span> for each <span class="math inline">\(u\)</span> and <span class="math inline">\(t \leq u\)</span>. The generalization to multiple Brownian motions is straightforward and allows for forward rates that are not instantaneously perfectly correlated. An important application of the HJM modelling framework is work by Brace, Gatarek and Musiela <span class="citation" data-cites="BGM">(<a href="#ref-BGM" role="doc-biblioref">Brace, Gatarek, and Musiela 1996</a>)</span> and Miltersen, Sandmann, and Sondermann <span class="citation" data-cites="MSS">(<a href="#ref-MSS" role="doc-biblioref">Miltersen, Sandermann, and Sondermann 1997</a>)</span>, who derive conditions on the volatility processes <span class="math inline">\(\sigma(t,u)\)</span> that guarantee forward LIBOR rates of a fixed maturity (e.g., quarterly or semi-annual rates) have deterministic volatilities, thus justifying the use of Black’s formula in Sect.~<span class="math inline">\(\ref{s_valuingcaps}\)</span> for valuing caps and floors.</p>
<p>To see how some of the models we have discussed can be written in the HJM form, let us re-examine the Hull-White model. From the Hull-White bond price formula <span class="quarto-unresolved-ref">?eq-extendedvasicekbondcombined</span>, the instantaneous forward rate in the Hull-White model is <span class="math display">\[
f(t,u)  = \phi(u)  + \frac{\partial}{\partial u} a(u-t) + \hat{r}(t)\frac{\partial}{\partial u} b(u-t)
\]</span> <span class="math display">\[
= \phi(u) -\frac{\sigma^2}{2\kappa^2}\left(1 + \mathrm{e}^{-2\kappa(u-t)} -2 \mathrm{e}^{-\kappa(u-t)}\right) + \mathrm{e}^{-\kappa(u-t)}\hat{r}(t)\;.
\]</span> Applying Ito’s formula yields <span class="math display">\[\mathrm{d} f(t,u) = -\frac{\sigma^2}{\kappa}\left(\mathrm{e}^{-2\kappa(u-t)}-\mathrm{e}^{-\kappa(u-t)}\right)\,\mathrm{d} t + \sigma \mathrm{e}^{-\kappa(u-t)}\,\mathrm{d} B\; .\]</span> Therefore, in the HJM notation, <span class="math display">\[\mu(t,u) = -\frac{\sigma^2}{\kappa}\left(\mathrm{e}^{-2\kappa(u-t)}-\mathrm{e}^{-\kappa(u-t)}\right) \qquad \text{and} \qquad \sigma(t,u) =  \sigma \mathrm{e}^{-\kappa(u-t)}\; .\]</span> A direct calculation shows that these functions <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> satisfy the HJM <a href="#eq-hjm">Equation&nbsp;<span>14.34</span></a>, as we knew they must, given that the HJM equation is based only on the assumption that expected returns of discount bonds equal the short rate under the risk-neutral measure. The initial forward rate curve in the Hull-White model is <span class="math inline">\(f(0,u) = \phi(u)\)</span> which is chosen to fit the market forward rate curve, as discussed in Sect.~<span class="math inline">\(\ref{s_vasicek_fitting}\)</span>. Thus, rather than defining the Hull-White model as we did in <a href="Chapter13.html"><span>Chapter&nbsp;13</span></a>, it could be defined alternatively as an HJM model in which the volatility process is the deterministic function <span class="math inline">\(\sigma(t,u) = \sigma \mathrm{e}^{-\kappa(u-t)}\)</span> for positive constants <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\kappa\)</span>. The normal distribution of the short rate in the Hull-White model is a consequence of the volatility <span class="math inline">\(\sigma(t,u)\)</span> being non-random.</p>
<p>Likewise, the Cox-Ingersoll-Ross model fit to market bond prices as we discussed in Sect.~<span class="math inline">\(\ref{s_cir}\)</span> could be described as an HJM model. Calculations of the sort we have just done show that the volatility process in the CIR model is <span class="math inline">\(\sigma(t,u) = \sigma b'(\tau)\sqrt{\hat{r}}(t)\)</span>, where <span class="math inline">\(\tau = u-t\)</span> and the function <span class="math inline">\(b\)</span> is defined in <span class="quarto-unresolved-ref">?eq-cirbondcombined</span>. In this case, the volatility is random, but it depends only on the short rate at date <span class="math inline">\(t\)</span>. Similarly, in any factor model, such as the Longstaff-Schwartz model, the volatilities <span class="math inline">\(\sigma(t,u)\)</span> of the forward rates will depend only on the factors at each date~<span class="math inline">\(t\)</span>. As mentioned at the beginning of this section, such a factor structure simplifies calculations considerably.</p>
<p>HJM models are sometimes written in a slightly different fashion than we have done here. If we define <span class="math display">\[\Sigma(t,u) = \int_t^u \sigma(t,s)\,\mathrm{d} s\]</span> then we have <span class="math inline">\(\mathrm{d} \Sigma(t,u)/\mathrm{d} u = \sigma(t,u)\)</span>, and the HJM <a href="#eq-hjm">Equation&nbsp;<span>14.34</span></a> can be written as <span class="math display">\[\mu(t,u) = \Sigma(t,u)\frac{\mathrm{d} \Sigma(t,u)}{\mathrm{d} u}\; ,\]</span> so the evolution of forward rates can be written as <span class="math display">\[\mathrm{d} f(t,u) = \Sigma(t,u)\frac{\mathrm{d} \Sigma(t,u)}{\mathrm{d} u}\,\mathrm{d} t + \frac{\mathrm{d} \Sigma(t,u)}{\mathrm{d} u}\,\mathrm{d} B(t)\; .\]</span> For example, in the Hull-White model we have <span class="math inline">\(\Sigma(t,u) = \sigma b(\tau)\)</span> where <span class="math inline">\(b\)</span> is defined in <span class="quarto-unresolved-ref">?eq-extendedvasicekbondcombined</span>, and in the CIR model, we have <span class="math inline">\(\Sigma(t,u) = \sigma b(\tau)\sqrt{\hat{r}(t)}\)</span>, where <span class="math inline">\(b\)</span> is defined in <span class="quarto-unresolved-ref">?eq-cirbondcombined</span>.</p>
</section>
<section id="market-models-again" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="market-models-again"><span class="header-section-number">14.7</span> Market Models Again</h2>
<p>Many fixed-income derivatives (e.g., caps, floors, and swaps) have cash flows that depend on simple interest rates (e.g., LIBOR). In this chapter and the preceding chapter, we discussed valuation formulas for fixed-income derivatives based on (i) models of the short rate or one-period rate and possibly other factors, or (ii) models of instantaneous forward rates. However, it is possible, and simpler for many purposes, to model simple interest rates directly. For example, we observed in <a href="Chapter12.html"><span>Chapter&nbsp;12</span></a> that Black’s formula can be applied to value caps and floors when the underlying simple interest rates have nonrandom volatilities. Models of this type are called market models or LIBOR models or, sometimes, BGM models, the last name referring to the paper of Brace, Gatarek and Musiela <span class="citation" data-cites="BGM">(<a href="#ref-BGM" role="doc-biblioref">Brace, Gatarek, and Musiela 1996</a>)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> This class of models has become quite popular in recent years. A thorough and very readable account is given by Rebonato <span class="citation" data-cites="Rebonato02">(<a href="#ref-Rebonato02" role="doc-biblioref">Rebonato 2002</a>)</span>.</p>
<p>As in <a href="Chapter12.html"><span>Chapter&nbsp;12</span></a>, we will use LIBOR as a generic name for simple interest rates. One important fact about forward LIBOR rates that we have already essentially derived is that they are martingales under the corresponding forward measures. As was discussed in Sect.~<span class="math inline">\(\ref{s_futuresforwards}\)</span>, a probability measure corresponding to a discount bond being the numeraire is called a forward measure, because the forward price of any contract maturing at the same time as the discount bond is a martingale under that measure. We showed in Sect.~<span class="math inline">\(\ref{s_portfoliosspotrates}\)</span> that forward LIBOR rates are forward prices of portfolios that pay spot rates. Specifically, considering a LIBOR rate of term (also called tenor) <span class="math inline">\(\Delta t\)</span> and the forward LIBOR rate corresponding to loans over a period <span class="math inline">\(u\)</span> to <span class="math inline">\(u+\Delta t\)</span>, the forward LIBOR rate is a martingale under the measure corresponding to the discount bond maturing at <span class="math inline">\(u+\Delta t\)</span>.</p>
<p>To price derivatives other than caps and floors (e.g., swaptions), it is important to know the dynamics of forward LIBOR rates under other probability measures as well—for example, it is useful to know the dynamics under the forward measures corresponding to discount bonds maturing at dates <span class="math inline">\(T \mathrm{n}eq u+\Delta t\)</span>, or under the risk-neutral measure, or under the measure that uses as numeraire the portfolio consisting of rolling over an investment at spot LIBOR rates.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> We will derive here the dynamics under different forward measures.</p>
<p>Consider dates <span class="math inline">\(t_1 &lt; t_2 &lt; \cdots &lt; t_N\)</span> with <span class="math inline">\(t_i-t_{i-1} = \Delta t\)</span> for each <span class="math inline">\(i\)</span>. At dates <span class="math inline">\(t\leq t_i\)</span>, we denote the forward LIBOR rate for the time period <span class="math inline">\((t_i, t_{i+1} )\)</span> by <span class="math inline">\(\mathcal{R}_i(t)\)</span>. The forward LIBOR rate satisfies <a href="Chapter12.html#eq-forward2">Equation&nbsp;<span>12.2</span></a>, which we repeat here: <span id="eq-marketmodel1"><span class="math display">\[
\frac{P(t,t_i)}{P(t,t_{i+1})}=1+\mathcal{R}_i(t)\,\Delta t\;.
\tag{14.35}\]</span></span></p>
<p>Fix a date <span class="math inline">\(t_n\)</span>. We will compute the drift of each rate <span class="math inline">\(\mathcal{R}_i(t)\)</span> when we use the discount bond maturing at <span class="math inline">\(t_{n}\)</span> as the numeraire.</p>
<p>Let <span class="math inline">\(\sigma_i(t)\)</span> denote the volatility of rate <span class="math inline">\(\mathcal{R}_i(t)\)</span> at date <span class="math inline">\(t\)</span>. This means that <span id="eq-marketmodel3"><span class="math display">\[
\frac{\mathrm{d} \mathcal{R}_i(t)}{\mathcal{R}_i(t)} = \mu_i(t)\,\mathrm{d} t + \sigma_i(t)\,\mathrm{d} B_i(t)\;,
\tag{14.36}\]</span></span></p>
<p>for some <span class="math inline">\(\mu_i\)</span>, where the <span class="math inline">\(B_i\)</span> are Brownian motions when <span class="math inline">\(P(t,t_n)\)</span> is used as the numeraire. The different rates should be correlated, so the Brownian motions will be correlated. Let <span class="math inline">\(\rho_{ij}\)</span> denote the correlation of <span class="math inline">\(B_i\)</span> and <span class="math inline">\(B_j\)</span>. We will show that the drifts <span class="math inline">\(\mu_i\)</span> are determined by the volatilities and correlations, in analogy to the HJM result for instantaneous forward rates.<br>
Specifying the volatilities and correlations of forward rates, and inputting initial forward rates, must therefore determine the value of any security whose cash flows depend on the LIBOR rates of term <span class="math inline">\(\Delta t\)</span> at the dates <span class="math inline">\(t_1, \ldots, t_N\)</span>. Of course, this does not mean that there are simple formulas. Obviously, the easiest case is when the volatilities and correlations are nonrandom. In this case, we can use Black’s formula to price caps and floors as in <a href="Chapter12.html"><span>Chapter&nbsp;12</span></a>. However, even when the <span class="math inline">\(\sigma_i\)</span> are nonrandom, forward swap rates will have random volatilities, as mentioned in Sect.~<span class="math inline">\(\ref{s_consistency}\)</span>.</p>
<p>If <span class="math inline">\(i = n-1\)</span>, then <a href="#eq-marketmodel1">Equation&nbsp;<span>14.35</span></a> implies <span class="math display">\[\mathcal{R}_i(t) = \frac{P(t,t_{n-1})-P(t,t_n)}{P(t,t_n)\,\Delta t}\; .\]</span> Hence, it is the ratio of a non-dividend-paying asset (portfolio) price to the price of the numeraire asset. Consequently, it is a martingale, and we have <span class="math inline">\(\mu_{n-1}=0\)</span>. This is the case discussed in the second paragraph of this section. Consider now <span class="math inline">\(i \mathrm{n}eq n-1\)</span>.</p>
<p>Define <span id="eq-marketmodely"><span class="math display">\[
Y(t) = \frac{P(t,t_{i+1})}{P(t,t_n)}\;,
\tag{14.37}\]</span></span></p>
<p>and <span id="eq-marketmodelz"><span class="math display">\[
Z(t) = \mathcal{R}_i(t)Y(t)\;.
\tag{14.38}\]</span></span></p>
<p>Note that <span class="math inline">\(Y\)</span> is the ratio of a non-dividend-paying asset price to the price of the numeraire asset and hence is a martingale. Furthermore, <a href="#eq-marketmodel1">Equation&nbsp;<span>14.35</span></a> gives us <span class="math display">\[ Z(t) = \frac{P(t,t_{i})-P(t,t_{i+1})}{P(t,t_n)\,\Delta t}\; ,\]</span> and hence <span class="math inline">\(Z\)</span> is also the ratio of a non-dividend-paying asset (portfolio) price to the price of the numeraire asset and consequently a martingale.<br>
Ito’s formula applied to <a href="#eq-marketmodelz">Equation&nbsp;<span>14.38</span></a> yields <span class="math display">\[\frac{\mathrm{d} Z}{Z} = \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i} + \frac{\mathrm{d} Y}{Y} + \left( \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\mathrm{d} Y}{Y}\right)\; .\]</span> Because both <span class="math inline">\(Z\)</span> and <span class="math inline">\(Y\)</span> are martingales, the drift of <span class="math inline">\(\mathrm{d} \,\mathcal{R}_i/\mathcal{R}_i\)</span> must cancel the product (covariance) term in this equation, implying <span id="eq-marketmodel4"><span class="math display">\[
\mu_i\,\mathrm{d} t = - \left( \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\mathrm{d} Y}{Y}\right)\;.
\tag{14.39}\]</span></span></p>
<p>To compute the covariance, it is helpful to define <span id="eq-marketmodelx"><span class="math display">\[
X_j(t) = 1+ \mathcal{R}_j(t)\,\Delta t
\tag{14.40}\]</span></span></p>
<p>for <span class="math inline">\(j = 1, \ldots , N\)</span>. Then we have <span id="eq-marketmodel5"><span class="math display">\[
\frac{\mathrm{d} X_j}{X_j} = \left(\frac{\mathcal{R}_j\,\Delta t}{1+\mathcal{R}_j\,\Delta t}\right)\big(\mu_j\,\mathrm{d} t + \sigma_j\,\mathrm{d} B_j\big)\;.
\tag{14.41}\]</span></span></p>
<p>We distinguish two cases. If <span class="math inline">\(i &lt; n-1\)</span>, then the definitions <a href="#eq-marketmodel1">Equation&nbsp;<span>14.35</span></a>, <a href="#eq-marketmodely">Equation&nbsp;<span>14.37</span></a> and <a href="#eq-marketmodelx">Equation&nbsp;<span>14.40</span></a> imply <span class="math display">\[
Y(t) = \frac{P(t,t_{i+1})}{P(t,t_{i+2})} \times \frac{P(t,t_{i+2})}{P(t,t_{i+3})} \cdots \times \frac{P(t,t_{n-1})}{P(t,t_n)}
\]</span> <span class="math display">\[
= X_{i+1}(t)\times X_{i+2}(t) \times \cdots \times X_{n-1}(t)\;.
\]</span> In this case, <a href="#eq-marketmodel3">Equation&nbsp;<span>14.36</span></a> and <a href="#eq-marketmodel5">Equation&nbsp;<span>14.41</span></a> yield <span class="math display">\[
\left( \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\mathrm{d} Y}{Y}\right) = \sum_{j=i+1}^{n-1} \left( \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\mathrm{d} X_j}{X_j}\right)
\]</span> <span class="math display">\[
= \sum_{j=i+1}^{n-1} \left(\frac{\mathcal{R}_j\,\Delta t}{1+\mathcal{R}_j\,\Delta t}\right)\sigma_i\sigma_j\rho_{ij}\,\mathrm{d} t\;.
\]</span> On the other hand, if <span class="math inline">\(i &gt; n-1\)</span>, then the definitions <a href="#eq-marketmodel1">Equation&nbsp;<span>14.35</span></a>, <a href="#eq-marketmodely">Equation&nbsp;<span>14.37</span></a> and <a href="#eq-marketmodelx">Equation&nbsp;<span>14.40</span></a> imply <span class="math display">\[
\frac{1}{Y(t)} = \frac{P(t,t_{n})}{P(t,t_{n+1})} \times \frac{P(t,t_{n+1})}{P(t,t_{n+2})} \times \cdots \times \frac{P(t,t_{i})}{P(t,t_{i+1})}
\]</span> <span class="math display">\[
= X_{n}(t)\times X_{n+1}(t) \times \cdots \times X_{i}(t)\;.
\]</span> In this case, <a href="#eq-marketmodel3">Equation&nbsp;<span>14.36</span></a> and <a href="#eq-marketmodel5">Equation&nbsp;<span>14.41</span></a> yield <span class="math display">\[
\left( \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\mathrm{d} Y}{Y}\right) = -\sum_{j=n}^{i} \left( \frac{\mathrm{d} \,\mathcal{R}_i}{\mathcal{R}_i}\right)\left(\frac{\mathrm{d} X_j}{X_j}\right)
\]</span> <span class="math display">\[
= -\sum_{j=n}^{i} \left(\frac{\mathcal{R}_j\,\Delta t}{1+\mathcal{R}_j\,\Delta t}\right)\sigma_i\sigma_j\rho_{ij}\,\mathrm{d} t\;.
\]</span> We conclude:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<p>When we use the discount bond maturing at <span class="math inline">\(t_n\)</span> as the numeraire, the drift of (expected percentage change in) the forward rate <span class="math inline">\(\mathcal{R}_i\)</span> is <span class="math display">\[
\mu_i(t) = \begin{cases}
\sum_{j=i+1}^{n-1} \left(\frac{\mathcal{R}_j(t)\,\Delta t}{1+\mathcal{R}_j(t)\,\Delta t}\right)\sigma_i\sigma_j\rho_{ij}  \text{if $i &lt; n-1$}\; ,
\]</span> <span class="math display">\[
0  \text{if $i = n-1$}\; ,
\]</span> <span class="math display">\[
-\sum_{j=n}^{i} \left(\frac{\mathcal{R}_j(t)\,\Delta t}{1+\mathcal{R}_j(t)\,\Delta t}\right)\sigma_i\sigma_j\rho_{ij}  \text{if $i &gt; n-1$}\;. \end{cases}
\]</span></p>
</div>
</div>
</section>
<section id="exercises" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="exercises"><span class="header-section-number">14.8</span> Exercises</h2>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.1 </strong></span>Create an Excel worksheet demonstrating a four-period Ho-Lee model. Allow the user to input <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\Delta t\)</span>, and <span class="math inline">\(P^{\text{mkt}}(t_n)\)</span> for <span class="math inline">\(n=1, \ldots, 5\)</span>. Compute <span class="math inline">\(\phi(t_n)\)</span> from <a href="#eq-holee3">Equation&nbsp;<span>14.3</span></a> for <span class="math inline">\(n=1,\ldots, 4\)</span>. Create the one-period interest rate tree (starting from <span class="math inline">\(r(0) = -\log P^{\text{mkt}}(t_1)/\Delta t\)</span>) and the valuation tree for a discount bond maturing at <span class="math inline">\(t_5\)</span>. Verify that the tree gives the price <span class="math inline">\(P^{\text{mkt}}(t_5)\)</span>. Note: to create a binomial tree in a spreadsheet, it is probably easiest to put the topmost (or bottommost) nodes along one row and the other nodes in a triangle below (or above).</p>
</div>
<div id="exr-e_holeecaplet" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.2 </strong></span>Modify the preceding exercise to include the valuation tree for a caplet with <span class="math inline">\(t_4\)</span> as its reset date and <span class="math inline">\(t_5\)</span> as its payment date. Note that the payoff of the caplet at date <span class="math inline">\(t_5\)</span> is <span class="math display">\[\max\left(0, \mathcal{R}(t_4)-\bar{\mathcal{R}}\right)\Delta t,\]</span> where <span class="math display">\[\mathcal{R}(t_4) = \frac{1}{P(t_4,t_5)}-1.\]</span> Allow the user to input <span class="math inline">\(\bar{\mathcal{R}}\)</span>.</p>
</div>
<div id="exr-e_holeecaplet2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.3 </strong></span>Create a function that values a caplet in the Ho-Lee model. Look up market discount bond prices from a function such as in Prob.~<span class="math inline">\(\ref{exercise121}\)</span> and calibrate to the market from <a href="#eq-holee3">Equation&nbsp;<span>14.3</span></a>. The inputs to the function should be <span class="math inline">\(\bar{\mathcal{R}}\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(T_1\)</span>, <span class="math inline">\(T_2\)</span>, <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span>, where <span class="math inline">\(T_1\)</span> is the reset date for the caplet, <span class="math inline">\(T_2\)</span> is the payment date for the caplet, <span class="math inline">\(N_1\)</span> is the number of periods between date 0 and~<span class="math inline">\(T_1\)</span>, and <span class="math inline">\(N_2\)</span> is the number of periods between <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span>. Note that the payoff of the caplet at date <span class="math inline">\(T_2\)</span> is <span class="math display">\[\max\left(0, \mathcal{R}(T_1)-\bar{\mathcal{R}}\right) \times (T_2-T_1),\]</span> where <span class="math display">\[\mathcal{R}(T_1) = \frac{1}{P(T_1,T_2)}-1.\]</span></p>
</div>
<div id="exr-e_bdt" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.4 </strong></span>Create an Excel worksheet demonstrating a four-period Black-Derman-Toy model. Allow the user to input <span class="math inline">\(\Delta t\)</span>, <span class="math inline">\(r(0)\)</span>, and <span class="math inline">\(\sigma(t_i)\)</span> and <span class="math inline">\(\theta(t_i)\)</span> for <span class="math inline">\(i=1,\ldots, 4\)</span>. Create the one-period interest rate and the valuation tree for a discount bond maturing at <span class="math inline">\(t_5\)</span>.</p>
</div>
<div id="exr-e_bdt2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.5 </strong></span>Modify the preceding exercise by including the valuation tree for a caplet with reset date <span class="math inline">\(t_4\)</span> and payment date <span class="math inline">\(t_5\)</span>, as in Prob.~<span class="math inline">\(\ref{e_holeecaplet}\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.6 </strong></span>Repeat Probs.~<span class="math inline">\(\ref{e_bdt}\)</span> and <span class="math inline">\(\ref{e_bdt2}\)</span> for the Black-Karasinski model, allowing the user to also input <span class="math inline">\(\kappa(t_i)\)</span> for <span class="math inline">\(i=1,\ldots, 4\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.7 </strong></span>Create a VBA function that values a caplet in the CIR model using Monte Carlo, without calibrating the model to the current yield curve. Simulate the CIR process as described in Sect.~<span class="math inline">\(\ref{s_stochasticvolatility}\)</span> for the Heston model. The inputs should be <span class="math inline">\(\bar{\mathcal{R}}\)</span>, <span class="math inline">\(r(0)\)</span>, <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(T_1\)</span>, <span class="math inline">\(T_2\)</span>, <span class="math inline">\(N\)</span> and <span class="math inline">\(M\)</span>, where <span class="math inline">\(T_1\)</span> is the reset date for the caplet, <span class="math inline">\(T_2\)</span> is the payment date for the caplet, <span class="math inline">\(N\)</span> is the number of periods between 0 and <span class="math inline">\(T_1\)</span>, and <span class="math inline">\(M\)</span> is the number of simulations. The payoff of the caplet is as in Prob.~<span class="math inline">\(\ref{e_holeecaplet2}\)</span>, where <span class="math inline">\(P(T_1,T_2)\)</span> is the function of <span class="math inline">\(r(T_1)\)</span> and <span class="math inline">\(T_2-T_1\)</span> given in <a href="#eq-cirPcal">Equation&nbsp;<span>14.20</span></a> with <span class="math inline">\(\phi=0\)</span>.</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.8 </strong></span>Modify the function in the preceding exercise to create a function that values a caplet in the CIR model using Monte Carlo, with the model calibrated to the market. Look up market discount bond prices from a function such as in Prob.~<span class="math inline">\(\ref{exercise121}\)</span>. To compute <span class="math inline">\(\phi(t_i)\)</span> for <span class="math inline">\(i=1,\ldots, N\)</span> from market bond prices, use <a href="#eq-circalibration">Equation&nbsp;<span>14.21</span></a> for dates <span class="math inline">\(t_i\)</span> and <span class="math inline">\(t_{i+1}\)</span> as in Sect.~<span class="math inline">\(\ref{s_vasicek_swaptions}\)</span>.</p>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-BDT" class="csl-entry" role="listitem">
Black, F., E. Derman, and W. Toy. 1990. <em>A One-Factor Model of Interest Rates and Its Application to Treasury Bond Options. Financial Analysts Journal</em>. January/February, 33–39.
</div>
<div id="ref-BK" class="csl-entry" role="listitem">
Black, F., and P. Karasinski. 1991. <em>Bond and Option Pricing When Short Rates Are Lognormal. Financial Analysts Journal</em>. July-August, 52–59.
</div>
<div id="ref-BGM" class="csl-entry" role="listitem">
Brace, A., D. Gatarek, and M. Musiela. 1996. <span>“The Market Model of Interest Rate Dynamics.”</span> <em>Mathematical Finance</em> 7: 127–54.
</div>
<div id="ref-CIR" class="csl-entry" role="listitem">
Cox, J., J. Ingersoll, and S. Ross. 1985. <span>“A Theory of the Term Structure of Interest Rates.”</span> <em>Econometrica</em> 53: 385–408.
</div>
<div id="ref-DSing" class="csl-entry" role="listitem">
Dai, Q., and K. Singleton. 2000. <span>“Specification Analysis of Affine Term Structure Models.”</span> <em>Journal of Finance</em> 55: 1943–78.
</div>
<div id="ref-DK" class="csl-entry" role="listitem">
Duffie, D., and R. Kan. 1996. <span>“A Yield-Factor Model of Interest Rates”</span> 6: 379–406.
</div>
<div id="ref-HJM" class="csl-entry" role="listitem">
Heath, D., R. Jarrow, and A. Morton. 1992. <span>“Bond Pricing and the Term Structure of Interest Rates: A New Methodology for Contingent Claims Valuation.”</span> <em>Econometrica</em> 60: 77–105.
</div>
<div id="ref-Heston" class="csl-entry" role="listitem">
Heston, S. 1993. <span>“A Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options.”</span> <em>Review of Financial Studies</em> 6: 327–44.
</div>
<div id="ref-HL" class="csl-entry" role="listitem">
Ho, T., and S. Lee. 1986. <span>“Term Structure Movements and Pricing Interest Rate Contingent Claims.”</span> <em>Journal of Finance</em> 41: 1011–29.
</div>
<div id="ref-Jamshidian97" class="csl-entry" role="listitem">
Jamshidian, F. 1997. <span>“LIBOR and Swap Market Models and Measures.”</span> <em>Finance and Stochastics</em> 1: 293–330.
</div>
<div id="ref-LS92" class="csl-entry" role="listitem">
Longstaff, F., and E. Schwartz. 1992. <span>“Interest Rate Volatility and the Term Structure: A Two-Factor General Equilibrium Model”</span> 47: 1259–82.
</div>
<div id="ref-MSS" class="csl-entry" role="listitem">
Miltersen, K. R., K. Sandermann, and D. Sondermann. 1997. <span>“Closed Form Solutions for Term Structure Derivatives with Log-Normal Interest Rates”</span> 52: 409–30.
</div>
<div id="ref-Rebonato02" class="csl-entry" role="listitem">
Rebonato, R. 2002. <em>Modern Pricing of Interest-Rate Derivatives</em>. The LIBOR Market Model; Beyond, Princeton University Press, Princeton, New Jersey.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Of course, the volatility is also not directly observable. Longstaff and Schwartz use a GARCH model to estimate it and then use the time series of estimated volatilities and the time series of short rates to estimate the parameters of the model.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>An affine function of a real variable <span class="math inline">\(x\)</span> is a function <span class="math inline">\(f(x) = a + bx\)</span> for constants <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. This is often called a linear function, but technically a linear function is of the form <span class="math inline">\(f(x)=bx\)</span>. Thus, an affine function is a constant plus a linear function.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Other important work on this topic includes Miltersen, Sandmann, and Sondermann <span class="citation" data-cites="MSS">(<a href="#ref-MSS" role="doc-biblioref">Miltersen, Sandermann, and Sondermann 1997</a>)</span> and Jamshidian <span class="citation" data-cites="Jamshidian97">(<a href="#ref-Jamshidian97" role="doc-biblioref">Jamshidian 1997</a>)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Actually, for this theory, it is not even necessary that the short rate exist, so the risk-neutral measure may not even be defined. The risk-neutral measure uses as numeraire the portfolio that consists of continuously rolling over an investment at the instantaneously risk-free rate, and the more natural object in a market model is the portfolio that consists of rolling over an investment at spot LIBOR rates.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter13.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>