<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Brownian Motion – Pricing and Hedging Derivative Securities: Theory and Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter_Ito.html" rel="next">
<link href="./Chapter_OptionPricing.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bb6b93f51bf5a7975605005bd985cc1c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>



<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

<script type="text/javascript">

window.PlotlyConfig = {MathJaxConfig: 'local'};

if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}

if (typeof require !== 'undefined') {

require.undef("plotly");

requirejs.config({

    paths: {

        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']

    }

});

require(['plotly'], function(Plotly) {

    window._Plotly = Plotly;

});

}

</script>




  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_Brownian.html">Part II: Mathematical Tools</a></li><li class="breadcrumb-item"><a href="./Chapter_Brownian.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Brownian Motion</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pricing and Hedging Derivative Securities: Theory and Methods</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/math-finance-book/book-code.git" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Options</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Arbitrage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Arbitrage Pricing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_OptionPricing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pricing Digitals</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Mathematical Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Brownian.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Brownian Motion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Ito.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ito’s Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Numeraires.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Changing Numeraires</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Black-Scholes and Extensions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_BlackScholes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FX.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Merton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Merton, Black, and Margrabe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Exotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Exotic Options</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Alternative Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Vol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Stochastic Volatility</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Numerical Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_MonteCarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Monte Carlo Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Binomial and Trinomial Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FiniteDifferences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier Transforms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VI: Fixed Income</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FixedIncome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FixedIncomeDerivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Vasicek.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Miscellaneous Facts about Continuous-Time Models</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_Brownian.html">Part II: Mathematical Tools</a></li><li class="breadcrumb-item"><a href="./Chapter_Brownian.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Brownian Motion</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-c_continuoustime" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Brownian Motion</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Brownian motion is a fundamental tool for modeling uncertainty that resolves over time. Consider predicting a future stock price. We don’t know today what the price will be tomorrow, nor what it will be the following day, nor what it will be the day after that. We can regard the price three days from now as today’s price plus the change from today to tomorrow plus the change from tomorrow to the following day plus the change from that day to the next. Thus, there are three random changes in this small example. A simple way to model this situation is to assume each change is a normally distributed random variable with some mean and variance. Thus, the price in three days is viewed as today’s price plus the sum of three normal increments.</p>
<p>Rather than predicting daily changes as in the previous paragraph, we might be interested in predicting hourly changes or even minute-to-minute changes. This will lead to more, but smaller, increments. A Brownian motion models changes at all frequencies simultaneously, with all changes being normally distributed.</p>
<p>We will ultimately deal with different means and different variances, but we start with what is called a standard Brownian motion, which is similar to beginning the study of normal random variables by studying a standard normal variable, that is, a normal random variable with a zero mean and a unit variance. The definition of a standard Brownian motion is that its change over any time interval</p>
<ul>
<li>is normally distributed</li>
<li>is independent of prior changes</li>
<li>has a zero mean</li>
<li>has a variance equal to the length of the time interval.</li>
</ul>
<p>We can plot an approximate path of a Brownian motion by summing up normally distributed changes. We take an interval of time <span class="math inline">\([0, t]\)</span> and split it up as <span class="math display">\[0=t_0 &lt; t_1&lt; \cdots &lt; t_{N-1} &lt; t_N=t\]</span> where the times <span class="math inline">\(t_i\)</span> are equally spaced, meaning that <span class="math inline">\(t_i-t_{i-1} = t/N\)</span>, which we will call <span class="math inline">\(\Delta t\)</span>. We generate <span class="math inline">\(N\)</span> normally distributed random variables with zero means and variance equal to <span class="math inline">\(\Delta t\)</span> and define the Brownian motion, which we call <span class="math inline">\(B\)</span>, as the cumulative sum of the normal variables. By convention, we will start the Brownian motion at <span class="math inline">\(B_0=0\)</span>. This fits the definition of a standard Brownian motion, except that we have limited the frequency of the changes to <span class="math inline">\(N\)</span> changes within the interval. By taking <span class="math inline">\(N\)</span> larger, we can always get a better approximation.</p>
<div id="cell-fig-brownian-path" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span>   <span class="co"># number of subdivisions</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">0.5</span>    <span class="co"># last date</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t<span class="op">/</span>N</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate dB for each date</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dB <span class="op">=</span> np.random.normal(scale <span class="op">=</span> np.sqrt(dt), size<span class="op">=</span>N)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.zeros(N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Brownian path starts at 0 and is cumulative sum of the dB</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>B[<span class="dv">1</span>:] <span class="op">=</span> dB.cumsum()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>fig.add_trace(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  go.Scatter(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>np.arange(<span class="dv">0</span>, t<span class="op">+</span>dt, dt), </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>B, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span><span class="st">'t=%</span><span class="sc">{x:.2f}</span><span class="st">&lt;br&gt;B=%</span><span class="sc">{y:.2f}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;'</span>  <span class="co"># </span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">'Time'</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">'Brownian Motion'</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'plotly_white'</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-brownian-path" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-brownian-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: A Path of a Brownian Motion
</figcaption>
<div aria-describedby="fig-brownian-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>                            <div id="e1719542-08ac-4b67-8e15-032e2a540770" class="plotly-graph-div" style="height:300px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e1719542-08ac-4b67-8e15-032e2a540770")) {                    Plotly.newPlot(                        "e1719542-08ac-4b67-8e15-032e2a540770",                        [{"hovertemplate":"t=%{x:.2f}\u003cbr\u003eB=%{y:.2f}\u003cextra\u003e\u003c\u002fextra\u003e","mode":"lines","x":[0.0,0.0005,0.001,0.0015,0.002,0.0025,0.003,0.0035,0.004,0.0045000000000000005,0.005,0.0055,0.006,0.006500000000000001,0.007,0.0075,0.008,0.0085,0.009000000000000001,0.0095,0.01,0.0105,0.011,0.0115,0.012,0.0125,0.013000000000000001,0.0135,0.014,0.0145,0.015,0.0155,0.016,0.0165,0.017,0.0175,0.018000000000000002,0.0185,0.019,0.0195,0.02,0.0205,0.021,0.021500000000000002,0.022,0.0225,0.023,0.0235,0.024,0.0245,0.025,0.025500000000000002,0.026000000000000002,0.0265,0.027,0.0275,0.028,0.0285,0.029,0.029500000000000002,0.03,0.0305,0.031,0.0315,0.032,0.0325,0.033,0.0335,0.034,0.0345,0.035,0.035500000000000004,0.036000000000000004,0.0365,0.037,0.0375,0.038,0.0385,0.039,0.0395,0.04,0.0405,0.041,0.0415,0.042,0.0425,0.043000000000000003,0.043500000000000004,0.044,0.0445,0.045,0.0455,0.046,0.0465,0.047,0.0475,0.048,0.0485,0.049,0.0495,0.05,0.0505,0.051000000000000004,0.051500000000000004,0.052000000000000005,0.0525,0.053,0.0535,0.054,0.0545,0.055,0.0555,0.056,0.0565,0.057,0.0575,0.058,0.0585,0.059000000000000004,0.059500000000000004,0.06,0.0605,0.061,0.0615,0.062,0.0625,0.063,0.0635,0.064,0.0645,0.065,0.0655,0.066,0.0665,0.067,0.0675,0.068,0.0685,0.069,0.0695,0.07,0.07050000000000001,0.07100000000000001,0.07150000000000001,0.07200000000000001,0.0725,0.073,0.0735,0.074,0.0745,0.075,0.0755,0.076,0.0765,0.077,0.0775,0.078,0.0785,0.079,0.0795,0.08,0.0805,0.081,0.0815,0.082,0.0825,0.083,0.0835,0.084,0.0845,0.085,0.0855,0.08600000000000001,0.08650000000000001,0.08700000000000001,0.08750000000000001,0.088,0.0885,0.089,0.0895,0.09,0.0905,0.091,0.0915,0.092,0.0925,0.093,0.0935,0.094,0.0945,0.095,0.0955,0.096,0.0965,0.097,0.0975,0.098,0.0985,0.099,0.0995,0.1,0.1005,0.101,0.1015,0.10200000000000001,0.10250000000000001,0.10300000000000001,0.10350000000000001,0.10400000000000001,0.1045,0.105,0.1055,0.106,0.1065,0.107,0.1075,0.108,0.1085,0.109,0.1095,0.11,0.1105,0.111,0.1115,0.112,0.1125,0.113,0.1135,0.114,0.1145,0.115,0.1155,0.116,0.1165,0.117,0.11750000000000001,0.11800000000000001,0.11850000000000001,0.11900000000000001,0.11950000000000001,0.12,0.1205,0.121,0.1215,0.122,0.1225,0.123,0.1235,0.124,0.1245,0.125,0.1255,0.126,0.1265,0.127,0.1275,0.128,0.1285,0.129,0.1295,0.13,0.1305,0.131,0.1315,0.132,0.1325,0.133,0.1335,0.134,0.1345,0.135,0.1355,0.136,0.1365,0.137,0.1375,0.138,0.1385,0.139,0.1395,0.14,0.1405,0.14100000000000001,0.14150000000000001,0.14200000000000002,0.14250000000000002,0.14300000000000002,0.14350000000000002,0.14400000000000002,0.1445,0.145,0.1455,0.146,0.1465,0.147,0.1475,0.148,0.1485,0.149,0.1495,0.15,0.1505,0.151,0.1515,0.152,0.1525,0.153,0.1535,0.154,0.1545,0.155,0.1555,0.156,0.1565,0.157,0.1575,0.158,0.1585,0.159,0.1595,0.16,0.1605,0.161,0.1615,0.162,0.1625,0.163,0.1635,0.164,0.1645,0.165,0.1655,0.166,0.1665,0.167,0.1675,0.168,0.1685,0.169,0.1695,0.17,0.1705,0.171,0.1715,0.17200000000000001,0.17250000000000001,0.17300000000000001,0.17350000000000002,0.17400000000000002,0.17450000000000002,0.17500000000000002,0.17550000000000002,0.176,0.1765,0.177,0.1775,0.178,0.1785,0.179,0.1795,0.18,0.1805,0.181,0.1815,0.182,0.1825,0.183,0.1835,0.184,0.1845,0.185,0.1855,0.186,0.1865,0.187,0.1875,0.188,0.1885,0.189,0.1895,0.19,0.1905,0.191,0.1915,0.192,0.1925,0.193,0.1935,0.194,0.1945,0.195,0.1955,0.196,0.1965,0.197,0.1975,0.198,0.1985,0.199,0.1995,0.2,0.2005,0.201,0.2015,0.202,0.2025,0.203,0.20350000000000001,0.20400000000000001,0.20450000000000002,0.20500000000000002,0.20550000000000002,0.20600000000000002,0.20650000000000002,0.20700000000000002,0.20750000000000002,0.20800000000000002,0.2085,0.209,0.2095,0.21,0.2105,0.211,0.2115,0.212,0.2125,0.213,0.2135,0.214,0.2145,0.215,0.2155,0.216,0.2165,0.217,0.2175,0.218,0.2185,0.219,0.2195,0.22,0.2205,0.221,0.2215,0.222,0.2225,0.223,0.2235,0.224,0.2245,0.225,0.2255,0.226,0.2265,0.227,0.2275,0.228,0.2285,0.229,0.2295,0.23,0.2305,0.231,0.2315,0.232,0.2325,0.233,0.2335,0.234,0.23450000000000001,0.23500000000000001,0.23550000000000001,0.23600000000000002,0.23650000000000002,0.23700000000000002,0.23750000000000002,0.23800000000000002,0.23850000000000002,0.23900000000000002,0.23950000000000002,0.24,0.2405,0.241,0.2415,0.242,0.2425,0.243,0.2435,0.244,0.2445,0.245,0.2455,0.246,0.2465,0.247,0.2475,0.248,0.2485,0.249,0.2495,0.25,0.2505,0.251,0.2515,0.252,0.2525,0.253,0.2535,0.254,0.2545,0.255,0.2555,0.256,0.2565,0.257,0.2575,0.258,0.2585,0.259,0.2595,0.26,0.2605,0.261,0.2615,0.262,0.2625,0.263,0.2635,0.264,0.2645,0.265,0.2655,0.266,0.2665,0.267,0.2675,0.268,0.2685,0.269,0.2695,0.27,0.2705,0.271,0.2715,0.272,0.2725,0.273,0.2735,0.274,0.2745,0.275,0.2755,0.276,0.2765,0.277,0.2775,0.278,0.2785,0.279,0.2795,0.28,0.2805,0.281,0.28150000000000003,0.28200000000000003,0.28250000000000003,0.28300000000000003,0.28350000000000003,0.28400000000000003,0.28450000000000003,0.28500000000000003,0.28550000000000003,0.28600000000000003,0.28650000000000003,0.28700000000000003,0.28750000000000003,0.28800000000000003,0.2885,0.289,0.2895,0.29,0.2905,0.291,0.2915,0.292,0.2925,0.293,0.2935,0.294,0.2945,0.295,0.2955,0.296,0.2965,0.297,0.2975,0.298,0.2985,0.299,0.2995,0.3,0.3005,0.301,0.3015,0.302,0.3025,0.303,0.3035,0.304,0.3045,0.305,0.3055,0.306,0.3065,0.307,0.3075,0.308,0.3085,0.309,0.3095,0.31,0.3105,0.311,0.3115,0.312,0.3125,0.313,0.3135,0.314,0.3145,0.315,0.3155,0.316,0.3165,0.317,0.3175,0.318,0.3185,0.319,0.3195,0.32,0.3205,0.321,0.3215,0.322,0.3225,0.323,0.3235,0.324,0.3245,0.325,0.3255,0.326,0.3265,0.327,0.3275,0.328,0.3285,0.329,0.3295,0.33,0.3305,0.331,0.3315,0.332,0.3325,0.333,0.3335,0.334,0.3345,0.335,0.3355,0.336,0.3365,0.337,0.3375,0.338,0.3385,0.339,0.3395,0.34,0.3405,0.341,0.3415,0.342,0.3425,0.343,0.3435,0.34400000000000003,0.34450000000000003,0.34500000000000003,0.34550000000000003,0.34600000000000003,0.34650000000000003,0.34700000000000003,0.34750000000000003,0.34800000000000003,0.34850000000000003,0.34900000000000003,0.34950000000000003,0.35000000000000003,0.35050000000000003,0.35100000000000003,0.35150000000000003,0.352,0.3525,0.353,0.3535,0.354,0.3545,0.355,0.3555,0.356,0.3565,0.357,0.3575,0.358,0.3585,0.359,0.3595,0.36,0.3605,0.361,0.3615,0.362,0.3625,0.363,0.3635,0.364,0.3645,0.365,0.3655,0.366,0.3665,0.367,0.3675,0.368,0.3685,0.369,0.3695,0.37,0.3705,0.371,0.3715,0.372,0.3725,0.373,0.3735,0.374,0.3745,0.375,0.3755,0.376,0.3765,0.377,0.3775,0.378,0.3785,0.379,0.3795,0.38,0.3805,0.381,0.3815,0.382,0.3825,0.383,0.3835,0.384,0.3845,0.385,0.3855,0.386,0.3865,0.387,0.3875,0.388,0.3885,0.389,0.3895,0.39,0.3905,0.391,0.3915,0.392,0.3925,0.393,0.3935,0.394,0.3945,0.395,0.3955,0.396,0.3965,0.397,0.3975,0.398,0.3985,0.399,0.3995,0.4,0.4005,0.401,0.4015,0.402,0.4025,0.403,0.4035,0.404,0.4045,0.405,0.4055,0.406,0.40650000000000003,0.40700000000000003,0.40750000000000003,0.40800000000000003,0.40850000000000003,0.40900000000000003,0.40950000000000003,0.41000000000000003,0.41050000000000003,0.41100000000000003,0.41150000000000003,0.41200000000000003,0.41250000000000003,0.41300000000000003,0.41350000000000003,0.41400000000000003,0.41450000000000004,0.41500000000000004,0.41550000000000004,0.41600000000000004,0.4165,0.417,0.4175,0.418,0.4185,0.419,0.4195,0.42,0.4205,0.421,0.4215,0.422,0.4225,0.423,0.4235,0.424,0.4245,0.425,0.4255,0.426,0.4265,0.427,0.4275,0.428,0.4285,0.429,0.4295,0.43,0.4305,0.431,0.4315,0.432,0.4325,0.433,0.4335,0.434,0.4345,0.435,0.4355,0.436,0.4365,0.437,0.4375,0.438,0.4385,0.439,0.4395,0.44,0.4405,0.441,0.4415,0.442,0.4425,0.443,0.4435,0.444,0.4445,0.445,0.4455,0.446,0.4465,0.447,0.4475,0.448,0.4485,0.449,0.4495,0.45,0.4505,0.451,0.4515,0.452,0.4525,0.453,0.4535,0.454,0.4545,0.455,0.4555,0.456,0.4565,0.457,0.4575,0.458,0.4585,0.459,0.4595,0.46,0.4605,0.461,0.4615,0.462,0.4625,0.463,0.4635,0.464,0.4645,0.465,0.4655,0.466,0.4665,0.467,0.4675,0.468,0.4685,0.46900000000000003,0.46950000000000003,0.47000000000000003,0.47050000000000003,0.47100000000000003,0.47150000000000003,0.47200000000000003,0.47250000000000003,0.47300000000000003,0.47350000000000003,0.47400000000000003,0.47450000000000003,0.47500000000000003,0.47550000000000003,0.47600000000000003,0.47650000000000003,0.47700000000000004,0.47750000000000004,0.47800000000000004,0.47850000000000004,0.47900000000000004,0.47950000000000004,0.48,0.4805,0.481,0.4815,0.482,0.4825,0.483,0.4835,0.484,0.4845,0.485,0.4855,0.486,0.4865,0.487,0.4875,0.488,0.4885,0.489,0.4895,0.49,0.4905,0.491,0.4915,0.492,0.4925,0.493,0.4935,0.494,0.4945,0.495,0.4955,0.496,0.4965,0.497,0.4975,0.498,0.4985,0.499,0.4995,0.5],"y":[0.0,0.03802083645519729,0.032060101401136396,0.025832450489880247,0.02793996064829188,0.0185347275017244,-0.009077267139638759,-0.0055945532632589836,0.02742387609114191,0.02647516012258491,-0.0008189674312365676,0.010440528245955328,0.029911398206228096,0.037433278495037234,0.02321392463102403,-0.007322686509375852,0.00661931517747604,-0.028172734550781828,-0.03725653710634581,-0.07845214512731111,-0.05611870661347683,-0.04454935887234712,-0.026832986708518435,-0.022992076710891398,-0.03616200101272317,-0.042619702679554575,-0.07570317539527036,-0.04285662474664835,-0.06250227084604894,-0.059858790119194344,-0.07280325145859887,-0.052191030215462925,-0.05305068239341982,-0.060450236171274395,-0.032610315409347154,-0.012077816351791417,-0.022355266548560092,-0.05931154107467646,-0.0858939227967157,-0.10046272356490535,-0.14345045244699206,-0.17044374454168976,-0.1354916096886824,-0.1805432632928963,-0.16418683220386332,-0.15976617775282234,-0.15554863747120526,-0.1583675849806891,-0.16856629941904164,-0.16434709304850573,-0.17009810079460996,-0.19590181943534773,-0.2192208530620225,-0.25111335102274657,-0.23366451583812578,-0.2203084524279459,-0.25358840188888543,-0.2331842097924036,-0.22732623810035232,-0.21911373548475133,-0.27508705052008964,-0.2666809915881506,-0.28703436677344407,-0.2997950816998615,-0.29004662488662625,-0.2558982753432626,-0.251259466792603,-0.24903355344670614,-0.2729830556995609,-0.29476567733157744,-0.2687138307773411,-0.2623646171063067,-0.2306724877014259,-0.19683352732897091,-0.2012129700630439,-0.20690938416723936,-0.1936575873393742,-0.20298387427626646,-0.195018657705838,-0.21121878615235243,-0.1814205329966706,-0.20620036336911207,-0.2009957601377425,-0.20547793625883762,-0.21400829958002668,-0.20848321725343305,-0.1909144120948686,-0.2293682074453462,-0.2324985207958166,-0.2369383050057219,-0.25699893736453827,-0.2784689165931503,-0.28285474723897003,-0.2603060106919515,-0.27826908047610066,-0.29452942453075887,-0.3102354480221661,-0.2989266445977618,-0.27748863750807684,-0.2802500308677118,-0.2827688072442785,-0.2742882209336684,-0.2662922389810503,-0.22391062374733095,-0.22458595348763633,-0.22521837815771087,-0.26672202774905485,-0.30164726196706515,-0.2757880025288696,-0.24574810595547125,-0.24316975283884631,-0.24729013083038007,-0.24501412796464175,-0.24661378043970292,-0.2487745412669872,-0.21434751676111968,-0.17762107601083407,-0.15920597988612126,-0.1602270112972596,-0.193709950464995,-0.18980372145477592,-0.1979017137554749,-0.21599156321897772,-0.23295983053993674,-0.2595483366996854,-0.29379968963053,-0.31770682621524515,-0.27719327634669605,-0.2725638131403295,-0.23582084916182874,-0.22837202655245123,-0.19360730414811697,-0.20000815534510027,-0.15012139735140423,-0.1726571930258359,-0.17854296767202782,-0.19862910391523558,-0.25361413729409893,-0.244293430151481,-0.23727485589728897,-0.23964148639255156,-0.2080169209472338,-0.2030889748711429,-0.1550816379870132,-0.15941302085419087,-0.15493758102618238,-0.132306450158264,-0.1329062330766041,-0.10226089161617799,-0.09398751390517988,-0.07645258201934561,-0.08095666634282613,-0.07099051527983784,-0.08988689210088127,-0.05477008495818638,-0.029449229181314526,-0.030594447444772552,-0.008145363940215429,-0.04283439022638019,-0.028834469869703623,-0.0692742416091548,-0.05584592342556639,-0.04522954225767897,-0.04673472263473306,-0.04698513042758773,-0.02161551768543908,-0.06617916327211726,-0.12207856738853437,-0.12512169761806782,-0.11346981309480031,-0.13671720343284677,-0.12620809778059663,-0.11012106558110904,-0.08692341970599433,-0.10496416113029121,-0.10954590740644655,-0.10620479214818533,-0.10704419807430576,-0.06998148600318857,-0.08770214151482467,-0.034259375882451905,-0.03843888389316415,-0.05067686690479322,-0.0650523872057436,-0.07938784839901783,-0.08909440684878128,-0.10329276202555454,-0.05869010026718307,-0.08598409214407668,-0.09420658463363298,-0.04386258598052732,-0.02356121528642689,-0.0014447581809210325,0.004489507437732038,-0.018118051752704766,-0.03529821778904158,-0.04549527957432535,-0.08280144633243278,-0.07505551239484139,-0.08391959499329002,-0.0640459264551108,-0.08137352890425376,-0.11090726368556297,-0.12523873150980155,-0.1039980691083637,-0.12885667987084207,-0.16922032284576105,-0.19801777580752056,-0.20130841256804752,-0.20262475948110545,-0.2301791349492324,-0.23965013844870056,-0.23986412542534163,-0.22037570147245875,-0.23330825418591877,-0.21522205927736143,-0.20615374839828846,-0.23599511589657907,-0.20711763421913226,-0.19158399816499963,-0.16064488552512024,-0.19002075363091933,-0.1690814724183091,-0.18600527257886026,-0.22857575203804426,-0.25424465096449106,-0.2591818421141431,-0.27108101749881564,-0.29580901686418565,-0.26554564138267983,-0.26434686883421427,-0.26915546311824046,-0.2407762664403922,-0.21540829530461464,-0.23187619358705974,-0.2295934134825225,-0.20860376695855304,-0.17046914151744244,-0.15131956277950093,-0.19494235668437604,-0.23813964883357142,-0.2599885177073322,-0.2570976112039509,-0.2605505972993239,-0.2826796226375271,-0.2906455493196691,-0.2959634784720585,-0.27257923218845187,-0.2508183959066069,-0.23266449655158591,-0.2445901705942976,-0.23613772938575112,-0.22719637808043808,-0.2418006750192915,-0.25275274168829026,-0.26126750827104417,-0.28215090277814336,-0.2972239721179869,-0.3038607749804178,-0.2892832153790741,-0.30237283447018387,-0.2948705305518938,-0.2768894911360932,-0.29282700976987497,-0.32562401342678676,-0.288291350722944,-0.24458504727193134,-0.2515454357211062,-0.21269151401697337,-0.22561470010871645,-0.2219920640646171,-0.20954288956086334,-0.21511171147482236,-0.23450543390686068,-0.19733789243328168,-0.20365264105922812,-0.20623228152840054,-0.20369730038461897,-0.21576087657477797,-0.20901468086338856,-0.2163800846046645,-0.22822715223461723,-0.206024759563022,-0.16656264923458902,-0.14756494290699604,-0.18634843403751364,-0.1994677643497805,-0.20330647311856806,-0.2108463095734115,-0.2520925124554067,-0.2397554018178688,-0.27853554469600117,-0.24777845263171983,-0.2638366012503659,-0.25718484683326454,-0.24635122205586427,-0.198997896760779,-0.20025102468738684,-0.17686666571117515,-0.1681193929704299,-0.14918139130291808,-0.15383697738778665,-0.1675280078447117,-0.17495279184544074,-0.21321828051283997,-0.16523564306004632,-0.1723370426755122,-0.15578566784471523,-0.16925438193736086,-0.1956700893144993,-0.1942825391103215,-0.17231200485794063,-0.15137956319952836,-0.1609074707165117,-0.16291253125726596,-0.17024139754372927,-0.19044831290262973,-0.18761253672826103,-0.1495361900390632,-0.16313876883935086,-0.1664211452214528,-0.15504699910400604,-0.15885138522802422,-0.18777402797866824,-0.19197297975502156,-0.19970764241410574,-0.1693156494916303,-0.18363627662963541,-0.16939316646644773,-0.1950278799294774,-0.20383454595251488,-0.1948258245360812,-0.1765436926226491,-0.17015758398728426,-0.160328198440909,-0.15326338440886214,-0.16620184293716248,-0.14525785956796863,-0.16517115874438018,-0.14667892525755963,-0.12724338247019587,-0.1221424748800414,-0.11374179498249376,-0.0974678396394587,-0.13996612211884263,-0.12737003376873687,-0.0962980806403275,-0.10457672519435154,-0.12684737584439984,-0.12022451841166347,-0.12221886911505257,-0.12362451964823112,-0.14739107152146078,-0.1609133045708398,-0.15192462400533124,-0.15074971726396907,-0.1618884016592673,-0.20395104511486634,-0.18601971962022423,-0.20289268134225638,-0.18144211425340495,-0.19467199515290448,-0.1903299752453078,-0.21304518393693284,-0.19782668941042694,-0.18592187083980438,-0.16462907096503682,-0.15149887761954692,-0.180970835344389,-0.1636533779859877,-0.15304363469541915,-0.13926339222181922,-0.1645675218014043,-0.1429029259953588,-0.13678719508408374,-0.13710682616378816,-0.1123356063404293,-0.08264035987619162,-0.09395751359391938,-0.06128800838024901,-0.02244817979631951,-0.008570044072516058,-0.008357191417712533,-0.044985852854525034,-0.04344116038689962,-0.039788565930267195,-0.0488162362916389,-0.05440183053482965,-0.034146407173384526,-0.021008667139906848,-0.03241791314685131,-0.03510243110670716,-0.058083932978719284,-0.01449929103974279,-0.01939515015166692,-0.04151962239192955,-0.011244017611887726,-0.011941408638639574,-0.030123420815563733,-0.02137811706698728,-0.037595796067002724,-0.03859998113671666,-0.022816662652943857,-0.0055978834346435205,-0.014029440719029916,0.011665043309617769,0.0005125988949207499,-0.006295079512897317,-0.010596860056657862,-0.02100200541391231,-0.03879595787653903,-0.03553303973062417,-0.03570811459484964,-0.044115942164183866,-0.07139719749761869,-0.06678061476000301,-0.054610697401227086,-0.06373631612423467,-0.022575728268182972,-0.041025117054741655,-0.006691621656570376,-0.023983763169619657,0.0031984100017062693,0.01573620494428269,0.05648688509427416,0.043715779892299286,0.0748927385548625,0.09705191978358951,0.08687550130621677,0.0885620647433496,0.0788503508572465,0.07137612994379272,0.07173287020476876,0.04413299201932528,0.008007539069325373,0.016019102051239173,0.0011127388292684875,-0.00788663124130062,-0.005672421542348431,-0.01334434128340724,-0.028042214987098885,-0.03846437848440661,-0.03340478993257545,-0.024221890057858873,-0.011875813719117917,0.023617650393397027,0.04384976676307288,0.03805211140557674,0.04805831674334601,0.045612632299834414,0.041651804952748804,0.03327960160318852,0.048786317839770985,0.020428801257023826,0.03253900334255763,0.053949750058959633,0.03857745733477769,0.015401625506538646,0.006049796535266973,0.01658237410012163,0.019773948491683443,0.01999145563326759,0.019110187925607775,-0.006134214814553535,0.0023524019012519694,0.006221620476187688,0.008430411530493218,-0.01329149891502127,-0.013342570403414895,-0.009795495295340649,0.01680268793548022,-0.013092533813659168,4.3485161110648485e-05,0.022529322671458567,0.010428566554521936,0.011234704801600907,0.03014647337422937,-0.0010502422844149845,0.005954409118657922,-0.014843380543556581,-0.032479346441656294,-0.02301985018793408,-0.053057306085930976,-0.0930754067336667,-0.08506698891584343,-0.09158979341237214,-0.07765142488896025,-0.07707524579996285,-0.08653433274483206,-0.07286037720848974,-0.0748113755548541,-0.07143737834361147,-0.057217109806731406,-0.06701786153595819,-0.0011198679711812987,-0.028127382452242587,-0.036420969046942364,-0.05461256578503526,-0.05471042371136014,-0.03499526092660225,-0.058091472591778964,-0.051236191585661985,-0.04938141157725532,-0.06280640309988651,-0.08476580285553312,-0.0932693935067006,-0.11114229601863668,-0.11220629073876007,-0.10122816684413839,-0.06804311585606809,-0.08529223171846276,-0.04400192799571659,-0.09865503050603613,-0.12516628635575397,-0.09655275302293465,-0.06702250974970472,-0.049905244666922144,-0.06440787701915178,-0.10226303127848244,-0.12156764480325216,-0.16185882056068815,-0.18259904816607112,-0.16115162864001384,-0.1305275539657935,-0.11440045483758654,-0.11103753610158174,-0.1040900292366762,-0.08370173764608124,-0.11061754123218569,-0.11289079900064088,-0.07045740224642766,-0.07308449961506065,-0.0813977596557337,-0.04816897061940627,-0.027918213301059234,-0.025185599369487922,0.01110067515075179,0.02499745243549423,0.021419461152848908,0.008361954986891889,-0.02119470482340089,0.013335702067283906,0.04626763926131505,0.06239123987470964,0.08529238779809167,0.06431414008384866,0.08420411777126084,0.09075199358791329,0.09504327191148415,0.11094510931588182,0.12540027474200585,0.1286975376428155,0.15168772756864807,0.13975431334995386,0.15673653935373216,0.19214391794730595,0.14215397432153787,0.15507135529028065,0.10711465727609118,0.09719697594724551,0.12817189185660705,0.14471252955631525,0.1324507905710175,0.12162730685423977,0.10192405704033852,0.09261261877921022,0.09522392899215312,0.10937044377407393,0.12890497020752015,0.13618015032592767,0.1360006540443896,0.14315324244313807,0.14455790071111946,0.11543767880315473,0.08919949113274424,0.16448608238427143,0.1689948412635984,0.1915575896614542,0.17816117525124195,0.15830452146301077,0.15243941285043072,0.1655645445949526,0.18857732423440418,0.19437458325524634,0.1936790521778671,0.19643672948976207,0.17712888346399494,0.20808880939744645,0.24198738069860953,0.23050591290627231,0.18888619059954415,0.2145030484882985,0.25217538488228813,0.2757102068515168,0.27203262825728447,0.27506069575437825,0.28241095895677215,0.2787123063079575,0.31725303446396985,0.28987212396010037,0.27506217922808973,0.24308338281118538,0.24778206157446456,0.24857445046888438,0.2264593391797693,0.23689449625363893,0.23483214369860822,0.2131704385925562,0.22468691497973906,0.1619511637833753,0.15438423897051323,0.1720918918850734,0.13509057152222048,0.11576087119944117,0.07205547300430515,0.1260275242019242,0.11289481361241506,0.131630357040931,0.12553736901669235,0.1385385297708761,0.134825776563364,0.18072333056707052,0.18850030219885397,0.20426826360089495,0.22551254684717242,0.22017388034770216,0.1955613261654779,0.22522412533846403,0.2001536148422059,0.2021339056940384,0.22740949594359683,0.22809104898837593,0.24809118622704593,0.2313267036243655,0.23387006241699385,0.2379221116506565,0.2101447896475393,0.15553428917751422,0.15318097889566912,0.1522843826186799,0.1501712150537575,0.164017788563934,0.18214906289251265,0.19737678994213836,0.19408100569402645,0.21485503867621,0.2636938370227972,0.22944614767882462,0.21440556965274607,0.21164990559701535,0.2740492804780034,0.31323232153921193,0.33453076946343846,0.3037774854604985,0.2755984424451341,0.27127614652668464,0.28440988410106693,0.2957388737117386,0.25965223698865336,0.24718878633011102,0.25535766193760195,0.28185126365657953,0.24188144952386947,0.24991438962050616,0.2347959634610517,0.24229578816288388,0.2481542681805715,0.2271197834058027,0.2206428905968318,0.2106572578409066,0.212083300459011,0.23417212034106138,0.2581325874229376,0.2377617958849337,0.23789451978344014,0.2463947500069279,0.27938339370163373,0.30594597139559626,0.2836906642169136,0.29629162430456496,0.29278464890109396,0.2904105747299505,0.2827441614679255,0.2653180640390782,0.2642806588469221,0.2707582907717707,0.26131454716657293,0.25010245864178354,0.2528666793442916,0.2536135993605197,0.25389019609459695,0.2729155801322909,0.2534182438432279,0.2738306669590469,0.2844498784030411,0.289755162734494,0.31535600134743647,0.3533057496435208,0.36237901833706715,0.38013099617084056,0.3839440457947288,0.370255083286017,0.3565318431875952,0.3416788622957308,0.35325206523163694,0.3961801893006184,0.433013327204901,0.4150746820766067,0.4149872943824289,0.4048825444293636,0.44418646354523883,0.4433439064768773,0.47052062137143974,0.47177977261616827,0.48580666743419515,0.4925565698264249,0.4776683085867617,0.497570025512021,0.5123019620818994,0.5230597330513408,0.5213513769532407,0.5329972409143919,0.5185405167740281,0.5212174514278834,0.5261445604116596,0.5530424176795304,0.5525586762120214,0.5541254560545511,0.5375057099502919,0.549949804370408,0.5062665091222702,0.5149584678093109,0.49752676834127235,0.5312225724039672,0.5288340848524173,0.5134183474334757,0.5290223906475149,0.5207545027881795,0.5188799755527115,0.502267833982056,0.5095780574587686,0.4829767421062317,0.5200116827683121,0.5219719897210366,0.4953906176147586,0.47737921156451185,0.5104191872139766,0.5262951047464528,0.518939355719285,0.489085494500153,0.5051498463980202,0.5665795308247505,0.6062915752870043,0.6350011098406444,0.650261129424353,0.6657621092518571,0.6905567118121599,0.6878697064131468,0.6919447960092612,0.6867324795805555,0.703729751624484,0.7199721460977023,0.7313799986008784,0.7516682474241111,0.7050613896333032,0.6895348425512849,0.7002740746617351,0.6597057730828324,0.635042730273157,0.622178488655241,0.6247445724895465,0.6248573499830248,0.5932766334332917,0.5966358266017873,0.5965745171585203,0.6171975137294347,0.6017897802472532,0.5896616137122972,0.5803489212992392,0.5272584471843161,0.5468082963500701,0.5552172813223635,0.555907654192128,0.5754713093049404,0.5804816815163271,0.5380487190738564,0.5015586187978112,0.4794217075435838,0.5025760397701348,0.47403306075841545,0.4637649786048884,0.48577096981262313,0.48136026930809034,0.4764770896163217,0.45184172663432703,0.4276724802612969,0.4660276443888455,0.4708088491348381,0.4574111678077813,0.49919689462108097,0.48588754452878763,0.42839917052858917,0.4078800087325321,0.3994139288579935,0.37123991254247846,0.34689182091430926,0.31668226661806453,0.33453068292014837,0.35313527551531076,0.4032377908582876,0.36666055040508544,0.3696235501240673,0.3469318786149608,0.33335516616719296,0.3213541135127626,0.3232555215759184,0.333773852393494,0.343229046878769,0.28854936661691544,0.26306181380599564,0.254459828871733,0.23819250223642452,0.23315832067889325,0.23544839230151346,0.22933122086008761,0.19798574504323135,0.19982934157329002,0.2012146521633657,0.17338723643526716,0.1467601927197892,0.16777734297287983,0.15647329613804034,0.12883612527124538,0.08319992001203216,0.08935612404413124,0.08256007386470071,0.09576884377961364,0.06301134901483965,0.06789442760905141,0.08021247169756063,0.0411973706934258,0.01933473309337196,0.044643892247826764,0.020428800983347102,0.008837492903359523,-0.01454042509905794,-0.00806604417586836,-0.031985573202462564,-0.043630189923571955,-0.04273824965561433,-0.04277838571157968,-0.039852311037584735,-0.011329993793109751,-0.03236577913201334,-0.05902245597547902,-0.029372506011882057,-0.05587233570021585,-0.027049757819890923,-0.0032554620504564,0.0355365139913941,0.009365719032147356,0.005063754966513451,-0.017806685892691833,-0.0181063376800668,0.0020328292850233,0.012406904932599614,0.029260639325908007,0.013742028482587126,-0.009746665488520843,-0.015277759049123343,-0.023370070355256633,-0.029230528339237533,-0.026689723529399006,-0.03667021435902683,-0.04792495735608667,-0.017655478448151157,-0.025474395056070145,-0.023487766497400375,0.026479484536213457,0.05107464757331116,0.08093226810602629,0.0491486278441067,0.01868704859683018,0.03088337876940218,0.07021522083132617,0.11792190456305035,0.09235738863573983,0.14243441588547281,0.12427042700677217,0.12781519438354624,0.15469287884189994,0.1609523657819203,0.12589275658959723,0.12287453813876163,0.09101324438234358,0.07135710189744637,0.10864448201457552,0.12825064699628616,0.13022519477244168,0.13993525882462332,0.11178619184365397,0.08622832579415748,0.07098488150047724,0.09430259549341925,0.07143283145623024,0.06672274635269104,0.06139406931781641,0.07439457017389658,0.08117881433992792,0.10005567489697512,0.0650939900210627,0.06636017098552023,0.05848869587526461,0.09349812494378641,0.10283899959589338,0.09218866297693637,0.06040654784960001,0.05116061022250648,0.041909870001790445,0.026492299970671204,0.012782517183292147,-0.0020913543247702802,-0.02614754991018731,-0.05338398628218355,-0.04826998323386044,-0.0002902392704154655,0.0016893205942790429,-0.010544214783898814,-0.007558095277277462,-0.028662211766676715,-0.013703005498419076,-0.006228538204783352,0.01230684127667456,0.05238754531714494,0.07184248674329885,0.09337002234106759,0.12292580137791033,0.11143002797072338,0.0926529342899359,0.11738937888174204,0.11582657961089764,0.11593218804730318,0.09079230009472228,0.08391590756419719,0.09043436231508219,0.06891403199119635,0.06634652372935305,0.042837278208364166,0.0548580912057758,0.02110144582971253,0.0016268232717487792,0.021349623167706784,-0.025579287478212073,-0.044567262544687736,-0.08613661721331875,-0.029628370296239964,-0.03822753852845696,-0.041787583918657806,-0.05996996539524239,-0.043313327704686155,-0.08211578330441871,-0.08316092498206418,-0.10858423532924397,-0.10216951226102189,-0.14361774238994304,-0.17792588379465846,-0.18871630078019916,-0.19150467366581655,-0.18936220721670988,-0.17348191052048467,-0.1706161784971533,-0.18997243489627902,-0.16476840323353478,-0.1916182092652983,-0.20201830510966926,-0.12162883696617273,-0.12921122378013594,-0.09585052503894778,-0.08661190971844217,-0.08556288037305454,-0.07889401968537406,-0.039785289425096924,-0.04145903775783714,-0.05684460236940968,-0.07974459634229418,-0.07791625023716704,-0.05396985937845403,-0.039689936122072306,-0.07562599169767428,-0.08471905546721094,-0.052067902960154615,-0.04425827528474494,-0.050798528224704945,-0.028636404385322514,-0.05222289134166337,-0.04320485202328474,-0.04487575712087181,-0.05200974960916683,-0.02997527081058047,-0.019783381505540723,-0.02161875596522047],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"showlegend":false,"xaxis":{"title":{"text":"Time"}},"yaxis":{"title":{"text":"Brownian Motion"}},"height":300},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e1719542-08ac-4b67-8e15-032e2a540770');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</figure>
</div>
</div>
<section id="sec-s_quadraticvariation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-s_quadraticvariation"><span class="header-section-number">4.1</span> Quadratic Variation</h2>
<p><a href="#fig-brownian-path" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> illustrates a distinctive characteristic of a Brownian motion: it jiggles rapidly, moving up and down in a very erratic way. The name Brownian motion derives from the botanist Robert Brown’s observations of the erratic behavior of particles suspended in a fluid. This has long been thought to be a reasonable model for the behavior of a stock price. The plot of other functions with which we may be familiar will be much smoother. This is captured in the concept of quadratic variation.</p>
<p>Consider a discrete partition <span class="math display">\[0=t_0 &lt; t_1 &lt; t_2 &lt; \cdots &lt; t_N=t\]</span> of the time interval <span class="math inline">\([0,t]\)</span> as before. Let <span class="math inline">\(B\)</span> be a Brownian motion and calculate the sum of squared changes <span class="math display">\[\sum_{i=1}^N [\Delta B_{t_i}]^2\; ,\]</span> where <span class="math inline">\(\Delta B_{t_i}\)</span> denotes the change <span class="math inline">\(B_{t_i}-B(t_{i-1}).\)</span> If we consider finer partitions with the length of each time interval <span class="math inline">\(t_i-t_{i-1}\)</span> going to zero, the limit of the sum is called the quadratic variation of the process. For a Brownian motion, the quadratic variation over an interval <span class="math inline">\([0,t]\)</span> is equal to <span class="math inline">\(t\)</span> with probability one. Here is a plot of the quadratic variation (that is, the cumulative sum of squared changes) of the previous approximation of a Brownian motion. The plot shows that the approximation has quadratic variation through each date <span class="math inline">\(s \le t\)</span> that is approximately equal to <span class="math inline">\(s\)</span>.</p>
<div id="cell-fig-quadratic-variation" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic variation is cumulative sum of squared changes</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dQ <span class="op">=</span> dB<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> np.zeros(N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Q[<span class="dv">1</span>:] <span class="op">=</span> dQ.cumsum()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>fig.add_trace(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  go.Scatter(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>np.arange(<span class="dv">0</span>, t<span class="op">+</span>dt, dt), </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>Q, </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span><span class="st">'t=%</span><span class="sc">{x:.2f}</span><span class="st">&lt;br&gt;B=%</span><span class="sc">{y:.2f}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;'</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">'Time'</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">'Quadratic Variation'</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'plotly_white'</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">300</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-quadratic-variation" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-quadratic-variation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Quadratic Variation of a Brownian Motion Path
</figcaption>
<div aria-describedby="fig-quadratic-variation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>                            <div id="9b65558a-0ce3-4607-8099-f897937eb1bc" class="plotly-graph-div" style="height:300px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9b65558a-0ce3-4607-8099-f897937eb1bc")) {                    Plotly.newPlot(                        "9b65558a-0ce3-4607-8099-f897937eb1bc",                        [{"hovertemplate":"t=%{x:.2f}\u003cbr\u003eB=%{y:.2f}\u003cextra\u003e\u003c\u002fextra\u003e","mode":"lines","x":[0.0,0.0005,0.001,0.0015,0.002,0.0025,0.003,0.0035,0.004,0.0045000000000000005,0.005,0.0055,0.006,0.006500000000000001,0.007,0.0075,0.008,0.0085,0.009000000000000001,0.0095,0.01,0.0105,0.011,0.0115,0.012,0.0125,0.013000000000000001,0.0135,0.014,0.0145,0.015,0.0155,0.016,0.0165,0.017,0.0175,0.018000000000000002,0.0185,0.019,0.0195,0.02,0.0205,0.021,0.021500000000000002,0.022,0.0225,0.023,0.0235,0.024,0.0245,0.025,0.025500000000000002,0.026000000000000002,0.0265,0.027,0.0275,0.028,0.0285,0.029,0.029500000000000002,0.03,0.0305,0.031,0.0315,0.032,0.0325,0.033,0.0335,0.034,0.0345,0.035,0.035500000000000004,0.036000000000000004,0.0365,0.037,0.0375,0.038,0.0385,0.039,0.0395,0.04,0.0405,0.041,0.0415,0.042,0.0425,0.043000000000000003,0.043500000000000004,0.044,0.0445,0.045,0.0455,0.046,0.0465,0.047,0.0475,0.048,0.0485,0.049,0.0495,0.05,0.0505,0.051000000000000004,0.051500000000000004,0.052000000000000005,0.0525,0.053,0.0535,0.054,0.0545,0.055,0.0555,0.056,0.0565,0.057,0.0575,0.058,0.0585,0.059000000000000004,0.059500000000000004,0.06,0.0605,0.061,0.0615,0.062,0.0625,0.063,0.0635,0.064,0.0645,0.065,0.0655,0.066,0.0665,0.067,0.0675,0.068,0.0685,0.069,0.0695,0.07,0.07050000000000001,0.07100000000000001,0.07150000000000001,0.07200000000000001,0.0725,0.073,0.0735,0.074,0.0745,0.075,0.0755,0.076,0.0765,0.077,0.0775,0.078,0.0785,0.079,0.0795,0.08,0.0805,0.081,0.0815,0.082,0.0825,0.083,0.0835,0.084,0.0845,0.085,0.0855,0.08600000000000001,0.08650000000000001,0.08700000000000001,0.08750000000000001,0.088,0.0885,0.089,0.0895,0.09,0.0905,0.091,0.0915,0.092,0.0925,0.093,0.0935,0.094,0.0945,0.095,0.0955,0.096,0.0965,0.097,0.0975,0.098,0.0985,0.099,0.0995,0.1,0.1005,0.101,0.1015,0.10200000000000001,0.10250000000000001,0.10300000000000001,0.10350000000000001,0.10400000000000001,0.1045,0.105,0.1055,0.106,0.1065,0.107,0.1075,0.108,0.1085,0.109,0.1095,0.11,0.1105,0.111,0.1115,0.112,0.1125,0.113,0.1135,0.114,0.1145,0.115,0.1155,0.116,0.1165,0.117,0.11750000000000001,0.11800000000000001,0.11850000000000001,0.11900000000000001,0.11950000000000001,0.12,0.1205,0.121,0.1215,0.122,0.1225,0.123,0.1235,0.124,0.1245,0.125,0.1255,0.126,0.1265,0.127,0.1275,0.128,0.1285,0.129,0.1295,0.13,0.1305,0.131,0.1315,0.132,0.1325,0.133,0.1335,0.134,0.1345,0.135,0.1355,0.136,0.1365,0.137,0.1375,0.138,0.1385,0.139,0.1395,0.14,0.1405,0.14100000000000001,0.14150000000000001,0.14200000000000002,0.14250000000000002,0.14300000000000002,0.14350000000000002,0.14400000000000002,0.1445,0.145,0.1455,0.146,0.1465,0.147,0.1475,0.148,0.1485,0.149,0.1495,0.15,0.1505,0.151,0.1515,0.152,0.1525,0.153,0.1535,0.154,0.1545,0.155,0.1555,0.156,0.1565,0.157,0.1575,0.158,0.1585,0.159,0.1595,0.16,0.1605,0.161,0.1615,0.162,0.1625,0.163,0.1635,0.164,0.1645,0.165,0.1655,0.166,0.1665,0.167,0.1675,0.168,0.1685,0.169,0.1695,0.17,0.1705,0.171,0.1715,0.17200000000000001,0.17250000000000001,0.17300000000000001,0.17350000000000002,0.17400000000000002,0.17450000000000002,0.17500000000000002,0.17550000000000002,0.176,0.1765,0.177,0.1775,0.178,0.1785,0.179,0.1795,0.18,0.1805,0.181,0.1815,0.182,0.1825,0.183,0.1835,0.184,0.1845,0.185,0.1855,0.186,0.1865,0.187,0.1875,0.188,0.1885,0.189,0.1895,0.19,0.1905,0.191,0.1915,0.192,0.1925,0.193,0.1935,0.194,0.1945,0.195,0.1955,0.196,0.1965,0.197,0.1975,0.198,0.1985,0.199,0.1995,0.2,0.2005,0.201,0.2015,0.202,0.2025,0.203,0.20350000000000001,0.20400000000000001,0.20450000000000002,0.20500000000000002,0.20550000000000002,0.20600000000000002,0.20650000000000002,0.20700000000000002,0.20750000000000002,0.20800000000000002,0.2085,0.209,0.2095,0.21,0.2105,0.211,0.2115,0.212,0.2125,0.213,0.2135,0.214,0.2145,0.215,0.2155,0.216,0.2165,0.217,0.2175,0.218,0.2185,0.219,0.2195,0.22,0.2205,0.221,0.2215,0.222,0.2225,0.223,0.2235,0.224,0.2245,0.225,0.2255,0.226,0.2265,0.227,0.2275,0.228,0.2285,0.229,0.2295,0.23,0.2305,0.231,0.2315,0.232,0.2325,0.233,0.2335,0.234,0.23450000000000001,0.23500000000000001,0.23550000000000001,0.23600000000000002,0.23650000000000002,0.23700000000000002,0.23750000000000002,0.23800000000000002,0.23850000000000002,0.23900000000000002,0.23950000000000002,0.24,0.2405,0.241,0.2415,0.242,0.2425,0.243,0.2435,0.244,0.2445,0.245,0.2455,0.246,0.2465,0.247,0.2475,0.248,0.2485,0.249,0.2495,0.25,0.2505,0.251,0.2515,0.252,0.2525,0.253,0.2535,0.254,0.2545,0.255,0.2555,0.256,0.2565,0.257,0.2575,0.258,0.2585,0.259,0.2595,0.26,0.2605,0.261,0.2615,0.262,0.2625,0.263,0.2635,0.264,0.2645,0.265,0.2655,0.266,0.2665,0.267,0.2675,0.268,0.2685,0.269,0.2695,0.27,0.2705,0.271,0.2715,0.272,0.2725,0.273,0.2735,0.274,0.2745,0.275,0.2755,0.276,0.2765,0.277,0.2775,0.278,0.2785,0.279,0.2795,0.28,0.2805,0.281,0.28150000000000003,0.28200000000000003,0.28250000000000003,0.28300000000000003,0.28350000000000003,0.28400000000000003,0.28450000000000003,0.28500000000000003,0.28550000000000003,0.28600000000000003,0.28650000000000003,0.28700000000000003,0.28750000000000003,0.28800000000000003,0.2885,0.289,0.2895,0.29,0.2905,0.291,0.2915,0.292,0.2925,0.293,0.2935,0.294,0.2945,0.295,0.2955,0.296,0.2965,0.297,0.2975,0.298,0.2985,0.299,0.2995,0.3,0.3005,0.301,0.3015,0.302,0.3025,0.303,0.3035,0.304,0.3045,0.305,0.3055,0.306,0.3065,0.307,0.3075,0.308,0.3085,0.309,0.3095,0.31,0.3105,0.311,0.3115,0.312,0.3125,0.313,0.3135,0.314,0.3145,0.315,0.3155,0.316,0.3165,0.317,0.3175,0.318,0.3185,0.319,0.3195,0.32,0.3205,0.321,0.3215,0.322,0.3225,0.323,0.3235,0.324,0.3245,0.325,0.3255,0.326,0.3265,0.327,0.3275,0.328,0.3285,0.329,0.3295,0.33,0.3305,0.331,0.3315,0.332,0.3325,0.333,0.3335,0.334,0.3345,0.335,0.3355,0.336,0.3365,0.337,0.3375,0.338,0.3385,0.339,0.3395,0.34,0.3405,0.341,0.3415,0.342,0.3425,0.343,0.3435,0.34400000000000003,0.34450000000000003,0.34500000000000003,0.34550000000000003,0.34600000000000003,0.34650000000000003,0.34700000000000003,0.34750000000000003,0.34800000000000003,0.34850000000000003,0.34900000000000003,0.34950000000000003,0.35000000000000003,0.35050000000000003,0.35100000000000003,0.35150000000000003,0.352,0.3525,0.353,0.3535,0.354,0.3545,0.355,0.3555,0.356,0.3565,0.357,0.3575,0.358,0.3585,0.359,0.3595,0.36,0.3605,0.361,0.3615,0.362,0.3625,0.363,0.3635,0.364,0.3645,0.365,0.3655,0.366,0.3665,0.367,0.3675,0.368,0.3685,0.369,0.3695,0.37,0.3705,0.371,0.3715,0.372,0.3725,0.373,0.3735,0.374,0.3745,0.375,0.3755,0.376,0.3765,0.377,0.3775,0.378,0.3785,0.379,0.3795,0.38,0.3805,0.381,0.3815,0.382,0.3825,0.383,0.3835,0.384,0.3845,0.385,0.3855,0.386,0.3865,0.387,0.3875,0.388,0.3885,0.389,0.3895,0.39,0.3905,0.391,0.3915,0.392,0.3925,0.393,0.3935,0.394,0.3945,0.395,0.3955,0.396,0.3965,0.397,0.3975,0.398,0.3985,0.399,0.3995,0.4,0.4005,0.401,0.4015,0.402,0.4025,0.403,0.4035,0.404,0.4045,0.405,0.4055,0.406,0.40650000000000003,0.40700000000000003,0.40750000000000003,0.40800000000000003,0.40850000000000003,0.40900000000000003,0.40950000000000003,0.41000000000000003,0.41050000000000003,0.41100000000000003,0.41150000000000003,0.41200000000000003,0.41250000000000003,0.41300000000000003,0.41350000000000003,0.41400000000000003,0.41450000000000004,0.41500000000000004,0.41550000000000004,0.41600000000000004,0.4165,0.417,0.4175,0.418,0.4185,0.419,0.4195,0.42,0.4205,0.421,0.4215,0.422,0.4225,0.423,0.4235,0.424,0.4245,0.425,0.4255,0.426,0.4265,0.427,0.4275,0.428,0.4285,0.429,0.4295,0.43,0.4305,0.431,0.4315,0.432,0.4325,0.433,0.4335,0.434,0.4345,0.435,0.4355,0.436,0.4365,0.437,0.4375,0.438,0.4385,0.439,0.4395,0.44,0.4405,0.441,0.4415,0.442,0.4425,0.443,0.4435,0.444,0.4445,0.445,0.4455,0.446,0.4465,0.447,0.4475,0.448,0.4485,0.449,0.4495,0.45,0.4505,0.451,0.4515,0.452,0.4525,0.453,0.4535,0.454,0.4545,0.455,0.4555,0.456,0.4565,0.457,0.4575,0.458,0.4585,0.459,0.4595,0.46,0.4605,0.461,0.4615,0.462,0.4625,0.463,0.4635,0.464,0.4645,0.465,0.4655,0.466,0.4665,0.467,0.4675,0.468,0.4685,0.46900000000000003,0.46950000000000003,0.47000000000000003,0.47050000000000003,0.47100000000000003,0.47150000000000003,0.47200000000000003,0.47250000000000003,0.47300000000000003,0.47350000000000003,0.47400000000000003,0.47450000000000003,0.47500000000000003,0.47550000000000003,0.47600000000000003,0.47650000000000003,0.47700000000000004,0.47750000000000004,0.47800000000000004,0.47850000000000004,0.47900000000000004,0.47950000000000004,0.48,0.4805,0.481,0.4815,0.482,0.4825,0.483,0.4835,0.484,0.4845,0.485,0.4855,0.486,0.4865,0.487,0.4875,0.488,0.4885,0.489,0.4895,0.49,0.4905,0.491,0.4915,0.492,0.4925,0.493,0.4935,0.494,0.4945,0.495,0.4955,0.496,0.4965,0.497,0.4975,0.498,0.4985,0.499,0.4995,0.5],"y":[0.0,0.0014455840047528593,0.0014811143671375696,0.0015198980030100393,0.0015243396020778474,0.001612798012619139,0.0023752202606938068,0.002387349556638535,0.0034775662336700977,0.0034784662956590926,0.004223435694583369,0.004350211937488072,0.004729326714497924,0.0047859053975771,0.004988095421887127,0.005920580041827122,0.006114959452863303,0.007325446177156872,0.007407961646025343,0.009105039766242363,0.00960382224209358,0.009737672049248762,0.010051541891896046,0.010066294481505917,0.010239741387621897,0.010281443298439694,0.011375959465371205,0.012454855354883696,0.01284080676554659,0.012847794755899842,0.01301535383526718,0.013440217499843164,0.013440956501710231,0.013495709897821593,0.01427077108585198,0.014692354603400508,0.014797980585947569,0.016163746812797246,0.016870369830813452,0.017082619786636655,0.018930564621076448,0.01965920243918612,0.020880854169968932,0.02291050566244301,0.023178038500413296,0.023197580686188803,0.023215368332215866,0.02322331479727709,0.02332732857347215,0.02334513027586932,0.02337820436596507,0.024044036261655428,0.024587813590937417,0.025604945017112204,0.025909406866412264,0.02608779129622901,0.0271953463323517,0.02761167738746183,0.027645993219806705,0.02771343841901796,0.03084645041506319,0.03091711224183042,0.03133137212326374,0.031494207968697036,0.031589240378936546,0.03275535015547229,0.03277686870024196,0.032781823390465405,0.0333554020486249,0.0338298846537885,0.03450858336267398,0.034548895876914426,0.03555328694313013,0.03669836218221871,0.036717541700879736,0.036749990834526215,0.03692560095369323,0.03701258058172248,0.037076025256736304,0.03733846941841987,0.03822640530954997,0.03884044530283694,0.03886753319763292,0.03888762310041344,0.03896039019880493,0.038990916733520564,0.039299579648220166,0.04077827402507658,0.04078807288674872,0.04080778457057924,0.04121021354121483,0.04167117354929187,0.04169040905974568,0.042198854579612526,0.04252152645568274,0.042785925244458595,0.04303260441837123,0.043160493453263046,0.04362008160124043,0.043627706894527066,0.043634051128962216,0.043705971473133924,0.04376990720052052,0.04556610851033955,0.04556656458059769,0.04556696454156101,0.04728951747096208,0.04850928945614496,0.049177990754836864,0.05008038614097733,0.05008703404577134,0.05010401156056446,0.05010919174960931,0.050111750637650276,0.050116419525003,0.0513016395413306,0.05265047099151484,0.052989586756797255,0.05299062926193979,0.05411173647725005,0.05412699510233033,0.05419257258163251,0.0545198152352447,0.054807737331120224,0.055514685990927216,0.05668784116852049,0.05725939234820072,0.05890074007115213,0.058922172000731236,0.06027221740265664,0.060327702360922615,0.06153628828477303,0.06157725918081895,0.06406594780394055,0.06457380989062028,0.06460845223380604,0.06501190510298674,0.06803525899866145,0.06812213458029989,0.0681713949648615,0.06817699590476262,0.0691771090443678,0.06920139369689667,0.071506098091603,0.07152485896914508,0.07154488853079921,0.07205705661516006,0.07205741635470919,0.07299655330793531,0.07306500208668415,0.07337247592292499,0.07339276269851802,0.07349208686552833,0.07384915992249119,0.07508235006638841,0.07572349580366156,0.07572480732853251,0.07622876867872709,0.07743209722340932,0.0776280949934026,0.07926347013174152,0.07944378986098122,0.0795564974100831,0.07955876297805056,0.07955882568211328,0.08020244293279988,0.08218836144077495,0.08531310482134545,0.08532236546293935,0.08545813187588291,0.0859985730334124,0.08610901433502256,0.08636780694000991,0.08690593771415714,0.08723140606529547,0.08725239846423453,0.08726356151540351,0.08726426611771232,0.08863791074377886,0.08895193237554094,0.09180806157397767,0.09182552986118928,0.0919752980893822,0.09218195367330523,0.0923874591209291,0.09248167639786778,0.09268326968759358,0.09467266712352528,0.09541762911610122,0.09548523849884202,0.09801975669922593,0.09843190235128521,0.09892104002618489,0.09895625553461762,0.09946735726716673,0.09976251537220282,0.09986649544125571,0.10125824551943943,0.10131824501200497,0.10139681697231709,0.1017917796734825,0.10209202548011805,0.10296426697025075,0.10316965794024793,0.10362082367949979,0.10423877420854019,0.10586799788274692,0.10669729117983168,0.1067081194701214,0.10670985223931692,0.10746909584675543,0.10755879575404237,0.10755884154446854,0.10793864021263584,0.10810589113232226,0.10843300157859259,0.1085152358407921,0.10940574305496013,0.1102396520029914,0.11048094585205366,0.1114381745429968,0.1123011161699661,0.11273956966766688,0.11302598467954116,0.11483823040092596,0.1154971227730221,0.1155214986294703,0.1156630890043055,0.11627456295691924,0.11719043485245384,0.1171918719080768,0.11721499448706517,0.11802037329114516,0.1186639072506908,0.11893509892453176,0.11894031000953743,0.11938087527073861,0.1208351249282724,0.12120183129411302,0.12310477944218023,0.12497078549120318,0.12544815856226596,0.12545651590267726,0.1254684390156521,0.12595813277807094,0.12602158876597622,0.12604986913644606,0.12659669211069843,0.1270702261063837,0.12739979016817593,0.12754201186954894,0.12761345563193288,0.1276934033950979,0.1279066888841761,0.1280266366484983,0.1280991378984571,0.12853525406459623,0.12876245148391996,0.12880649863615473,0.12901900388008547,0.1291903420080358,0.1292466265721182,0.12956994435059077,0.1298239488507929,0.13089959229966439,0.13229332000422328,0.13420356096557529,0.13425200797293868,0.13576163520472956,0.13592864394349138,0.1359417674353994,0.13609674938122432,0.1361277611587337,0.13650387762850466,0.13788530376769487,0.13792517981790375,0.13793183436285394,0.13793826049225327,0.13808379036274904,0.1381293015193254,0.1381835506915974,0.13832390370302608,0.1388168499433698,0.14037410809494322,0.14073502094065268,0.14223918012492362,0.142411296952766,0.14242603263777756,0.14248288177154333,0.14418413102372604,0.1443363353226089,0.14584023480425726,0.14678623351650794,0.14704409765356646,0.1470883434903919,0.1472057109162094,0.14944804833271155,0.149449618662312,0.1499964469070403,0.1500729616874413,0.15043160959459997,0.1504532840763936,0.15064072839136605,0.15069585580882353,0.15216010343177838,0.15446243692870462,0.15451286680520315,0.1547868148139927,0.15496822107330213,0.15566601066953673,0.15566793596510584,0.15615064034044088,0.1565888074542237,0.1566795884758759,0.156683608743648,0.15673732102469287,0.15714564045301463,0.15715368207952574,0.1586034902567217,0.15878852040673974,0.15879929440145352,0.15892866560135455,0.15894313895513518,0.15977965821881657,0.1597972894148367,0.15985711442128653,0.16078078765508633,0.1609858680167121,0.1611887342038328,0.16184587273816445,0.16192343010460578,0.1620045871661647,0.16233882351346482,0.1623796058969675,0.1624762227171868,0.16252613431449422,0.16269353802358277,0.16313218846295185,0.16352872794704112,0.16387069064637222,0.16424843096981168,0.16427445022805498,0.16434502165079604,0.16460986327330313,0.16641596728700064,0.1665746287287243,0.16754009499993838,0.16760863095559025,0.16810461283596675,0.1681484750765411,0.1681524525112692,0.16815442836469063,0.16871927735263356,0.16890212813927527,0.168982924517584,0.1689843049234349,0.16910837521349298,0.17087764118796583,0.17119917362196063,0.1714838704592338,0.17194399728766713,0.17211902703628207,0.17213788017316003,0.17265386087906412,0.17288546345471742,0.17302718815991686,0.17348057148642376,0.17365297346371372,0.1745215697558486,0.17482146408520863,0.1749340307379004,0.1751239258205316,0.17576422479431203,0.17623357950575136,0.17627098167033048,0.17627108383435758,0.17688469716589475,0.17776650482846656,0.17789458279673726,0.1789618793676433,0.1804704116520723,0.1806630143032406,0.18066305960949328,0.18200471844814592,0.18200710452296545,0.18202044596923006,0.18210194480138364,0.1821331436644332,0.1825434258399846,0.18271602605317183,0.1828461969476188,0.18285340358429558,0.18338155301258888,0.18528117402553768,0.1853051434619815,0.18579463573389163,0.18671124797868893,0.18671173433293312,0.18704231989973494,0.1871188002373898,0.18738181334953735,0.1873828217371916,0.1876319348795518,0.18792842123732037,0.18799951239556026,0.1886597189050587,0.1887840959214816,0.18883044040678587,0.18884894572263256,0.18895721277253816,0.18927383751678037,0.1892844841516073,0.18928451480281538,0.18935520636725103,0.1900994732598191,0.19012078609599234,0.19026889298451177,0.19035216990158949,0.19204636389424523,0.19238674384084284,0.1935655327470991,0.1938645509052064,0.19460342144352236,0.19476061774554446,0.19642123567823136,0.19658433680631127,0.19755633955775845,0.19804736887048602,0.19815092836351264,0.19815377285974012,0.19824809024634565,0.19830395422460875,0.19830408148822257,0.19906583476407388,0.20037088311491655,0.20043506825632973,0.20065726792083505,0.2007382565825021,0.20074315930709305,0.20080201765960629,0.20101804515101596,0.20112666664298057,0.2011522660792944,0.20123659172940347,0.2013890173303655,0.20264880332507187,0.20305814185786797,0.20309175466551227,0.20319187881077388,0.20319786018317113,0.20321354833644453,0.20328364212537092,0.2035241003738128,0.20432824912055358,0.20447490611510605,0.20493332619005997,0.20516963357365792,0.20570675275458875,0.20579420945969668,0.20590514464985635,0.20591533079695323,0.20591537810630986,0.20591615473908242,0.2065534346087899,0.20662545727207088,0.20664042812445152,0.2066453068823731,0.20711714827577604,0.20711715088407298,0.2071297326258953,0.20783719597707562,0.20873092026050583,0.20890347525501135,0.2094090881435531,0.2095555164421547,0.2095561663010281,0.20991382129157277,0.21088705635945906,0.21093612150073762,0.21136866955557135,0.21167969684873028,0.21176917891810446,0.21267142767492855,0.21427287605438086,0.2143370108103257,0.21437955778882561,0.21457383590592005,0.21457416788826264,0.21466364221409323,0.2148506192741031,0.21485442566865062,0.2148658095258321,0.21506802556309307,0.21516408029755102,0.2195066258534144,0.22023603169185915,0.22030481527046294,0.22063574946234435,0.2206357590385181,0.2210244466821476,0.22155788167543025,0.22160487655310307,0.22160831676198264,0.22178854715936536,0.22227076239699364,0.22234307345095627,0.22266251409515744,0.2226636461799219,0.22278416538416757,0.22388541299324838,0.2241829449912827,0.2258878341727993,0.2288747957868028,0.22957764247353202,0.2303963767633204,0.23126841203109652,0.23156141279501077,0.2317717391401547,0.23320475184415243,0.23357741994749315,0.23520079879140973,0.23563095583253282,0.23609094763685953,0.23702878158651175,0.23728886491280277,0.23730017413522775,0.23734844198686567,0.2377641244208488,0.23848858490353456,0.2384937526044164,0.2402943457645169,0.24030124740510117,0.240370357697605,0.24147451011842577,0.24188460329039235,0.24189207046929137,0.24320876418784956,0.2434018846067513,0.24341468662837,0.243585185095644,0.24445878123478537,0.24565113023482163,0.24673564272217324,0.2469956132189135,0.2475200757951221,0.24796016267228227,0.24835577388468802,0.24839864856239832,0.24841706363204868,0.24866993206488458,0.2488788838723812,0.24888975581501824,0.2494183046478441,0.24956071102275904,0.24984910702280244,0.2511027894816711,0.2536017839453786,0.2537686426764702,0.25606848756089434,0.2561668479638349,0.2571262933794269,0.2573998860749399,0.2575502363178835,0.25766738411765083,0.2580556021708798,0.2581423050533706,0.2581491239943988,0.2583492478748739,0.2587308455978529,0.2587837738436082,0.25878380606252327,0.2588349655833252,0.25883693864817503,0.25968492597214415,0.2603733684643718,0.26604143928664636,0.26606176819327826,0.2665708458085432,0.26675030972759334,0.267144596427259,0.2671789959262964,0.2673512650096075,0.26788085303634146,0.2679144612484962,0.2679149450119758,0.2679225497961324,0.2682953427142871,0.2692538597280919,0.27040297286435194,0.27053479696701843,0.2722669982519076,0.2729232216600002,0.2743424265893821,0.2748963144345054,0.27490983901882216,0.2749190082115891,0.2749730345807336,0.2749867146121502,0.2764721023389458,0.2772218165989667,0.27744115106193196,0.27846379448220576,0.27848587206432623,0.2784864999444862,0.27897557809181617,0.2790844705949725,0.27908872389303374,0.2795579533611353,0.27969058258951185,0.2836263570676839,0.28368361541880743,0.28399717639054994,0.28536627409914445,0.2857399114137129,0.28765007324510833,0.29056305555558676,0.2907355236430146,0.2910865442305764,0.29112366873363993,0.2912926989145961,0.291306483450976,0.29341306891449914,0.2934735502022607,0.29372217880903695,0.29417349837968504,0.2942019997396776,0.2948077775630505,0.2956876592178274,0.2963161897143704,0.29632011126622826,0.2969589667286918,0.29695943124324464,0.2973594367328103,0.29764048460974585,0.2976469532836939,0.29766337238668594,0.29843495200435083,0.30141725876593745,0.3014227968352201,0.30142360072010405,0.3014280661972615,0.3016197937952342,0.30194853690401235,0.30218042057511024,0.3021912827689203,0.30262284321526517,0.3050080714392038,0.306180975664605,0.3064071946519636,0.3064147883363516,0.3103084703218897,0.31184378102869403,0.31229740491267505,0.31324316938964053,0.3140372278549023,0.3140559100969089,0.31422840515958167,0.31435675116518036,0.31565899651516427,0.31581433411748216,0.3158810646461728,0.31658297557821663,0.31818056162002,0.31824508974661614,0.318473656556155,0.3185299039267132,0.31856422571483084,0.3190066752645708,0.3190486254050297,0.3191483382665659,0.31915037186411455,0.3196382878278962,0.3202123918106779,0.3206273609585627,0.32062737857419593,0.3206996324880482,0.3217878831008645,0.3224934536346123,0.3229887523322298,0.3231475365273604,0.32315983540384097,0.32316547163201104,0.32322424552431517,0.32352791439591483,0.32352899060544754,0.32357095032080135,0.32366013461408205,0.32378584554316975,0.3237934864592619,0.32379404434877257,0.32379412085452586,0.3241560860923076,0.3245362322146764,0.32495289923213566,0.32506566688382793,0.32509381292566547,0.32574921586335137,0.3271893992590875,0.3272717234638728,0.32758685618088357,0.3276013955283178,0.32778878322288274,0.32797711054168166,0.32819772158305577,0.32833166060925145,0.3301744844453333,0.33153116449320924,0.33185295948224813,0.3318529671188572,0.3319550730904712,0.33349987114833846,0.3335005810507519,0.33423915488321226,0.33424074034506934,0.3344374941233053,0.33448305530560996,0.3347047156283504,0.3351007939649236,0.3353178239200225,0.3354335535562535,0.3354364720368114,0.335572098184213,0.3357810950570836,0.3357882610362246,0.3358125374391626,0.33653603216476535,0.33653626617057275,0.3365387209696477,0.33681493693021775,0.3369697924161545,0.3388780226998905,0.3389535728457077,0.33925743699205174,0.34039284420348326,0.34039854907626715,0.3406361940364369,0.3408796802010625,0.34094803817071706,0.3409515520230736,0.3412275152706371,0.3412809546379166,0.3419885846164017,0.34336017144624553,0.34336401424959445,0.34407058359264686,0.3443949943405537,0.3454866343314709,0.3457386790889689,0.3457927861327196,0.34668403916241075,0.34694210256430924,0.3507157086930769,0.3522927551684489,0.35311699254273554,0.35334986074043073,0.3535901411160434,0.3542049134321668,0.35421213343018115,0.35422873978539754,0.3542559080279505,0.3545448152848858,0.3548086306631094,0.35493876976184363,0.355350382802157,0.35752258199528963,0.35776365565957974,0.35787898676590185,0.35952477385889864,0.3601330395395305,0.36029852825193465,0.36030511303817936,0.3603051257569424,0.361302467414737,0.3613137515934802,0.36131375535232807,0.36173906333989203,0.36197646159095,0.3621235540144496,0.36221028025442986,0.3650288786961772,0.3654110752985809,0.3654817863268452,0.3654822629415445,0.36586499954291757,0.3658901033726142,0.3676906596742583,0.36902218709241413,0.36951222993229166,0.37004835303314915,0.3708630546840126,0.3709684881951242,0.3714527518441591,0.3714722061230998,0.3714960515670019,0.37210295267625654,0.3726871051464968,0.37415822376174795,0.37418108368057107,0.37436058154551244,0.37610662851082816,0.3762837673107074,0.3795886804558941,0.3800097164567069,0.380081390965149,0.3808751661604959,0.3814679957264296,0.3823806128972073,0.3826991788616998,0.38304530972733175,0.38555557177102495,0.38689346629019633,0.386902245657531,0.3874171576134082,0.3876014847342976,0.387745509999112,0.3877491253517346,0.38785976063492256,0.38794916133767693,0.39093902877121545,0.3915886441195049,0.3916626382643142,0.391927264180174,0.39195260716412816,0.3919578515921649,0.3919952713786087,0.3929778102327938,0.39298120908095946,0.3929831281663904,0.39375749323249487,0.39446649268952083,0.39490821329428183,0.3950359947691261,0.3957998079826465,0.39788247121310755,0.39792037006119235,0.39796655635923367,0.39814102796189876,0.39921408142516296,0.3992379258817202,0.39938966009188664,0.4009118381982495,0.4013898131210808,0.4020303666581863,0.4026167373031334,0.4027510957261386,0.40329762277626635,0.4033395403846049,0.40391168425345897,0.4040472813520405,0.4040480769094821,0.40404807852038505,0.40405664043338285,0.40487016301437734,0.4053126672792018,0.40602324569953874,0.40690236523238255,0.4076046062058932,0.4084353472015606,0.4090015157127239,0.4105063331179554,0.41119124362675435,0.4112097505215764,0.4117328075866708,0.4117328973778645,0.4121384834239123,0.41224610486945396,0.4125301532324541,0.4127709805149606,0.41332269925942894,0.41335329225540507,0.41341877775768043,0.4134531227254624,0.4134595784145441,0.4135591886117444,0.4136858578516743,0.4146020992050322,0.4146632346619538,0.4146671813549839,0.4171639075308401,0.4177688295756615,0.41866030707953716,0.4196705068678363,0.4205984146780744,0.4207471651477528,0.4222941589477369,0.4245700866204157,0.4252236310950134,0.4277313397531839,0.42806127024516943,0.4280738356209249,0.4287962455427677,0.42883542671951996,0.4300646029162384,0.43007371255885535,0.4310888545986881,0.4314752185360747,0.432865567252074,0.43324996895736406,0.4332538677962844,0.4333481531401819,0.43414052311208096,0.43479372762908497,0.4350260902230195,0.4355698060088762,0.43609283211599287,0.43611501701767547,0.4361434118166175,0.4363124248391264,0.43635845080803076,0.43671478667252095,0.4379371060818836,0.43793870929611833,0.4380006694165297,0.43922632954023355,0.43931358147949995,0.43942701114959704,0.4404371139915643,0.44052260135416843,0.4406081775487996,0.4408458790144641,0.4410338371585412,0.44125506921217955,0.4418337697582234,0.4425755932244692,0.44260174625164744,0.4449038020824452,0.4449077207397031,0.4450573801275522,0.44506629703726003,0.44551168077005815,0.4457354586222344,0.44579132628355805,0.4461348865760797,0.44774134941245947,0.44811984415835454,0.44858327894726774,0.4494568230217424,0.4495889758279718,0.4499415550750689,0.45055344676611236,0.4505558891076733,0.45055590026081516,0.4511879142270835,0.45123519900131737,0.4512776892536567,0.45174081387090587,0.4517474059695805,0.4523000905945467,0.4524445905396654,0.4535841016467107,0.45396336257048586,0.4543523514062219,0.4565546740606345,0.4569152172577596,0.458643228505326,0.46183641047496754,0.4619103561692535,0.4619230300924338,0.46225362908859385,0.4625310726677483,0.4640367032283175,0.46403779554944385,0.4646841402584529,0.46472528893049486,0.4664432447113149,0.46762029327796084,0.4677367263766827,0.46774450140003193,0.4677490915625175,0.46800127538567765,0.4680094878057072,0.46838415246749593,0.46901939567955253,0.46974030776349585,0.46984846975706795,0.4763109363454622,0.4763684289352587,0.477481365155759,0.4775667171687993,0.47756781763136674,0.47761229133423844,0.4791417841168096,0.47914458555029094,0.4793813011487078,0.4799057108726659,0.47990905372214604,0.4804824833573043,0.48068639956551246,0.4819777996558452,0.48206048346456204,0.4831265812246011,0.48318757150902963,0.4832303464175483,0.48372150615062043,0.48427782851756207,0.4843591535507099,0.4843619454745551,0.48441283932337814,0.4848983575793035,0.4850022321869097,0.48500560078631694],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"showlegend":false,"xaxis":{"title":{"text":"Time"}},"yaxis":{"title":{"text":"Quadratic Variation"}},"height":300},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9b65558a-0ce3-4607-8099-f897937eb1bc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</figure>
</div>
</div>
<p>The functions with which we are normally familiar are continuously differentiable. If <span class="math inline">\(X\)</span> is a continuously differentiable function of time (in each state of the world), then the quadratic variation of <span class="math inline">\(X\)</span> will be zero. A simple example is a linear function: <span class="math inline">\(X(t) = at\)</span> for some constant <span class="math inline">\(a\)</span>. Then, taking <span class="math inline">\(t_i-t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>, the sum of squared changes is <span class="math display">\[\sum_{i=1}^N [\Delta X_{t_i}]^2 = \sum_{i=1}^N  [a\,\Delta t]^2 = Na^2 (\Delta t)^2 = Na^2 \left(\frac{T}{N}\right)^2 = \frac{a^2T^2}{N} \rightarrow 0\]</span> as <span class="math inline">\(N \rightarrow \infty\)</span>. Essentially the same argument shows that the quadratic variation of any continuously differentiable function is zero, because such a function is approximately linear at each point. Thus, the jiggling of a Brownian motion, which leads to the nonzero quadratic variation, is quite unusual. To explain exactly how unusual it is, it is helpful to introduce the concept of total variation, which is defined in the same way as quadratic variation but with the squared changes <span class="math inline">\([\Delta B_{t_i}]^2\)</span> replaced by the absolute value of the changes <span class="math inline">\(|\Delta B_{t_i}|.\)</span> If the quadratic variation of a continuous function is nonzero, then its total variation is necessarily infinite, so each path of a Brownian motion has infinite total variation (with probability one). It was mentioned above that, with a large number of time steps in the simulation of the preceding section, one could see the distinctive jiggling property of a Brownian motion. This is not quite right. Any plot drawn by a pencil (or a laser printer, for that matter) must have finite total variation, because the total variation is the total distance traveled by the pencil. Hence, no matter how many time steps one uses, one will never create a continuous plot with the nonzero quadratic variation (and infinite total variation) that a Brownian path has. Another way to understand this is to consider focusing on a small segment of a plot and viewing it with a magnifying glass. If the segment is small enough, and excluding the finite number of kinks that a pencil can draw in the plot of a function, it will look approximately like a straight line under the magnifying glass (with slope equal to the derivative of the function). However, if one could view a segment of a path of a true Brownian motion under a magnifying glass, it would look much the same as the entire picture does to the naked eye—no matter how small the segment, one would still see the characteristic jiggling.</p>
<p>To better visualize the convergence of the quadratic variation of a handful of simulated paths of a standard Brownian motion, we encourage readers to interact with the plot below.</p>
<div id="fig-interactive_quad_var" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-interactive_quad_var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Convergence of quadratic variation for a standard Brownian motion
</figcaption>
<div aria-describedby="fig-interactive_quad_var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p>&lt;iframe wi, th=“780” height=“1000” src=“https://derivatives-book-26ac36570fb8.herokuapp.com/math_finance_book_plots/quad_var_plot”&gt;</p>
</div>
</figure>
</div>
<p>One may well question why we should be interested in this curious mathematical object. The reason is that asset pricing inherently involves martingales (variables that evolve randomly over time in such a way that their expected changes are always zero), as our fundamental pricing formula (<a href="Chapter_Arbitrage.html#eq-formula" class="quarto-xref">Equation&nbsp;<span>2.28</span></a>) establishes. Furthermore, continuous processes (variables whose paths are continuous functions of time) are much more tractable mathematically than are processes that can jump at some instants. More importantly, it is possible in a mathematical model with continuous processes to define perfect hedges much more readily than it is in a model involving jump processes. So, we are led to a study of continuous martingales. An important fact is that any non-constant continuous martingale must have infinite total variation! So, the normal functions with which we are familiar are left behind once we enter the study of continuous martingales.</p>
<p>There remains perhaps the question of why we focus on Brownian motion within the world of continuous martingales. The answer here is that any continuous martingale is really just a transformation of a Brownian motion. This is a consequence of the following important fact, which is known as Levy’s theorem: </p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A continuous martingale is a Brownian motion if and only if its quadratic variation over each interval <span class="math inline">\([0,T]\)</span> equals <span class="math inline">\(T\)</span>.</p>
</div>
</div>
<p>Thus, among continuous martingales, a Brownian motion is defined by the condition that the quadratic variation over each interval <span class="math inline">\([0,T]\)</span> is equal to <span class="math inline">\(T\)</span>. This is really just a normalization. A different continuous martingale may have a different quadratic variation, but it can be converted to a Brownian motion just by deforming the time scale. Furthermore, many continuous martingales can be constructed as stochastic integrals with respect to a Brownian motion. We take up this topic in the next section.</p>
</section>
<section id="exercises" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.2</span> Exercises</h2>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1</strong></span> Consider a discrete partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_i - t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>. Consider the function <span class="math display">\[X(t)=\mathrm{e}^t\; .\]</span> Write a code, which computes and plots <span class="math inline">\(\sum_{i=1}^N [\Delta X_{t_i}]^2\)</span>, where <span class="math display">\[\Delta X_{t_i} = X_{t_i}-X(t_{i-1}) = \mathrm{e}^{t_i} - \mathrm{e}^{t_{i-1}}\; .\]</span></p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2</strong></span> Repeat the previous problem for the function <span class="math inline">\(X(t) = t^3\)</span>. In both this and the previous problem, what happens to <span class="math inline">\(\sum_{i=1}^N [\Delta X_{t_i}]^2\)</span> as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.3</strong></span> Either use the code provided or write a code to compute <span class="math inline">\(\sum_{i=1}^N [\Delta B_{t_i}]^2\)</span>, where <span class="math inline">\(B\)</span> is a simulated Brownian motion. For a given <span class="math inline">\(T\)</span>, what happens to the sum as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.4</strong></span> Repeat the previous problem to compute <span class="math inline">\(\sum_{i=1}^N [\Delta B_{t_i}]^3\)</span>, where <span class="math inline">\(B\)</span> is a simulated Brownian motion. For a given <span class="math inline">\(T\)</span>, what happens to the sum as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>
<div id="exr-nolabel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.5</strong></span> Repeat the previous problem, computing instead <span class="math inline">\(\sum_{i=1}^N |\Delta B_{t_i}|\)</span> where <span class="math inline">\(| \cdot |\)</span> denotes the absolute value. What happens to this sum as <span class="math inline">\(N \rightarrow \infty\)</span>?</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter_OptionPricing.html" class="pagination-link" aria-label="Pricing Digitals">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pricing Digitals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter_Ito.html" class="pagination-link" aria-label="Ito's Formula">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ito’s Formula</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/math-finance-book/book-code.git/blob/main/Chapter_Brownian.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>