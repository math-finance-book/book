<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13&nbsp; Asians, Baskets, and Spreads â€“ Pricing and Hedging Derivative Securities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter_Exotics.html" rel="next">
<link href="./Chapter_Merton.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-45de5ea787cff190a632d730191a5db6.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-8deca16a749a126e590a598812fafdf7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-45de5ea787cff190a632d730191a5db6.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
<style>
div.callout-Principle.callout {
  border-left-color: #eb4034;
}
div.callout-Principle.callout-style-default > .callout-header {
  background-color: rgba(235, 64, 52, 0.13);
}
div.callout-Principle .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-Principle.callout-style-default .callout-icon::before, div.callout-Principle.callout-titled .callout-icon::before {
  font-family: 'Font Awesome 6 Free';
  content: '\f06a';
  background-image: none;
}
div.callout-Extra.callout {
  border-left-color: #a1bced;
}
div.callout-Extra.callout-style-default > .callout-header {
  background-color: rgba(161, 188, 237, 0.13);
}
div.callout-Extra .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-Extra.callout-style-default .callout-icon::before, div.callout-Extra.callout-titled .callout-icon::before {
  font-family: 'Font Awesome 6 Free';
  content: '\f48b';
  background-image: none;
}
div.callout-Example.callout {
  border-left-color: #a1bced;
}
div.callout-Example.callout-style-default > .callout-header {
  background-color: rgba(161, 188, 237, 0.13);
}
div.callout-Example .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-Example.callout-style-default .callout-icon::before, div.callout-Example.callout-titled .callout-icon::before {
  font-family: 'Font Awesome 6 Free';
  content: '\f185';
  background-image: none;
}
div.callout-Rule.callout {
  border-left-color: #12801f;
}
div.callout-Rule.callout-style-default > .callout-header {
  background-color: rgba(18, 128, 31, 0.13);
}
div.callout-Rule .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-Rule.callout-style-default .callout-icon::before, div.callout-Rule.callout-titled .callout-icon::before {
  font-family: 'Font Awesome 6 Free';
  content: '\f164';
  background-image: none;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating fullcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_BlackScholes.html">Part 4: Black-Scholes and Extensions</a></li><li class="breadcrumb-item"><a href="./Chapter_Asians.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Asians, Baskets, and Spreads</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pricing and Hedging Derivative Securities</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://chat.derivative-securities.org/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-chat-square-text"></i></a>
    <a href="https://github.com/math-finance-book/book-published-code.git" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Intro_Derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Derivative Securities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Intro_Options.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Options Markets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Intro_Futures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Futures Markets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Intro_Arbitrage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Arbitrage and Trees</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Mathematical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Brownian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Brownian Motion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Ito.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ito Processes and Itoâ€™s Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_GBM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Geometric Brownian Motion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 3: Arbitrage Pricing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Arbitrage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More on Arbitrage Pricing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Deltas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Delta Hedges, Replication, and PDEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Girsanov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Arbitrage Pricing in Continuous Time</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 4: Black-Scholes and Extensions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_BlackScholes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Merton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Merton, Black, and Margrabe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Asians.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Asians, Baskets, and Spreads</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Exotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Other Exotics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 5: Numerical Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_MonteCarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Monte Carlo Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Binomial and Trinomial Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendix_Binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Binomial Tree Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendix_MonteCarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo Simulations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_BlackScholes.html">Part 4: Black-Scholes and Extensions</a></li><li class="breadcrumb-item"><a href="./Chapter_Asians.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Asians, Baskets, and Spreads</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-c:asians" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Asians, Baskets, and Spreads</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="74f9c9dd" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG"></script>
</div>
</div>
<p>This chapter addresses some <strong>non-vanilla</strong> options that are very important for hedging: Asian options, basket options, and spread options. More exotic options are studied in the following chapter.</p>
<section id="asian-options" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="asian-options"><span class="header-section-number">13.1</span> Asian Options</h2>
<p>An Asian option is an option whose value depends on the average underlying asset price during the lifetime of the option. Average-price calls and puts are defined like standard calls and puts but with the final asset price replaced by the average price. Average-strike calls and puts are defined like standard calls and puts but with the exercise price replaced by the average asset price. A firm that must purchase an input at frequent intervals or will sell a product in a foreign currency at frequent intervals can use an average price option as an alternative to buying multiple options with different maturity dates. The average-price option will generally be both less expensive and a better hedge than purchasing multiple options.</p>
<p>In practice, the average price is computed by averaging over the prices sampled at a finite number of discrete dates. First, we consider the case of continuous sampling. With continuous sampling, the average price at date <span class="math inline">\(T\)</span> for an option written at date <span class="math inline">\(0\)</span> will be denoted by <span class="math inline">\(A_T\)</span> and is defined as <span class="math display">\[
A_T = \frac{1}{T}\int_0^T S_t\mathrm{d}   t\; .
\]</span> A sum of lognormally distributed variables is not itself lognormally distributed. Likeise, the integral above, which is essentially a continuous sum of the prices at different dates, is not lognormally distributed.</p>
<p>An alternative contract would replace the average price with the geometric average. This is defined as the exponential of the average logarithm. We denote this by <span class="math inline">\(A^g\)</span>. The average logarithm is <span class="math display">\[
\frac{1}{T}\int_0^T \log S_t\mathrm{d}   t\; ,
\]</span> and the geometric average is <span class="math display">\[
A^g_T = \exp\left(\frac{1}{T}\int_0^T \log S_t\mathrm{d}   t\right)\; .
\]</span> The concavity of the logarithm function guarantees that <span class="math display">\[
\log \frac{1}{T}\int_0^T S_t &gt; \frac{1}{T}\int_0^T \log S_t\mathrm{d}   t \; .
\]</span> Therefore, <span class="math display">\[\begin{align*}
A_T &amp;= \exp\left(\log \frac{1}{T}\int_0^T S_t\right)\\
&amp;&gt; \exp\left(\frac{1}{T}\int_0^T \log S_t\mathrm{d}   t\right) \\
&amp;= A^g_T\; .
\end{align*}\]</span> Consequently, approximating the value of an average-price or average-strike option by substituting <span class="math inline">\(A^g_T\)</span> for <span class="math inline">\(A_T\)</span> produces a biased estimate of the value. Nevertheless, the geometric average<span class="math inline">\(A^g_T\)</span> and the arithmetic average <span class="math inline">\(A_T\)</span> are highly correlated, so <span class="math inline">\(A^g_T\)</span> forms a very useful for Monte-Carlo valuation of average-price and average-strike options, as will be discussed later. To implement the idea, we need a valuation formula for options written on <span class="math inline">\(A^g_T\)</span>. We derive this for an average-price call, in which <span class="math inline">\(A^g_T\)</span> substitutes for <span class="math inline">\(A_T\)</span>.</p>
<p>Specifically, consider a contract that pays <span class="math inline">\(\max(0,A^g_T-K)\)</span> at its maturity <span class="math inline">\(T\)</span>. This is a geometric-average-price call. Let <span class="math inline">\(V_t\)</span> denote the value at date <span class="math inline">\(t\)</span> of receiving <span class="math inline">\(A^g_T\)</span> at date <span class="math inline">\(T\)</span>. This can be calculated, and the result is given below. <span class="math inline">\(V_t\)</span> is the value of a dividend-reinvested portfolio, and, by definition, <span class="math inline">\(V_T=A^g_T\)</span>, so the geometric-average-price call is equivalent to a standard call with <span class="math inline">\(V\)</span> being the price of the underlying. We will show that <span class="math inline">\(V\)</span> has a time-varying but non-random volatility. This allows us to apply the Black-Scholes formula. We could attempt the same route to price average-price options, but we would find that the volatility of the corresponding value <span class="math inline">\(V\)</span> varies randomly, making the Black-Scholes formula inapplicable.</p>
<p>The value <span class="math inline">\(V_t\)</span> can be calculated as <span class="math display">\[
V_t= \mathrm{e}^{-r(T-t)}\mathbb{E}^R_t\big[A^g_T\big]\; .
\]</span> Define <span class="math display">\[
A^g_t = \exp\left(\frac{1}{t}\int_0^t \log S_u\,du\right)\;.
\]</span></p>
<p>We will verify at the end of this section that <span id="eq-geometricaveragev1"><span class="math display">\[
V_t = \mathrm{e}^{-r(T-t)}(A^g_t)^{\frac{t}{T}}S_t^{\frac{T-t}{T}}\exp\left(\frac{(r-q-\sigma^2/2)(T-t)^2}{2T} + \frac{\sigma^2(T-t)^3}{6T^2}\right)\;.
\qquad(13.1)\]</span></span></p>
<p>Two points are noteworthy. First, the value at date <span class="math inline">\(0\)</span> is</p>
<p><span class="math display">\[
V_0 = \mathrm{e}^{-rT}S_0\exp\left(\frac{(r-q-\sigma^2/2)T}{2} + \frac{\sigma^2T}{6}\right)
\]</span> <span id="eq-asianV0"><span class="math display">\[
=\exp\left(-\frac{6r+6q + \sigma^2}{12}T\right)S_0\;.
\qquad(13.2)\]</span></span></p>
<p>Second, the volatility comes from the factor <span class="math inline">\(S_t^{(T-t)/T}\)</span>, and, by Itoâ€™s formula, <span class="math display">\[
\mathrm{d}  \log S_t^{(T-t)/T} = \text{something}\mathrm{d}    t + \left(\frac{T-t}{T}\right)\sigma\mathrm{d}   B\;.
\]</span> We can compute the average volatility in the sense of <span class="math display">\[
\sigma_{\text{avg}} = \sqrt{\frac{1}{T}\int_0^T \left(\frac{T-t}{T}\right)^2\sigma^2\mathrm{d}   t}
=\frac{\sigma}{\sqrt{3}}\;.
\]</span> and insert that into the Black-Scholes formula as <span class="math inline">\(\sigma\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This yields:</p>
<div class="callout callout-style-simple callout-Rule callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="header-section-number">13.2</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The value at date <span class="math inline">\(0\)</span> of a continuously-sampled geometric-average-price call written at date <span class="math inline">\(0\)</span> and having <span class="math inline">\(T\)</span> years to maturity is <span class="math display">\[
V_0\mathrm{N}(d_1)-\mathrm{e}^{-rT}K\mathrm{N}(d_2)\; ,
\]</span> where <span class="math display">\[
d_1 = \frac{\log\left(\frac{V_0}{K}\right)+\left(r+\frac{1}{2}\sigma_{\text{avg}}^2\right)T}{\sigma_{\text{avg}}\sqrt{T}}, \qquad d_2 = d_1 - \sigma_{\text{avg}}\sqrt{T}\; ,
\]</span> <span class="math inline">\(V_0\)</span> is defined in <a href="#eq-asianV0" class="quarto-xref">Equation&nbsp;<span>13.2</span></a>, and <span class="math inline">\(\sigma_{\text{avg}}=\sigma/\sqrt{3}\)</span>.</p>
</div>
</div>
<p>We can also value a discretely-sampled geometric-average-price call by the same arguments. Consider dates <span class="math inline">\(0&lt;t_0&lt; t_1 &lt; \cdots t_N=T\)</span>, where <span class="math inline">\(t_i-t_{i-1}=\Delta t\)</span> for each <span class="math inline">\(i\)</span> and suppose the price is to be sampled at the dates <span class="math inline">\(t_1,\ldots,t_N\)</span>. Now let <span class="math inline">\(V_t\)</span> denote the value at date <span class="math inline">\(t\)</span> of the contract that pays <span id="eq-geometricaveragev0"><span class="math display">\[
\exp\left(\frac{1}{N} \sum_{i=1}^N \log S_{t_i}\right) = \left(\prod_{i=1}^N S_{t_i}\right)^{1/N}
\qquad(13.3)\]</span></span></p>
<p>at date <span class="math inline">\(T\)</span>. The call option will pay <span class="math inline">\(\max(0,V_T-K)\)</span> at date <span class="math inline">\(T\)</span>. Let <span class="math inline">\(k\)</span> denote the integer such that <span class="math inline">\(t_{N-k-1} \leq t &lt; t_{N-k}\)</span>. This means that we have already observed the prices <span class="math inline">\(S(t_1), \ldots, S(t_{N-k-1})\)</span> and we have yet to observe the <span class="math inline">\(k+1\)</span> prices <span class="math inline">\(S(t_{N-k}), \ldots ,S(t_N)\)</span>. Define <span class="math inline">\(\varepsilon = (t_{N\!-k}-t)/\Delta t\)</span>, which is fraction of the interval <span class="math inline">\(\Delta t\)</span> that must pass before we reach the next sampling date <span class="math inline">\(t_{N\!-k}\)</span>. We will show at the end of this section that</p>
<p><span id="eq-geometricaveragev2"><span class="math display">\[
\begin{multline}
V_t = \mathrm{e}^{-r(T-t)}S_t^{\frac{k+1}{N}}\prod_{i=1}^{N-k-1}S_{t_i}^{\frac{1}{N}}\\
\times\,\exp\left(\left[ \frac{(k+1)\varepsilon\nu}{N}\!+\! \frac{k(k+1)\nu}{2N}\! +\! \frac{(k+1)^2\sigma^2\varepsilon}{2N^2}\!+\!\frac{k(k+1)(2k+1)\sigma^2}{12N^2} \right]\Delta t\right)\;,
\end{multline}
\qquad(13.4)\]</span></span></p>
<p>where <span class="math inline">\(\nu = r-q-\sigma^2/2\)</span></p>
<p>Again, two points are noteworthy. Assume the call was written at date <span class="math inline">\(0\)</span> and the first observation date <span class="math inline">\(t_1\)</span> is <span class="math inline">\(\Delta t\)</span> years away. Then, we have <span class="math inline">\(k+1=N\)</span> and <span class="math inline">\(\varepsilon=1\)</span> so <span id="eq-asianV02"><span class="math display">\[
V_0 = \mathrm{e}^{-rT}S_0\exp\left( \frac{(N+1)\nu\Delta t}{2} + \frac{(N+1)(2N+1)\sigma^2\Delta t}{12N} \right)\;.
\qquad(13.5)\]</span></span></p>
<p>Second, the volatility of <span class="math inline">\(V_t\)</span> comes from the factor <span class="math inline">\(S_t^{(k+1)/N}\)</span>, and <span class="math display">\[
\frac{ \mathrm{d}  S^{\frac{k+1}{N}}}{S^{\frac{k+1}{N}}} = \text{something}\mathrm{d}    t + \left(\frac{k+1}{N}\right)\sigma\mathrm{d}   B\;.
\]</span> This implies that the average volatility, in the sense of <span class="quarto-unresolved-ref">?sec-s:timevaryingvolatility</span>, is</p>
<p><span class="math display">\[
\sigma_{\text{avg}} = \sqrt{\frac{1}{N}\sum_{k=0}^{N-1} \left(\frac{k+1}{N}\right)^2\sigma^2\mathrm{d}   t}
\]</span> <span id="eq-asiansigmaavg"><span class="math display">\[
=\frac{\sigma}{N^{3/2}}\sqrt{\frac{N(N+1)(2N+1)}{6}}\;,
\qquad(13.6)\]</span></span></p>
<p>where we have used the fact that <span class="math inline">\(\sum_{i=1}^N i^2 = N(N+1)(2N+1)/6\)</span> to obtain the second equality. Thus, the Black-Scholes formula implies:</p>
<div class="callout callout-style-simple callout-Rule callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="header-section-number">13.3</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The value at date <span class="math inline">\(0\)</span> of a discretely-sampled geometric-average-price call written at date <span class="math inline">\(0\)</span> and having <span class="math inline">\(T\)</span> years to maturity is <span id="eq-disc_geom_avg_call"><span class="math display">\[
V_0\mathrm{N}(d_1)-\mathrm{e}^{-rT}K\mathrm{N}(d_2)\;,
\qquad(13.7)\]</span></span></p>
<p>where <span class="math display">\[
d_1 = \frac{\log\left(\frac{V_0}{K}\right)+\left(r+\frac{1}{2}\sigma_{\text{avg}}^2\right)T}{\sigma_{\text{avg}}\sqrt{T}}, \qquad d_2 = d_1 - \sigma_{\text{avg}}\sqrt{T}\; ,
\]</span> <span class="math inline">\(V_0\)</span> is defined in <a href="#eq-asianV02" class="quarto-xref">Equation&nbsp;<span>13.5</span></a>, and <span class="math inline">\(\sigma_{\text{avg}}\)</span> is defined in <a href="#eq-asiansigmaavg" class="quarto-xref">Equation&nbsp;<span>13.6</span></a>.</p>
</div>
</div>
<p>This formula will be used in <a href="Chapter_MonteCarlo.html#sec-s:controlvariates" class="quarto-xref"><span>Section 15.3</span></a> as a control variate for pricing discretely-sampled average-price calls (even average-price calls that were written before the date of valuation).</p>
<div class="callout callout-style-simple callout-Extra callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Theory Extra
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>##</p>
<p>We will now derive <a href="#eq-geometricaveragev1" class="quarto-xref">Equation&nbsp;<span>13.1</span></a> and <a href="#eq-geometricaveragev2" class="quarto-xref">Equation&nbsp;<span>13.4</span></a>. We will begin with <a href="#eq-geometricaveragev1" class="quarto-xref">Equation&nbsp;<span>13.1</span></a>. The random variable <span class="math inline">\(A^g_T\)</span> is normally distributed under the risk-neutral probability given information at time <span class="math inline">\(t\)</span>. To establish this, and to calculate the mean and variance of <span class="math inline">\(A^g_T\)</span>, the key is to change the order of integration in the integral in the second line below to obtain the third line: <span class="math display">\[\begin{align*}
\int_t^T \log S_u\,du &amp;= \int_t^T \left\{\log S_t + \left(r-q-\frac{1}{2}\sigma^2\right)(u-t) + \sigma [B(u)-B_t]\right\}\,du\\
&amp;= (T-t)\log S_t + \left(r-q-\frac{1}{2}\sigma^2\right)\frac{(T-t)^2}{2} + \sigma\int_t^T \int_t^u \mathrm{d}  B_s\,du\\
&amp;= (T-t)\log S_t + \left(r-q-\frac{1}{2}\sigma^2\right)\frac{(T-t)^2}{2} + \sigma\int_t^T \int_s^T du\mathrm{d}   B_s\\
&amp;= (T-t)\log S_t + \left(r-q-\frac{1}{2}\sigma^2\right)\frac{(T-t)^2}{2} + \sigma\int_t^T (T-s)\mathrm{d}   B_s
\end{align*}\]</span> and then to note that <span class="math inline">\(\int_t^T (T-s)\mathrm{d}   B_s\)</span> is normally distributed with mean zero and variance equal to <span class="math display">\[
\int_t^T (T-s)^2\,ds =\frac{(T-t)^3}{3}\;.
\]</span> Therefore <span class="math inline">\(\mathbb{E}^R_t\left[A^g_T\right]\)</span> is the expectation of the exponential of a normally distributed random variable. Equation~<a href="#eq-geometricaveragev1" class="quarto-xref">Equation&nbsp;<span>13.1</span></a> now follows from the fact that if <span class="math inline">\(x\)</span> is normally distributed with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span> then <span class="math inline">\(\mathbb{E}\left[\mathrm{e}^x\right] = \mathrm{e}^{\mu+\sigma^2/2}\)</span>.</p>
<p>To establish <a href="#eq-geometricaveragev2" class="quarto-xref">Equation&nbsp;<span>13.4</span></a>, note that the discounted risk-neutral expectation of <a href="#eq-geometricaveragev0" class="quarto-xref">Equation&nbsp;<span>13.3</span></a>, conditional on having observed <span class="math inline">\(S(t_1), \ldots, S(t_{N-k-1})\)</span>, is</p>
<p><span class="math display">\[
V_t = \mathrm{e}^{-r(T-t)}\mathbb{E}^R_t \left[\exp\left(\frac{1}{N} \sum_{i=1}^N \log S_{t_i}\right)\right]
\]</span> <span class="math display">\[
= \mathrm{e}^{-r(T-t)}\exp\left(\frac{1}{N}\sum_{i=1}^{N-k-1} \log S_{t_i}\right)\times \mathbb{E}^R_t \left[\exp\left(\frac{1}{N} \sum_{i=N-k}^N \log S_{t_i}\right)\right]
\]</span> <span id="eq-geometricaveragev3"><span class="math display">\[
=\left(\prod_{i=1}^{N-k-1}S_{t_i}^{\frac{1}{N}}\right)\times \mathrm{e}^{-r(T-t)}\mathbb{E}^R_t \left[\exp\left(\frac{1}{N} \sum_{i=N-k}^N \log S_{t_i}\right)\right]\;.
\qquad(13.8)\]</span></span></p>
<p>Let <span class="math inline">\(\Delta_0B = B(t_{N-k})-B_t\)</span> and <span class="math inline">\(\Delta_iB = B(t_{N\!-k+i})-B(t_{N\!-k+i-1})\)</span> for <span class="math inline">\(i \geq 1\)</span>. We can write the sum of logarithms inside the expectation above as <span class="math display">\[\begin{multline*}
\sum_{i=0}^{k}\big\{[\log S_t + (t_{N-k+i}-t)\nu + \sigma [B(t_{N-k+i})-B_t]\big\}\\
=(k+1)\log S_t + \sum_{i=0}^{k} (\varepsilon + i)\nu\Delta t + \sigma\sum_{i=0}^{k} [\Delta_0B + \Delta_1B + \cdots + \Delta_iB] \\
=(k+1)\log S_t + (k+1)\varepsilon\nu\Delta t + \frac{k(k+1)}{2}\nu\Delta t + \sigma\sum_{i=0}^{k} (k+1-i)\Delta_iB\;,
\end{multline*}\]</span> where to obtain the last equality we used the fact that <span class="math inline">\(\sum_{i=0}^k i = k(k+1)/2\)</span>. The random variables <span class="math inline">\(\Delta_iB\)</span> are normally distributed with mean zero and variance <span class="math inline">\(\Delta t\)</span> (the variance is <span class="math inline">\(\varepsilon \Delta t\)</span> for <span class="math inline">\(i=0\)</span>). Thus, the sum of logarithms is a normally distributed random variable with mean <span class="math display">\[
(k+1)\log S_t + (k+1)\varepsilon\nu\Delta t + \frac{k(k+1)}{2}\nu\Delta t
\]</span> and variance <span class="math display">\[
(k+1)^2\sigma^2\varepsilon\Delta t + \sigma^2\sum_{i=1}^{k} (k+1-i)^2\Delta t = (k+1)^2\sigma^2\varepsilon\Delta t +\frac{k(k+1)(2k+1)\sigma^2}{6}\; ,
\]</span> using the fact that <span class="math inline">\(\sum_{i=1}^k i^2 = k(k+1)(2k+1)/6\)</span>. The expectation of the exponential of a normally distributed random variable equals the exponential of its mean plus one-half of its variance, and the exponential of <span class="math inline">\((k+1)\log S_t/N\)</span> is <span class="math inline">\(S_t^{(k+1)/N}\)</span>. Therefore the conditional expectation in <a href="#eq-geometricaveragev3" class="quarto-xref">Equation&nbsp;<span>13.8</span></a> is <span class="math display">\[S_t^{\frac{k+1}{N}}\exp\left(\left[ \frac{(k+1)\varepsilon\nu}{N}+ \frac{k(k+1)\nu}{2N} + \frac{(k+1)^2\sigma^2\varepsilon}{2N^2}+\frac{k(k+1)(2k+1)\sigma^2}{12N^2} \right]\Delta t\right)\; ,
\]</span> which implies <a href="#eq-geometricaveragev2" class="quarto-xref">Equation&nbsp;<span>13.4</span></a>.</p>
</div>
</div>
</div>
<p>The following code computes the price of a geometric-average-price call.</p>
<div id="geometric_average_price_calls" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> black_scholes_call(S, K, r, sigma, q, T):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Inputs:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    S = initial stock price</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    K = strike price</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    r = risk-free rate</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    sigma = volatility</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">    q = dividend yield</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    T = time to maturity</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sigma <span class="op">&lt;=</span> <span class="dv">0</span> <span class="kw">or</span> T <span class="op">&lt;=</span> <span class="dv">0</span>:</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">max</span>(<span class="dv">0</span>, np.exp(<span class="op">-</span>q <span class="op">*</span> T) <span class="op">*</span> S <span class="op">-</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> K)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    d1 <span class="op">=</span> (np.log(S <span class="op">/</span> K) <span class="op">+</span> (r <span class="op">-</span> q <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> sigma <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> T) <span class="op">/</span> (sigma <span class="op">*</span> np.sqrt(T))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    d2 <span class="op">=</span> d1 <span class="op">-</span> sigma <span class="op">*</span> np.sqrt(T)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    N1 <span class="op">=</span> norm.cdf(d1)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    N2 <span class="op">=</span> norm.cdf(d2)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>q <span class="op">*</span> T) <span class="op">*</span> S <span class="op">*</span> N1 <span class="op">-</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> K <span class="op">*</span> N2</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> discrete_geom_average_price_call(S, K, r, sigma, q, T, N):</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> T <span class="op">/</span> N</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    nu <span class="op">=</span> r <span class="op">-</span> q <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> sigma <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> N <span class="op">*</span> (N <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> (<span class="dv">2</span> <span class="op">*</span> N <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">6</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> S <span class="op">*</span> np.exp(((N <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> nu <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> sigma <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> a <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> N <span class="op">**</span> <span class="dv">2</span>)) <span class="op">*</span> dt)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    sigavg <span class="op">=</span> sigma <span class="op">*</span> np.sqrt(a) <span class="op">/</span> (N <span class="op">**</span> <span class="fl">1.5</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> black_scholes_call(V, K, r, sigavg, q, T)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>S<span class="op">=</span><span class="dv">60</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>K<span class="op">=</span><span class="dv">50</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span><span class="fl">0.05</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>sigma<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>q<span class="op">=</span><span class="dv">0</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>N<span class="op">=</span><span class="dv">100</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Discrete Geometric Average Price Call:"</span>, discrete_geom_average_price_call(S, K, r, sigma, q, T, N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Discrete Geometric Average Price Call: 10.87461058434939</code></pre>
</div>
</div>
</section>
<section id="basket-options" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="basket-options"><span class="header-section-number">13.4</span> Basket Options</h2>
<p>A basket option is an option written on a portfolio of assets. For example, someone may want to hedge the change in the value of the dollar relative to a basket of currencies. A basket option is an alternative to purchasing separate options on each currency. Generally, the basket option would have a lower premium than the separate options, because an option on a portfolio is cheaper (and pays less at maturity) than a portfolio of options.</p>
<p>Letting <span class="math inline">\(S_1\)</span>, , <span class="math inline">\(S_n\)</span> denote the asset prices and <span class="math inline">\(w_1\)</span>, , <span class="math inline">\(w_n\)</span> the weights specified by the contract, a basket call would pay <span class="math display">\[\max\left(0,\;\sum_{i=1}^n w_iS_{iT} - K\right)\]</span> at maturity <span class="math inline">\(T\)</span>. A spread option is actually a special case of a basket option, with <span class="math inline">\(n=2\)</span>, <span class="math inline">\(w_1=1\)</span>, and <span class="math inline">\(w_2=-1\)</span>. The difficulty in valuing basket options is the same as that encountered in valuing spread options. The volatility of the basket price <span class="math inline">\(\sum_{i=1}^nw_iS_{it}\)</span> will vary over time, depending on the relative volatilities of the assets and the price changes in the assets. For example, consider the case <span class="math inline">\(n=2\)</span> and write <span class="math inline">\(S_t\)</span> for the basket price <span class="math inline">\(w_1S_{1t}+w_2S_{2t}\)</span>. Then <span class="math display">\[\begin{align*}
\frac{\mathrm{d}  S}{S} &amp;= \frac{w_1\mathrm{d}   S_1}{S} + \frac{w_2\mathrm{d}   S_2}{S}\\
&amp;=\frac{w_1S_1}{S}\times \frac{\mathrm{d}  S_1}{S_1} + \frac{w_2S_2}{S}\times \frac{\mathrm{d}  S_2}{S_2}\;.
\end{align*}\]</span> Let <span class="math inline">\(x_{it}=w_iS_{it}/S_t\)</span>. This is the fraction of the portfolio value that the <span class="math inline">\(i\)</span>â€“th asset contributes. It will vary randomly over time as the prices change. Letting <span class="math inline">\(\sigma_i\)</span> denote the volatilities of the individual assets and <span class="math inline">\(\rho\)</span> their correlation, the formula just given for <span class="math inline">\(\mathrm{d}  S/S\)</span> shows that the instantaneous volatility of the basket price at any date <span class="math inline">\(t\)</span> is <span class="math display">\[
\sqrt{x_{t}^2\sigma_1^2 + 2x_{1t}x_{2t}\rho\sigma_1\sigma_2 + x_{2t}^2S_{2t}\sigma_2^2}\; .
\]</span></p>
<p>Hence, the volatility will vary randomly over time as the <span class="math inline">\(x_i\)</span> change. There is no simple closed-form solution for the value of a basket option.</p>
</section>
<section id="spread-options" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="spread-options"><span class="header-section-number">13.5</span> Spread Options</h2>
<p>A spread option is a call or a put written on the difference of two asset prices. For example, a spread call will pay at maturity <span class="math inline">\(T\)</span> the larger of zero and <span class="math inline">\(S_{1T}-S_{2T}-K\)</span>, where the <span class="math inline">\(S_i\)</span> are the asset prices and <span class="math inline">\(K\)</span> is the strike price of the call. Spread options can be used by producers to hedge the difference between an input price and an output price. They are also useful for hedging basis risk. For example, someone may want to hedge an asset by selling a futures contract on a closely related but not identical asset. This exposes the hedger to basis risk: the difference in value between the asset and the underlying asset on the futures contract. A spread call can hedge the basis risk: take <span class="math inline">\(S_1\)</span> to be the value of the asset underlying the futures contract and <span class="math inline">\(S_2\)</span> the value of the asset being hedged.</p>
<p>A spread option is actually an exchange option. Assuming constant dividend yields <span class="math inline">\(q_1\)</span> and <span class="math inline">\(q_2\)</span>, we can take the assets underlying the exchange option to be as follows</p>
<ol type="1">
<li>At date <span class="math inline">\(0\)</span>, purchase <span class="math inline">\(\mathrm{e}^{-q_1T}\)</span> units of the asset with price <span class="math inline">\(S_1\)</span> and reinvest dividends, leading to a value of <span class="math inline">\(S_{1T}\)</span> at date <span class="math inline">\(T\)</span>,</li>
<li>At date <span class="math inline">\(0\)</span>, purchase <span class="math inline">\(\mathrm{e}^{-q_2T}\)</span> units of the asset with price <span class="math inline">\(S_2\)</span> and invest <span class="math inline">\(\mathrm{e}^{-rT}K\)</span> in the risk-free asset. Reinvesting dividends and accumulating interest means that we will have <span class="math inline">\(S_{2T}+K\)</span> dollars at date <span class="math inline">\(T\)</span>.</li>
</ol>
<p>However, we cannot apply Margrabeâ€™s formula to price spread options, because the second portfolio described above will have a stochastic volatility. To see this, note that if the price <span class="math inline">\(S_{2t}\)</span> falls to a low level, then the portfolio will consist primarily of the risk-free asset, so the portfolio volatility will be near the volatility of the risk-free asset, which is zero. On the other hand, if <span class="math inline">\(S_{2t}\)</span> becomes very high, then the portfolio will be weighted very heavily on the stock investment, and its volatility will approach the volatility of <span class="math inline">\(S_2\)</span>.</p>
</section>
<section id="exercises" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">13.6</span> Exercises</h2>
<div id="exr-asians1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.1</strong></span> Intuitively, the value of a forward-start call option should be lower the closer is the date <span class="math inline">\(T\)</span> at which the strike is set to the date <span class="math inline">\(T^*\)</span> at which the option matures, because then the option has less time to maturity after being created at <span class="math inline">\(T\)</span>. Create a Python program to confirm this. Allow the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(q\)</span>, and <span class="math inline">\(T^*\)</span>. Compute and plot the value of the option for <span class="math inline">\(T=0.1T^*\)</span>, <span class="math inline">\(T=0.2T^*\)</span>, , <span class="math inline">\(T=0.9T^*\)</span>.</p>
</div>
<div id="exr-asians2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.2</strong></span> Create a Python program to demonstrate the additional leverage of a call-on-a-call relative to a standard call. Allow the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(q\)</span>, and <span class="math inline">\(T^*\)</span>. Use the <code>Black-Scholes_Call</code> function to compute and output the value <span class="math inline">\(C\)</span> of a European call with strike <span class="math inline">\(K**=S\)</span> (i.e., the call is at the money) and maturity <span class="math inline">\(T^*\)</span>. Use the <code>Call_on_Call</code> function to compute and output the value of a call option on the call with strike <span class="math inline">\(K=C\)</span> (i.e., the call-on-a-call is at the money) and maturity <span class="math inline">\(T=0.5T^*\)</span>. Compute the percentage returns the standard European call and the call-on-a-call would experience if the stock price <span class="math inline">\(S\)</span> instantaneously increased by 10%.</p>
</div>
<div id="exr-asians3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.3</strong></span> Create a Python program to illustrate the early exercise premium for an American call on a stock paying a discrete dividend. Allow the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(T^*\)</span>. Take the date of the dividend payment to be <span class="math inline">\(T=0.5T^*\)</span> and take the strike price to be <span class="math inline">\(K=S\)</span>. The value of a European call is given by the Black-Scholes formula with <span class="math inline">\(S-\mathrm{e}^{-rT}D\)</span> being the initial asset price and <span class="math inline">\(q=0\)</span> being the constant dividend yield. Use the function <code>American_Call_Dividend</code> to compute the value of an American call for dividends <span class="math inline">\(D=.1S\)</span>, <span class="math inline">\(D=.9S\)</span>. Subtract the value of the European call with the same dividend to obtain the early exercise premium. Plot the early exercise premium against the dividend <span class="math inline">\(D\)</span>.</p>
</div>
<div id="exr-asians4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.4</strong></span> Create a Python function to value a simple chooser (a chooser option in which <span class="math inline">\(K_c=K_p\)</span> and <span class="math inline">\(T_c=T_p\)</span>) using put-call parity to compute <span class="math inline">\(S^*\)</span> as mentioned in <a href="Chapter_Exotics.html#sec-s:choosers" class="quarto-xref"><span>Section 14.6</span></a>. Verify that the function gives the same result as the function <code>Chooser</code>.</p>
</div>
<div id="exr-asians5" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.5</strong></span> Write Python code to compare the cost of a simple chooser to that of a straddle (straddle = call + put with same strike and maturity). Allow the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(q\)</span>, and <span class="math inline">\(T^*\)</span>. Take the time to maturity of the underlying call and put to be <span class="math inline">\(T^*\)</span> for both the chooser and the straddle. Take the strike prices to be <span class="math inline">\(K=S\)</span>. Take the time the choice must be made for the chooser to be <span class="math inline">\(T=0.5T^*\)</span>. Compute the cost of the chooser and the cost of the straddle.</p>
</div>
<div id="exr-asians6" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.6</strong></span> A stock has fallen in price and you are attempting to persuade a client that it is now a good buy. The client believes it may fall further before bouncing back and hence is inclined to postpone a decision. To convince the client to buy now, you offer to deliver the stock to him at the end of two months at which time he will pay you the lowest price it trades during the two months plus a fee for your costs. The stock is not expected to pay a dividend during the next two months. Assuming the stock actually satisfies the Black-Scholes assumptions, find a formula for the minimum fee that you would require. (Hint: It is almost in <a href="Chapter_Exotics.html#sec-s:lookbacks" class="quarto-xref"><span>Section 14.2</span></a>.) Create a Python program allowing the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, and <span class="math inline">\(\sigma\)</span> and computing the minimum fee.</p>
</div>
<div id="exr-e_standardknockout" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.7</strong></span> Suppose you must purchase 100 units of an asset at the end of a year. Create a Python program simulating the asset price and comparing the quality of the following hedges (assuming 100 contracts of each):</p>
<ol type="1">
<li>a standard European call,</li>
<li>a down-and-out call in which the knock-out barrier is 10% below the current price of the asset.</li>
</ol>
<p>Take both options to be at the money at the beginning of the year. Allow the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(q\)</span>. Generate 500 simulated end-of-year costs (net of the option values at maturity) for each hedging strategy and create histogram charts to visually compare the hedges. Note: to create histograms, you will need the Data Analysis add-in, which may be need to be loaded (click Tools/Add Ins).</p>
</div>
<div id="exr-e_standardknockout2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.8</strong></span> Compute the prices of the options in the previous exercise. Modify the simulations to compare the end-of-year costs including the costs of the options, adding interest on the option prices to put everything on an end-of-year basis.</p>
</div>
<div id="exr-e_standardknockout3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.9</strong></span> Modify <a href="Chapter_Exotics.html#exr-e_standardknockout" class="quarto-xref">Exercise&nbsp;<span>14.7</span></a> by including a third hedge: a combination of a down-and-out call as in part (b) of <a href="Chapter_Exotics.html#exr-e_standardknockout" class="quarto-xref">Exercise&nbsp;<span>14.7</span></a> and a down-and-in call with knockout barrier and strike 10% below the current price of the asset. Note that this combination forms a call option with strike that is reset when the underlying asset price hits a barrier.</p>
</div>
<div id="exr-e_standardknockout4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.10</strong></span> Modify <a href="Chapter_Exotics.html#exr-e_standardknockout2" class="quarto-xref">Exercise&nbsp;<span>14.8</span></a> by including the hedge in <a href="Chapter_Exotics.html#exr-e_standardknockout3" class="quarto-xref">Exercise&nbsp;<span>14.9</span></a>. Value the down-and-in call using the function <code>Down_And_Out_Call</code> and the fact that a down-and-out and down-and-in with the same strikes and barriers form a standard option.</p>
</div>
<div id="exr-e_averagehedge" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.11</strong></span> Each week you purchase 100 units of an asset, and you want to hedge your total quarterly (13-week) cost. Create a Python program simulating the asset price and comparing the quality of the following hedges:</p>
<ol type="1">
<li>a standard European call maturing at the end of the quarter (<span class="math inline">\(T=0.25\)</span>) on 1300 units of the asset,</li>
<li>13 call options maturing at the end of each week of the quarter, each written on 100 units of the asset, and</li>
<li>a discretely sampled average-price call with maturity <span class="math inline">\(T=0.25\)</span> written on 1300 units of the asset, where the sampling is at the end of each week.<br>
</li>
<li>a discretely sampled geometric-average-price call with maturity <span class="math inline">\(T=0.25\)</span> written on 1300 units of the asset, where the sampling is at the end of each week.</li>
</ol>
<p>Allow the user to input <span class="math inline">\(S\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(q\)</span>. Assume all of the options are at the money at the beginning of the quarter (<span class="math inline">\(K=S\)</span>). Compare the hedges as in <a href="Chapter_Exotics.html#exr-e_standardknockout" class="quarto-xref">Exercise&nbsp;<span>14.7</span></a>.</p>
</div>
<div id="exr-e_averagehedge2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.12</strong></span> In the setting of the previous problem, compute the prices of the options in parts (a), (b) and (d). Modify the simulations in the previous problem to compare the end-of-quarter costs including the costs of the options (adding interest on the option prices to put everything on an end-of-quarter basis).</p>
</div>
<div id="exr-asians13" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.13</strong></span> Using the put-call parity relation, derive a formula for the value of a forward-start put.</p>
</div>
<div id="exr-asians14" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.14</strong></span> Derive <a href="Chapter_Exotics.html#eq-callonaput" class="quarto-xref">Equation&nbsp;<span>14.19</span></a> for the value of a call on a put.</p>
</div>
<div id="exr-asians15" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.15</strong></span> Complete the derivation of <a href="Chapter_Exotics.html#eq-chooser2" class="quarto-xref">Equation&nbsp;<span>14.34</span></a> for the value of a chooser option.</p>
</div>
<div id="exr-asians16" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.16</strong></span> Derive a formula for the value of a put option on the maximum of two risky asset prices.</p>
</div>
<div id="exr-asians17" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 13.17</strong></span> Using the result of the preceding exercise and Margrabeâ€™s formula, verify that calls and puts (having the same strike <span class="math inline">\(K\)</span> and maturity <span class="math inline">\(T\)</span>) on the maximum of two risky asset prices satisfy the following put-call parity relation: <span class="math display">\[\begin{multline*}
\mathrm{e}^{-rT}K + \text{Value of call on max} \\
= \mathrm{e}^{-q_2T}S_{20} + \text{Value of option to exchange asset 2 for asset 1} \\+ \text{Value of put on max}\;.
\end{multline*}\]</span></p>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We assumed a constant volatility when deriving the Black-Scholes formula, but it is easy to check that the same logic works when the volatility is non-randomly time-varying if we substitute this average volatility.<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter_Merton.html" class="pagination-link" aria-label="Merton, Black, and Margrabe">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Merton, Black, and Margrabe</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter_Exotics.html" class="pagination-link" aria-label="Other Exotics">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Other Exotics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/math-finance-book/book-published-code.git/blob/main/Chapter_Asians.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>