<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Finance Book - 12&nbsp; Introduction to Fixed Income Derivatives</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter13.html" rel="next">
<link href="./Chapter11.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Finance Book</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Asset Pricing Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Continuous-Time Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Black-Scholes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimating and Modelling Volatility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo and Binomial Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Foreign Exchange</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Forward, Futures, and Exchange Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exotic Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Monte Carlo and Binomial Valuation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finite Difference Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter14.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Brief Survey of Term Structure Models</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#caps-and-floors" id="toc-caps-and-floors" class="nav-link active" data-scroll-target="#caps-and-floors"><span class="toc-section-number">13</span>  Caps and Floors</a></li>
  <li><a href="#s_forwardrates" id="toc-s_forwardrates" class="nav-link" data-scroll-target="#s_forwardrates"><span class="toc-section-number">14</span>  Forward Rates</a></li>
  <li><a href="#s_portfoliosspotrates" id="toc-s_portfoliosspotrates" class="nav-link" data-scroll-target="#s_portfoliosspotrates"><span class="toc-section-number">15</span>  Portfolios that Pay Spot Rates</a></li>
  <li><a href="#s_valuingcaps" id="toc-s_valuingcaps" class="nav-link" data-scroll-target="#s_valuingcaps"><span class="toc-section-number">16</span>  The Market Model for Caps and Floors</a></li>
  <li><a href="#s_swaptions" id="toc-s_swaptions" class="nav-link" data-scroll-target="#s_swaptions"><span class="toc-section-number">17</span>  The Market Model for European Swaptions</a></li>
  <li><a href="#s_consistency" id="toc-s_consistency" class="nav-link" data-scroll-target="#s_consistency"><span class="toc-section-number">18</span>  A Comment on Consistency</a></li>
  <li><a href="#s_caps2" id="toc-s_caps2" class="nav-link" data-scroll-target="#s_caps2"><span class="toc-section-number">19</span>  Caplets as Puts on Discount Bonds</a></li>
  <li><a href="#s_swaptionscouponbondoptions" id="toc-s_swaptionscouponbondoptions" class="nav-link" data-scroll-target="#s_swaptionscouponbondoptions"><span class="toc-section-number">20</span>  Swaptions as Options on Coupon Bonds</a></li>
  <li><a href="#s_fixedincomederivatives_matlab" id="toc-s_fixedincomederivatives_matlab" class="nav-link" data-scroll-target="#s_fixedincomederivatives_matlab"><span class="toc-section-number">21</span>  Calculations in VBA</a>
  <ul class="collapse">
  <li><a href="#valuing-caps-with-blacks-formula" id="toc-valuing-caps-with-blacks-formula" class="nav-link" data-scroll-target="#valuing-caps-with-blacks-formula">Valuing Caps with Black’s Formula</a></li>
  <li><a href="#valuing-swaptions-with-margrabes-formula" id="toc-valuing-swaptions-with-margrabes-formula" class="nav-link" data-scroll-target="#valuing-swaptions-with-margrabes-formula">Valuing Swaptions with Margrabe’s Formula</a></li>
  </ul></li>
  <li><a href="#problems" id="toc-problems" class="nav-link" data-scroll-target="#problems">Problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-c_fixedincomederivatives" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Fixed Income Derivatives</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>In this chapter, we will introduce some fundamental fixed-income derivatives (caps, floors and swaptions) and explain the “market model” approach to valuation. We will also explain the relation between caps, floors and swaptions on the one hand and discount and coupon bond options on the other. This leads to other approaches for valuing caps, floors and swaptions, which will be developed in the following chapters.</p>
<section id="caps-and-floors" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Caps and Floors</h1>
<p>Caps and floors have a structure very similar to that of swaps, as described in Sect. <a href="Chapter11.html#s_swaps" data-reference-type="ref" data-reference="s_swaps">[s_swaps]</a>. At each reset date <span class="math inline">\(t_i\)</span>, the simple interest rate <span class="math inline">\(\mathcal{R}_i\)</span> for period <span class="math inline">\(\varDelta t\)</span> is observed. This rate determines a payment at the following date <span class="math inline">\(t_{i+1}\)</span>. As discussed in the preceding chapter, the cash flow to the payer in a swap is <span class="math inline">\((\mathcal{R}_i - \bar{\mathcal{R}})\,\varDelta t\)</span> and the cash flow to the receiver is <span class="math inline">\((\bar{\mathcal{R}}-\mathcal{R}_i)\,\varDelta t\)</span>, for each $1 of notional principal. A swap is really a series of forward contracts, in which both parties have obligations. On the other hand, caps and floors are series of options. A premium is paid up-front by the buyer of a cap or floor to the seller and all future cash flows are paid by the seller to the buyer. The owner of a cap with cap rate <span class="math inline">\(\bar{\mathcal{R}}\)</span> receives <span class="math inline">\(\max(0,\mathcal{R}_i-\bar{\mathcal{R}})\varDelta t\)</span> at date <span class="math inline">\(t_{i+1}\)</span> for each $1 of notional principal, and the owner of a floor receives <span class="math inline">\(\max(0,\bar{\mathcal{R}}-\mathcal{R}_i)\varDelta t\)</span> at date <span class="math inline">\(t_{i+1}\)</span> for each $1 of notional principal.</p>
<p>Caps and floors are used in conjunction with hedging floating rate obligations or for speculative purposes. Portfolios of caps and floors have properties analogous to option portfolios. For example, the combination of a long cap and a short floor at the same rate <span class="math inline">\(\bar{\mathcal{R}}\)</span> creates the payer side of a swap, in the same way that a long call and short put create a synthetic long forward (and a short cap and a long floor at the same rate <span class="math inline">\(\bar{\mathcal{R}}\)</span> creates the receiver side of a swap just as a short call and long put create a synthetic short forward contract). A long cap at rate <span class="math inline">\(\bar{\mathcal{R}}_c\)</span> and a short floor at rate <span class="math inline">\(\bar{\mathcal{R}}_f &lt; \bar{\mathcal{R}}_c\)</span> creates a collar (for an underlying floating rate obligation), etc.</p>
<p>The individual payments on a cap are called “caplets,” and a cap is simply a portfolio of caplets. Similarly, the individual payments on a floor are called “floorlets,” and the values of caplets and floorlets are linked by put-call parity, as we will see below.</p>
<p>A caplet can be viewed as a call option on the spot rate with strike equal to the fixed rate. Thus, it is a “bet” on higher interest rates. Because interest rates and bond prices are inversely related, it can also be viewed as a bet on lower bond prices. In this regard, it is similar to a put option on bond prices. In fact, we will see in Sect. <a href="#s_caps2" data-reference-type="ref" data-reference="s_caps2">[s_caps2]</a> that a caplet is exactly equivalent to a put option on a discount bond. Likewise, a floorlet can be viewed either as a put option on the spot rate or a call option on a discount bond.</p>
</section>
<section id="s_forwardrates" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Forward Rates</h1>
<p>Suppose we wish to borrow money at date <span class="math inline">\(u\)</span> for a period of <span class="math inline">\(\varDelta t\)</span> years, and we want to lock in the rate on the loan at date <span class="math inline">\(t&lt;u\)</span>. To do this, we can buy the discount bond maturing at <span class="math inline">\(u\)</span> and finance the purchase by shorting <span class="math inline">\(P(t,u)/P(t,u+\varDelta t)\)</span> units of the bond maturing at <span class="math inline">\(u+\varDelta t\)</span>. This generates a cash flow of $1 at date <span class="math inline">\(u\)</span> and <span class="math inline">\(-P(t,u)/P(t,u+\varDelta t)\)</span> dollars at date <span class="math inline">\(u+\varDelta t\)</span>. This implies a simple interest rate of <span class="math inline">\(\mathcal{R}\)</span> defined as <span class="math display">\[\begin{equation}\label{forward1}
\frac{P(t,u)}{P(t,u+\varDelta t)} = 1+\mathcal{R}\,\varDelta t\;.
\end{equation}\]</span> This rate is called a “forward rate.” </p>
<p>Forward rates will be important for loans at the reset dates maturing at the subsequent payment dates. We will denote the forward rate at date <span class="math inline">\(t \leq t_i\)</span> for a loan between <span class="math inline">\(t_i\)</span> and <span class="math inline">\(t_{i+1}\)</span> as <span class="math inline">\(\mathcal{R}_i(t)\)</span>. This rate is defined in accord with <a href="#forward1" data-reference-type="eqref" data-reference="forward1">[forward1]</a>, substituting the date <span class="math inline">\(t_i\)</span> for date <span class="math inline">\(u\)</span>; i.e., <span class="math display">\[\begin{equation}\label{forward2}
\frac{P(t,t_i)}{P(t,t_{i+1})}=1+\mathcal{R}_i(t)\,\varDelta t\;.
\end{equation}\]</span> Note that when <span class="math inline">\(t=t_i\)</span>, <span class="math inline">\(P(t,t_i)=1\)</span>, so <span class="math inline">\(\mathcal{R}_i(t_i)=\mathcal{R}_i\)</span> defined in <a href="#spot2" data-reference-type="eqref" data-reference="spot2">[spot2]</a>—i.e., the forward rate equals the spot rate at <span class="math inline">\(t_i\)</span>.</p>
</section>
<section id="s_portfoliosspotrates" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Portfolios that Pay Spot Rates</h1>
<p>One way to value caps and floors is to view them as portfolios of options on rates, as we will see later. In order to apply the option pricing formulas derived earlier, we need to know that each rate is the value of some asset, so the option can be viewed as an option on an asset. This is very straightforward.</p>
<p>To obtain the spot rate <span class="math inline">\(\mathcal{R}_i\)</span> at date <span class="math inline">\(t_{i+1}\)</span>, one needs $1 to invest at date <span class="math inline">\(t_i\)</span>. This can be arranged at date <span class="math inline">\(t&lt;t_i\)</span> by buying one unit of the bond maturing at <span class="math inline">\(t_i\)</span>. Investing the dollar paid by the bond at the spot rate at <span class="math inline">\(t_i\)</span> will generate <span class="math inline">\(1+\mathcal{R}_i\,\varDelta t\)</span> dollars at date <span class="math inline">\(t_{i+1}\)</span>. The “extra” dollar can be eliminated by being short one unit of the bond maturing at <span class="math inline">\(t_{i+1}\)</span>, leaving <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> dollars. Thus, the portfolio that pays the spot rate multiplied by the period length <span class="math inline">\(\varDelta t\)</span> consists of being long one unit of the bond maturing at <span class="math inline">\(t_i\)</span> and short one unit of the bond maturing at <span class="math inline">\(t_{i+1}\)</span>. This implies that the value at date <span class="math inline">\(t&lt;t_i\)</span> of receiving <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> dollars at date <span class="math inline">\(t_{i+1}\)</span> is <span class="math inline">\(P(t,t_i)-P(t,t_{i+1})\)</span>.</p>
<p>At date <span class="math inline">\(t_i\)</span> the spot rate <span class="math inline">\(\mathcal{R}_i\)</span> becomes known. Between <span class="math inline">\(t_i\)</span> and <span class="math inline">\(t_{i+1}\)</span>, the value of receiving <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> dollars at date <span class="math inline">\(t_{i+1}\)</span> is the present value of this known cash flow, which is <span class="math inline">\(\mathcal{R}_i\,\varDelta t\,P(t, t_{i+1})\)</span>. To summarize, the value of receiving <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> dollars at date <span class="math inline">\(t_{i+1}\)</span> is <span class="math display">\[\begin{equation}\label{S_i}
S_i(t) = \begin{cases} P(t,t_i)-P(t,t_{i+1}) &amp; \text{if } t &lt; t_{i}\; ,\\
\mathcal{R}_i\,\varDelta t\, P(t,t_{i+1}) &amp; \text{if }  t_{i} \leq t \leq t_{i+1}\;. \end{cases}
\end{equation}\]</span></p>
<p>Actually, we will view a caplet as an option on a forward contract and apply Black’s formula. To do this, we need to know the forward price of the asset with price <span class="math inline">\(S_i(t)\)</span> for a contract maturing at <span class="math inline">\(t_{i+1}\)</span>. We denote this forward price by <span class="math inline">\(F_i(t)\)</span>. The synthetic forward argument presented in Sect. <a href="Chapter7.html#s_merton" data-reference-type="ref" data-reference="s_merton">[s_merton]</a> shows that for any non-dividend paying asset with price <span class="math inline">\(S\)</span>, the forward price for a contract maturing at <span class="math inline">\(T\)</span> is <span class="math inline">\(S(t)/P(t,T)\)</span>. So, <span class="math inline">\(F_i\)</span> is given by <span class="math display">\[\begin{align}
F_i(t) &amp;= \begin{cases} \frac{P(t,t_i)}{P(t,t_{i+1})}-1 &amp; \text{if } t &lt; t_{i}\; ,\\
\mathcal{R}_i\,\varDelta t &amp; \text{if }  t_{i} \leq t \leq t_{i+1}\;. \end{cases}\notag\\
&amp;= \begin{cases}\mathcal{R}_i(t)\,\varDelta t &amp; \text{if } t &lt; t_{i}\; ,\\
\mathcal{R}_i\,\varDelta t &amp; \text{if }  t_{i} \leq t \leq t_{i+1}\;, \end{cases}\label{F_i}
\end{align}\]</span> where <span class="math inline">\(\mathcal{R}_i(t)\)</span> is the forward rate defined in <a href="#forward2" data-reference-type="eqref" data-reference="forward2">[forward2]</a>. Thus, the asset with price <span class="math inline">\(S_i(t)\)</span> pays the spot rate at date <span class="math inline">\(t_i\)</span> times the period length at date <span class="math inline">\(t_{i+1}\)</span>, and the forward price of this asset is the forward rate times the period length.</p>
</section>
<section id="s_valuingcaps" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> The Market Model for Caps and Floors</h1>
<p>The valuation we will describe here is standard market practice for valuing caps and floors or at least for quoting the prices of caps and floors. Specifically, it is standard to quote prices in terms of implied volatilities, where the volatility is to be input into Black’s formula for options on forwards. This model is sometimes called the “market model.” We can apply Black’s formula to the forward contract with price <span class="math inline">\(F_i\)</span> described in the previous section. We view the caplet as a call option maturing at <span class="math inline">\(t_i\)</span> on this forward contract that matures at <span class="math inline">\(t_{i+1}\)</span>. As explained in Chapter <a href="#c_forwardexchange" data-reference-type="ref" data-reference="c_forwardexchange">[c_forwardexchange]</a>, the value at the maturity date <span class="math inline">\(T\)</span> of a call option with strike <span class="math inline">\(K\)</span> on a forward contract with price <span class="math inline">\(F\)</span> maturing at <span class="math inline">\(T' \geq T\)</span> is <span class="math inline">\(\max(0,F(T)-K)P(T,T')\)</span>. Therefore, the value at maturity of a call option maturing at <span class="math inline">\(t_i\)</span> with strike <span class="math inline">\(\bar{\mathcal{R}}\,\varDelta t\)</span> on the forward contract with price <span class="math inline">\(F_i\)</span> is <span class="math display">\[\max(0,F_i(t_i)-\bar{\mathcal{R}}\,\varDelta t)P(t_i,t_{i+1})\; .\]</span> Since <span class="math inline">\(F_i(t_i)=\mathcal{R}_i\,\varDelta t\)</span>, this equals <span class="math display">\[\begin{equation}\label{capletvalue}
\max(0,\mathcal{R}_i-\bar{\mathcal{R}})\,\varDelta t\,P(t_i,t_{i+1})\;.
\end{equation}\]</span> This is also the value of the caplet at date <span class="math inline">\(t_i\)</span>.</p>
<p>It follows that the value of the caplet at any date <span class="math inline">\(t\leq t_i\)</span> is the value of the call option on the forward contract. To apply Black’s formula, we need the forward price to have a constant (or at least non-randomly varying) volatility. As noted earlier, at dates <span class="math inline">\(t\leq t_i\)</span>, <span class="math inline">\(F_i(t)=\mathcal{R}_i(t)\,\varDelta t\)</span>, where <span class="math inline">\(\mathcal{R}_i(t)\)</span> is the forward rate, so the volatility of the forward price is the volatility of the forward rate. Black’s formula yields:</p>
<p>The put-call parity relationship for caplets and floorlets can be seen as follows. If we add <span class="math inline">\(\bar{\mathcal{R}}\varDelta t\)</span> to the caplet payment, we obtain <span class="math display">\[\bar{\mathcal{R}}\,\varDelta t +  \max(0,\mathcal{R}_i-\bar{\mathcal{R}})\,\varDelta t = \max( \bar{\mathcal{R}}, \mathcal{R}_i)\,\varDelta t\; .\]</span> On the other hand, if we add <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> to the floorlet payment, we obtain the same thing: <span class="math display">\[\mathcal{R}_i\,\varDelta t + \max(0,\bar{\mathcal{R}}-\mathcal{R}_i)\,\varDelta t = \max( \mathcal{R}_i,\bar{\mathcal{R}} )\,\varDelta t\; .\]</span> Hence, the value of a caplet plus the value of receiving <span class="math inline">\(\bar{\mathcal{R}}\,\varDelta t\)</span> at date <span class="math inline">\(t_{i+1}\)</span> must equal the value of a floorlet plus the value of receiving <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> at date <span class="math inline">\(t_{i+1}\)</span>. The value at any date <span class="math inline">\(t\leq t_i\)</span> of receiving <span class="math inline">\(\bar{\mathcal{R}}\,\varDelta t\)</span> at date <span class="math inline">\(t_{i+1}\)</span> is the value of <span class="math inline">\(\bar{\mathcal{R}}\,\varDelta t\)</span> discount bonds maturing at date <span class="math inline">\(t_{i+1}\)</span>, which we are denoting by <span class="math inline">\(\bar{\mathcal{R}}\,\varDelta t P(t,t_{i+1})\)</span>. The value at at any date <span class="math inline">\(t\leq t_i\)</span> of obtaining <span class="math inline">\(\mathcal{R}_i\,\varDelta t\)</span> dollars at date <span class="math inline">\(t_{i+1}\)</span> is<br>
<span class="math inline">\(S_i(t) =P(t,t_i)-P(t,t_{i+1})\)</span>. We conclude that <span class="math display">\[\text{ Value of Caplet} \;+ \;\bar{\mathcal{R}}\,\varDelta t P(t,t_{i+1}) = \text{Value of Floorlet} \;+\; P(t,t_i)-P(t,t_{i+1})\; .\]</span></p>
</section>
<section id="s_swaptions" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> The Market Model for European Swaptions</h1>
<p>The owner of a European swaption has an option to enter into a swap at the maturity date of the swaption. A payer swaption gives the owner of the option the right to enter into a swap as a fixed-rate payer, for a given swap rate (not necessarily a rate that makes the swap have zero value at any date). The owner of a receiver swaption has the right to enter into the swap as a fixed-rate receiver. The values of payer swaptions and receiver swaptions are linked by put-call parity.</p>
<p>A payer swaption has similarities to a cap. The owner of a cap has the right to receive the floating rate and pay the fixed rate and will do so in each period in which the floating rate is higher. Similarly, the owner of a payer swaption has the right to receive floating and pay fixed. However, the owner of a cap chooses each period whether to exercise his option, whereas the owner of a swaption makes a once-and-for-all decision whether to exercise, at the maturity of the swaption. A cap is therefore a portfolio of options, whereas a swaption is an option on a portfolio. In general of course, other things being equal, a portfolio of options is worth more than an option on a portfolio.</p>
<p>Consider a payer swaption with maturity date <span class="math inline">\(T\)</span> and swap rate <span class="math inline">\(\bar{\mathcal{R}}\)</span>, where the underlying swap has payment dates <span class="math inline">\(t_1,\ldots,t_N\)</span> with the first reset date of the swap being <span class="math inline">\(t_0 = t_1-\varDelta t \geq T\)</span>. We assume the notional principal of the swap is $1. Expression <a href="#swapvalue100" data-reference-type="eqref" data-reference="swapvalue100">[swapvalue100]</a> in Sect. <a href="Chapter11.html#s_swaps" data-reference-type="ref" data-reference="s_swaps">[s_swaps]</a> gives the value at date <span class="math inline">\(T\)</span> to the payer in the swap as <span class="math display">\[S(T)-Z(T)\; ,\]</span> where we define <span class="math display">\[\begin{align}
S(t)&amp;=P(t,t_0)- P(t,t_N)\; ,\\
Z(t) &amp;=  \bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(t,t_i)\;.\label{fixedrateside}
\end{align}\]</span> As explained in Sect.~<span class="math inline">\(\ref{s_swaps}\)</span>, <span class="math inline">\(S(t)\)</span> is the value of the floating-rate payments in the swap and <span class="math inline">\(Z(t)\)</span> is the value of the fixed-rate payments. The value of a payer swaption at its maturity~<span class="math inline">\(T\)</span> is therefore <span class="math display">\[\max(0,S(T)-Z(T))\; .\]</span></p>
<p>We can value the swaption using Margrabe’s formula for exchange options provided the ratio of prices <span class="math inline">\(S/Z\)</span> has a constant (or non-randomly varying) volatility. The volatility of the ratio is the same as the volatility of the forward swap rate. To see this, recall that in Sect.~<span class="math inline">\(\ref{s_swaps}\)</span> the forward swap rate <span class="math inline">\(\mathcal{R}(t)\)</span> was defined to be the rate such that <span class="math display">\[P(t,t_0)- P(t,t_N) = \mathcal{R}(t)\,\varDelta t \sum_{i=1}^N P(t,t_i)\; ,\]</span> which means that the swap would have zero value if initiated at date <span class="math inline">\(t\)</span> at the rate <span class="math inline">\(\mathcal{R}(t)\)</span>—cf.&nbsp;equation~<span class="math inline">\(\eqref{swaprate1}\)</span>. Thus, <span class="math display">\[\begin{equation*}
\frac{S(t)}{Z(t)} = \frac{P(t,t_0)- P(t,t_N)}{\bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(t,t_i)} = \frac{\mathcal{R}(t)\,\varDelta t \sum_{i=1}^N P(t,t_i)}{\bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(t,t_i)} = \frac{\mathcal{R}(t)}{\bar{\mathcal{R}}}\;,
\end{equation*}\]</span> where <span class="math inline">\(\mathcal{R}(t)\)</span> is the forward swap rate.<br>
Margrabe’s formula implies:</p>
<p>Put-call parity for swaptions is as follows: fixed-rate cash flows plus the option to exchange for floating is equivalent to floating-rate cash flows plus the option to exchange for fixed. In each side of this equivalence, one obtains, at the option maturity, the larger of the values of the fixed and floating-rate legs. More formally, <span class="math display">\[\begin{multline*} \bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(T,t_i) + \max\left(0, \,P(T,t_0)- P(T,t_N)-  \bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(T,t_i)\right) \\= P(T,t_0)- P(T,t_N) + \max\left(0,\,  \bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(T,t_i)-P(T,t_0)+ P(T,t_N)\right).
\end{multline*}\]</span> Therefore, at any date <span class="math inline">\(t \leq T\)</span>, <span class="math display">\[\begin{multline}\label{swaptionparity}
\bar{\mathcal{R}}\,\varDelta t \sum_{i=1}^N P(t,t_i)\; + \;\text{Value of Payer Swaption}\\ =
P(t,t_0)- P(t,t_N) \;+ \;\text{Value of Receiver Swaption}.
\end{multline}\]</span></p>
</section>
<section id="s_consistency" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> A Comment on Consistency</h1>
<p>It is well known that it is inconsistent to assume both that the forward rates <span class="math inline">\(\mathcal{R}_i(t)\)</span> and the forward swap rate <span class="math inline">\(\mathcal{R}(t)\)</span> have constant volatilities. We can obtain some intuition for this as follows. Recall that <span class="math display">\[\mathcal{R}_i(t)\,\varDelta t = \frac{P(t,t_i)-P(t,t_{i+1})}{P(t,t_{i+1})}\; ,\]</span> and <span class="math display">\[\mathcal{R}(t)\,\varDelta t = \frac{P(t,t_0)-P(t,t_N)}{\sum_{i=0}^{N-1} P(t,t_{i+1})}\; .\]</span> The numerator in the last equation is the sum (over <span class="math inline">\(i=0,\dots,N\!-\!1\)</span>) of the numerators in the previous equation; hence, it is the sum of the <span class="math inline">\(\mathcal{R}_i(t)\,\varDelta t\,P(t,t_{i+1})\)</span>. This implies that <span class="math display">\[\mathcal{R}(t) = \frac{\sum_{i=0}^{N-1} P(t,t_{i+1})\mathcal{R}_i(t)}{\sum_{i=1}^{N-1}P(t,t_{i+1})}\; ,\]</span> which we can write as <span class="math display">\[\mathcal{R}(t) = \sum_{i=0}^{N-1} w_i(t) \mathcal{R}_i(t)\; ,\]</span> where the weights <span class="math inline">\(w_i(t)\)</span> are defined as <span class="math display">\[w_i(t) = \frac{P(t,t_{i+1})}{\sum_{i=0}^{N-1}P(t,t_{i+1})}\; .\]</span> Therefore, the forward swap rate is a weighted average of the forward rates. A sum (or average) of lognormal variables is not lognormal, so if the forward rate has a constant volatility, then the forward swap rate will not (and vice versa), absent very peculiar assumptions about the weights <span class="math inline">\(w_i(t)\)</span>. This means that one should not really simultaneously use Black’s formula for valuing caps (or floors) and Margrabe’s formula for valuing swaptions (though there is evidence that the error introduced by doing so may be small). In the following chapters, we will consider other models that do not suffer from this type of inconsistency.</p>
</section>
<section id="s_caps2" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Caplets as Puts on Discount Bonds</h1>
<p>Previously, we considered a caplet as a call option on the forward rate and thus a “bet” on higher interest rates. This is equivalent to a bet on lower bond prices, and we will now show that a caplet with payment date <span class="math inline">\(t_{i+1}\)</span> is equivalent to <span class="math inline">\(1+\bar{\mathcal{R}}\,\varDelta t\)</span> put options on the <span class="math inline">\(t_{i+1}\)</span>–maturity discount bond. The put options mature at the reset date <span class="math inline">\(t_i\)</span> of the caplet and have strike equal to <span class="math inline">\(1/(1+ \bar{\mathcal{R}}\,\varDelta t)\)</span>. To see this equivalence, note that the value of <span class="math inline">\(1+\bar{\mathcal{R}}\,\varDelta t\)</span> such options at their maturity date <span class="math inline">\(t_i\)</span> is <span class="math display">\[\begin{multline*}
\big[1+\bar{\mathcal{R}}\,\varDelta t\big] \max\left(0,\frac{1}{1+ \bar{\mathcal{R}}\,\varDelta t}-P(t_i,t_{i+1})\right) \\ \begin{array}{l}
= \max\big(0,\,1-\big[1+\bar{\mathcal{R}}\,\varDelta t\big]P(t_i,t_{i+1})\big)\\
=P(t_i,t_{i+1})\max\left(0,\frac{1}{P(t_i,t_{i+1})}-1-\bar{\mathcal{R}}\,\varDelta t\right)\;. \end{array}
\end{multline*}\]</span> Given that <span class="math inline">\(1/P(t_i,t_{i+1}) = 1+\mathcal{R}_i\,\varDelta t\)</span>, this equals <span class="math display">\[P(t_i,t_{i+1}) \max(0,\mathcal{R}_i-\bar{\mathcal{R}})\,\varDelta t\; .\]</span> This is the value at date <span class="math inline">\(t_i\)</span> of the caplet with payment date <span class="math inline">\(t_{i+1}\)</span> shown in expression <a href="#capletvalue" data-reference-type="eqref" data-reference="capletvalue">[capletvalue]</a>. It follows that the caplet and the <span class="math inline">\(1+\bar{\mathcal{R}}\,\varDelta t\)</span> put options must have the same value at any date prior to <span class="math inline">\(t_i\)</span>.</p>
<p>Similarly, a floorlet with payment date <span class="math inline">\(t_{i+1}\)</span> is equivalent to <span class="math inline">\(1+\bar{\mathcal{R}}\,\varDelta t\)</span> call options on the <span class="math inline">\(t_{i+1}\)</span>–maturity discount bond, with the call options maturing at date <span class="math inline">\(t_i\)</span> and having strike equal to <span class="math inline">\(1/(1+ \bar{\mathcal{R}}\,\varDelta t)\)</span>.<br>
In the following chapters, we will describe models for valuing bond options. These models will also be applied to price caps, as portfolios of put options on discount bonds, and to price floors, as portfolios of calls. </p>
</section>
<section id="s_swaptionscouponbondoptions" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Swaptions as Options on Coupon Bonds</h1>
<p>As noted previously, the value at date <span class="math inline">\(T\)</span> of the payer swaption, if exercised, is <span class="math display">\[P(T,t_0)-P(T,t_N) - \bar{\mathcal{R}}\,\varDelta t\sum_{i=1}^N P(T,t_i)\; .\]</span> In Sect.~<span class="math inline">\(\ref{s_swaptions}\)</span>, we considered this as the difference of two pieces, the first piece being <span class="math inline">\(S(T) = P(T,t_0)-P(T,t_N)\)</span>, which is the value of the floating-rate leg, and the second being <span class="math inline">\(Z(T) = \bar{\mathcal{R}}\,\varDelta t\sum_{i=1}^N P(T,t_i)\)</span>, the value of the fixed-rate leg. We can also separate it differently—the first part being <span class="math inline">\(P(T,t_0)\)</span>, which is the value at the swaption maturity of the discount bond maturing at <span class="math inline">\(t_0\)</span>, and the second part being <span class="math inline">\(P(T,t_N)+\bar{\mathcal{R}}\,\varDelta t\sum_{i=1}^N P(T,t_i)\)</span>, which is the value of a fixed-rate bond including the face value at maturity. Thus, a payer swaption is equivalent to an option to exchange a fixed-rate coupon bond for a discount bond. A receiver swaption is an option to engage in the reverse exchange.</p>
<p>Typically, <span class="math inline">\(t_0=T\)</span> (the swap starts at the swaption maturity), in which case <span class="math inline">\(P(T,t_0)=1\)</span> and the payer (receiver) swaption is a standard put (call) option on the coupon bond, with exercise price equal to 1. The models developed in later chapters for valuing options on coupon bonds can therefore also be applied to value swaptions.</p>
</section>
<section id="s_fixedincomederivatives_matlab" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Calculations in VBA</h1>
<section id="valuing-caps-with-blacks-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="valuing-caps-with-blacks-formula">Valuing Caps with Black’s Formula</h2>
<p>We will compute the value of each caplet with the <code>Black_Call</code> function. In the <code>Black_Call</code> function, we input the forward price for the caplet with reset date <span class="math inline">\(t_i\)</span> as <span class="math display">\[\begin{equation}\label{capletforwardprice}
F_i(0) = \mathcal{R}_i(0)\,\varDelta t = \frac{P(0,t_i)}{P(0,t_{i+1})} - 1\;,
\end{equation}\]</span> as given in equations <span class="math inline">\(\eqref{forward2}\)</span> and <span class="math inline">\(\eqref{F_i}\)</span>. The exercise price of each caplet is <span class="math inline">\(K=\bar{\mathcal{R}}\,\varDelta t\)</span>. We also need to input the discounting factor <span class="math inline">\(P(0,t_{i+1})\)</span>. The discount bond prices <span class="math inline">\(P(0,t_1)\)</span>, …, <span class="math inline">\(P(0, t_N)\)</span> are input as a vector <code>P</code>. The discount bond price <span class="math inline">\(P(0,t_0)\)</span> is input as <code>P0</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> We will assume the same volatility for each forward rate.</p>

</section>
<section id="valuing-swaptions-with-margrabes-formula" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="valuing-swaptions-with-margrabes-formula">Valuing Swaptions with Margrabe’s Formula</h2>

</section>
</section>
<section id="problems" class="level1 unnumbered">
<h1 class="unnumbered">Problems</h1>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The reason for separating the bond maturing at <span class="math inline">\(t_0\)</span> is that vectors input as arrays from Excel worksheets are automatically indexed beginning with the index 1. To keep the indexing consistent with our notation, we want the first element of the input vector to be <span class="math inline">\(P(0,t_1)\)</span>, the second element to be <span class="math inline">\(P(0,t_2)\)</span>, etc. This consistency is convenient, though obviously not essential.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter11.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Income Concepts</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter13.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valuing Derivatives in the Extended Vasicek Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>