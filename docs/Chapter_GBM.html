<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Geometric Brownian Motion – Pricing and Hedging Derivative Securities: Theory and Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter_Girsanov.html" rel="next">
<link href="./Chapter_Ito.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bb6b93f51bf5a7975605005bd985cc1c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<style>
.Done {
  --color1: #e8cc97;
  --color2: #7d6538;
}
.Rule {
  --color1: #a1bced;
  --color2: #38568f;
}
.Extra {
  --color1: #d5deed;
  --color2: #6d778a;
}
.Principle {
  --color1: #e3aab2;
  --color2: #8f575f;
}
.ToDo {
  --color1: #a7f2d8;
  --color2: #50997f;
}
.InProgress {
  --color1: #eaacf2;
  --color2: #75387d;
}
.Exercise {
  --color1: #ede29d;
  --color2: #8c813a;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_Brownian.html">Part II: Mathematical Tools</a></li><li class="breadcrumb-item"><a href="./Chapter_GBM.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Geometric Brownian Motion</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pricing and Hedging Derivative Securities: Theory and Methods</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/math-finance-book/book-code.git" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Options.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Options</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Futures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Futures and Swaps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Arbitrage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Arbitrage Pricing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Digitals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Pricing Digitals</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Mathematical Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Brownian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Brownian Motion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Ito.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ito Processes and Ito’s Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_GBM.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Geometric Brownian Motion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Girsanov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Girsanov’s Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Deltas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Delta Hedges and PDEs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Black-Scholes and Extensions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_BlackScholes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Black-Scholes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Americans.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">American Options</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Greeks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Greeks and Hedging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FX.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">FX and Quantos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Merton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Merton, Black, and Margrabe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Asians.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Asians, Baskets, and Spreads</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Exotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Other Exotics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Alternative Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_GARCH.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">GARCH Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_StochasticVol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Stochastic Volatility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Jumps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Jumps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_VarianceSwaps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variance Swaps</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Numerical Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_MonteCarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Monte Carlo Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Binomial and Trinomial Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_PDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">PDE Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Fourier Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_MachineLearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VI: Fixed Income</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FixedIncome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fixed-Income Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_FixedIncomeDerivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fixed-Income Derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Vasicek.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Vasicek and Extensions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_Survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Term Structure Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Miscellaneous Facts about Continuous-Time Models</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_Brownian.html">Part II: Mathematical Tools</a></li><li class="breadcrumb-item"><a href="./Chapter_GBM.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Geometric Brownian Motion</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-s:geometricbrownianmotion" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Geometric Brownian Motion</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A random variable is lognormally distributed if it can be written as <span class="math inline">\(\tilde{y}=  e^{\tilde{x}}\)</span> where <span class="math inline">\(\tilde{x}\)</span> is distributed according to a normal distribution with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(s\)</span>. The expected value of <span class="math inline">\(\tilde{y}\)</span> is given by <span class="math inline">\(\mathbb{E}[\tilde{y}] = e^{m+\frac{s^2}{2}}\)</span>.</p>
<div id="Rule-7.1" class="Rule">
<p></p><details class="Rule fbx-simplebox fbx-default" open=""><summary><strong>Calculation Rule 7.1</strong></summary><div><strong>Lognormal Random Variable.</strong>; If <span class="math inline">\(\tilde{x}\)</span> is normally distributed with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(s\)</span>, then <span class="math inline">\(e^{\tilde{x}}\)</span> is lognormally distributed and <span id="eq-lognormal"><span class="math display">\[\mathbb{E}[e^{\tilde{x}}]=e^{m + \frac{1}{2} s^2};.
\qquad(7.1)\]</span></span><p></p>
</div></details>
</div>
<p>An important stochastic process is geometric Brownian motion given by <span id="eq-exponential1"><span class="math display">\[
S_t=S_0\exp\left(\mu t- \sigma^2 t/2 + \sigma B_t\right)
\qquad(7.2)\]</span></span></p>
<p>for constants <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, where <span class="math inline">\(B\)</span> is a Brownian motion. Note that for each time <span class="math inline">\(t\)</span>, the random variable <span class="math inline">\(S_t\)</span> in <span class="quarto-unresolved-ref">?eq-exponential</span> is a lognormal random variable. Using the product rule and the rule for exponentials, we obtain <span id="eq-Y"><span class="math display">\[
\frac{\,\mathrm{d}S}{S} = \mu\,\mathrm{d}t+\sigma\,\mathrm{d}B\;.
\qquad(7.3)\]</span></span></p>
<p>When we see an equation of the form <a href="#eq-Y" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>, we should recognize <a href="#eq-exponential1" class="quarto-xref">Equation&nbsp;<span>7.2</span></a> as the solution.</p>
<p>The process <span class="math inline">\(S\)</span> is called a geometric Brownian motion. In keeping with the discussion of <a href="Chapter_Ito.html#sec-s:itoprocesses" class="quarto-xref"><span>Section 6.2</span></a>, we interpret <a href="#eq-Y" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> as stating that <span class="math inline">\(\mu\,\mathrm{d}t\)</span> is the expected rate of change of <span class="math inline">\(S\)</span> and <span class="math inline">\(\sigma^2\,\mathrm{d}t\)</span> is the variance of the rate of change in an instant <span class="math inline">\(\,\mathrm{d}t\)</span>. We call <span class="math inline">\(\mu\)</span> the drift and <span class="math inline">\(\sigma\)</span> the volatility. The geometric Brownian motion will grow at the average rate of <span class="math inline">\(\mu\)</span>, in the sense that <span class="math inline">\(\mathbb{E}[S_t] = \mathrm{e}^{\mu t}S_0\)</span>; one way to verify this uses the formula for the mean of a lognormal random variable.</p>
<p>Taking the natural logarithm of <a href="#eq-exponential1" class="quarto-xref">Equation&nbsp;<span>7.2</span></a> gives an equivalent form of the solution: <span id="eq-exponential2"><span class="math display">\[
\log S_t= \log S_0+\left(\mu -\frac{1}{2}\sigma^2\right)t + \sigma B_t\;.
\qquad(7.4)\]</span></span> This shows that <span class="math inline">\(\log S_t - \log S_0\)</span> is a <span class="math inline">\((\mu-\sigma^2/2,\sigma)\)</span>–Brownian motion. Given information at time <span class="math inline">\(t\)</span>, the logarithm of <span class="math inline">\(S(u)\)</span> for <span class="math inline">\(u&gt;t\)</span> is normally distributed with mean <span class="math inline">\((u-t)(\mu-\sigma^2/2)\)</span> and variance <span class="math inline">\((u-t)\sigma^2\)</span>. Because <span class="math inline">\(S\)</span> is the exponential of its logarithm, <span class="math inline">\(S\)</span> can never be negative. For this reason, a geometric Brownian motion is a better model for stock prices than is a Brownian motion.</p>
<p>The differential of <a href="#eq-exponential2" class="quarto-xref">Equation&nbsp;<span>7.4</span></a> is <span id="eq-exponential3"><span class="math display">\[
\,\mathrm{d}\log S_t = \left(\mu -\frac{1}{2}\sigma^2\right)\,\mathrm{d}t+ \sigma\,\mathrm{d}B_t\;.
\qquad(7.5)\]</span></span></p>
<p>We conclude:</p>
<div id="Rule-7.2" class="Rule">
<p></p><details class="Rule fbx-simplebox fbx-default" open=""><summary><strong>Calculation Rule 7.2</strong></summary><div>The equation <span class="math display">\[\frac{\,\mathrm{d}S}{S} = \mu\,\mathrm{d}t+\sigma\,\mathrm{d}B\]</span> is equivalent to the equation <span class="math display">\[\,\mathrm{d}\log S = \left(\mu -\frac{1}{2}\sigma^2\right)\,\mathrm{d}t+ \sigma\,\mathrm{d}B\; .\]</span> The solution of both equations is <a href="#eq-exponential1" class="quarto-xref">Equation&nbsp;<span>7.2</span></a> or the equivalent <a href="#eq-exponential2" class="quarto-xref">Equation&nbsp;<span>7.4</span></a>.<p></p>
</div></details>
</div>
<p>Over a discrete time interval <span class="math inline">\(\Delta t\)</span>, <a href="#eq-exponential3" class="quarto-xref">Equation&nbsp;<span>7.5</span></a> implies that the change in the logarithm of <span class="math inline">\(S\)</span> is <span id="eq-exponential11"><span class="math display">\[
\Delta \log S = \left(\mu -\frac{1}{2}\sigma^2\right)\Delta t+ \sigma\,\Delta B\;.
\qquad(7.6)\]</span></span></p>
<p>If <span class="math inline">\(S\)</span> is the price of a non-dividend-paying asset, then over the time period <span class="math inline">\(t_{i-1}\)</span> to <span class="math inline">\(t_i\)</span>, with <span class="math inline">\(t_i-t_{i-1}=\Delta t\)</span>, we have <span id="eq-exponential10"><span class="math display">\[
\Delta \log S = r_i\,\Delta t\;,
\qquad(7.7)\]</span></span></p>
<p>where <span class="math inline">\(r_i\)</span> is the continuously compounded annualized rate of return during the period <span class="math inline">\(\Delta t\)</span>. This follows from the definition of the continuously compounded rate of return as the constant rate over the time period <span class="math inline">\(\Delta t\)</span> that would cause <span class="math inline">\(S\)</span> to grow (or fall) from <span class="math inline">\(S_{t_{i-1}}\)</span> to <span class="math inline">\(S_{t_i}\)</span>. To be precise, <span class="math inline">\(r_i\)</span> is defined by <span class="math display">\[\frac{S_{t_i}}{S_{t_{i-1}}} = \mathrm{e}^{r_i\Delta t}\; ,\]</span> which is equivalent to <a href="#eq-exponential10" class="quarto-xref">Equation&nbsp;<span>7.7</span></a>. Thus, the geometric Brownian motion model (<a href="#eq-Y" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>)implies that the continuously compounded annualized rate of return over a period of length <span class="math inline">\(\Delta t\)</span> is given by <span class="math display">\[r_i = \mu -\frac{1}{2}\sigma^2+ \frac{\sigma\Delta B}{\Delta t}\; .\]</span> This means that <span class="math inline">\(r_i\)</span> is normally distributed with mean <span class="math inline">\(\mu-\sigma^2/2\)</span> and variance <span class="math inline">\(\sigma^2/\Delta t\)</span>. Given historical data on the rates of return, the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> can be estimated by standard methods (see <a href="Chapter_StochasticVol.html" class="quarto-xref"><span>Chapter 18</span></a>).</p>
<p>We can simulate a path of <span class="math inline">\(S\)</span> by simulating the changes <span class="math inline">\(\Delta \log S\)</span>. The random variable <span class="math inline">\(\sigma \Delta B\)</span> in <a href="#eq-exponential11" class="quarto-xref">Equation&nbsp;<span>7.6</span></a> has a normal distribution with zero mean and variance equal to <span class="math inline">\(\sigma^2\Delta t\)</span>. We simulate it as <span class="math inline">\(\sigma\sqrt{\Delta t}\)</span> multiplied by a standard normal. The code below simulates <span class="math inline">\(n=10000\)</span> paths with <span class="math inline">\(m=1000\)</span> time steps. There are some features of the simulation which will prove useful later. The drift <span class="math inline">\(\mu\)</span> is labelled the interest rate <span class="math inline">\(r=0.1\)</span>. Other parameters are <span class="math inline">\(\sigma = 0.2\)</span>, and <span class="math inline">\(T=0.5\)</span>. The drift of the log stock price is labelled <span class="math inline">\(drift=r-\frac{\sigma^2}{2}\)</span>. The plot output is one of the simulated sample paths. In practice, if we are only interested in the terminal value of the stock price we would use many fewer subdivisions, <span class="math inline">\(n=1\)</span>. Given a simulated mean zero normal random variable, <span class="math inline">\(z\)</span>, changing the sign to <span class="math inline">\(-z\)</span> is also a simulated normal random variable with zero mean and the same standard deviation. As a result, we have two simulations for the stock price labelled <span class="math inline">\(St\)</span> and <span class="math inline">\(St1\)</span>, but we only plot one sample path for <span class="math inline">\(St\)</span>.</p>
<div id="90ac82da" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate geometric Brownian motion</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">import numpy as np</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">import matplotlib.pyplot as plt</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># number of paths</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">n = 10000</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#number of divisions</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">m = 1000</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Interest rate (We set the drift equal to the interest rate)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">r = 0.1</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Volatility</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">sig = 0.2</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial Stock Price</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">S0 = 42</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Maturity</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">T = 0.5</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Delta t</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">dt = T/m</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Drift</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">drift = (r-0.5*sig**2)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Volatility</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">vol = sig * np.sqrt(dt)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">t = np.array(range(0,m + 1,1)) * dt</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># seed for random generator</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">seed= 2020</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># define a random generator</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">np.random.seed(seed)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">inc = np.zeros(shape = (m + 1, n))</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">inc[1:] = np.transpose(np.random.normal(loc = 0, scale = vol,size = (n,m)))</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">St = np.zeros(shape = (m + 1, n))</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">St = S0 * np.exp(np.cumsum(inc,axis=0) + (drift * t[0:m + 1])[:,None])</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">St1 = S0 * np.exp(-np.cumsum(inc,axis=0) + (drift * t[0:m + 1])[:,None])</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">plt.figure(figsize=(9,6))</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">plt.plot(t,St[:,1])</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>'\n# Simulate geometric Brownian motion\nimport numpy as np\nimport matplotlib.pyplot as plt\n# number of paths\nn = 10000\n#number of divisions\nm = 1000\n# Interest rate (We set the drift equal to the interest rate)\nr = 0.1\n# Volatility\nsig = 0.2\n# Initial Stock Price\nS0 = 42\n# Maturity\nT = 0.5\n# Delta t\ndt = T/m\n# Drift\ndrift = (r-0.5*sig**2)\n# Volatility\nvol = sig * np.sqrt(dt)\n\nt = np.array(range(0,m + 1,1)) * dt\n\n# seed for random generator\nseed= 2020\n# define a random generator\nnp.random.seed(seed)\ninc = np.zeros(shape = (m + 1, n))\ninc[1:] = np.transpose(np.random.normal(loc = 0, scale = vol,size = (n,m)))\nSt = np.zeros(shape = (m + 1, n))\nSt = S0 * np.exp(np.cumsum(inc,axis=0) + (drift * t[0:m + 1])[:,None])\nSt1 = S0 * np.exp(-np.cumsum(inc,axis=0) + (drift * t[0:m + 1])[:,None])\nplt.figure(figsize=(9,6))\nplt.plot(t,St[:,1])\n'</code></pre>
</div>
</div>
<p>The plot below is the distribution of the simulated stock price at <span class="math inline">\(T\)</span>.</p>
<div id="fe1bf98a" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">plt.figure(figsize=(9,6))</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">a=plt.hist(St[m,:], bins=100)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>'\nplt.figure(figsize=(9,6))\na=plt.hist(St[m,:], bins=100)\n'</code></pre>
</div>
</div>
<section id="sec-s:reinvestingdividends" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sec-s:reinvestingdividends"><span class="header-section-number">7.1</span> Reinvesting Dividends</h2>
<p>Frequently, we will assume that the asset underlying a derivative security pays a constant dividend yield, which we will denote by <span class="math inline">\(q\)</span>. This means, for an asset with price <span class="math inline">\(S_t\)</span>, that the dividend in an instant <span class="math inline">\(\,\mathrm{d}t\)</span> is <span class="math inline">\(q S_t\,\mathrm{d}t\)</span>. If the dividends are reinvested in new shares, the number of shares will grow exponentially at rate <span class="math inline">\(q\)</span>. To see this, consider the portfolio starting with a single share of the asset and reinvesting dividends until some date <span class="math inline">\(T\)</span>. Let <span class="math inline">\(X_t\)</span> denote the number of shares resulting from this strategy at any time <span class="math inline">\(t\leq T\)</span>. Then the dividend received at date <span class="math inline">\(t\)</span> is <span class="math inline">\(q S_tX_t\,\mathrm{d}t\)</span>, which can be used to purchase <span class="math inline">\(q X_t\,\mathrm{d}t\)</span> new shares. This implies that <span class="math inline">\(\,\mathrm{d}X_t=q X_t\,\mathrm{d}t\)</span>, or <span class="math inline">\(\,\mathrm{d}X_t/\,\mathrm{d}t = q X_t\)</span>, and it is easy to check (and very well known) that this equation is solved by <span class="math inline">\(X_t=\mathrm{e}^{q t}X_0\)</span>. In our case, with <span class="math inline">\(X_0=1\)</span>, we have <span class="math inline">\(X_t=\mathrm{e}^{q t}\)</span>.</p>
<p>The dollar value of the trading strategy just described will be <span class="math inline">\(X_tS_t = \mathrm{e}^{q t}S_t\)</span>. Denote this by <span class="math inline">\(V_t\)</span>. This is the value of a non-dividend-paying portfolio, because all dividends are reinvested. From the Compounding/Discounting example in <span class="quarto-unresolved-ref">?sec-s:examples</span>, we know that <span id="eq-reinvestingdividends"><span class="math display">\[
\frac{\,\mathrm{d}V}{V} = q\,\mathrm{d}t + \frac{\,\mathrm{d}S}{S}\;.
\qquad(7.8)\]</span></span></p>
<p>This means that the rate of return on the portfolio is the dividend yield <span class="math inline">\(q\,\mathrm{d}t\)</span> plus the return <span class="math inline">\(\,\mathrm{d}S/S\)</span> due to capital gains.</p>
<p>While geometric Brownian motion is an important stochastic process to model stock prices, the process with drift equal to zero given by <span class="math display">\[X_t = \exp\left(-\frac{\kappa^2}{2} + \kappa B_t\right)\]</span></p>
<p>satisfies <span class="math inline">\(\mathbb{E}[X_t]=1\)</span> and <span class="math inline">\(\mathbb{E}[X_t|X_s]=X_s\)</span> and is an important example of a strictly positive martingale. Again, these facts can be verified using the formula for the expected value of a lognormal random variable. Notice that we can write <span class="math display">\[\,\mathrm{d}X_t= \kappa X_t \,\mathrm{d}B_t\;,\]</span> which agrees with the martingale characterization of <span class="math inline">\(\int_0^t \sigma(X_t,t) \,\mathrm{d}B_t\)</span>.</p>
</section>
<section id="sec-s:volatilities" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sec-s:volatilities"><span class="header-section-number">7.2</span> Volatilities</h2>
<p>As mentioned in <a href="#sec-s:geometricbrownianmotion" class="quarto-xref"><span>Chapter 7</span></a>, when we encounter an equation of the form <span class="math display">\[\frac{\,\mathrm{d}S}{S} = \mu\,\mathrm{d}t + \sigma\,\mathrm{d}B\]</span> where <span class="math inline">\(B\)</span> is a Brownian motion, we will say <span class="math inline">\(\sigma\)</span> is the volatility of <span class="math inline">\(S\)</span>. We will occasionally need to compute the volatilities of products or ratios of random processes. These computations follow directly from Ito’s formula.</p>
<p>Suppose <span class="math display">\[\frac{\,\mathrm{d}X}{X} = \mu_x\,\mathrm{d}t + \sigma_x\,\mathrm{d}B_x \qquad \text{and} \qquad
\frac{\,\mathrm{d}Y}{Y} = \mu_y\,\mathrm{d}t + \sigma_y\,\mathrm{d}B_y\; ,\]</span> where <span class="math inline">\(B_x\)</span> and <span class="math inline">\(B_y\)</span> are Brownian motions with correlation <span class="math inline">\(\rho\)</span>, and <span class="math inline">\(\mu_x\)</span>, <span class="math inline">\(\mu_y\)</span>, <span class="math inline">\(\sigma_x\)</span>, <span class="math inline">\(\sigma_y\)</span>, and <span class="math inline">\(\rho\)</span> may be quite general random processes.</p>
<section id="products" class="level3">
<h3 class="anchored" data-anchor-id="products">Products</h3>
<p>If <span class="math inline">\(Z=XY\)</span>, then <a href="Chapter_Ito.html#eq-rule2" class="quarto-xref">Equation&nbsp;<span>6.28</span></a> gives us <span id="eq-volproduct1"><span class="math display">\[
\frac{\,\mathrm{d}Z}{Z} = (\mu_x+\mu_y+\rho\sigma_x\sigma_y)\,\mathrm{d}t + \sigma_x\,\mathrm{d}B_x + \sigma_y\,\mathrm{d}B_y\;.
\qquad(7.9)\]</span></span></p>
<p>The instantaneous variance of <span class="math inline">\(\,\mathrm{d}Z/Z\)</span> is calculated, using the rules for products of differentials, as <span class="math display">\[\begin{align*}
\left(\frac{\,\mathrm{d}Z}{Z}\right)^2 &amp;= (\sigma_x\,\mathrm{d}B_x + \sigma_y\,\mathrm{d}B_y)^2\\
&amp;= (\sigma_x^2 + \sigma_y^2 + 2\rho\sigma_x\sigma_y)\,\mathrm{d}t\;.
\end{align*}\]</span> As will be explained below, the volatility is the square root of the instantaneous variance (dropping the <span class="math inline">\(\,\mathrm{d}t\)</span>). This implies:</p>
<div id="section" class="Rule" title="">
<p></p><details class="Rule fbx-simplebox fbx-default" open=""><summary><strong>Calculation Rule 7.3</strong></summary><div>The volatility of <span class="math inline">\(XY\)</span> is <span id="eq-volatilityproduct"><span class="math display">\[
\sqrt{\sigma_x^2 + \sigma_y^2 + 2\rho\sigma_x\sigma_y}\;.
\qquad(7.10)\]</span></span><p></p>
</div></details>
</div>
</section>
<section id="ratios" class="level3">
<h3 class="anchored" data-anchor-id="ratios">Ratios</h3>
<p>If <span class="math inline">\(Z=Y/X\)</span>, then <a href="Chapter_Ito.html#eq-rule4" class="quarto-xref">Equation&nbsp;<span>6.29</span></a> gives us <span id="eq-ratioproduct1"><span class="math display">\[
\frac{\,\mathrm{d}Z}{Z} = (\mu_y-\mu_x-\rho\sigma_x\sigma_y+\sigma_x^2)\,\mathrm{d}t + \sigma_y\,\mathrm{d}B_y - \sigma_x\,\mathrm{d}B_x\;.
\qquad(7.11)\]</span></span></p>
<p>The instantaneous variance of <span class="math inline">\(\,\mathrm{d}Z/Z\)</span> is therefore <span class="math display">\[\begin{align*}
\left(\frac{\,\mathrm{d}Z}{Z}\right)^2 &amp;= (\sigma_y\,\mathrm{d}B_y - \sigma_x\,\mathrm{d}B_x)^2\\
&amp;= (\sigma_x^2 + \sigma_y^2 - 2\rho\sigma_x\sigma_y)\,\mathrm{d}t\;.
\end{align*}\]</span> This implies:</p>
<div id="section-1" class="Rule" title="">
<p></p><details class="Rule fbx-simplebox fbx-default" open=""><summary><strong>Calculation Rule 7.4</strong></summary><div>The volatility of <span class="math inline">\(Y/X\)</span> is<br>
<span id="eq-volatilityratio"><span class="math display">\[
\sqrt{\sigma_x^2 + \sigma_y^2 - 2\rho\sigma_x\sigma_y}\;.
\qquad(7.12)\]</span></span><p></p>
</div></details>
</div>
<div id="Extra-7.1" class="Extra">
<p></p><details class="Extra fbx-simplebox fbx-default"><summary><strong>Theory Extra 7.1</strong></summary><div>To understand why taking the square root of <span class="math inline">\((\,\mathrm{d}Z/Z)^2\)</span> (dropping the <span class="math inline">\(\,\mathrm{d}t\)</span>) gives the volatility, consider for example the product case <span class="math inline">\(Z=XY\)</span>. Define a random process <span class="math inline">\(B\)</span> by <span class="math inline">\(B_0=0\)</span> and <span class="math display">\[
\,\mathrm{d}B = \frac{\sigma_x}{\sigma}\,\mathrm{d}B_x + \frac{\sigma_y}{\sigma}\,\mathrm{d}B_y\;,
\]</span> {#eq-foreign}<p></p>
<p>where <span class="math inline">\(\sigma\)</span> is the volatility defined in <a href="#eq-volatilityproduct" class="quarto-xref">Equation&nbsp;<span>7.10</span></a>. Then we can write <a href="#eq-volproduct1" class="quarto-xref">Equation&nbsp;<span>7.9</span></a> as <span id="eq-volproduct2"><span class="math display">\[
\frac{\,\mathrm{d}Z}{Z} = \left(\mu_x +\mu_y+ \rho\sigma_x\sigma_y\right)\,\mathrm{d}t + \sigma\,\mathrm{d}B\;. \qquad(7.13)\]</span></span></p>
<p>From the discussion in <a href="Chapter_Ito.html#sec-s:itoprocesses" class="quarto-xref"><span>Section 6.2</span></a>, we know that <span class="math inline">\(B\)</span> is a continuous martingale. We can compute its quadratic variation from <span class="math display">\[\begin{align*}
(\,\mathrm{d}B)^2 &amp;= \left(\frac{\sigma_x\,\mathrm{d}B_x + \sigma_s\,\mathrm{d}B_s}{\sigma}\right)^2\\
&amp;= \frac{(\sigma_x^2 + \sigma_s^2 + 2\rho\sigma_x\sigma_s)\,\mathrm{d}t}{\sigma^2}\; ,\\
&amp;= \,\mathrm{d}t\;.
\end{align*}\]</span> By Levy’s theorem (see <a href="Chapter_Brownian.html#sec-s:quadraticvariation" class="quarto-xref"><span>Section 5.3</span></a>), any continuous martingale with this quadratic variation is necessarily a Brownian motion. Therefore, <a href="#eq-volproduct2" class="quarto-xref">Equation&nbsp;<span>7.13</span></a> shows that <span class="math inline">\(\sigma\)</span> is the volatility of <span class="math inline">\(Z\)</span> as defined at the beginning of the section.</p>
</div></details>
</div>
</section>
</section>
<section id="section-2" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="section-2"></h2>
<div id="Exercise-7.1" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.1</strong></summary><div>Consider a discrete partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_i - t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>. Consider the function <span class="math display">\[X_t=\mathrm{e}^t\; .\]</span> Write a code, which computes and plots <span class="math inline">\(\sum_{i=1}^N [\Delta X_{t_i}]^2\)</span>, where <span class="math display">\[\Delta X_{t_i} = X_{t_i}-X_{t_{i-1}} = \mathrm{e}^{t_i} - \mathrm{e}^{t_{i-1}}\; .\]</span><p></p>
</div></details>
</div>
<div id="Exercise-7.2" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.2</strong></summary><div>Repeat the previous problem for the function <span class="math inline">\(X_t = t^3\)</span>. In both this and the previous problem, what happens to <span class="math inline">\(\sum_{i=1}^N [\Delta X_{t_i}]^2\)</span> as <span class="math inline">\(N \rightarrow \infty\)</span>?<p></p>
</div></details>
</div>
<div id="Exercise-7.3" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.3</strong></summary><div>Either use the code provided or write a code to compute <span class="math inline">\(\sum_{i=1}^N [\Delta B_{t_i}]^2\)</span>, where <span class="math inline">\(B\)</span> is a simulated Brownian motion. For a given <span class="math inline">\(T\)</span>, what happens to the sum as <span class="math inline">\(N \rightarrow \infty\)</span>?<p></p>
</div></details>
</div>
<div id="Exercise-7.4" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.4</strong></summary><div>Repeat the previous problem to compute <span class="math inline">\(\sum_{i=1}^N [\Delta B_{t_i}]^3\)</span>, where <span class="math inline">\(B\)</span> is a simulated Brownian motion. For a given <span class="math inline">\(T\)</span>, what happens to the sum as <span class="math inline">\(N \rightarrow \infty\)</span>?<p></p>
</div></details>
</div>
<div id="Exercise-7.5" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.5</strong></summary><div>Repeat the previous problem, computing instead <span class="math inline">\(\sum_{i=1}^N |\Delta B_{t_i}|\)</span> where <span class="math inline">\(| \cdot |\)</span> denotes the absolute value. What happens to this sum as <span class="math inline">\(N \rightarrow \infty\)</span>?<p></p>
</div></details>
</div>
<div id="Exercise-7.6" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.6</strong></summary><div>Use Ito’s Lemma to derive the stochastic differential equation for <span class="math inline">\(S_t^2\)</span>. Argue that <span class="math inline">\(S_t^2\)</span> is geometric Brownian motion and find <span class="math inline">\(\mathbb{E}[S_t^2]\)</span>.<p></p>
</div></details>
</div>
<div id="Exercise-7.7" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.7</strong></summary><div>Ito’s Lemma can be used in different ways to get the same answer. For example, let <span class="math inline">\(X_t = a t + b B_t\)</span> and use Ito’s lemma on the function <span class="math inline">\(e^{X_t}\)</span>. Alternatively, let <span class="math inline">\(f(t, B_t) = e^{a t + bB_t}\)</span>. Use Ito’s lemma on <span class="math inline">\(f(,)\)</span>.<p></p>
</div></details>
</div>
<div id="Exercise-7.8" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.8</strong></summary><div>Use the facts <span class="math inline">\(e^{x+y}=e^x \times e^y\)</span> and <span class="math inline">\(\frac{e^x}{e^y} = e^{x-y}\)</span> to deduce the drift and volatility of the product and ratio of two geometric Brownian motions.<p></p>
</div></details>
</div>
<div id="Exercise-7.9" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.9</strong></summary><div>Consider a discrete partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_i - t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>. Consider a geometric Brownian motion <span class="math display">\[\frac{\,\mathrm{d}Z}{Z} = \mu\,\mathrm{d}t + \sigma\,\mathrm{d}B\; .\]</span> An approximate path <span class="math inline">\(\tilde{Z}_t\)</span> of the geometric Brownian motion can be simulated as <span id="eq-exponential111"><span class="math display">\[
\Delta \tilde{Z}_{t_i} = \tilde{Z}_{t_{i-1}} \big[ \mu\,\Delta t + \sigma\,\Delta B\big]\;.
\qquad(7.14)\]</span></span> Modify the code to generate both a path <span class="math inline">\(Z_t\)</span> and an approximate path <span class="math inline">\(\tilde{Z}_t\)</span> according to <a href="#eq-exponential111" class="quarto-xref">Equation&nbsp;<span>7.16</span></a>, using the same <span class="math inline">\(\Delta B\)</span> for both paths and taking <span class="math inline">\(\tilde{Z}_0 = Z_0\)</span>. Plot both paths in the same figure. How well does the approximation work for large <span class="math inline">\(N\)</span>? Warning:<br>
For <span class="math inline">\(N\)</span> larger than about <span class="math inline">\(100 T\)</span>, the approximation will look perfect—you won’t be able to tell that there are two plots in the figure. One reason this is true is an exact formula is <span id="eq-exponential112"><span class="math display">\[
Z_{t_i} = Z_{t_{i-1}} \exp\left[ \left(\mu -\frac{\sigma^2}{2}\right)\,\Delta t + \sigma\,\Delta B\right]\;.
\qquad(7.15)\]</span></span> and using Taylor’s Theorem for small <span class="math inline">\(\Delta t\)</span>, <span class="math inline">\(e^{\left(\mu-\frac{\sigma^2}{2}\right) \Delta t} \approx 1+ \left(\mu-\frac{\sigma^2}{2}\right) \Delta t\)</span> and <span class="math inline">\(e^{\sigma \Delta B_t} \approx 1+ \sigma \Delta B_t +\frac{1}{2}\sigma^2 (\Delta B_t)^2\)</span> and <span class="math inline">\((\,\mathrm{d}B_t)^2=\Delta t\)</span>.<p></p>
</div></details>
</div>
<div id="Exercise-7.10" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.10</strong></summary><div>Use simulation to find <span class="math inline">\(\mathbb{E}^*[e^{-r T}{\mathbf{1}}_{\{S_t \ge K\}}]\)</span> in the risk-neutral probability where <span class="math display">\[\begin{equation*}
\,\mathrm{d}S_t= r S_t \,\mathrm{d}t + \sigma S_t \,\mathrm{d}B_t^*
\end{equation*}\]</span> Verify that <span class="math inline">\(S_t/e^{r t}\)</span> is a martingale in the <span class="math inline">\(*\)</span> measure where <span class="math inline">\(B^*\)</span> is a Brownian motion. Then use simulation to find <span class="math inline">\(S_0\mathbb{E}^S[\frac{1}{S_t} {\mathbf{1}}_{\{S_t \ge K\}}]\)</span> in the pricing measure which uses the share as numeraire where <span class="math display">\[\begin{equation*}
\,\mathrm{d}S_t = (r + \sigma^2) S_t \,\mathrm{d}t + \sigma S_t \,\mathrm{d}B_t^S
\end{equation*}\]</span> so the log satisfies <span class="math display">\[\begin{equation*}
\log(S_t) = \log(S_0) + (r + \frac{\sigma^2}{2})t + \sigma B_t^S
\end{equation*}\]</span> You should verify <span class="math inline">\(e^{rt}/S_t\)</span> is a martingale in the <span class="math inline">\(S\)</span> measure where <span class="math inline">\(B^S\)</span> is a Brownian motion. Both estimates should be the same up to simulation error and give the time zero value of the random payoff <span class="math inline">\({\mathbf{1}}_{\{S_t \ge K\}}\)</span> which is a random variable equal to <span class="math inline">\(1\)</span> if <span class="math inline">\(S_t\ge K\)</span> and <span class="math inline">\(0\)</span> otherwise. You should choose the values for <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(K\)</span>.<p></p>
</div></details>
</div>
</section>
<section id="section-3" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="section-3"></h2>
<div id="Exercise-7.11" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.11</strong></summary><div>Use Ito’s formula to derive the stochastic differential equation for <span class="math inline">\(S_t^2\)</span>. Argue that <span class="math inline">\(S_t^2\)</span> is geometric Brownian motion and find <span class="math inline">\(\mathbb{E}[S_t^2]\)</span>.<p></p>
</div></details>
</div>
<div id="Exercise-7.12" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.12</strong></summary><div>Use the facts <span class="math inline">\(\mathrm{e}^{x+y}=\mathrm{e}^x \times \mathrm{e}^y\)</span> and <span class="math inline">\(\frac{\mathrm{e}^x}{\mathrm{e}^y} = \mathrm{e}^{x-y}\)</span> to deduce the drift and volatility of the product and ratio of two geometric Brownian motions.<p></p>
</div></details>
</div>
<div id="Exercise-7.13" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.13</strong></summary><div>Consider a discrete partition <span class="math inline">\(0=t_0 &lt; t_1 &lt; \cdots t_N=T\)</span> of the time interval <span class="math inline">\([0,T]\)</span> with <span class="math inline">\(t_i - t_{i-1} = \Delta t = T/N\)</span> for each <span class="math inline">\(i\)</span>. Consider a geometric Brownian motion <span class="math display">\[\frac{\,\mathrm{d}Z}{Z} = \mu\,\mathrm{d}t + \sigma\,\mathrm{d}B\; .\]</span> An approximate path <span class="math inline">\(\tilde{Z}_t\)</span> of the geometric Brownian motion can be simulated as <span id="eq-exponential111"><span class="math display">\[
\Delta \tilde{Z}_{t_i} = \tilde{Z}_{t_{i-1}} \big[ \mu\,\Delta t + \sigma\,\Delta B\big]\;.
\qquad(7.16)\]</span></span> Modify the code to generate both a path <span class="math inline">\(Z_t\)</span> and an approximate path <span class="math inline">\(\tilde{Z}_t\)</span> according to <a href="#eq-exponential111" class="quarto-xref">Equation&nbsp;<span>7.16</span></a>, using the same <span class="math inline">\(\Delta B\)</span> for both paths and taking <span class="math inline">\(\tilde{Z}_0 = Z_0\)</span>. Plot both paths in the same figure. How well does the approximation work for large <span class="math inline">\(N\)</span>? Warning:<br>
For <span class="math inline">\(N\)</span> larger than about <span class="math inline">\(100 T\)</span>, the approximation will look perfect—you won’t be able to tell that there are two plots in the figure. One reason this is true is an exact formula is <span id="eq-exponential112"><span class="math display">\[
Z_{t_i} = Z_{t_{i-1}} \exp\left[ \left(\mu -\frac{\sigma^2}{2}\right)\,\Delta t + \sigma\,\Delta B\right]\;.
\qquad(7.17)\]</span></span> and using Taylor’s Theorem for small <span class="math inline">\(\Delta t\)</span>, <span class="math inline">\(\mathrm{e}^{\left(\mu-\frac{\sigma^2}{2}\right) \Delta t} \approx 1+ \left(\mu-\frac{\sigma^2}{2}\right) \Delta t\)</span> and <span class="math inline">\(\mathrm{e}^{\sigma \Delta B_t} \approx 1+ \sigma \Delta B_t +\frac{1}{2}\sigma^2 (\Delta B_t)^2\)</span> and <span class="math inline">\((\,\mathrm{d}B_t)^2=\Delta t\)</span>.<p></p>
</div></details>
</div>
<div id="Exercise-7.14" class="Exercise">
<p></p><details class="Exercise fbx-simplebox fbx-default"><summary><strong>Exercise 7.14</strong></summary><div>Use simulation to find <span class="math inline">\(\mathbb{E}^*[\mathrm{e}^{-r T}{\mathbf{1}}_{\{S_t \ge K\}}]\)</span> in the risk-neutral probability where <span class="math display">\[\begin{equation*}
\,\mathrm{d}S_t= r S_t \,\mathrm{d}t + \sigma S_t \,\mathrm{d}B_t^*
\end{equation*}\]</span> Verify that <span class="math inline">\(S_t/\mathrm{e}^{r t}\)</span> is a martingale in the <span class="math inline">\(*\)</span> measure where <span class="math inline">\(B^*\)</span> is a Brownian motion. Then use simulation to find <span class="math inline">\(S_0\mathbb{E}^S[\frac{1}{S_t} {\mathbf{1}}_{\{S_t \ge K\}}]\)</span> in the pricing measure which uses the share as numeraire where <span class="math display">\[\begin{equation*}
\,\mathrm{d}S_t = (r + \sigma^2) S_t \,\mathrm{d}t + \sigma S_t \,\mathrm{d}B_t^S
\end{equation*}\]</span> so the log satisfies <span class="math display">\[\begin{equation*}
\log(S_t) = \log(S_0) + (r + \frac{\sigma^2}{2})t + \sigma B_t^S
\end{equation*}\]</span> You should verify <span class="math inline">\(\mathrm{e}^{rt}/S_t\)</span> is a martingale in the <span class="math inline">\(S\)</span> measure where <span class="math inline">\(B^S\)</span> is a Brownian motion. Both estimates should be the same up to simulation error and give the time zero value of the random payoff <span class="math inline">\({\mathbf{1}}_{\{S_t \ge K\}}\)</span> which is a random variable equal to <span class="math inline">\(1\)</span> if <span class="math inline">\(S_t\ge K\)</span> and <span class="math inline">\(0\)</span> otherwise. You should choose the values for <span class="math inline">\(r\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(K\)</span>.<p></p>
</div></details>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter_Ito.html" class="pagination-link" aria-label="Ito Processes and Ito's Formula">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ito Processes and Ito’s Formula</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter_Girsanov.html" class="pagination-link" aria-label="Girsanov's Theorem">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Girsanov’s Theorem</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/math-finance-book/book-code.git/blob/main/Chapter_GBM.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>